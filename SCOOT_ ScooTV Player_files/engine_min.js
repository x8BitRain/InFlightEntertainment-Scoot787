
/***************************************************************************************
Application: JS-Engine
Build: 2015-09-22 10:44:12
Build Number: 125_sb
***************************************************************************************/


//SCRIPT: ../../vendor/js/underscore-min.js
//     Underscore.js 1.5.1
//     http://underscorejs.org
//     (c) 2009-2013 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
//     Underscore may be freely distributed under the MIT license.
!function(){var n=this,t=n._,r={},e=Array.prototype,u=Object.prototype,i=Function.prototype,a=e.push,o=e.slice,c=e.concat,l=u.toString,f=u.hasOwnProperty,s=e.forEach,p=e.map,v=e.reduce,h=e.reduceRight,d=e.filter,g=e.every,m=e.some,y=e.indexOf,b=e.lastIndexOf,x=Array.isArray,_=Object.keys,w=i.bind,j=function(n){return n instanceof j?n:this instanceof j?(this._wrapped=n,void 0):new j(n)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=j),exports._=j):n._=j,j.VERSION="1.5.1";var A=j.each=j.forEach=function(n,t,e){if(null!=n)if(s&&n.forEach===s)n.forEach(t,e);else if(n.length===+n.length){for(var u=0,i=n.length;i>u;u++)if(t.call(e,n[u],u,n)===r)return}else for(var a in n)if(j.has(n,a)&&t.call(e,n[a],a,n)===r)return};j.map=j.collect=function(n,t,r){var e=[];return null==n?e:p&&n.map===p?n.map(t,r):(A(n,function(n,u,i){e.push(t.call(r,n,u,i))}),e)};var E="Reduce of empty array with no initial value";j.reduce=j.foldl=j.inject=function(n,t,r,e){var u=arguments.length>2;if(null==n&&(n=[]),v&&n.reduce===v)return e&&(t=j.bind(t,e)),u?n.reduce(t,r):n.reduce(t);if(A(n,function(n,i,a){u?r=t.call(e,r,n,i,a):(r=n,u=!0)}),!u)throw new TypeError(E);return r},j.reduceRight=j.foldr=function(n,t,r,e){var u=arguments.length>2;if(null==n&&(n=[]),h&&n.reduceRight===h)return e&&(t=j.bind(t,e)),u?n.reduceRight(t,r):n.reduceRight(t);var i=n.length;if(i!==+i){var a=j.keys(n);i=a.length}if(A(n,function(o,c,l){c=a?a[--i]:--i,u?r=t.call(e,r,n[c],c,l):(r=n[c],u=!0)}),!u)throw new TypeError(E);return r},j.find=j.detect=function(n,t,r){var e;return O(n,function(n,u,i){return t.call(r,n,u,i)?(e=n,!0):void 0}),e},j.filter=j.select=function(n,t,r){var e=[];return null==n?e:d&&n.filter===d?n.filter(t,r):(A(n,function(n,u,i){t.call(r,n,u,i)&&e.push(n)}),e)},j.reject=function(n,t,r){return j.filter(n,function(n,e,u){return!t.call(r,n,e,u)},r)},j.every=j.all=function(n,t,e){t||(t=j.identity);var u=!0;return null==n?u:g&&n.every===g?n.every(t,e):(A(n,function(n,i,a){return(u=u&&t.call(e,n,i,a))?void 0:r}),!!u)};var O=j.some=j.any=function(n,t,e){t||(t=j.identity);var u=!1;return null==n?u:m&&n.some===m?n.some(t,e):(A(n,function(n,i,a){return u||(u=t.call(e,n,i,a))?r:void 0}),!!u)};j.contains=j.include=function(n,t){return null==n?!1:y&&n.indexOf===y?n.indexOf(t)!=-1:O(n,function(n){return n===t})},j.invoke=function(n,t){var r=o.call(arguments,2),e=j.isFunction(t);return j.map(n,function(n){return(e?t:n[t]).apply(n,r)})},j.pluck=function(n,t){return j.map(n,function(n){return n[t]})},j.where=function(n,t,r){return j.isEmpty(t)?r?void 0:[]:j[r?"find":"filter"](n,function(n){for(var r in t)if(t[r]!==n[r])return!1;return!0})},j.findWhere=function(n,t){return j.where(n,t,!0)},j.max=function(n,t,r){if(!t&&j.isArray(n)&&n[0]===+n[0]&&n.length<65535)return Math.max.apply(Math,n);if(!t&&j.isEmpty(n))return-1/0;var e={computed:-1/0,value:-1/0};return A(n,function(n,u,i){var a=t?t.call(r,n,u,i):n;a>e.computed&&(e={value:n,computed:a})}),e.value},j.min=function(n,t,r){if(!t&&j.isArray(n)&&n[0]===+n[0]&&n.length<65535)return Math.min.apply(Math,n);if(!t&&j.isEmpty(n))return 1/0;var e={computed:1/0,value:1/0};return A(n,function(n,u,i){var a=t?t.call(r,n,u,i):n;a<e.computed&&(e={value:n,computed:a})}),e.value},j.shuffle=function(n){var t,r=0,e=[];return A(n,function(n){t=j.random(r++),e[r-1]=e[t],e[t]=n}),e};var F=function(n){return j.isFunction(n)?n:function(t){return t[n]}};j.sortBy=function(n,t,r){var e=F(t);return j.pluck(j.map(n,function(n,t,u){return{value:n,index:t,criteria:e.call(r,n,t,u)}}).sort(function(n,t){var r=n.criteria,e=t.criteria;if(r!==e){if(r>e||r===void 0)return 1;if(e>r||e===void 0)return-1}return n.index<t.index?-1:1}),"value")};var k=function(n,t,r,e){var u={},i=F(null==t?j.identity:t);return A(n,function(t,a){var o=i.call(r,t,a,n);e(u,o,t)}),u};j.groupBy=function(n,t,r){return k(n,t,r,function(n,t,r){(j.has(n,t)?n[t]:n[t]=[]).push(r)})},j.countBy=function(n,t,r){return k(n,t,r,function(n,t){j.has(n,t)||(n[t]=0),n[t]++})},j.sortedIndex=function(n,t,r,e){r=null==r?j.identity:F(r);for(var u=r.call(e,t),i=0,a=n.length;a>i;){var o=i+a>>>1;r.call(e,n[o])<u?i=o+1:a=o}return i},j.toArray=function(n){return n?j.isArray(n)?o.call(n):n.length===+n.length?j.map(n,j.identity):j.values(n):[]},j.size=function(n){return null==n?0:n.length===+n.length?n.length:j.keys(n).length},j.first=j.head=j.take=function(n,t,r){return null==n?void 0:null==t||r?n[0]:o.call(n,0,t)},j.initial=function(n,t,r){return o.call(n,0,n.length-(null==t||r?1:t))},j.last=function(n,t,r){return null==n?void 0:null==t||r?n[n.length-1]:o.call(n,Math.max(n.length-t,0))},j.rest=j.tail=j.drop=function(n,t,r){return o.call(n,null==t||r?1:t)},j.compact=function(n){return j.filter(n,j.identity)};var R=function(n,t,r){return t&&j.every(n,j.isArray)?c.apply(r,n):(A(n,function(n){j.isArray(n)||j.isArguments(n)?t?a.apply(r,n):R(n,t,r):r.push(n)}),r)};j.flatten=function(n,t){return R(n,t,[])},j.without=function(n){return j.difference(n,o.call(arguments,1))},j.uniq=j.unique=function(n,t,r,e){j.isFunction(t)&&(e=r,r=t,t=!1);var u=r?j.map(n,r,e):n,i=[],a=[];return A(u,function(r,e){(t?e&&a[a.length-1]===r:j.contains(a,r))||(a.push(r),i.push(n[e]))}),i},j.union=function(){return j.uniq(j.flatten(arguments,!0))},j.intersection=function(n){var t=o.call(arguments,1);return j.filter(j.uniq(n),function(n){return j.every(t,function(t){return j.indexOf(t,n)>=0})})},j.difference=function(n){var t=c.apply(e,o.call(arguments,1));return j.filter(n,function(n){return!j.contains(t,n)})},j.zip=function(){for(var n=j.max(j.pluck(arguments,"length").concat(0)),t=new Array(n),r=0;n>r;r++)t[r]=j.pluck(arguments,""+r);return t},j.object=function(n,t){if(null==n)return{};for(var r={},e=0,u=n.length;u>e;e++)t?r[n[e]]=t[e]:r[n[e][0]]=n[e][1];return r},j.indexOf=function(n,t,r){if(null==n)return-1;var e=0,u=n.length;if(r){if("number"!=typeof r)return e=j.sortedIndex(n,t),n[e]===t?e:-1;e=0>r?Math.max(0,u+r):r}if(y&&n.indexOf===y)return n.indexOf(t,r);for(;u>e;e++)if(n[e]===t)return e;return-1},j.lastIndexOf=function(n,t,r){if(null==n)return-1;var e=null!=r;if(b&&n.lastIndexOf===b)return e?n.lastIndexOf(t,r):n.lastIndexOf(t);for(var u=e?r:n.length;u--;)if(n[u]===t)return u;return-1},j.range=function(n,t,r){arguments.length<=1&&(t=n||0,n=0),r=arguments[2]||1;for(var e=Math.max(Math.ceil((t-n)/r),0),u=0,i=new Array(e);e>u;)i[u++]=n,n+=r;return i};var M=function(){};j.bind=function(n,t){var r,e;if(w&&n.bind===w)return w.apply(n,o.call(arguments,1));if(!j.isFunction(n))throw new TypeError;return r=o.call(arguments,2),e=function(){if(!(this instanceof e))return n.apply(t,r.concat(o.call(arguments)));M.prototype=n.prototype;var u=new M;M.prototype=null;var i=n.apply(u,r.concat(o.call(arguments)));return Object(i)===i?i:u}},j.partial=function(n){var t=o.call(arguments,1);return function(){return n.apply(this,t.concat(o.call(arguments)))}},j.bindAll=function(n){var t=o.call(arguments,1);if(0===t.length)throw new Error("bindAll must be passed function names");return A(t,function(t){n[t]=j.bind(n[t],n)}),n},j.memoize=function(n,t){var r={};return t||(t=j.identity),function(){var e=t.apply(this,arguments);return j.has(r,e)?r[e]:r[e]=n.apply(this,arguments)}},j.delay=function(n,t){var r=o.call(arguments,2);return setTimeout(function(){return n.apply(null,r)},t)},j.defer=function(n){return j.delay.apply(j,[n,1].concat(o.call(arguments,1)))},j.throttle=function(n,t,r){var e,u,i,a=null,o=0;r||(r={});var c=function(){o=r.leading===!1?0:new Date,a=null,i=n.apply(e,u)};return function(){var l=new Date;o||r.leading!==!1||(o=l);var f=t-(l-o);return e=this,u=arguments,0>=f?(clearTimeout(a),a=null,o=l,i=n.apply(e,u)):a||r.trailing===!1||(a=setTimeout(c,f)),i}},j.debounce=function(n,t,r){var e,u=null;return function(){var i=this,a=arguments,o=function(){u=null,r||(e=n.apply(i,a))},c=r&&!u;return clearTimeout(u),u=setTimeout(o,t),c&&(e=n.apply(i,a)),e}},j.once=function(n){var t,r=!1;return function(){return r?t:(r=!0,t=n.apply(this,arguments),n=null,t)}},j.wrap=function(n,t){return function(){var r=[n];return a.apply(r,arguments),t.apply(this,r)}},j.compose=function(){var n=arguments;return function(){for(var t=arguments,r=n.length-1;r>=0;r--)t=[n[r].apply(this,t)];return t[0]}},j.after=function(n,t){return function(){return--n<1?t.apply(this,arguments):void 0}},j.keys=_||function(n){if(n!==Object(n))throw new TypeError("Invalid object");var t=[];for(var r in n)j.has(n,r)&&t.push(r);return t},j.values=function(n){var t=[];for(var r in n)j.has(n,r)&&t.push(n[r]);return t},j.pairs=function(n){var t=[];for(var r in n)j.has(n,r)&&t.push([r,n[r]]);return t},j.invert=function(n){var t={};for(var r in n)j.has(n,r)&&(t[n[r]]=r);return t},j.functions=j.methods=function(n){var t=[];for(var r in n)j.isFunction(n[r])&&t.push(r);return t.sort()},j.extend=function(n){return A(o.call(arguments,1),function(t){if(t)for(var r in t)n[r]=t[r]}),n},j.pick=function(n){var t={},r=c.apply(e,o.call(arguments,1));return A(r,function(r){r in n&&(t[r]=n[r])}),t},j.omit=function(n){var t={},r=c.apply(e,o.call(arguments,1));for(var u in n)j.contains(r,u)||(t[u]=n[u]);return t},j.defaults=function(n){return A(o.call(arguments,1),function(t){if(t)for(var r in t)n[r]===void 0&&(n[r]=t[r])}),n},j.clone=function(n){return j.isObject(n)?j.isArray(n)?n.slice():j.extend({},n):n},j.tap=function(n,t){return t(n),n};var S=function(n,t,r,e){if(n===t)return 0!==n||1/n==1/t;if(null==n||null==t)return n===t;n instanceof j&&(n=n._wrapped),t instanceof j&&(t=t._wrapped);var u=l.call(n);if(u!=l.call(t))return!1;switch(u){case"[object String]":return n==String(t);case"[object Number]":return n!=+n?t!=+t:0==n?1/n==1/t:n==+t;case"[object Date]":case"[object Boolean]":return+n==+t;case"[object RegExp]":return n.source==t.source&&n.global==t.global&&n.multiline==t.multiline&&n.ignoreCase==t.ignoreCase}if("object"!=typeof n||"object"!=typeof t)return!1;for(var i=r.length;i--;)if(r[i]==n)return e[i]==t;var a=n.constructor,o=t.constructor;if(a!==o&&!(j.isFunction(a)&&a instanceof a&&j.isFunction(o)&&o instanceof o))return!1;r.push(n),e.push(t);var c=0,f=!0;if("[object Array]"==u){if(c=n.length,f=c==t.length)for(;c--&&(f=S(n[c],t[c],r,e)););}else{for(var s in n)if(j.has(n,s)&&(c++,!(f=j.has(t,s)&&S(n[s],t[s],r,e))))break;if(f){for(s in t)if(j.has(t,s)&&!c--)break;f=!c}}return r.pop(),e.pop(),f};j.isEqual=function(n,t){return S(n,t,[],[])},j.isEmpty=function(n){if(null==n)return!0;if(j.isArray(n)||j.isString(n))return 0===n.length;for(var t in n)if(j.has(n,t))return!1;return!0},j.isElement=function(n){return!(!n||1!==n.nodeType)},j.isArray=x||function(n){return"[object Array]"==l.call(n)},j.isObject=function(n){return n===Object(n)},A(["Arguments","Function","String","Number","Date","RegExp"],function(n){j["is"+n]=function(t){return l.call(t)=="[object "+n+"]"}}),j.isArguments(arguments)||(j.isArguments=function(n){return!(!n||!j.has(n,"callee"))}),"function"!=typeof/./&&(j.isFunction=function(n){return"function"==typeof n}),j.isFinite=function(n){return isFinite(n)&&!isNaN(parseFloat(n))},j.isNaN=function(n){return j.isNumber(n)&&n!=+n},j.isBoolean=function(n){return n===!0||n===!1||"[object Boolean]"==l.call(n)},j.isNull=function(n){return null===n},j.isUndefined=function(n){return n===void 0},j.has=function(n,t){return f.call(n,t)},j.noConflict=function(){return n._=t,this},j.identity=function(n){return n},j.times=function(n,t,r){for(var e=Array(Math.max(0,n)),u=0;n>u;u++)e[u]=t.call(r,u);return e},j.random=function(n,t){return null==t&&(t=n,n=0),n+Math.floor(Math.random()*(t-n+1))};var I={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};I.unescape=j.invert(I.escape);var T={escape:new RegExp("["+j.keys(I.escape).join("")+"]","g"),unescape:new RegExp("("+j.keys(I.unescape).join("|")+")","g")};j.each(["escape","unescape"],function(n){j[n]=function(t){return null==t?"":(""+t).replace(T[n],function(t){return I[n][t]})}}),j.result=function(n,t){if(null==n)return void 0;var r=n[t];return j.isFunction(r)?r.call(n):r},j.mixin=function(n){A(j.functions(n),function(t){var r=j[t]=n[t];j.prototype[t]=function(){var n=[this._wrapped];return a.apply(n,arguments),z.call(this,r.apply(j,n))}})};var N=0;j.uniqueId=function(n){var t=++N+"";return n?n+t:t},j.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var q=/(.)^/,B={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},D=/\\|'|\r|\n|\t|\u2028|\u2029/g;j.template=function(n,t,r){var e;r=j.defaults({},r,j.templateSettings);var u=new RegExp([(r.escape||q).source,(r.interpolate||q).source,(r.evaluate||q).source].join("|")+"|$","g"),i=0,a="__p+='";n.replace(u,function(t,r,e,u,o){return a+=n.slice(i,o).replace(D,function(n){return"\\"+B[n]}),r&&(a+="'+\n((__t=("+r+"))==null?'':_.escape(__t))+\n'"),e&&(a+="'+\n((__t=("+e+"))==null?'':__t)+\n'"),u&&(a+="';\n"+u+"\n__p+='"),i=o+t.length,t}),a+="';\n",r.variable||(a="with(obj||{}){\n"+a+"}\n"),a="var __t,__p='',__j=Array.prototype.join,"+"print=function(){__p+=__j.call(arguments,'');};\n"+a+"return __p;\n";try{e=new Function(r.variable||"obj","_",a)}catch(o){throw o.source=a,o}if(t)return e(t,j);var c=function(n){return e.call(this,n,j)};return c.source="function("+(r.variable||"obj")+"){\n"+a+"}",c},j.chain=function(n){return j(n).chain()};var z=function(n){return this._chain?j(n).chain():n};j.mixin(j),A(["pop","push","reverse","shift","sort","splice","unshift"],function(n){var t=e[n];j.prototype[n]=function(){var r=this._wrapped;return t.apply(r,arguments),"shift"!=n&&"splice"!=n||0!==r.length||delete r[0],z.call(this,r)}}),A(["concat","join","slice"],function(n){var t=e[n];j.prototype[n]=function(){return z.call(this,t.apply(this._wrapped,arguments))}}),j.extend(j.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}.call(this);


//SCRIPT: ../../vendor/js/underscore.string.min.js
//  Underscore.string
//  (c) 2010 Esa-Matti Suuronen <esa-matti aet suuronen dot org>
//  Underscore.string is freely distributable under the terms of the MIT license.
//  Documentation: https://github.com/epeli/underscore.string
//  Some code is borrowed from MooTools and Alexandru Marasteanu.
//  Version '2.3.0'

!function(root, String){
  'use strict';

  // Defining helper functions.

  var nativeTrim = String.prototype.trim;
  var nativeTrimRight = String.prototype.trimRight;
  var nativeTrimLeft = String.prototype.trimLeft;

  var parseNumber = function(source) { return source * 1 || 0; };

  var strRepeat = function(str, qty){
    if (qty < 1) return '';
    var result = '';
    while (qty > 0) {
      if (qty & 1) result += str;
      qty >>= 1, str += str;
    }
    return result;
  };

  var slice = [].slice;

  var defaultToWhiteSpace = function(characters) {
    if (characters == null)
      return '\\s';
    else if (characters.source)
      return characters.source;
    else
      return '[' + _s.escapeRegExp(characters) + ']';
  };

  var escapeChars = {
    lt: '<',
    gt: '>',
    quot: '"',
    apos: "'",
    amp: '&'
  };

  var reversedEscapeChars = {};
  for(var key in escapeChars){ reversedEscapeChars[escapeChars[key]] = key; }

  // sprintf() for JavaScript 0.7-beta1
  // http://www.diveintojavascript.com/projects/javascript-sprintf
  //
  // Copyright (c) Alexandru Marasteanu <alexaholic [at) gmail (dot] com>
  // All rights reserved.

  var sprintf = (function() {
    function get_type(variable) {
      return Object.prototype.toString.call(variable).slice(8, -1).toLowerCase();
    }

    var str_repeat = strRepeat;

    var str_format = function() {
      if (!str_format.cache.hasOwnProperty(arguments[0])) {
        str_format.cache[arguments[0]] = str_format.parse(arguments[0]);
      }
      return str_format.format.call(null, str_format.cache[arguments[0]], arguments);
    };

    str_format.format = function(parse_tree, argv) {
      var cursor = 1, tree_length = parse_tree.length, node_type = '', arg, output = [], i, k, match, pad, pad_character, pad_length;
      for (i = 0; i < tree_length; i++) {
        node_type = get_type(parse_tree[i]);
        if (node_type === 'string') {
          output.push(parse_tree[i]);
        }
        else if (node_type === 'array') {
          match = parse_tree[i]; // convenience purposes only
          if (match[2]) { // keyword argument
            arg = argv[cursor];
            for (k = 0; k < match[2].length; k++) {
              if (!arg.hasOwnProperty(match[2][k])) {
                throw new Error(sprintf('[_.sprintf] property "%s" does not exist', match[2][k]));
              }
              arg = arg[match[2][k]];
            }
          } else if (match[1]) { // positional argument (explicit)
            arg = argv[match[1]];
          }
          else { // positional argument (implicit)
            arg = argv[cursor++];
          }

          if (/[^s]/.test(match[8]) && (get_type(arg) != 'number')) {
            throw new Error(sprintf('[_.sprintf] expecting number but found %s', get_type(arg)));
          }
          switch (match[8]) {
            case 'b': arg = arg.toString(2); break;
            case 'c': arg = String.fromCharCode(arg); break;
            case 'd': arg = parseInt(arg, 10); break;
            case 'e': arg = match[7] ? arg.toExponential(match[7]) : arg.toExponential(); break;
            case 'f': arg = match[7] ? parseFloat(arg).toFixed(match[7]) : parseFloat(arg); break;
            case 'o': arg = arg.toString(8); break;
            case 's': arg = ((arg = String(arg)) && match[7] ? arg.substring(0, match[7]) : arg); break;
            case 'u': arg = Math.abs(arg); break;
            case 'x': arg = arg.toString(16); break;
            case 'X': arg = arg.toString(16).toUpperCase(); break;
          }
          arg = (/[def]/.test(match[8]) && match[3] && arg >= 0 ? '+'+ arg : arg);
          pad_character = match[4] ? match[4] == '0' ? '0' : match[4].charAt(1) : ' ';
          pad_length = match[6] - String(arg).length;
          pad = match[6] ? str_repeat(pad_character, pad_length) : '';
          output.push(match[5] ? arg + pad : pad + arg);
        }
      }
      return output.join('');
    };

    str_format.cache = {};

    str_format.parse = function(fmt) {
      var _fmt = fmt, match = [], parse_tree = [], arg_names = 0;
      while (_fmt) {
        if ((match = /^[^\x25]+/.exec(_fmt)) !== null) {
          parse_tree.push(match[0]);
        }
        else if ((match = /^\x25{2}/.exec(_fmt)) !== null) {
          parse_tree.push('%');
        }
        else if ((match = /^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-fosuxX])/.exec(_fmt)) !== null) {
          if (match[2]) {
            arg_names |= 1;
            var field_list = [], replacement_field = match[2], field_match = [];
            if ((field_match = /^([a-z_][a-z_\d]*)/i.exec(replacement_field)) !== null) {
              field_list.push(field_match[1]);
              while ((replacement_field = replacement_field.substring(field_match[0].length)) !== '') {
                if ((field_match = /^\.([a-z_][a-z_\d]*)/i.exec(replacement_field)) !== null) {
                  field_list.push(field_match[1]);
                }
                else if ((field_match = /^\[(\d+)\]/.exec(replacement_field)) !== null) {
                  field_list.push(field_match[1]);
                }
                else {
                  throw new Error('[_.sprintf] huh?');
                }
              }
            }
            else {
              throw new Error('[_.sprintf] huh?');
            }
            match[2] = field_list;
          }
          else {
            arg_names |= 2;
          }
          if (arg_names === 3) {
            throw new Error('[_.sprintf] mixing positional and named placeholders is not (yet) supported');
          }
          parse_tree.push(match);
        }
        else {
          throw new Error('[_.sprintf] huh?');
        }
        _fmt = _fmt.substring(match[0].length);
      }
      return parse_tree;
    };

    return str_format;
  })();



  // Defining underscore.string

  var _s = {

    VERSION: '2.3.0',

    isBlank: function(str){
      if (str == null) str = '';
      return (/^\s*$/).test(str);
    },

    stripTags: function(str){
      if (str == null) return '';
      return String(str).replace(/<\/?[^>]+>/g, '');
    },

    capitalize : function(str){
      str = str == null ? '' : String(str);
      return str.charAt(0).toUpperCase() + str.slice(1);
    },

    chop: function(str, step){
      if (str == null) return [];
      str = String(str);
      step = ~~step;
      return step > 0 ? str.match(new RegExp('.{1,' + step + '}', 'g')) : [str];
    },

    clean: function(str){
      return _s.strip(str).replace(/\s+/g, ' ');
    },

    count: function(str, substr){
      if (str == null || substr == null) return 0;
      return String(str).split(substr).length - 1;
    },

    chars: function(str) {
      if (str == null) return [];
      return String(str).split('');
    },

    swapCase: function(str) {
      if (str == null) return '';
      return String(str).replace(/\S/g, function(c){
        return c === c.toUpperCase() ? c.toLowerCase() : c.toUpperCase();
      });
    },

    escapeHTML: function(str) {
      if (str == null) return '';
      return String(str).replace(/[&<>"']/g, function(m){ return '&' + reversedEscapeChars[m] + ';'; });
    },

    unescapeHTML: function(str) {
      if (str == null) return '';
      return String(str).replace(/\&([^;]+);/g, function(entity, entityCode){
        var match;

        if (entityCode in escapeChars) {
          return escapeChars[entityCode];
        } else if (match = entityCode.match(/^#x([\da-fA-F]+)$/)) {
          return String.fromCharCode(parseInt(match[1], 16));
        } else if (match = entityCode.match(/^#(\d+)$/)) {
          return String.fromCharCode(~~match[1]);
        } else {
          return entity;
        }
      });
    },

    escapeRegExp: function(str){
      if (str == null) return '';
      return String(str).replace(/([.*+?^=!:${}()|[\]\/\\])/g, '\\$1');
    },

    splice: function(str, i, howmany, substr){
      var arr = _s.chars(str);
      arr.splice(~~i, ~~howmany, substr);
      return arr.join('');
    },

    insert: function(str, i, substr){
      return _s.splice(str, i, 0, substr);
    },

    include: function(str, needle){
      if (needle === '') return true;
      if (str == null) return false;
      return String(str).indexOf(needle) !== -1;
    },

    join: function() {
      var args = slice.call(arguments),
        separator = args.shift();

      if (separator == null) separator = '';

      return args.join(separator);
    },

    lines: function(str) {
      if (str == null) return [];
      return String(str).split("\n");
    },

    reverse: function(str){
      return _s.chars(str).reverse().join('');
    },

    startsWith: function(str, starts){
      if (starts === '') return true;
      if (str == null || starts == null) return false;
      str = String(str); starts = String(starts);
      return str.length >= starts.length && str.slice(0, starts.length) === starts;
    },

    endsWith: function(str, ends){
      if (ends === '') return true;
      if (str == null || ends == null) return false;
      str = String(str); ends = String(ends);
      return str.length >= ends.length && str.slice(str.length - ends.length) === ends;
    },

    succ: function(str){
      if (str == null) return '';
      str = String(str);
      return str.slice(0, -1) + String.fromCharCode(str.charCodeAt(str.length-1) + 1);
    },

    titleize: function(str){
      if (str == null) return '';
      return String(str).replace(/(?:^|\s)\S/g, function(c){ return c.toUpperCase(); });
    },

    camelize: function(str){
      return _s.trim(str).replace(/[-_\s]+(.)?/g, function(match, c){ return c.toUpperCase(); });
    },

    underscored: function(str){
      return _s.trim(str).replace(/([a-z\d])([A-Z]+)/g, '$1_$2').replace(/[-\s]+/g, '_').toLowerCase();
    },

    dasherize: function(str){
      return _s.trim(str).replace(/([A-Z])/g, '-$1').replace(/[-_\s]+/g, '-').toLowerCase();
    },

    classify: function(str){
      return _s.titleize(String(str).replace(/_/g, ' ')).replace(/\s/g, '');
    },

    humanize: function(str){
      return _s.capitalize(_s.underscored(str).replace(/_id$/,'').replace(/_/g, ' '));
    },

    trim: function(str, characters){
      if (str == null) return '';
      if (!characters && nativeTrim) return nativeTrim.call(str);
      characters = defaultToWhiteSpace(characters);
      return String(str).replace(new RegExp('\^' + characters + '+|' + characters + '+$', 'g'), '');
    },

    ltrim: function(str, characters){
      if (str == null) return '';
      if (!characters && nativeTrimLeft) return nativeTrimLeft.call(str);
      characters = defaultToWhiteSpace(characters);
      return String(str).replace(new RegExp('^' + characters + '+'), '');
    },

    rtrim: function(str, characters){
      if (str == null) return '';
      if (!characters && nativeTrimRight) return nativeTrimRight.call(str);
      characters = defaultToWhiteSpace(characters);
      return String(str).replace(new RegExp(characters + '+$'), '');
    },

    truncate: function(str, length, truncateStr){
      if (str == null) return '';
      str = String(str); truncateStr = truncateStr || '...';
      length = ~~length;
      return str.length > length ? str.slice(0, length) + truncateStr : str;
    },

    /**
     * _s.prune: a more elegant version of truncate
     * prune extra chars, never leaving a half-chopped word.
     * @author github.com/rwz
     */
    prune: function(str, length, pruneStr){
      if (str == null) return '';

      str = String(str); length = ~~length;
      pruneStr = pruneStr != null ? String(pruneStr) : '...';

      if (str.length <= length) return str;

      var tmpl = function(c){ return c.toUpperCase() !== c.toLowerCase() ? 'A' : ' '; },
        template = str.slice(0, length+1).replace(/.(?=\W*\w*$)/g, tmpl); // 'Hello, world' -> 'HellAA AAAAA'

      if (template.slice(template.length-2).match(/\w\w/))
        template = template.replace(/\s*\S+$/, '');
      else
        template = _s.rtrim(template.slice(0, template.length-1));

      return (template+pruneStr).length > str.length ? str : str.slice(0, template.length)+pruneStr;
    },

    words: function(str, delimiter) {
      if (_s.isBlank(str)) return [];
      return _s.trim(str, delimiter).split(delimiter || /\s+/);
    },

    pad: function(str, length, padStr, type) {
      str = str == null ? '' : String(str);
      length = ~~length;

      var padlen  = 0;

      if (!padStr)
        padStr = ' ';
      else if (padStr.length > 1)
        padStr = padStr.charAt(0);

      switch(type) {
        case 'right':
          padlen = length - str.length;
          return str + strRepeat(padStr, padlen);
        case 'both':
          padlen = length - str.length;
          return strRepeat(padStr, Math.ceil(padlen/2)) + str
                  + strRepeat(padStr, Math.floor(padlen/2));
        default: // 'left'
          padlen = length - str.length;
          return strRepeat(padStr, padlen) + str;
        }
    },

    lpad: function(str, length, padStr) {
      return _s.pad(str, length, padStr);
    },

    rpad: function(str, length, padStr) {
      return _s.pad(str, length, padStr, 'right');
    },

    lrpad: function(str, length, padStr) {
      return _s.pad(str, length, padStr, 'both');
    },

    sprintf: sprintf,

    vsprintf: function(fmt, argv){
      argv.unshift(fmt);
      return sprintf.apply(null, argv);
    },

    toNumber: function(str, decimals) {
      if (str == null || str == '') return 0;
      str = String(str);
      var num = parseNumber(parseNumber(str).toFixed(~~decimals));
      return num === 0 && !str.match(/^0+$/) ? Number.NaN : num;
    },

    numberFormat : function(number, dec, dsep, tsep) {
      if (isNaN(number) || number == null) return '';

      number = number.toFixed(~~dec);
      tsep = tsep || ',';

      var parts = number.split('.'), fnums = parts[0],
        decimals = parts[1] ? (dsep || '.') + parts[1] : '';

      return fnums.replace(/(\d)(?=(?:\d{3})+$)/g, '$1' + tsep) + decimals;
    },

    strRight: function(str, sep){
      if (str == null) return '';
      str = String(str); sep = sep != null ? String(sep) : sep;
      var pos = !sep ? -1 : str.indexOf(sep);
      return ~pos ? str.slice(pos+sep.length, str.length) : str;
    },

    strRightBack: function(str, sep){
      if (str == null) return '';
      str = String(str); sep = sep != null ? String(sep) : sep;
      var pos = !sep ? -1 : str.lastIndexOf(sep);
      return ~pos ? str.slice(pos+sep.length, str.length) : str;
    },

    strLeft: function(str, sep){
      if (str == null) return '';
      str = String(str); sep = sep != null ? String(sep) : sep;
      var pos = !sep ? -1 : str.indexOf(sep);
      return ~pos ? str.slice(0, pos) : str;
    },

    strLeftBack: function(str, sep){
      if (str == null) return '';
      str += ''; sep = sep != null ? ''+sep : sep;
      var pos = str.lastIndexOf(sep);
      return ~pos ? str.slice(0, pos) : str;
    },

    toSentence: function(array, separator, lastSeparator, serial) {
      separator = separator || ', '
      lastSeparator = lastSeparator || ' and '
      var a = array.slice(), lastMember = a.pop();

      if (array.length > 2 && serial) lastSeparator = _s.rtrim(separator) + lastSeparator;

      return a.length ? a.join(separator) + lastSeparator + lastMember : lastMember;
    },

    toSentenceSerial: function() {
      var args = slice.call(arguments);
      args[3] = true;
      return _s.toSentence.apply(_s, args);
    },

    slugify: function(str) {
      if (str == null) return '';

      var from  = "ąàáäâãåæćęèéëêìíïîłńòóöôõøùúüûñçżź",
          to    = "aaaaaaaaceeeeeiiiilnoooooouuuunczz",
          regex = new RegExp(defaultToWhiteSpace(from), 'g');

      str = String(str).toLowerCase().replace(regex, function(c){
        var index = from.indexOf(c);
        return to.charAt(index) || '-';
      });

      return _s.dasherize(str.replace(/[^\w\s-]/g, ''));
    },

    surround: function(str, wrapper) {
      return [wrapper, str, wrapper].join('');
    },

    quote: function(str) {
      return _s.surround(str, '"');
    },

    exports: function() {
      var result = {};

      for (var prop in this) {
        if (!this.hasOwnProperty(prop) || prop.match(/^(?:include|contains|reverse)$/)) continue;
        result[prop] = this[prop];
      }

      return result;
    },

    repeat: function(str, qty, separator){
      if (str == null) return '';

      qty = ~~qty;

      // using faster implementation if separator is not needed;
      if (separator == null) return strRepeat(String(str), qty);

      // this one is about 300x slower in Google Chrome
      for (var repeat = []; qty > 0; repeat[--qty] = str) {}
      return repeat.join(separator);
    },

    levenshtein: function(str1, str2) {
      if (str1 == null && str2 == null) return 0;
      if (str1 == null) return String(str2).length;
      if (str2 == null) return String(str1).length;

      str1 = String(str1); str2 = String(str2);

      var current = [], prev, value;

      for (var i = 0; i <= str2.length; i++)
        for (var j = 0; j <= str1.length; j++) {
          if (i && j)
            if (str1.charAt(j - 1) === str2.charAt(i - 1))
              value = prev;
            else
              value = Math.min(current[j], current[j - 1], prev) + 1;
          else
            value = i + j;

          prev = current[j];
          current[j] = value;
        }

      return current.pop();
    }
  };

  // Aliases

  _s.strip    = _s.trim;
  _s.lstrip   = _s.ltrim;
  _s.rstrip   = _s.rtrim;
  _s.center   = _s.lrpad;
  _s.rjust    = _s.lpad;
  _s.ljust    = _s.rpad;
  _s.contains = _s.include;
  _s.q        = _s.quote;

  // CommonJS module is defined
  if (typeof exports !== 'undefined') {
    if (typeof module !== 'undefined' && module.exports) {
      // Export module
      module.exports = _s;
    }
    exports._s = _s;

  } else if (typeof define === 'function' && define.amd) {
    // Register as a named module with AMD.
    define('underscore.string', [], function() {
      return _s;
    });

  } else {
    // Integrate with Underscore.js if defined
    // or create our own underscore object.
    root._ = root._ || {};
    root._.string = root._.str = _s;
  }

}(this, String);


//SCRIPT: ../../vendor/js/json2.js
/*
    json2.js
    2011-10-19

    Public Domain.

    NO WARRANTY EXPRESSED OR IMPLIED. USE AT YOUR OWN RISK.

    See http://www.JSON.org/js.html


    This code should be minified before deployment.
    See http://javascript.crockford.com/jsmin.html

    USE YOUR OWN COPY. IT IS EXTREMELY UNWISE TO LOAD CODE FROM SERVERS YOU DO
    NOT CONTROL.


    This file creates a global JSON object containing two methods: stringify
    and parse.

        JSON.stringify(value, replacer, space)
            value       any JavaScript value, usually an object or array.

            replacer    an optional parameter that determines how object
                        values are stringified for objects. It can be a
                        function or an array of strings.

            space       an optional parameter that specifies the indentation
                        of nested structures. If it is omitted, the text will
                        be packed without extra whitespace. If it is a number,
                        it will specify the number of spaces to indent at each
                        level. If it is a string (such as '\t' or '&nbsp;'),
                        it contains the characters used to indent at each level.

            This method produces a JSON text from a JavaScript value.

            When an object value is found, if the object contains a toJSON
            method, its toJSON method will be called and the result will be
            stringified. A toJSON method does not serialize: it returns the
            value represented by the name/value pair that should be serialized,
            or undefined if nothing should be serialized. The toJSON method
            will be passed the key associated with the value, and this will be
            bound to the value

            For example, this would serialize Dates as ISO strings.

                Date.prototype.toJSON = function (key) {
                    function f(n) {
                        // Format integers to have at least two digits.
                        return n < 10 ? '0' + n : n;
                    }

                    return this.getUTCFullYear()   + '-' +
                         f(this.getUTCMonth() + 1) + '-' +
                         f(this.getUTCDate())      + 'T' +
                         f(this.getUTCHours())     + ':' +
                         f(this.getUTCMinutes())   + ':' +
                         f(this.getUTCSeconds())   + 'Z';
                };

            You can provide an optional replacer method. It will be passed the
            key and value of each member, with this bound to the containing
            object. The value that is returned from your method will be
            serialized. If your method returns undefined, then the member will
            be excluded from the serialization.

            If the replacer parameter is an array of strings, then it will be
            used to select the members to be serialized. It filters the results
            such that only members with keys listed in the replacer array are
            stringified.

            Values that do not have JSON representations, such as undefined or
            functions, will not be serialized. Such values in objects will be
            dropped; in arrays they will be replaced with null. You can use
            a replacer function to replace those with JSON values.
            JSON.stringify(undefined) returns undefined.

            The optional space parameter produces a stringification of the
            value that is filled with line breaks and indentation to make it
            easier to read.

            If the space parameter is a non-empty string, then that string will
            be used for indentation. If the space parameter is a number, then
            the indentation will be that many spaces.

            Example:

            text = JSON.stringify(['e', {pluribus: 'unum'}]);
            // text is '["e",{"pluribus":"unum"}]'


            text = JSON.stringify(['e', {pluribus: 'unum'}], null, '\t');
            // text is '[\n\t"e",\n\t{\n\t\t"pluribus": "unum"\n\t}\n]'

            text = JSON.stringify([new Date()], function (key, value) {
                return this[key] instanceof Date ?
                    'Date(' + this[key] + ')' : value;
            });
            // text is '["Date(---current time---)"]'


        JSON.parse(text, reviver)
            This method parses a JSON text to produce an object or array.
            It can throw a SyntaxError exception.

            The optional reviver parameter is a function that can filter and
            transform the results. It receives each of the keys and values,
            and its return value is used instead of the original value.
            If it returns what it received, then the structure is not modified.
            If it returns undefined then the member is deleted.

            Example:

            // Parse the text. Values that look like ISO date strings will
            // be converted to Date objects.

            myData = JSON.parse(text, function (key, value) {
                var a;
                if (typeof value === 'string') {
                    a =
/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2}(?:\.\d*)?)Z$/.exec(value);
                    if (a) {
                        return new Date(Date.UTC(+a[1], +a[2] - 1, +a[3], +a[4],
                            +a[5], +a[6]));
                    }
                }
                return value;
            });

            myData = JSON.parse('["Date(09/09/2001)"]', function (key, value) {
                var d;
                if (typeof value === 'string' &&
                        value.slice(0, 5) === 'Date(' &&
                        value.slice(-1) === ')') {
                    d = new Date(value.slice(5, -1));
                    if (d) {
                        return d;
                    }
                }
                return value;
            });


    This is a reference implementation. You are free to copy, modify, or
    redistribute.
*/

/*jslint evil: true, regexp: true */

/*members "", "\b", "\t", "\n", "\f", "\r", "\"", JSON, "\\", apply,
    call, charCodeAt, getUTCDate, getUTCFullYear, getUTCHours,
    getUTCMinutes, getUTCMonth, getUTCSeconds, hasOwnProperty, join,
    lastIndex, length, parse, prototype, push, replace, slice, stringify,
    test, toJSON, toString, valueOf
*/


// Create a JSON object only if one does not already exist. We create the
// methods in a closure to avoid creating global variables.

var JSON;
if (!JSON) {
    JSON = {};
}

(function () {
    'use strict';

    function f(n) {
        // Format integers to have at least two digits.
        return n < 10 ? '0' + n : n;
    }

    if (typeof Date.prototype.toJSON !== 'function') {

        Date.prototype.toJSON = function (key) {

            return isFinite(this.valueOf())
                ? this.getUTCFullYear()     + '-' +
                    f(this.getUTCMonth() + 1) + '-' +
                    f(this.getUTCDate())      + 'T' +
                    f(this.getUTCHours())     + ':' +
                    f(this.getUTCMinutes())   + ':' +
                    f(this.getUTCSeconds())   + 'Z'
                : null;
        };

        String.prototype.toJSON      =
            Number.prototype.toJSON  =
            Boolean.prototype.toJSON = function (key) {
                return this.valueOf();
            };
    }

    var cx = /[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
        escapable = /[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
        gap,
        indent,
        meta = {    // table of character substitutions
            '\b': '\\b',
            '\t': '\\t',
            '\n': '\\n',
            '\f': '\\f',
            '\r': '\\r',
            '"' : '\\"',
            '\\': '\\\\'
        },
        rep;


    function quote(string) {

// If the string contains no control characters, no quote characters, and no
// backslash characters, then we can safely slap some quotes around it.
// Otherwise we must also replace the offending characters with safe escape
// sequences.

        escapable.lastIndex = 0;
        return escapable.test(string) ? '"' + string.replace(escapable, function (a) {
            var c = meta[a];
            return typeof c === 'string'
                ? c
                : '\\u' + ('0000' + a.charCodeAt(0).toString(16)).slice(-4);
        }) + '"' : '"' + string + '"';
    }


    function str(key, holder) {

// Produce a string from holder[key].

        var i,          // The loop counter.
            k,          // The member key.
            v,          // The member value.
            length,
            mind = gap,
            partial,
            value = holder[key];

// If the value has a toJSON method, call it to obtain a replacement value.

        if (value && typeof value === 'object' &&
                typeof value.toJSON === 'function') {
            value = value.toJSON(key);
        }

// If we were called with a replacer function, then call the replacer to
// obtain a replacement value.

        if (typeof rep === 'function') {
            value = rep.call(holder, key, value);
        }

// What happens next depends on the value's type.

        switch (typeof value) {
        case 'string':
            return quote(value);

        case 'number':

// JSON numbers must be finite. Encode non-finite numbers as null.

            return isFinite(value) ? String(value) : 'null';

        case 'boolean':
        case 'null':

// If the value is a boolean or null, convert it to a string. Note:
// typeof null does not produce 'null'. The case is included here in
// the remote chance that this gets fixed someday.

            return String(value);

// If the type is 'object', we might be dealing with an object or an array or
// null.

        case 'object':

// Due to a specification blunder in ECMAScript, typeof null is 'object',
// so watch out for that case.

            if (!value) {
                return 'null';
            }

// Make an array to hold the partial results of stringifying this object value.

            gap += indent;
            partial = [];

// Is the value an array?

            if (Object.prototype.toString.apply(value) === '[object Array]') {

// The value is an array. Stringify every element. Use null as a placeholder
// for non-JSON values.

                length = value.length;
                for (i = 0; i < length; i += 1) {
                    partial[i] = str(i, value) || 'null';
                }

// Join all of the elements together, separated with commas, and wrap them in
// brackets.

                v = partial.length === 0
                    ? '[]'
                    : gap
                    ? '[\n' + gap + partial.join(',\n' + gap) + '\n' + mind + ']'
                    : '[' + partial.join(',') + ']';
                gap = mind;
                return v;
            }

// If the replacer is an array, use it to select the members to be stringified.

            if (rep && typeof rep === 'object') {
                length = rep.length;
                for (i = 0; i < length; i += 1) {
                    if (typeof rep[i] === 'string') {
                        k = rep[i];
                        v = str(k, value);
                        if (v) {
                            partial.push(quote(k) + (gap ? ': ' : ':') + v);
                        }
                    }
                }
            } else {

// Otherwise, iterate through all of the keys in the object.

                for (k in value) {
                    if (Object.prototype.hasOwnProperty.call(value, k)) {
                        v = str(k, value);
                        if (v) {
                            partial.push(quote(k) + (gap ? ': ' : ':') + v);
                        }
                    }
                }
            }

// Join all of the member texts together, separated with commas,
// and wrap them in braces.

            v = partial.length === 0
                ? '{}'
                : gap
                ? '{\n' + gap + partial.join(',\n' + gap) + '\n' + mind + '}'
                : '{' + partial.join(',') + '}';
            gap = mind;
            return v;
        }
    }

// If the JSON object does not yet have a stringify method, give it one.

    if (typeof JSON.stringify !== 'function') {
        JSON.stringify = function (value, replacer, space) {

// The stringify method takes a value and an optional replacer, and an optional
// space parameter, and returns a JSON text. The replacer can be a function
// that can replace values, or an array of strings that will select the keys.
// A default replacer method can be provided. Use of the space parameter can
// produce text that is more easily readable.

            var i;
            gap = '';
            indent = '';

// If the space parameter is a number, make an indent string containing that
// many spaces.

            if (typeof space === 'number') {
                for (i = 0; i < space; i += 1) {
                    indent += ' ';
                }

// If the space parameter is a string, it will be used as the indent string.

            } else if (typeof space === 'string') {
                indent = space;
            }

// If there is a replacer, it must be a function or an array.
// Otherwise, throw an error.

            rep = replacer;
            if (replacer && typeof replacer !== 'function' &&
                    (typeof replacer !== 'object' ||
                    typeof replacer.length !== 'number')) {
                throw new Error('JSON.stringify');
            }

// Make a fake root object containing our value under the key of ''.
// Return the result of stringifying the value.

            return str('', {'': value});
        };
    }


// If the JSON object does not yet have a parse method, give it one.

    if (typeof JSON.parse !== 'function') {
        JSON.parse = function (text, reviver) {

// The parse method takes a text and an optional reviver function, and returns
// a JavaScript value if the text is a valid JSON text.

            var j;

            function walk(holder, key) {

// The walk method is used to recursively walk the resulting structure so
// that modifications can be made.

                var k, v, value = holder[key];
                if (value && typeof value === 'object') {
                    for (k in value) {
                        if (Object.prototype.hasOwnProperty.call(value, k)) {
                            v = walk(value, k);
                            if (v !== undefined) {
                                value[k] = v;
                            } else {
                                delete value[k];
                            }
                        }
                    }
                }
                return reviver.call(holder, key, value);
            }


// Parsing happens in four stages. In the first stage, we replace certain
// Unicode characters with escape sequences. JavaScript handles many characters
// incorrectly, either silently deleting them, or treating them as line endings.

            text = String(text);
            cx.lastIndex = 0;
            if (cx.test(text)) {
                text = text.replace(cx, function (a) {
                    return '\\u' +
                        ('0000' + a.charCodeAt(0).toString(16)).slice(-4);
                });
            }

// In the second stage, we run the text against regular expressions that look
// for non-JSON patterns. We are especially concerned with '()' and 'new'
// because they can cause invocation, and '=' because it can cause mutation.
// But just to be safe, we want to reject all unexpected forms.

// We split the second stage into 4 regexp operations in order to work around
// crippling inefficiencies in IE's and Safari's regexp engines. First we
// replace the JSON backslash pairs with '@' (a non-JSON character). Second, we
// replace all simple value tokens with ']' characters. Third, we delete all
// open brackets that follow a colon or comma or that begin the text. Finally,
// we look to see that the remaining characters are only whitespace or ']' or
// ',' or ':' or '{' or '}'. If that is so, then the text is safe for eval.

            if (/^[\],:{}\s]*$/
                    .test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g, '@')
                        .replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g, ']')
                        .replace(/(?:^|:|,)(?:\s*\[)+/g, ''))) {

// In the third stage we use the eval function to compile the text into a
// JavaScript structure. The '{' operator is subject to a syntactic ambiguity
// in JavaScript: it can begin a block or an object literal. We wrap the text
// in parens to eliminate the ambiguity.

                j = eval('(' + text + ')');

// In the optional fourth stage, we recursively walk the new structure, passing
// each name/value pair to a reviver function for possible transformation.

                return typeof reviver === 'function'
                    ? walk({'': j}, '')
                    : j;
            }

// If the text is not JSON parseable, then a SyntaxError is thrown.

            throw new SyntaxError('JSON.parse');
        };
    }
}());


//SCRIPT: ../../vendor/js/jquery/jquery_min_1.7.1.js
/*! jQuery v1.7.1 jquery.com | jquery.org/license */
(function(a,b){function cy(a){return f.isWindow(a)?a:a.nodeType===9?a.defaultView||a.parentWindow:!1}function cv(a){if(!ck[a]){var b=c.body,d=f("<"+a+">").appendTo(b),e=d.css("display");d.remove();if(e==="none"||e===""){cl||(cl=c.createElement("iframe"),cl.frameBorder=cl.width=cl.height=0),b.appendChild(cl);if(!cm||!cl.createElement)cm=(cl.contentWindow||cl.contentDocument).document,cm.write((c.compatMode==="CSS1Compat"?"<!doctype html>":"")+"<html><body>"),cm.close();d=cm.createElement(a),cm.body.appendChild(d),e=f.css(d,"display"),b.removeChild(cl)}ck[a]=e}return ck[a]}function cu(a,b){var c={};f.each(cq.concat.apply([],cq.slice(0,b)),function(){c[this]=a});return c}function ct(){cr=b}function cs(){setTimeout(ct,0);return cr=f.now()}function cj(){try{return new a.ActiveXObject("Microsoft.XMLHTTP")}catch(b){}}function ci(){try{return new a.XMLHttpRequest}catch(b){}}function cc(a,c){a.dataFilter&&(c=a.dataFilter(c,a.dataType));var d=a.dataTypes,e={},g,h,i=d.length,j,k=d[0],l,m,n,o,p;for(g=1;g<i;g++){if(g===1)for(h in a.converters)typeof h=="string"&&(e[h.toLowerCase()]=a.converters[h]);l=k,k=d[g];if(k==="*")k=l;else if(l!=="*"&&l!==k){m=l+" "+k,n=e[m]||e["* "+k];if(!n){p=b;for(o in e){j=o.split(" ");if(j[0]===l||j[0]==="*"){p=e[j[1]+" "+k];if(p){o=e[o],o===!0?n=p:p===!0&&(n=o);break}}}}!n&&!p&&f.error("No conversion from "+m.replace(" "," to ")),n!==!0&&(c=n?n(c):p(o(c)))}}return c}function cb(a,c,d){var e=a.contents,f=a.dataTypes,g=a.responseFields,h,i,j,k;for(i in g)i in d&&(c[g[i]]=d[i]);while(f[0]==="*")f.shift(),h===b&&(h=a.mimeType||c.getResponseHeader("content-type"));if(h)for(i in e)if(e[i]&&e[i].test(h)){f.unshift(i);break}if(f[0]in d)j=f[0];else{for(i in d){if(!f[0]||a.converters[i+" "+f[0]]){j=i;break}k||(k=i)}j=j||k}if(j){j!==f[0]&&f.unshift(j);return d[j]}}function ca(a,b,c,d){if(f.isArray(b))f.each(b,function(b,e){c||bE.test(a)?d(a,e):ca(a+"["+(typeof e=="object"||f.isArray(e)?b:"")+"]",e,c,d)});else if(!c&&b!=null&&typeof b=="object")for(var e in b)ca(a+"["+e+"]",b[e],c,d);else d(a,b)}function b_(a,c){var d,e,g=f.ajaxSettings.flatOptions||{};for(d in c)c[d]!==b&&((g[d]?a:e||(e={}))[d]=c[d]);e&&f.extend(!0,a,e)}function b$(a,c,d,e,f,g){f=f||c.dataTypes[0],g=g||{},g[f]=!0;var h=a[f],i=0,j=h?h.length:0,k=a===bT,l;for(;i<j&&(k||!l);i++)l=h[i](c,d,e),typeof l=="string"&&(!k||g[l]?l=b:(c.dataTypes.unshift(l),l=b$(a,c,d,e,l,g)));(k||!l)&&!g["*"]&&(l=b$(a,c,d,e,"*",g));return l}function bZ(a){return function(b,c){typeof b!="string"&&(c=b,b="*");if(f.isFunction(c)){var d=b.toLowerCase().split(bP),e=0,g=d.length,h,i,j;for(;e<g;e++)h=d[e],j=/^\+/.test(h),j&&(h=h.substr(1)||"*"),i=a[h]=a[h]||[],i[j?"unshift":"push"](c)}}}function bC(a,b,c){var d=b==="width"?a.offsetWidth:a.offsetHeight,e=b==="width"?bx:by,g=0,h=e.length;if(d>0){if(c!=="border")for(;g<h;g++)c||(d-=parseFloat(f.css(a,"padding"+e[g]))||0),c==="margin"?d+=parseFloat(f.css(a,c+e[g]))||0:d-=parseFloat(f.css(a,"border"+e[g]+"Width"))||0;return d+"px"}d=bz(a,b,b);if(d<0||d==null)d=a.style[b]||0;d=parseFloat(d)||0;if(c)for(;g<h;g++)d+=parseFloat(f.css(a,"padding"+e[g]))||0,c!=="padding"&&(d+=parseFloat(f.css(a,"border"+e[g]+"Width"))||0),c==="margin"&&(d+=parseFloat(f.css(a,c+e[g]))||0);return d+"px"}function bp(a,b){b.src?f.ajax({url:b.src,async:!1,dataType:"script"}):f.globalEval((b.text||b.textContent||b.innerHTML||"").replace(bf,"/*$0*/")),b.parentNode&&b.parentNode.removeChild(b)}function bo(a){var b=c.createElement("div");bh.appendChild(b),b.innerHTML=a.outerHTML;return b.firstChild}function bn(a){var b=(a.nodeName||"").toLowerCase();b==="input"?bm(a):b!=="script"&&typeof a.getElementsByTagName!="undefined"&&f.grep(a.getElementsByTagName("input"),bm)}function bm(a){if(a.type==="checkbox"||a.type==="radio")a.defaultChecked=a.checked}function bl(a){return typeof a.getElementsByTagName!="undefined"?a.getElementsByTagName("*"):typeof a.querySelectorAll!="undefined"?a.querySelectorAll("*"):[]}function bk(a,b){var c;if(b.nodeType===1){b.clearAttributes&&b.clearAttributes(),b.mergeAttributes&&b.mergeAttributes(a),c=b.nodeName.toLowerCase();if(c==="object")b.outerHTML=a.outerHTML;else if(c!=="input"||a.type!=="checkbox"&&a.type!=="radio"){if(c==="option")b.selected=a.defaultSelected;else if(c==="input"||c==="textarea")b.defaultValue=a.defaultValue}else a.checked&&(b.defaultChecked=b.checked=a.checked),b.value!==a.value&&(b.value=a.value);b.removeAttribute(f.expando)}}function bj(a,b){if(b.nodeType===1&&!!f.hasData(a)){var c,d,e,g=f._data(a),h=f._data(b,g),i=g.events;if(i){delete h.handle,h.events={};for(c in i)for(d=0,e=i[c].length;d<e;d++)f.event.add(b,c+(i[c][d].namespace?".":"")+i[c][d].namespace,i[c][d],i[c][d].data)}h.data&&(h.data=f.extend({},h.data))}}function bi(a,b){return f.nodeName(a,"table")?a.getElementsByTagName("tbody")[0]||a.appendChild(a.ownerDocument.createElement("tbody")):a}function U(a){var b=V.split("|"),c=a.createDocumentFragment();if(c.createElement)while(b.length)c.createElement(b.pop());return c}function T(a,b,c){b=b||0;if(f.isFunction(b))return f.grep(a,function(a,d){var e=!!b.call(a,d,a);return e===c});if(b.nodeType)return f.grep(a,function(a,d){return a===b===c});if(typeof b=="string"){var d=f.grep(a,function(a){return a.nodeType===1});if(O.test(b))return f.filter(b,d,!c);b=f.filter(b,d)}return f.grep(a,function(a,d){return f.inArray(a,b)>=0===c})}function S(a){return!a||!a.parentNode||a.parentNode.nodeType===11}function K(){return!0}function J(){return!1}function n(a,b,c){var d=b+"defer",e=b+"queue",g=b+"mark",h=f._data(a,d);h&&(c==="queue"||!f._data(a,e))&&(c==="mark"||!f._data(a,g))&&setTimeout(function(){!f._data(a,e)&&!f._data(a,g)&&(f.removeData(a,d,!0),h.fire())},0)}function m(a){for(var b in a){if(b==="data"&&f.isEmptyObject(a[b]))continue;if(b!=="toJSON")return!1}return!0}function l(a,c,d){if(d===b&&a.nodeType===1){var e="data-"+c.replace(k,"-$1").toLowerCase();d=a.getAttribute(e);if(typeof d=="string"){try{d=d==="true"?!0:d==="false"?!1:d==="null"?null:f.isNumeric(d)?parseFloat(d):j.test(d)?f.parseJSON(d):d}catch(g){}f.data(a,c,d)}else d=b}return d}function h(a){var b=g[a]={},c,d;a=a.split(/\s+/);for(c=0,d=a.length;c<d;c++)b[a[c]]=!0;return b}var c=a.document,d=a.navigator,e=a.location,f=function(){function J(){if(!e.isReady){try{c.documentElement.doScroll("left")}catch(a){setTimeout(J,1);return}e.ready()}}var e=function(a,b){return new e.fn.init(a,b,h)},f=a.jQuery,g=a.$,h,i=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,j=/\S/,k=/^\s+/,l=/\s+$/,m=/^<(\w+)\s*\/?>(?:<\/\1>)?$/,n=/^[\],:{}\s]*$/,o=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,p=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,q=/(?:^|:|,)(?:\s*\[)+/g,r=/(webkit)[ \/]([\w.]+)/,s=/(opera)(?:.*version)?[ \/]([\w.]+)/,t=/(msie) ([\w.]+)/,u=/(mozilla)(?:.*? rv:([\w.]+))?/,v=/-([a-z]|[0-9])/ig,w=/^-ms-/,x=function(a,b){return(b+"").toUpperCase()},y=d.userAgent,z,A,B,C=Object.prototype.toString,D=Object.prototype.hasOwnProperty,E=Array.prototype.push,F=Array.prototype.slice,G=String.prototype.trim,H=Array.prototype.indexOf,I={};e.fn=e.prototype={constructor:e,init:function(a,d,f){var g,h,j,k;if(!a)return this;if(a.nodeType){this.context=this[0]=a,this.length=1;return this}if(a==="body"&&!d&&c.body){this.context=c,this[0]=c.body,this.selector=a,this.length=1;return this}if(typeof a=="string"){a.charAt(0)!=="<"||a.charAt(a.length-1)!==">"||a.length<3?g=i.exec(a):g=[null,a,null];if(g&&(g[1]||!d)){if(g[1]){d=d instanceof e?d[0]:d,k=d?d.ownerDocument||d:c,j=m.exec(a),j?e.isPlainObject(d)?(a=[c.createElement(j[1])],e.fn.attr.call(a,d,!0)):a=[k.createElement(j[1])]:(j=e.buildFragment([g[1]],[k]),a=(j.cacheable?e.clone(j.fragment):j.fragment).childNodes);return e.merge(this,a)}h=c.getElementById(g[2]);if(h&&h.parentNode){if(h.id!==g[2])return f.find(a);this.length=1,this[0]=h}this.context=c,this.selector=a;return this}return!d||d.jquery?(d||f).find(a):this.constructor(d).find(a)}if(e.isFunction(a))return f.ready(a);a.selector!==b&&(this.selector=a.selector,this.context=a.context);return e.makeArray(a,this)},selector:"",jquery:"1.7.1",length:0,size:function(){return this.length},toArray:function(){return F.call(this,0)},get:function(a){return a==null?this.toArray():a<0?this[this.length+a]:this[a]},pushStack:function(a,b,c){var d=this.constructor();e.isArray(a)?E.apply(d,a):e.merge(d,a),d.prevObject=this,d.context=this.context,b==="find"?d.selector=this.selector+(this.selector?" ":"")+c:b&&(d.selector=this.selector+"."+b+"("+c+")");return d},each:function(a,b){return e.each(this,a,b)},ready:function(a){e.bindReady(),A.add(a);return this},eq:function(a){a=+a;return a===-1?this.slice(a):this.slice(a,a+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},slice:function(){return this.pushStack(F.apply(this,arguments),"slice",F.call(arguments).join(","))},map:function(a){return this.pushStack(e.map(this,function(b,c){return a.call(b,c,b)}))},end:function(){return this.prevObject||this.constructor(null)},push:E,sort:[].sort,splice:[].splice},e.fn.init.prototype=e.fn,e.extend=e.fn.extend=function(){var a,c,d,f,g,h,i=arguments[0]||{},j=1,k=arguments.length,l=!1;typeof i=="boolean"&&(l=i,i=arguments[1]||{},j=2),typeof i!="object"&&!e.isFunction(i)&&(i={}),k===j&&(i=this,--j);for(;j<k;j++)if((a=arguments[j])!=null)for(c in a){d=i[c],f=a[c];if(i===f)continue;l&&f&&(e.isPlainObject(f)||(g=e.isArray(f)))?(g?(g=!1,h=d&&e.isArray(d)?d:[]):h=d&&e.isPlainObject(d)?d:{},i[c]=e.extend(l,h,f)):f!==b&&(i[c]=f)}return i},e.extend({noConflict:function(b){a.$===e&&(a.$=g),b&&a.jQuery===e&&(a.jQuery=f);return e},isReady:!1,readyWait:1,holdReady:function(a){a?e.readyWait++:e.ready(!0)},ready:function(a){if(a===!0&&!--e.readyWait||a!==!0&&!e.isReady){if(!c.body)return setTimeout(e.ready,1);e.isReady=!0;if(a!==!0&&--e.readyWait>0)return;A.fireWith(c,[e]),e.fn.trigger&&e(c).trigger("ready").off("ready")}},bindReady:function(){if(!A){A=e.Callbacks("once memory");if(c.readyState==="complete")return setTimeout(e.ready,1);if(c.addEventListener)c.addEventListener("DOMContentLoaded",B,!1),a.addEventListener("load",e.ready,!1);else if(c.attachEvent){c.attachEvent("onreadystatechange",B),a.attachEvent("onload",e.ready);var b=!1;try{b=a.frameElement==null}catch(d){}c.documentElement.doScroll&&b&&J()}}},isFunction:function(a){return e.type(a)==="function"},isArray:Array.isArray||function(a){return e.type(a)==="array"},isWindow:function(a){return a&&typeof a=="object"&&"setInterval"in a},isNumeric:function(a){return!isNaN(parseFloat(a))&&isFinite(a)},type:function(a){return a==null?String(a):I[C.call(a)]||"object"},isPlainObject:function(a){if(!a||e.type(a)!=="object"||a.nodeType||e.isWindow(a))return!1;try{if(a.constructor&&!D.call(a,"constructor")&&!D.call(a.constructor.prototype,"isPrototypeOf"))return!1}catch(c){return!1}var d;for(d in a);return d===b||D.call(a,d)},isEmptyObject:function(a){for(var b in a)return!1;return!0},error:function(a){throw new Error(a)},parseJSON:function(b){if(typeof b!="string"||!b)return null;b=e.trim(b);if(a.JSON&&a.JSON.parse)return a.JSON.parse(b);if(n.test(b.replace(o,"@").replace(p,"]").replace(q,"")))return(new Function("return "+b))();e.error("Invalid JSON: "+b)},parseXML:function(c){var d,f;try{a.DOMParser?(f=new DOMParser,d=f.parseFromString(c,"text/xml")):(d=new ActiveXObject("Microsoft.XMLDOM"),d.async="false",d.loadXML(c))}catch(g){d=b}(!d||!d.documentElement||d.getElementsByTagName("parsererror").length)&&e.error("Invalid XML: "+c);return d},noop:function(){},globalEval:function(b){b&&j.test(b)&&(a.execScript||function(b){a.eval.call(a,b)})(b)},camelCase:function(a){return a.replace(w,"ms-").replace(v,x)},nodeName:function(a,b){return a.nodeName&&a.nodeName.toUpperCase()===b.toUpperCase()},each:function(a,c,d){var f,g=0,h=a.length,i=h===b||e.isFunction(a);if(d){if(i){for(f in a)if(c.apply(a[f],d)===!1)break}else for(;g<h;)if(c.apply(a[g++],d)===!1)break}else if(i){for(f in a)if(c.call(a[f],f,a[f])===!1)break}else for(;g<h;)if(c.call(a[g],g,a[g++])===!1)break;return a},trim:G?function(a){return a==null?"":G.call(a)}:function(a){return a==null?"":(a+"").replace(k,"").replace(l,"")},makeArray:function(a,b){var c=b||[];if(a!=null){var d=e.type(a);a.length==null||d==="string"||d==="function"||d==="regexp"||e.isWindow(a)?E.call(c,a):e.merge(c,a)}return c},inArray:function(a,b,c){var d;if(b){if(H)return H.call(b,a,c);d=b.length,c=c?c<0?Math.max(0,d+c):c:0;for(;c<d;c++)if(c in b&&b[c]===a)return c}return-1},merge:function(a,c){var d=a.length,e=0;if(typeof c.length=="number")for(var f=c.length;e<f;e++)a[d++]=c[e];else while(c[e]!==b)a[d++]=c[e++];a.length=d;return a},grep:function(a,b,c){var d=[],e;c=!!c;for(var f=0,g=a.length;f<g;f++)e=!!b(a[f],f),c!==e&&d.push(a[f]);return d},map:function(a,c,d){var f,g,h=[],i=0,j=a.length,k=a instanceof e||j!==b&&typeof j=="number"&&(j>0&&a[0]&&a[j-1]||j===0||e.isArray(a));if(k)for(;i<j;i++)f=c(a[i],i,d),f!=null&&(h[h.length]=f);else for(g in a)f=c(a[g],g,d),f!=null&&(h[h.length]=f);return h.concat.apply([],h)},guid:1,proxy:function(a,c){if(typeof c=="string"){var d=a[c];c=a,a=d}if(!e.isFunction(a))return b;var f=F.call(arguments,2),g=function(){return a.apply(c,f.concat(F.call(arguments)))};g.guid=a.guid=a.guid||g.guid||e.guid++;return g},access:function(a,c,d,f,g,h){var i=a.length;if(typeof c=="object"){for(var j in c)e.access(a,j,c[j],f,g,d);return a}if(d!==b){f=!h&&f&&e.isFunction(d);for(var k=0;k<i;k++)g(a[k],c,f?d.call(a[k],k,g(a[k],c)):d,h);return a}return i?g(a[0],c):b},now:function(){return(new Date).getTime()},uaMatch:function(a){a=a.toLowerCase();var b=r.exec(a)||s.exec(a)||t.exec(a)||a.indexOf("compatible")<0&&u.exec(a)||[];return{browser:b[1]||"",version:b[2]||"0"}},sub:function(){function a(b,c){return new a.fn.init(b,c)}e.extend(!0,a,this),a.superclass=this,a.fn=a.prototype=this(),a.fn.constructor=a,a.sub=this.sub,a.fn.init=function(d,f){f&&f instanceof e&&!(f instanceof a)&&(f=a(f));return e.fn.init.call(this,d,f,b)},a.fn.init.prototype=a.fn;var b=a(c);return a},browser:{}}),e.each("Boolean Number String Function Array Date RegExp Object".split(" "),function(a,b){I["[object "+b+"]"]=b.toLowerCase()}),z=e.uaMatch(y),z.browser&&(e.browser[z.browser]=!0,e.browser.version=z.version),e.browser.webkit&&(e.browser.safari=!0),j.test(" ")&&(k=/^[\s\xA0]+/,l=/[\s\xA0]+$/),h=e(c),c.addEventListener?B=function(){c.removeEventListener("DOMContentLoaded",B,!1),e.ready()}:c.attachEvent&&(B=function(){c.readyState==="complete"&&(c.detachEvent("onreadystatechange",B),e.ready())});return e}(),g={};f.Callbacks=function(a){a=a?g[a]||h(a):{};var c=[],d=[],e,i,j,k,l,m=function(b){var d,e,g,h,i;for(d=0,e=b.length;d<e;d++)g=b[d],h=f.type(g),h==="array"?m(g):h==="function"&&(!a.unique||!o.has(g))&&c.push(g)},n=function(b,f){f=f||[],e=!a.memory||[b,f],i=!0,l=j||0,j=0,k=c.length;for(;c&&l<k;l++)if(c[l].apply(b,f)===!1&&a.stopOnFalse){e=!0;break}i=!1,c&&(a.once?e===!0?o.disable():c=[]:d&&d.length&&(e=d.shift(),o.fireWith(e[0],e[1])))},o={add:function(){if(c){var a=c.length;m(arguments),i?k=c.length:e&&e!==!0&&(j=a,n(e[0],e[1]))}return this},remove:function(){if(c){var b=arguments,d=0,e=b.length;for(;d<e;d++)for(var f=0;f<c.length;f++)if(b[d]===c[f]){i&&f<=k&&(k--,f<=l&&l--),c.splice(f--,1);if(a.unique)break}}return this},has:function(a){if(c){var b=0,d=c.length;for(;b<d;b++)if(a===c[b])return!0}return!1},empty:function(){c=[];return this},disable:function(){c=d=e=b;return this},disabled:function(){return!c},lock:function(){d=b,(!e||e===!0)&&o.disable();return this},locked:function(){return!d},fireWith:function(b,c){d&&(i?a.once||d.push([b,c]):(!a.once||!e)&&n(b,c));return this},fire:function(){o.fireWith(this,arguments);return this},fired:function(){return!!e}};return o};var i=[].slice;f.extend({Deferred:function(a){var b=f.Callbacks("once memory"),c=f.Callbacks("once memory"),d=f.Callbacks("memory"),e="pending",g={resolve:b,reject:c,notify:d},h={done:b.add,fail:c.add,progress:d.add,state:function(){return e},isResolved:b.fired,isRejected:c.fired,then:function(a,b,c){i.done(a).fail(b).progress(c);return this},always:function(){i.done.apply(i,arguments).fail.apply(i,arguments);return this},pipe:function(a,b,c){return f.Deferred(function(d){f.each({done:[a,"resolve"],fail:[b,"reject"],progress:[c,"notify"]},function(a,b){var c=b[0],e=b[1],g;f.isFunction(c)?i[a](function(){g=c.apply(this,arguments),g&&f.isFunction(g.promise)?g.promise().then(d.resolve,d.reject,d.notify):d[e+"With"](this===i?d:this,[g])}):i[a](d[e])})}).promise()},promise:function(a){if(a==null)a=h;else for(var b in h)a[b]=h[b];return a}},i=h.promise({}),j;for(j in g)i[j]=g[j].fire,i[j+"With"]=g[j].fireWith;i.done(function(){e="resolved"},c.disable,d.lock).fail(function(){e="rejected"},b.disable,d.lock),a&&a.call(i,i);return i},when:function(a){function m(a){return function(b){e[a]=arguments.length>1?i.call(arguments,0):b,j.notifyWith(k,e)}}function l(a){return function(c){b[a]=arguments.length>1?i.call(arguments,0):c,--g||j.resolveWith(j,b)}}var b=i.call(arguments,0),c=0,d=b.length,e=Array(d),g=d,h=d,j=d<=1&&a&&f.isFunction(a.promise)?a:f.Deferred(),k=j.promise();if(d>1){for(;c<d;c++)b[c]&&b[c].promise&&f.isFunction(b[c].promise)?b[c].promise().then(l(c),j.reject,m(c)):--g;g||j.resolveWith(j,b)}else j!==a&&j.resolveWith(j,d?[a]:[]);return k}}),f.support=function(){var b,d,e,g,h,i,j,k,l,m,n,o,p,q=c.createElement("div"),r=c.documentElement;q.setAttribute("className","t"),q.innerHTML="   <link/><table></table><a href='/a' style='top:1px;float:left;opacity:.55;'>a</a><input type='checkbox'/>",d=q.getElementsByTagName("*"),e=q.getElementsByTagName("a")[0];if(!d||!d.length||!e)return{};g=c.createElement("select"),h=g.appendChild(c.createElement("option")),i=q.getElementsByTagName("input")[0],b={leadingWhitespace:q.firstChild.nodeType===3,tbody:!q.getElementsByTagName("tbody").length,htmlSerialize:!!q.getElementsByTagName("link").length,style:/top/.test(e.getAttribute("style")),hrefNormalized:e.getAttribute("href")==="/a",opacity:/^0.55/.test(e.style.opacity),cssFloat:!!e.style.cssFloat,checkOn:i.value==="on",optSelected:h.selected,getSetAttribute:q.className!=="t",enctype:!!c.createElement("form").enctype,html5Clone:c.createElement("nav").cloneNode(!0).outerHTML!=="<:nav></:nav>",submitBubbles:!0,changeBubbles:!0,focusinBubbles:!1,deleteExpando:!0,noCloneEvent:!0,inlineBlockNeedsLayout:!1,shrinkWrapBlocks:!1,reliableMarginRight:!0},i.checked=!0,b.noCloneChecked=i.cloneNode(!0).checked,g.disabled=!0,b.optDisabled=!h.disabled;try{delete q.test}catch(s){b.deleteExpando=!1}!q.addEventListener&&q.attachEvent&&q.fireEvent&&(q.attachEvent("onclick",function(){b.noCloneEvent=!1}),q.cloneNode(!0).fireEvent("onclick")),i=c.createElement("input"),i.value="t",i.setAttribute("type","radio"),b.radioValue=i.value==="t",i.setAttribute("checked","checked"),q.appendChild(i),k=c.createDocumentFragment(),k.appendChild(q.lastChild),b.checkClone=k.cloneNode(!0).cloneNode(!0).lastChild.checked,b.appendChecked=i.checked,k.removeChild(i),k.appendChild(q),q.innerHTML="",a.getComputedStyle&&(j=c.createElement("div"),j.style.width="0",j.style.marginRight="0",q.style.width="2px",q.appendChild(j),b.reliableMarginRight=(parseInt((a.getComputedStyle(j,null)||{marginRight:0}).marginRight,10)||0)===0);if(q.attachEvent)for(o in{submit:1,change:1,focusin:1})n="on"+o,p=n in q,p||(q.setAttribute(n,"return;"),p=typeof q[n]=="function"),b[o+"Bubbles"]=p;k.removeChild(q),k=g=h=j=q=i=null,f(function(){var a,d,e,g,h,i,j,k,m,n,o,r=c.getElementsByTagName("body")[0];!r||(j=1,k="position:absolute;top:0;left:0;width:1px;height:1px;margin:0;",m="visibility:hidden;border:0;",n="style='"+k+"border:5px solid #000;padding:0;'",o="<div "+n+"><div></div></div>"+"<table "+n+" cellpadding='0' cellspacing='0'>"+"<tr><td></td></tr></table>",a=c.createElement("div"),a.style.cssText=m+"width:0;height:0;position:static;top:0;margin-top:"+j+"px",r.insertBefore(a,r.firstChild),q=c.createElement("div"),a.appendChild(q),q.innerHTML="<table><tr><td style='padding:0;border:0;display:none'></td><td>t</td></tr></table>",l=q.getElementsByTagName("td"),p=l[0].offsetHeight===0,l[0].style.display="",l[1].style.display="none",b.reliableHiddenOffsets=p&&l[0].offsetHeight===0,q.innerHTML="",q.style.width=q.style.paddingLeft="1px",f.boxModel=b.boxModel=q.offsetWidth===2,typeof q.style.zoom!="undefined"&&(q.style.display="inline",q.style.zoom=1,b.inlineBlockNeedsLayout=q.offsetWidth===2,q.style.display="",q.innerHTML="<div style='width:4px;'></div>",b.shrinkWrapBlocks=q.offsetWidth!==2),q.style.cssText=k+m,q.innerHTML=o,d=q.firstChild,e=d.firstChild,h=d.nextSibling.firstChild.firstChild,i={doesNotAddBorder:e.offsetTop!==5,doesAddBorderForTableAndCells:h.offsetTop===5},e.style.position="fixed",e.style.top="20px",i.fixedPosition=e.offsetTop===20||e.offsetTop===15,e.style.position=e.style.top="",d.style.overflow="hidden",d.style.position="relative",i.subtractsBorderForOverflowNotVisible=e.offsetTop===-5,i.doesNotIncludeMarginInBodyOffset=r.offsetTop!==j,r.removeChild(a),q=a=null,f.extend(b,i))});return b}();var j=/^(?:\{.*\}|\[.*\])$/,k=/([A-Z])/g;f.extend({cache:{},uuid:0,expando:"jQuery"+(f.fn.jquery+Math.random()).replace(/\D/g,""),noData:{embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:!0},hasData:function(a){a=a.nodeType?f.cache[a[f.expando]]:a[f.expando];return!!a&&!m(a)},data:function(a,c,d,e){if(!!f.acceptData(a)){var g,h,i,j=f.expando,k=typeof c=="string",l=a.nodeType,m=l?f.cache:a,n=l?a[j]:a[j]&&j,o=c==="events";if((!n||!m[n]||!o&&!e&&!m[n].data)&&k&&d===b)return;n||(l?a[j]=n=++f.uuid:n=j),m[n]||(m[n]={},l||(m[n].toJSON=f.noop));if(typeof c=="object"||typeof c=="function")e?m[n]=f.extend(m[n],c):m[n].data=f.extend(m[n].data,c);g=h=m[n],e||(h.data||(h.data={}),h=h.data),d!==b&&(h[f.camelCase(c)]=d);if(o&&!h[c])return g.events;k?(i=h[c],i==null&&(i=h[f.camelCase(c)])):i=h;return i}},removeData:function(a,b,c){if(!!f.acceptData(a)){var d,e,g,h=f.expando,i=a.nodeType,j=i?f.cache:a,k=i?a[h]:h;if(!j[k])return;if(b){d=c?j[k]:j[k].data;if(d){f.isArray(b)||(b in d?b=[b]:(b=f.camelCase(b),b in d?b=[b]:b=b.split(" ")));for(e=0,g=b.length;e<g;e++)delete d[b[e]];if(!(c?m:f.isEmptyObject)(d))return}}if(!c){delete j[k].data;if(!m(j[k]))return}f.support.deleteExpando||!j.setInterval?delete j[k]:j[k]=null,i&&(f.support.deleteExpando?delete a[h]:a.removeAttribute?a.removeAttribute(h):a[h]=null)}},_data:function(a,b,c){return f.data(a,b,c,!0)},acceptData:function(a){if(a.nodeName){var b=f.noData[a.nodeName.toLowerCase()];if(b)return b!==!0&&a.getAttribute("classid")===b}return!0}}),f.fn.extend({data:function(a,c){var d,e,g,h=null;if(typeof a=="undefined"){if(this.length){h=f.data(this[0]);if(this[0].nodeType===1&&!f._data(this[0],"parsedAttrs")){e=this[0].attributes;for(var i=0,j=e.length;i<j;i++)g=e[i].name,g.indexOf("data-")===0&&(g=f.camelCase(g.substring(5)),l(this[0],g,h[g]));f._data(this[0],"parsedAttrs",!0)}}return h}if(typeof a=="object")return this.each(function(){f.data(this,a)});d=a.split("."),d[1]=d[1]?"."+d[1]:"";if(c===b){h=this.triggerHandler("getData"+d[1]+"!",[d[0]]),h===b&&this.length&&(h=f.data(this[0],a),h=l(this[0],a,h));return h===b&&d[1]?this.data(d[0]):h}return this.each(function(){var b=f(this),e=[d[0],c];b.triggerHandler("setData"+d[1]+"!",e),f.data(this,a,c),b.triggerHandler("changeData"+d[1]+"!",e)})},removeData:function(a){return this.each(function(){f.removeData(this,a)})}}),f.extend({_mark:function(a,b){a&&(b=(b||"fx")+"mark",f._data(a,b,(f._data(a,b)||0)+1))},_unmark:function(a,b,c){a!==!0&&(c=b,b=a,a=!1);if(b){c=c||"fx";var d=c+"mark",e=a?0:(f._data(b,d)||1)-1;e?f._data(b,d,e):(f.removeData(b,d,!0),n(b,c,"mark"))}},queue:function(a,b,c){var d;if(a){b=(b||"fx")+"queue",d=f._data(a,b),c&&(!d||f.isArray(c)?d=f._data(a,b,f.makeArray(c)):d.push(c));return d||[]}},dequeue:function(a,b){b=b||"fx";var c=f.queue(a,b),d=c.shift(),e={};d==="inprogress"&&(d=c.shift()),d&&(b==="fx"&&c.unshift("inprogress"),f._data(a,b+".run",e),d.call(a,function(){f.dequeue(a,b)},e)),c.length||(f.removeData(a,b+"queue "+b+".run",!0),n(a,b,"queue"))}}),f.fn.extend({queue:function(a,c){typeof a!="string"&&(c=a,a="fx");if(c===b)return f.queue(this[0],a);return this.each(function(){var b=f.queue(this,a,c);a==="fx"&&b[0]!=="inprogress"&&f.dequeue(this,a)})},dequeue:function(a){return this.each(function(){f.dequeue(this,a)})},delay:function(a,b){a=f.fx?f.fx.speeds[a]||a:a,b=b||"fx";return this.queue(b,function(b,c){var d=setTimeout(b,a);c.stop=function(){clearTimeout(d)}})},clearQueue:function(a){return this.queue(a||"fx",[])},promise:function(a,c){function m(){--h||d.resolveWith(e,[e])}typeof a!="string"&&(c=a,a=b),a=a||"fx";var d=f.Deferred(),e=this,g=e.length,h=1,i=a+"defer",j=a+"queue",k=a+"mark",l;while(g--)if(l=f.data(e[g],i,b,!0)||(f.data(e[g],j,b,!0)||f.data(e[g],k,b,!0))&&f.data(e[g],i,f.Callbacks("once memory"),!0))h++,l.add(m);m();return d.promise()}});var o=/[\n\t\r]/g,p=/\s+/,q=/\r/g,r=/^(?:button|input)$/i,s=/^(?:button|input|object|select|textarea)$/i,t=/^a(?:rea)?$/i,u=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,v=f.support.getSetAttribute,w,x,y;f.fn.extend({attr:function(a,b){return f.access(this,a,b,!0,f.attr)},removeAttr:function(a){return this.each(function(){f.removeAttr(this,a)})},prop:function(a,b){return f.access(this,a,b,!0,f.prop)},removeProp:function(a){a=f.propFix[a]||a;return this.each(function(){try{this[a]=b,delete this[a]}catch(c){}})},addClass:function(a){var b,c,d,e,g,h,i;if(f.isFunction(a))return this.each(function(b){f(this).addClass(a.call(this,b,this.className))});if(a&&typeof a=="string"){b=a.split(p);for(c=0,d=this.length;c<d;c++){e=this[c];if(e.nodeType===1)if(!e.className&&b.length===1)e.className=a;else{g=" "+e.className+" ";for(h=0,i=b.length;h<i;h++)~g.indexOf(" "+b[h]+" ")||(g+=b[h]+" ");e.className=f.trim(g)}}}return this},removeClass:function(a){var c,d,e,g,h,i,j;if(f.isFunction(a))return this.each(function(b){f(this).removeClass(a.call(this,b,this.className))});if(a&&typeof a=="string"||a===b){c=(a||"").split(p);for(d=0,e=this.length;d<e;d++){g=this[d];if(g.nodeType===1&&g.className)if(a){h=(" "+g.className+" ").replace(o," ");for(i=0,j=c.length;i<j;i++)h=h.replace(" "+c[i]+" "," ");g.className=f.trim(h)}else g.className=""}}return this},toggleClass:function(a,b){var c=typeof a,d=typeof b=="boolean";if(f.isFunction(a))return this.each(function(c){f(this).toggleClass(a.call(this,c,this.className,b),b)});return this.each(function(){if(c==="string"){var e,g=0,h=f(this),i=b,j=a.split(p);while(e=j[g++])i=d?i:!h.hasClass(e),h[i?"addClass":"removeClass"](e)}else if(c==="undefined"||c==="boolean")this.className&&f._data(this,"__className__",this.className),this.className=this.className||a===!1?"":f._data(this,"__className__")||""})},hasClass:function(a){var b=" "+a+" ",c=0,d=this.length;for(;c<d;c++)if(this[c].nodeType===1&&(" "+this[c].className+" ").replace(o," ").indexOf(b)>-1)return!0;return!1},val:function(a){var c,d,e,g=this[0];{if(!!arguments.length){e=f.isFunction(a);return this.each(function(d){var g=f(this),h;if(this.nodeType===1){e?h=a.call(this,d,g.val()):h=a,h==null?h="":typeof h=="number"?h+="":f.isArray(h)&&(h=f.map(h,function(a){return a==null?"":a+""})),c=f.valHooks[this.nodeName.toLowerCase()]||f.valHooks[this.type];if(!c||!("set"in c)||c.set(this,h,"value")===b)this.value=h}})}if(g){c=f.valHooks[g.nodeName.toLowerCase()]||f.valHooks[g.type];if(c&&"get"in c&&(d=c.get(g,"value"))!==b)return d;d=g.value;return typeof d=="string"?d.replace(q,""):d==null?"":d}}}}),f.extend({valHooks:{option:{get:function(a){var b=a.attributes.value;return!b||b.specified?a.value:a.text}},select:{get:function(a){var b,c,d,e,g=a.selectedIndex,h=[],i=a.options,j=a.type==="select-one";if(g<0)return null;c=j?g:0,d=j?g+1:i.length;for(;c<d;c++){e=i[c];if(e.selected&&(f.support.optDisabled?!e.disabled:e.getAttribute("disabled")===null)&&(!e.parentNode.disabled||!f.nodeName(e.parentNode,"optgroup"))){b=f(e).val();if(j)return b;h.push(b)}}if(j&&!h.length&&i.length)return f(i[g]).val();return h},set:function(a,b){var c=f.makeArray(b);f(a).find("option").each(function(){this.selected=f.inArray(f(this).val(),c)>=0}),c.length||(a.selectedIndex=-1);return c}}},attrFn:{val:!0,css:!0,html:!0,text:!0,data:!0,width:!0,height:!0,offset:!0},attr:function(a,c,d,e){var g,h,i,j=a.nodeType;if(!!a&&j!==3&&j!==8&&j!==2){if(e&&c in f.attrFn)return f(a)[c](d);if(typeof a.getAttribute=="undefined")return f.prop(a,c,d);i=j!==1||!f.isXMLDoc(a),i&&(c=c.toLowerCase(),h=f.attrHooks[c]||(u.test(c)?x:w));if(d!==b){if(d===null){f.removeAttr(a,c);return}if(h&&"set"in h&&i&&(g=h.set(a,d,c))!==b)return g;a.setAttribute(c,""+d);return d}if(h&&"get"in h&&i&&(g=h.get(a,c))!==null)return g;g=a.getAttribute(c);return g===null?b:g}},removeAttr:function(a,b){var c,d,e,g,h=0;if(b&&a.nodeType===1){d=b.toLowerCase().split(p),g=d.length;for(;h<g;h++)e=d[h],e&&(c=f.propFix[e]||e,f.attr(a,e,""),a.removeAttribute(v?e:c),u.test(e)&&c in a&&(a[c]=!1))}},attrHooks:{type:{set:function(a,b){if(r.test(a.nodeName)&&a.parentNode)f.error("type property can't be changed");else if(!f.support.radioValue&&b==="radio"&&f.nodeName(a,"input")){var c=a.value;a.setAttribute("type",b),c&&(a.value=c);return b}}},value:{get:function(a,b){if(w&&f.nodeName(a,"button"))return w.get(a,b);return b in a?a.value:null},set:function(a,b,c){if(w&&f.nodeName(a,"button"))return w.set(a,b,c);a.value=b}}},propFix:{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},prop:function(a,c,d){var e,g,h,i=a.nodeType;if(!!a&&i!==3&&i!==8&&i!==2){h=i!==1||!f.isXMLDoc(a),h&&(c=f.propFix[c]||c,g=f.propHooks[c]);return d!==b?g&&"set"in g&&(e=g.set(a,d,c))!==b?e:a[c]=d:g&&"get"in g&&(e=g.get(a,c))!==null?e:a[c]}},propHooks:{tabIndex:{get:function(a){var c=a.getAttributeNode("tabindex");return c&&c.specified?parseInt(c.value,10):s.test(a.nodeName)||t.test(a.nodeName)&&a.href?0:b}}}}),f.attrHooks.tabindex=f.propHooks.tabIndex,x={get:function(a,c){var d,e=f.prop(a,c);return e===!0||typeof e!="boolean"&&(d=a.getAttributeNode(c))&&d.nodeValue!==!1?c.toLowerCase():b},set:function(a,b,c){var d;b===!1?f.removeAttr(a,c):(d=f.propFix[c]||c,d in a&&(a[d]=!0),a.setAttribute(c,c.toLowerCase()));return c}},v||(y={name:!0,id:!0},w=f.valHooks.button={get:function(a,c){var d;d=a.getAttributeNode(c);return d&&(y[c]?d.nodeValue!=="":d.specified)?d.nodeValue:b},set:function(a,b,d){var e=a.getAttributeNode(d);e||(e=c.createAttribute(d),a.setAttributeNode(e));return e.nodeValue=b+""}},f.attrHooks.tabindex.set=w.set,f.each(["width","height"],function(a,b){f.attrHooks[b]=f.extend(f.attrHooks[b],{set:function(a,c){if(c===""){a.setAttribute(b,"auto");return c}}})}),f.attrHooks.contenteditable={get:w.get,set:function(a,b,c){b===""&&(b="false"),w.set(a,b,c)}}),f.support.hrefNormalized||f.each(["href","src","width","height"],function(a,c){f.attrHooks[c]=f.extend(f.attrHooks[c],{get:function(a){var d=a.getAttribute(c,2);return d===null?b:d}})}),f.support.style||(f.attrHooks.style={get:function(a){return a.style.cssText.toLowerCase()||b},set:function(a,b){return a.style.cssText=""+b}}),f.support.optSelected||(f.propHooks.selected=f.extend(f.propHooks.selected,{get:function(a){var b=a.parentNode;b&&(b.selectedIndex,b.parentNode&&b.parentNode.selectedIndex);return null}})),f.support.enctype||(f.propFix.enctype="encoding"),f.support.checkOn||f.each(["radio","checkbox"],function(){f.valHooks[this]={get:function(a){return a.getAttribute("value")===null?"on":a.value}}}),f.each(["radio","checkbox"],function(){f.valHooks[this]=f.extend(f.valHooks[this],{set:function(a,b){if(f.isArray(b))return a.checked=f.inArray(f(a).val(),b)>=0}})});var z=/^(?:textarea|input|select)$/i,A=/^([^\.]*)?(?:\.(.+))?$/,B=/\bhover(\.\S+)?\b/,C=/^key/,D=/^(?:mouse|contextmenu)|click/,E=/^(?:focusinfocus|focusoutblur)$/,F=/^(\w*)(?:#([\w\-]+))?(?:\.([\w\-]+))?$/,G=function(a){var b=F.exec(a);b&&(b[1]=(b[1]||"").toLowerCase(),b[3]=b[3]&&new RegExp("(?:^|\\s)"+b[3]+"(?:\\s|$)"));return b},H=function(a,b){var c=a.attributes||{};return(!b[1]||a.nodeName.toLowerCase()===b[1])&&(!b[2]||(c.id||{}).value===b[2])&&(!b[3]||b[3].test((c["class"]||{}).value))},I=function(a){return f.event.special.hover?a:a.replace(B,"mouseenter$1 mouseleave$1")};
f.event={add:function(a,c,d,e,g){var h,i,j,k,l,m,n,o,p,q,r,s;if(!(a.nodeType===3||a.nodeType===8||!c||!d||!(h=f._data(a)))){d.handler&&(p=d,d=p.handler),d.guid||(d.guid=f.guid++),j=h.events,j||(h.events=j={}),i=h.handle,i||(h.handle=i=function(a){return typeof f!="undefined"&&(!a||f.event.triggered!==a.type)?f.event.dispatch.apply(i.elem,arguments):b},i.elem=a),c=f.trim(I(c)).split(" ");for(k=0;k<c.length;k++){l=A.exec(c[k])||[],m=l[1],n=(l[2]||"").split(".").sort(),s=f.event.special[m]||{},m=(g?s.delegateType:s.bindType)||m,s=f.event.special[m]||{},o=f.extend({type:m,origType:l[1],data:e,handler:d,guid:d.guid,selector:g,quick:G(g),namespace:n.join(".")},p),r=j[m];if(!r){r=j[m]=[],r.delegateCount=0;if(!s.setup||s.setup.call(a,e,n,i)===!1)a.addEventListener?a.addEventListener(m,i,!1):a.attachEvent&&a.attachEvent("on"+m,i)}s.add&&(s.add.call(a,o),o.handler.guid||(o.handler.guid=d.guid)),g?r.splice(r.delegateCount++,0,o):r.push(o),f.event.global[m]=!0}a=null}},global:{},remove:function(a,b,c,d,e){var g=f.hasData(a)&&f._data(a),h,i,j,k,l,m,n,o,p,q,r,s;if(!!g&&!!(o=g.events)){b=f.trim(I(b||"")).split(" ");for(h=0;h<b.length;h++){i=A.exec(b[h])||[],j=k=i[1],l=i[2];if(!j){for(j in o)f.event.remove(a,j+b[h],c,d,!0);continue}p=f.event.special[j]||{},j=(d?p.delegateType:p.bindType)||j,r=o[j]||[],m=r.length,l=l?new RegExp("(^|\\.)"+l.split(".").sort().join("\\.(?:.*\\.)?")+"(\\.|$)"):null;for(n=0;n<r.length;n++)s=r[n],(e||k===s.origType)&&(!c||c.guid===s.guid)&&(!l||l.test(s.namespace))&&(!d||d===s.selector||d==="**"&&s.selector)&&(r.splice(n--,1),s.selector&&r.delegateCount--,p.remove&&p.remove.call(a,s));r.length===0&&m!==r.length&&((!p.teardown||p.teardown.call(a,l)===!1)&&f.removeEvent(a,j,g.handle),delete o[j])}f.isEmptyObject(o)&&(q=g.handle,q&&(q.elem=null),f.removeData(a,["events","handle"],!0))}},customEvent:{getData:!0,setData:!0,changeData:!0},trigger:function(c,d,e,g){if(!e||e.nodeType!==3&&e.nodeType!==8){var h=c.type||c,i=[],j,k,l,m,n,o,p,q,r,s;if(E.test(h+f.event.triggered))return;h.indexOf("!")>=0&&(h=h.slice(0,-1),k=!0),h.indexOf(".")>=0&&(i=h.split("."),h=i.shift(),i.sort());if((!e||f.event.customEvent[h])&&!f.event.global[h])return;c=typeof c=="object"?c[f.expando]?c:new f.Event(h,c):new f.Event(h),c.type=h,c.isTrigger=!0,c.exclusive=k,c.namespace=i.join("."),c.namespace_re=c.namespace?new RegExp("(^|\\.)"+i.join("\\.(?:.*\\.)?")+"(\\.|$)"):null,o=h.indexOf(":")<0?"on"+h:"";if(!e){j=f.cache;for(l in j)j[l].events&&j[l].events[h]&&f.event.trigger(c,d,j[l].handle.elem,!0);return}c.result=b,c.target||(c.target=e),d=d!=null?f.makeArray(d):[],d.unshift(c),p=f.event.special[h]||{};if(p.trigger&&p.trigger.apply(e,d)===!1)return;r=[[e,p.bindType||h]];if(!g&&!p.noBubble&&!f.isWindow(e)){s=p.delegateType||h,m=E.test(s+h)?e:e.parentNode,n=null;for(;m;m=m.parentNode)r.push([m,s]),n=m;n&&n===e.ownerDocument&&r.push([n.defaultView||n.parentWindow||a,s])}for(l=0;l<r.length&&!c.isPropagationStopped();l++)m=r[l][0],c.type=r[l][1],q=(f._data(m,"events")||{})[c.type]&&f._data(m,"handle"),q&&q.apply(m,d),q=o&&m[o],q&&f.acceptData(m)&&q.apply(m,d)===!1&&c.preventDefault();c.type=h,!g&&!c.isDefaultPrevented()&&(!p._default||p._default.apply(e.ownerDocument,d)===!1)&&(h!=="click"||!f.nodeName(e,"a"))&&f.acceptData(e)&&o&&e[h]&&(h!=="focus"&&h!=="blur"||c.target.offsetWidth!==0)&&!f.isWindow(e)&&(n=e[o],n&&(e[o]=null),f.event.triggered=h,e[h](),f.event.triggered=b,n&&(e[o]=n));return c.result}},dispatch:function(c){c=f.event.fix(c||a.event);var d=(f._data(this,"events")||{})[c.type]||[],e=d.delegateCount,g=[].slice.call(arguments,0),h=!c.exclusive&&!c.namespace,i=[],j,k,l,m,n,o,p,q,r,s,t;g[0]=c,c.delegateTarget=this;if(e&&!c.target.disabled&&(!c.button||c.type!=="click")){m=f(this),m.context=this.ownerDocument||this;for(l=c.target;l!=this;l=l.parentNode||this){o={},q=[],m[0]=l;for(j=0;j<e;j++)r=d[j],s=r.selector,o[s]===b&&(o[s]=r.quick?H(l,r.quick):m.is(s)),o[s]&&q.push(r);q.length&&i.push({elem:l,matches:q})}}d.length>e&&i.push({elem:this,matches:d.slice(e)});for(j=0;j<i.length&&!c.isPropagationStopped();j++){p=i[j],c.currentTarget=p.elem;for(k=0;k<p.matches.length&&!c.isImmediatePropagationStopped();k++){r=p.matches[k];if(h||!c.namespace&&!r.namespace||c.namespace_re&&c.namespace_re.test(r.namespace))c.data=r.data,c.handleObj=r,n=((f.event.special[r.origType]||{}).handle||r.handler).apply(p.elem,g),n!==b&&(c.result=n,n===!1&&(c.preventDefault(),c.stopPropagation()))}}return c.result},props:"attrChange attrName relatedNode srcElement altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(a,b){a.which==null&&(a.which=b.charCode!=null?b.charCode:b.keyCode);return a}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(a,d){var e,f,g,h=d.button,i=d.fromElement;a.pageX==null&&d.clientX!=null&&(e=a.target.ownerDocument||c,f=e.documentElement,g=e.body,a.pageX=d.clientX+(f&&f.scrollLeft||g&&g.scrollLeft||0)-(f&&f.clientLeft||g&&g.clientLeft||0),a.pageY=d.clientY+(f&&f.scrollTop||g&&g.scrollTop||0)-(f&&f.clientTop||g&&g.clientTop||0)),!a.relatedTarget&&i&&(a.relatedTarget=i===a.target?d.toElement:i),!a.which&&h!==b&&(a.which=h&1?1:h&2?3:h&4?2:0);return a}},fix:function(a){if(a[f.expando])return a;var d,e,g=a,h=f.event.fixHooks[a.type]||{},i=h.props?this.props.concat(h.props):this.props;a=f.Event(g);for(d=i.length;d;)e=i[--d],a[e]=g[e];a.target||(a.target=g.srcElement||c),a.target.nodeType===3&&(a.target=a.target.parentNode),a.metaKey===b&&(a.metaKey=a.ctrlKey);return h.filter?h.filter(a,g):a},special:{ready:{setup:f.bindReady},load:{noBubble:!0},focus:{delegateType:"focusin"},blur:{delegateType:"focusout"},beforeunload:{setup:function(a,b,c){f.isWindow(this)&&(this.onbeforeunload=c)},teardown:function(a,b){this.onbeforeunload===b&&(this.onbeforeunload=null)}}},simulate:function(a,b,c,d){var e=f.extend(new f.Event,c,{type:a,isSimulated:!0,originalEvent:{}});d?f.event.trigger(e,null,b):f.event.dispatch.call(b,e),e.isDefaultPrevented()&&c.preventDefault()}},f.event.handle=f.event.dispatch,f.removeEvent=c.removeEventListener?function(a,b,c){a.removeEventListener&&a.removeEventListener(b,c,!1)}:function(a,b,c){a.detachEvent&&a.detachEvent("on"+b,c)},f.Event=function(a,b){if(!(this instanceof f.Event))return new f.Event(a,b);a&&a.type?(this.originalEvent=a,this.type=a.type,this.isDefaultPrevented=a.defaultPrevented||a.returnValue===!1||a.getPreventDefault&&a.getPreventDefault()?K:J):this.type=a,b&&f.extend(this,b),this.timeStamp=a&&a.timeStamp||f.now(),this[f.expando]=!0},f.Event.prototype={preventDefault:function(){this.isDefaultPrevented=K;var a=this.originalEvent;!a||(a.preventDefault?a.preventDefault():a.returnValue=!1)},stopPropagation:function(){this.isPropagationStopped=K;var a=this.originalEvent;!a||(a.stopPropagation&&a.stopPropagation(),a.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=K,this.stopPropagation()},isDefaultPrevented:J,isPropagationStopped:J,isImmediatePropagationStopped:J},f.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(a,b){f.event.special[a]={delegateType:b,bindType:b,handle:function(a){var c=this,d=a.relatedTarget,e=a.handleObj,g=e.selector,h;if(!d||d!==c&&!f.contains(c,d))a.type=e.origType,h=e.handler.apply(this,arguments),a.type=b;return h}}}),f.support.submitBubbles||(f.event.special.submit={setup:function(){if(f.nodeName(this,"form"))return!1;f.event.add(this,"click._submit keypress._submit",function(a){var c=a.target,d=f.nodeName(c,"input")||f.nodeName(c,"button")?c.form:b;d&&!d._submit_attached&&(f.event.add(d,"submit._submit",function(a){this.parentNode&&!a.isTrigger&&f.event.simulate("submit",this.parentNode,a,!0)}),d._submit_attached=!0)})},teardown:function(){if(f.nodeName(this,"form"))return!1;f.event.remove(this,"._submit")}}),f.support.changeBubbles||(f.event.special.change={setup:function(){if(z.test(this.nodeName)){if(this.type==="checkbox"||this.type==="radio")f.event.add(this,"propertychange._change",function(a){a.originalEvent.propertyName==="checked"&&(this._just_changed=!0)}),f.event.add(this,"click._change",function(a){this._just_changed&&!a.isTrigger&&(this._just_changed=!1,f.event.simulate("change",this,a,!0))});return!1}f.event.add(this,"beforeactivate._change",function(a){var b=a.target;z.test(b.nodeName)&&!b._change_attached&&(f.event.add(b,"change._change",function(a){this.parentNode&&!a.isSimulated&&!a.isTrigger&&f.event.simulate("change",this.parentNode,a,!0)}),b._change_attached=!0)})},handle:function(a){var b=a.target;if(this!==b||a.isSimulated||a.isTrigger||b.type!=="radio"&&b.type!=="checkbox")return a.handleObj.handler.apply(this,arguments)},teardown:function(){f.event.remove(this,"._change");return z.test(this.nodeName)}}),f.support.focusinBubbles||f.each({focus:"focusin",blur:"focusout"},function(a,b){var d=0,e=function(a){f.event.simulate(b,a.target,f.event.fix(a),!0)};f.event.special[b]={setup:function(){d++===0&&c.addEventListener(a,e,!0)},teardown:function(){--d===0&&c.removeEventListener(a,e,!0)}}}),f.fn.extend({on:function(a,c,d,e,g){var h,i;if(typeof a=="object"){typeof c!="string"&&(d=c,c=b);for(i in a)this.on(i,c,d,a[i],g);return this}d==null&&e==null?(e=c,d=c=b):e==null&&(typeof c=="string"?(e=d,d=b):(e=d,d=c,c=b));if(e===!1)e=J;else if(!e)return this;g===1&&(h=e,e=function(a){f().off(a);return h.apply(this,arguments)},e.guid=h.guid||(h.guid=f.guid++));return this.each(function(){f.event.add(this,a,e,d,c)})},one:function(a,b,c,d){return this.on.call(this,a,b,c,d,1)},off:function(a,c,d){if(a&&a.preventDefault&&a.handleObj){var e=a.handleObj;f(a.delegateTarget).off(e.namespace?e.type+"."+e.namespace:e.type,e.selector,e.handler);return this}if(typeof a=="object"){for(var g in a)this.off(g,c,a[g]);return this}if(c===!1||typeof c=="function")d=c,c=b;d===!1&&(d=J);return this.each(function(){f.event.remove(this,a,d,c)})},bind:function(a,b,c){return this.on(a,null,b,c)},unbind:function(a,b){return this.off(a,null,b)},live:function(a,b,c){f(this.context).on(a,this.selector,b,c);return this},die:function(a,b){f(this.context).off(a,this.selector||"**",b);return this},delegate:function(a,b,c,d){return this.on(b,a,c,d)},undelegate:function(a,b,c){return arguments.length==1?this.off(a,"**"):this.off(b,a,c)},trigger:function(a,b){return this.each(function(){f.event.trigger(a,b,this)})},triggerHandler:function(a,b){if(this[0])return f.event.trigger(a,b,this[0],!0)},toggle:function(a){var b=arguments,c=a.guid||f.guid++,d=0,e=function(c){var e=(f._data(this,"lastToggle"+a.guid)||0)%d;f._data(this,"lastToggle"+a.guid,e+1),c.preventDefault();return b[e].apply(this,arguments)||!1};e.guid=c;while(d<b.length)b[d++].guid=c;return this.click(e)},hover:function(a,b){return this.mouseenter(a).mouseleave(b||a)}}),f.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(a,b){f.fn[b]=function(a,c){c==null&&(c=a,a=null);return arguments.length>0?this.on(b,null,a,c):this.trigger(b)},f.attrFn&&(f.attrFn[b]=!0),C.test(b)&&(f.event.fixHooks[b]=f.event.keyHooks),D.test(b)&&(f.event.fixHooks[b]=f.event.mouseHooks)}),function(){function x(a,b,c,e,f,g){for(var h=0,i=e.length;h<i;h++){var j=e[h];if(j){var k=!1;j=j[a];while(j){if(j[d]===c){k=e[j.sizset];break}if(j.nodeType===1){g||(j[d]=c,j.sizset=h);if(typeof b!="string"){if(j===b){k=!0;break}}else if(m.filter(b,[j]).length>0){k=j;break}}j=j[a]}e[h]=k}}}function w(a,b,c,e,f,g){for(var h=0,i=e.length;h<i;h++){var j=e[h];if(j){var k=!1;j=j[a];while(j){if(j[d]===c){k=e[j.sizset];break}j.nodeType===1&&!g&&(j[d]=c,j.sizset=h);if(j.nodeName.toLowerCase()===b){k=j;break}j=j[a]}e[h]=k}}}var a=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^\[\]]*\]|['"][^'"]*['"]|[^\[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g,d="sizcache"+(Math.random()+"").replace(".",""),e=0,g=Object.prototype.toString,h=!1,i=!0,j=/\\/g,k=/\r\n/g,l=/\W/;[0,0].sort(function(){i=!1;return 0});var m=function(b,d,e,f){e=e||[],d=d||c;var h=d;if(d.nodeType!==1&&d.nodeType!==9)return[];if(!b||typeof b!="string")return e;var i,j,k,l,n,q,r,t,u=!0,v=m.isXML(d),w=[],x=b;do{a.exec(""),i=a.exec(x);if(i){x=i[3],w.push(i[1]);if(i[2]){l=i[3];break}}}while(i);if(w.length>1&&p.exec(b))if(w.length===2&&o.relative[w[0]])j=y(w[0]+w[1],d,f);else{j=o.relative[w[0]]?[d]:m(w.shift(),d);while(w.length)b=w.shift(),o.relative[b]&&(b+=w.shift()),j=y(b,j,f)}else{!f&&w.length>1&&d.nodeType===9&&!v&&o.match.ID.test(w[0])&&!o.match.ID.test(w[w.length-1])&&(n=m.find(w.shift(),d,v),d=n.expr?m.filter(n.expr,n.set)[0]:n.set[0]);if(d){n=f?{expr:w.pop(),set:s(f)}:m.find(w.pop(),w.length===1&&(w[0]==="~"||w[0]==="+")&&d.parentNode?d.parentNode:d,v),j=n.expr?m.filter(n.expr,n.set):n.set,w.length>0?k=s(j):u=!1;while(w.length)q=w.pop(),r=q,o.relative[q]?r=w.pop():q="",r==null&&(r=d),o.relative[q](k,r,v)}else k=w=[]}k||(k=j),k||m.error(q||b);if(g.call(k)==="[object Array]")if(!u)e.push.apply(e,k);else if(d&&d.nodeType===1)for(t=0;k[t]!=null;t++)k[t]&&(k[t]===!0||k[t].nodeType===1&&m.contains(d,k[t]))&&e.push(j[t]);else for(t=0;k[t]!=null;t++)k[t]&&k[t].nodeType===1&&e.push(j[t]);else s(k,e);l&&(m(l,h,e,f),m.uniqueSort(e));return e};m.uniqueSort=function(a){if(u){h=i,a.sort(u);if(h)for(var b=1;b<a.length;b++)a[b]===a[b-1]&&a.splice(b--,1)}return a},m.matches=function(a,b){return m(a,null,null,b)},m.matchesSelector=function(a,b){return m(b,null,null,[a]).length>0},m.find=function(a,b,c){var d,e,f,g,h,i;if(!a)return[];for(e=0,f=o.order.length;e<f;e++){h=o.order[e];if(g=o.leftMatch[h].exec(a)){i=g[1],g.splice(1,1);if(i.substr(i.length-1)!=="\\"){g[1]=(g[1]||"").replace(j,""),d=o.find[h](g,b,c);if(d!=null){a=a.replace(o.match[h],"");break}}}}d||(d=typeof b.getElementsByTagName!="undefined"?b.getElementsByTagName("*"):[]);return{set:d,expr:a}},m.filter=function(a,c,d,e){var f,g,h,i,j,k,l,n,p,q=a,r=[],s=c,t=c&&c[0]&&m.isXML(c[0]);while(a&&c.length){for(h in o.filter)if((f=o.leftMatch[h].exec(a))!=null&&f[2]){k=o.filter[h],l=f[1],g=!1,f.splice(1,1);if(l.substr(l.length-1)==="\\")continue;s===r&&(r=[]);if(o.preFilter[h]){f=o.preFilter[h](f,s,d,r,e,t);if(!f)g=i=!0;else if(f===!0)continue}if(f)for(n=0;(j=s[n])!=null;n++)j&&(i=k(j,f,n,s),p=e^i,d&&i!=null?p?g=!0:s[n]=!1:p&&(r.push(j),g=!0));if(i!==b){d||(s=r),a=a.replace(o.match[h],"");if(!g)return[];break}}if(a===q)if(g==null)m.error(a);else break;q=a}return s},m.error=function(a){throw new Error("Syntax error, unrecognized expression: "+a)};var n=m.getText=function(a){var b,c,d=a.nodeType,e="";if(d){if(d===1||d===9){if(typeof a.textContent=="string")return a.textContent;if(typeof a.innerText=="string")return a.innerText.replace(k,"");for(a=a.firstChild;a;a=a.nextSibling)e+=n(a)}else if(d===3||d===4)return a.nodeValue}else for(b=0;c=a[b];b++)c.nodeType!==8&&(e+=n(c));return e},o=m.selectors={order:["ID","NAME","TAG"],match:{ID:/#((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,CLASS:/\.((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,NAME:/\[name=['"]*((?:[\w\u00c0-\uFFFF\-]|\\.)+)['"]*\]/,ATTR:/\[\s*((?:[\w\u00c0-\uFFFF\-]|\\.)+)\s*(?:(\S?=)\s*(?:(['"])(.*?)\3|(#?(?:[\w\u00c0-\uFFFF\-]|\\.)*)|)|)\s*\]/,TAG:/^((?:[\w\u00c0-\uFFFF\*\-]|\\.)+)/,CHILD:/:(only|nth|last|first)-child(?:\(\s*(even|odd|(?:[+\-]?\d+|(?:[+\-]?\d*)?n\s*(?:[+\-]\s*\d+)?))\s*\))?/,POS:/:(nth|eq|gt|lt|first|last|even|odd)(?:\((\d*)\))?(?=[^\-]|$)/,PSEUDO:/:((?:[\w\u00c0-\uFFFF\-]|\\.)+)(?:\((['"]?)((?:\([^\)]+\)|[^\(\)]*)+)\2\))?/},leftMatch:{},attrMap:{"class":"className","for":"htmlFor"},attrHandle:{href:function(a){return a.getAttribute("href")},type:function(a){return a.getAttribute("type")}},relative:{"+":function(a,b){var c=typeof b=="string",d=c&&!l.test(b),e=c&&!d;d&&(b=b.toLowerCase());for(var f=0,g=a.length,h;f<g;f++)if(h=a[f]){while((h=h.previousSibling)&&h.nodeType!==1);a[f]=e||h&&h.nodeName.toLowerCase()===b?h||!1:h===b}e&&m.filter(b,a,!0)},">":function(a,b){var c,d=typeof b=="string",e=0,f=a.length;if(d&&!l.test(b)){b=b.toLowerCase();for(;e<f;e++){c=a[e];if(c){var g=c.parentNode;a[e]=g.nodeName.toLowerCase()===b?g:!1}}}else{for(;e<f;e++)c=a[e],c&&(a[e]=d?c.parentNode:c.parentNode===b);d&&m.filter(b,a,!0)}},"":function(a,b,c){var d,f=e++,g=x;typeof b=="string"&&!l.test(b)&&(b=b.toLowerCase(),d=b,g=w),g("parentNode",b,f,a,d,c)},"~":function(a,b,c){var d,f=e++,g=x;typeof b=="string"&&!l.test(b)&&(b=b.toLowerCase(),d=b,g=w),g("previousSibling",b,f,a,d,c)}},find:{ID:function(a,b,c){if(typeof b.getElementById!="undefined"&&!c){var d=b.getElementById(a[1]);return d&&d.parentNode?[d]:[]}},NAME:function(a,b){if(typeof b.getElementsByName!="undefined"){var c=[],d=b.getElementsByName(a[1]);for(var e=0,f=d.length;e<f;e++)d[e].getAttribute("name")===a[1]&&c.push(d[e]);return c.length===0?null:c}},TAG:function(a,b){if(typeof b.getElementsByTagName!="undefined")return b.getElementsByTagName(a[1])}},preFilter:{CLASS:function(a,b,c,d,e,f){a=" "+a[1].replace(j,"")+" ";if(f)return a;for(var g=0,h;(h=b[g])!=null;g++)h&&(e^(h.className&&(" "+h.className+" ").replace(/[\t\n\r]/g," ").indexOf(a)>=0)?c||d.push(h):c&&(b[g]=!1));return!1},ID:function(a){return a[1].replace(j,"")},TAG:function(a,b){return a[1].replace(j,"").toLowerCase()},CHILD:function(a){if(a[1]==="nth"){a[2]||m.error(a[0]),a[2]=a[2].replace(/^\+|\s*/g,"");var b=/(-?)(\d*)(?:n([+\-]?\d*))?/.exec(a[2]==="even"&&"2n"||a[2]==="odd"&&"2n+1"||!/\D/.test(a[2])&&"0n+"+a[2]||a[2]);a[2]=b[1]+(b[2]||1)-0,a[3]=b[3]-0}else a[2]&&m.error(a[0]);a[0]=e++;return a},ATTR:function(a,b,c,d,e,f){var g=a[1]=a[1].replace(j,"");!f&&o.attrMap[g]&&(a[1]=o.attrMap[g]),a[4]=(a[4]||a[5]||"").replace(j,""),a[2]==="~="&&(a[4]=" "+a[4]+" ");return a},PSEUDO:function(b,c,d,e,f){if(b[1]==="not")if((a.exec(b[3])||"").length>1||/^\w/.test(b[3]))b[3]=m(b[3],null,null,c);else{var g=m.filter(b[3],c,d,!0^f);d||e.push.apply(e,g);return!1}else if(o.match.POS.test(b[0])||o.match.CHILD.test(b[0]))return!0;return b},POS:function(a){a.unshift(!0);return a}},filters:{enabled:function(a){return a.disabled===!1&&a.type!=="hidden"},disabled:function(a){return a.disabled===!0},checked:function(a){return a.checked===!0},selected:function(a){a.parentNode&&a.parentNode.selectedIndex;return a.selected===!0},parent:function(a){return!!a.firstChild},empty:function(a){return!a.firstChild},has:function(a,b,c){return!!m(c[3],a).length},header:function(a){return/h\d/i.test(a.nodeName)},text:function(a){var b=a.getAttribute("type"),c=a.type;return a.nodeName.toLowerCase()==="input"&&"text"===c&&(b===c||b===null)},radio:function(a){return a.nodeName.toLowerCase()==="input"&&"radio"===a.type},checkbox:function(a){return a.nodeName.toLowerCase()==="input"&&"checkbox"===a.type},file:function(a){return a.nodeName.toLowerCase()==="input"&&"file"===a.type},password:function(a){return a.nodeName.toLowerCase()==="input"&&"password"===a.type},submit:function(a){var b=a.nodeName.toLowerCase();return(b==="input"||b==="button")&&"submit"===a.type},image:function(a){return a.nodeName.toLowerCase()==="input"&&"image"===a.type},reset:function(a){var b=a.nodeName.toLowerCase();return(b==="input"||b==="button")&&"reset"===a.type},button:function(a){var b=a.nodeName.toLowerCase();return b==="input"&&"button"===a.type||b==="button"},input:function(a){return/input|select|textarea|button/i.test(a.nodeName)},focus:function(a){return a===a.ownerDocument.activeElement}},setFilters:{first:function(a,b){return b===0},last:function(a,b,c,d){return b===d.length-1},even:function(a,b){return b%2===0},odd:function(a,b){return b%2===1},lt:function(a,b,c){return b<c[3]-0},gt:function(a,b,c){return b>c[3]-0},nth:function(a,b,c){return c[3]-0===b},eq:function(a,b,c){return c[3]-0===b}},filter:{PSEUDO:function(a,b,c,d){var e=b[1],f=o.filters[e];if(f)return f(a,c,b,d);if(e==="contains")return(a.textContent||a.innerText||n([a])||"").indexOf(b[3])>=0;if(e==="not"){var g=b[3];for(var h=0,i=g.length;h<i;h++)if(g[h]===a)return!1;return!0}m.error(e)},CHILD:function(a,b){var c,e,f,g,h,i,j,k=b[1],l=a;switch(k){case"only":case"first":while(l=l.previousSibling)if(l.nodeType===1)return!1;if(k==="first")return!0;l=a;case"last":while(l=l.nextSibling)if(l.nodeType===1)return!1;return!0;case"nth":c=b[2],e=b[3];if(c===1&&e===0)return!0;f=b[0],g=a.parentNode;if(g&&(g[d]!==f||!a.nodeIndex)){i=0;for(l=g.firstChild;l;l=l.nextSibling)l.nodeType===1&&(l.nodeIndex=++i);g[d]=f}j=a.nodeIndex-e;return c===0?j===0:j%c===0&&j/c>=0}},ID:function(a,b){return a.nodeType===1&&a.getAttribute("id")===b},TAG:function(a,b){return b==="*"&&a.nodeType===1||!!a.nodeName&&a.nodeName.toLowerCase()===b},CLASS:function(a,b){return(" "+(a.className||a.getAttribute("class"))+" ").indexOf(b)>-1},ATTR:function(a,b){var c=b[1],d=m.attr?m.attr(a,c):o.attrHandle[c]?o.attrHandle[c](a):a[c]!=null?a[c]:a.getAttribute(c),e=d+"",f=b[2],g=b[4];return d==null?f==="!=":!f&&m.attr?d!=null:f==="="?e===g:f==="*="?e.indexOf(g)>=0:f==="~="?(" "+e+" ").indexOf(g)>=0:g?f==="!="?e!==g:f==="^="?e.indexOf(g)===0:f==="$="?e.substr(e.length-g.length)===g:f==="|="?e===g||e.substr(0,g.length+1)===g+"-":!1:e&&d!==!1},POS:function(a,b,c,d){var e=b[2],f=o.setFilters[e];if(f)return f(a,c,b,d)}}},p=o.match.POS,q=function(a,b){return"\\"+(b-0+1)};for(var r in o.match)o.match[r]=new RegExp(o.match[r].source+/(?![^\[]*\])(?![^\(]*\))/.source),o.leftMatch[r]=new RegExp(/(^(?:.|\r|\n)*?)/.source+o.match[r].source.replace(/\\(\d+)/g,q));var s=function(a,b){a=Array.prototype.slice.call(a,0);if(b){b.push.apply(b,a);return b}return a};try{Array.prototype.slice.call(c.documentElement.childNodes,0)[0].nodeType}catch(t){s=function(a,b){var c=0,d=b||[];if(g.call(a)==="[object Array]")Array.prototype.push.apply(d,a);else if(typeof a.length=="number")for(var e=a.length;c<e;c++)d.push(a[c]);else for(;a[c];c++)d.push(a[c]);return d}}var u,v;c.documentElement.compareDocumentPosition?u=function(a,b){if(a===b){h=!0;return 0}if(!a.compareDocumentPosition||!b.compareDocumentPosition)return a.compareDocumentPosition?-1:1;return a.compareDocumentPosition(b)&4?-1:1}:(u=function(a,b){if(a===b){h=!0;return 0}if(a.sourceIndex&&b.sourceIndex)return a.sourceIndex-b.sourceIndex;var c,d,e=[],f=[],g=a.parentNode,i=b.parentNode,j=g;if(g===i)return v(a,b);if(!g)return-1;if(!i)return 1;while(j)e.unshift(j),j=j.parentNode;j=i;while(j)f.unshift(j),j=j.parentNode;c=e.length,d=f.length;for(var k=0;k<c&&k<d;k++)if(e[k]!==f[k])return v(e[k],f[k]);return k===c?v(a,f[k],-1):v(e[k],b,1)},v=function(a,b,c){if(a===b)return c;var d=a.nextSibling;while(d){if(d===b)return-1;d=d.nextSibling}return 1}),function(){var a=c.createElement("div"),d="script"+(new Date).getTime(),e=c.documentElement;a.innerHTML="<a name='"+d+"'/>",e.insertBefore(a,e.firstChild),c.getElementById(d)&&(o.find.ID=function(a,c,d){if(typeof c.getElementById!="undefined"&&!d){var e=c.getElementById(a[1]);return e?e.id===a[1]||typeof e.getAttributeNode!="undefined"&&e.getAttributeNode("id").nodeValue===a[1]?[e]:b:[]}},o.filter.ID=function(a,b){var c=typeof a.getAttributeNode!="undefined"&&a.getAttributeNode("id");return a.nodeType===1&&c&&c.nodeValue===b}),e.removeChild(a),e=a=null}(),function(){var a=c.createElement("div");a.appendChild(c.createComment("")),a.getElementsByTagName("*").length>0&&(o.find.TAG=function(a,b){var c=b.getElementsByTagName(a[1]);if(a[1]==="*"){var d=[];for(var e=0;c[e];e++)c[e].nodeType===1&&d.push(c[e]);c=d}return c}),a.innerHTML="<a href='#'></a>",a.firstChild&&typeof a.firstChild.getAttribute!="undefined"&&a.firstChild.getAttribute("href")!=="#"&&(o.attrHandle.href=function(a){return a.getAttribute("href",2)}),a=null}(),c.querySelectorAll&&function(){var a=m,b=c.createElement("div"),d="__sizzle__";b.innerHTML="<p class='TEST'></p>";if(!b.querySelectorAll||b.querySelectorAll(".TEST").length!==0){m=function(b,e,f,g){e=e||c;if(!g&&!m.isXML(e)){var h=/^(\w+$)|^\.([\w\-]+$)|^#([\w\-]+$)/.exec(b);if(h&&(e.nodeType===1||e.nodeType===9)){if(h[1])return s(e.getElementsByTagName(b),f);if(h[2]&&o.find.CLASS&&e.getElementsByClassName)return s(e.getElementsByClassName(h[2]),f)}if(e.nodeType===9){if(b==="body"&&e.body)return s([e.body],f);if(h&&h[3]){var i=e.getElementById(h[3]);if(!i||!i.parentNode)return s([],f);if(i.id===h[3])return s([i],f)}try{return s(e.querySelectorAll(b),f)}catch(j){}}else if(e.nodeType===1&&e.nodeName.toLowerCase()!=="object"){var k=e,l=e.getAttribute("id"),n=l||d,p=e.parentNode,q=/^\s*[+~]/.test(b);l?n=n.replace(/'/g,"\\$&"):e.setAttribute("id",n),q&&p&&(e=e.parentNode);try{if(!q||p)return s(e.querySelectorAll("[id='"+n+"'] "+b),f)}catch(r){}finally{l||k.removeAttribute("id")}}}return a(b,e,f,g)};for(var e in a)m[e]=a[e];b=null}}(),function(){var a=c.documentElement,b=a.matchesSelector||a.mozMatchesSelector||a.webkitMatchesSelector||a.msMatchesSelector;if(b){var d=!b.call(c.createElement("div"),"div"),e=!1;try{b.call(c.documentElement,"[test!='']:sizzle")}catch(f){e=!0}m.matchesSelector=function(a,c){c=c.replace(/\=\s*([^'"\]]*)\s*\]/g,"='$1']");if(!m.isXML(a))try{if(e||!o.match.PSEUDO.test(c)&&!/!=/.test(c)){var f=b.call(a,c);if(f||!d||a.document&&a.document.nodeType!==11)return f}}catch(g){}return m(c,null,null,[a]).length>0}}}(),function(){var a=c.createElement("div");a.innerHTML="<div class='test e'></div><div class='test'></div>";if(!!a.getElementsByClassName&&a.getElementsByClassName("e").length!==0){a.lastChild.className="e";if(a.getElementsByClassName("e").length===1)return;o.order.splice(1,0,"CLASS"),o.find.CLASS=function(a,b,c){if(typeof b.getElementsByClassName!="undefined"&&!c)return b.getElementsByClassName(a[1])},a=null}}(),c.documentElement.contains?m.contains=function(a,b){return a!==b&&(a.contains?a.contains(b):!0)}:c.documentElement.compareDocumentPosition?m.contains=function(a,b){return!!(a.compareDocumentPosition(b)&16)}:m.contains=function(){return!1},m.isXML=function(a){var b=(a?a.ownerDocument||a:0).documentElement;return b?b.nodeName!=="HTML":!1};var y=function(a,b,c){var d,e=[],f="",g=b.nodeType?[b]:b;while(d=o.match.PSEUDO.exec(a))f+=d[0],a=a.replace(o.match.PSEUDO,"");a=o.relative[a]?a+"*":a;for(var h=0,i=g.length;h<i;h++)m(a,g[h],e,c);return m.filter(f,e)};m.attr=f.attr,m.selectors.attrMap={},f.find=m,f.expr=m.selectors,f.expr[":"]=f.expr.filters,f.unique=m.uniqueSort,f.text=m.getText,f.isXMLDoc=m.isXML,f.contains=m.contains}();var L=/Until$/,M=/^(?:parents|prevUntil|prevAll)/,N=/,/,O=/^.[^:#\[\.,]*$/,P=Array.prototype.slice,Q=f.expr.match.POS,R={children:!0,contents:!0,next:!0,prev:!0};f.fn.extend({find:function(a){var b=this,c,d;if(typeof a!="string")return f(a).filter(function(){for(c=0,d=b.length;c<d;c++)if(f.contains(b[c],this))return!0});var e=this.pushStack("","find",a),g,h,i;for(c=0,d=this.length;c<d;c++){g=e.length,f.find(a,this[c],e);if(c>0)for(h=g;h<e.length;h++)for(i=0;i<g;i++)if(e[i]===e[h]){e.splice(h--,1);break}}return e},has:function(a){var b=f(a);return this.filter(function(){for(var a=0,c=b.length;a<c;a++)if(f.contains(this,b[a]))return!0})},not:function(a){return this.pushStack(T(this,a,!1),"not",a)},filter:function(a){return this.pushStack(T(this,a,!0),"filter",a)},is:function(a){return!!a&&(typeof a=="string"?Q.test(a)?f(a,this.context).index(this[0])>=0:f.filter(a,this).length>0:this.filter(a).length>0)},closest:function(a,b){var c=[],d,e,g=this[0];if(f.isArray(a)){var h=1;while(g&&g.ownerDocument&&g!==b){for(d=0;d<a.length;d++)f(g).is(a[d])&&c.push({selector:a[d],elem:g,level:h});g=g.parentNode,h++}return c}var i=Q.test(a)||typeof a!="string"?f(a,b||this.context):0;for(d=0,e=this.length;d<e;d++){g=this[d];while(g){if(i?i.index(g)>-1:f.find.matchesSelector(g,a)){c.push(g);break}g=g.parentNode;if(!g||!g.ownerDocument||g===b||g.nodeType===11)break}}c=c.length>1?f.unique(c):c;return this.pushStack(c,"closest",a)},index:function(a){if(!a)return this[0]&&this[0].parentNode?this.prevAll().length:-1;if(typeof a=="string")return f.inArray(this[0],f(a));return f.inArray(a.jquery?a[0]:a,this)},add:function(a,b){var c=typeof a=="string"?f(a,b):f.makeArray(a&&a.nodeType?[a]:a),d=f.merge(this.get(),c);return this.pushStack(S(c[0])||S(d[0])?d:f.unique(d))},andSelf:function(){return this.add(this.prevObject)}}),f.each({parent:function(a){var b=a.parentNode;return b&&b.nodeType!==11?b:null},parents:function(a){return f.dir(a,"parentNode")},parentsUntil:function(a,b,c){return f.dir(a,"parentNode",c)},next:function(a){return f.nth(a,2,"nextSibling")},prev:function(a){return f.nth(a,2,"previousSibling")},nextAll:function(a){return f.dir(a,"nextSibling")},prevAll:function(a){return f.dir(a,"previousSibling")},nextUntil:function(a,b,c){return f.dir(a,"nextSibling",c)},prevUntil:function(a,b,c){return f.dir(a,"previousSibling",c)},siblings:function(a){return f.sibling(a.parentNode.firstChild,a)},children:function(a){return f.sibling(a.firstChild)},contents:function(a){return f.nodeName(a,"iframe")?a.contentDocument||a.contentWindow.document:f.makeArray(a.childNodes)}},function(a,b){f.fn[a]=function(c,d){var e=f.map(this,b,c);L.test(a)||(d=c),d&&typeof d=="string"&&(e=f.filter(d,e)),e=this.length>1&&!R[a]?f.unique(e):e,(this.length>1||N.test(d))&&M.test(a)&&(e=e.reverse());return this.pushStack(e,a,P.call(arguments).join(","))}}),f.extend({filter:function(a,b,c){c&&(a=":not("+a+")");return b.length===1?f.find.matchesSelector(b[0],a)?[b[0]]:[]:f.find.matches(a,b)},dir:function(a,c,d){var e=[],g=a[c];while(g&&g.nodeType!==9&&(d===b||g.nodeType!==1||!f(g).is(d)))g.nodeType===1&&e.push(g),g=g[c];return e},nth:function(a,b,c,d){b=b||1;var e=0;for(;a;a=a[c])if(a.nodeType===1&&++e===b)break;return a},sibling:function(a,b){var c=[];for(;a;a=a.nextSibling)a.nodeType===1&&a!==b&&c.push(a);return c}});var V="abbr|article|aside|audio|canvas|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",W=/ jQuery\d+="(?:\d+|null)"/g,X=/^\s+/,Y=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/ig,Z=/<([\w:]+)/,$=/<tbody/i,_=/<|&#?\w+;/,ba=/<(?:script|style)/i,bb=/<(?:script|object|embed|option|style)/i,bc=new RegExp("<(?:"+V+")","i"),bd=/checked\s*(?:[^=]|=\s*.checked.)/i,be=/\/(java|ecma)script/i,bf=/^\s*<!(?:\[CDATA\[|\-\-)/,bg={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],area:[1,"<map>","</map>"],_default:[0,"",""]},bh=U(c);bg.optgroup=bg.option,bg.tbody=bg.tfoot=bg.colgroup=bg.caption=bg.thead,bg.th=bg.td,f.support.htmlSerialize||(bg._default=[1,"div<div>","</div>"]),f.fn.extend({text:function(a){if(f.isFunction(a))return this.each(function(b){var c=f(this);c.text(a.call(this,b,c.text()))});if(typeof a!="object"&&a!==b)return this.empty().append((this[0]&&this[0].ownerDocument||c).createTextNode(a));return f.text(this)},wrapAll:function(a){if(f.isFunction(a))return this.each(function(b){f(this).wrapAll(a.call(this,b))});if(this[0]){var b=f(a,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&b.insertBefore(this[0]),b.map(function(){var a=this;while(a.firstChild&&a.firstChild.nodeType===1)a=a.firstChild;return a}).append(this)}return this},wrapInner:function(a){if(f.isFunction(a))return this.each(function(b){f(this).wrapInner(a.call(this,b))});return this.each(function(){var b=f(this),c=b.contents();c.length?c.wrapAll(a):b.append(a)})},wrap:function(a){var b=f.isFunction(a);return this.each(function(c){f(this).wrapAll(b?a.call(this,c):a)})},unwrap:function(){return this.parent().each(function(){f.nodeName(this,"body")||f(this).replaceWith(this.childNodes)}).end()},append:function(){return this.domManip(arguments,!0,function(a){this.nodeType===1&&this.appendChild(a)})},prepend:function(){return this.domManip(arguments,!0,function(a){this.nodeType===1&&this.insertBefore(a,this.firstChild)})},before:function(){if(this[0]&&this[0].parentNode)return this.domManip(arguments,!1,function(a){this.parentNode.insertBefore(a,this)});if(arguments.length){var a=f.clean(arguments);a.push.apply(a,this.toArray());return this.pushStack(a,"before",arguments)}},after:function(){if(this[0]&&this[0].parentNode)return this.domManip(arguments,!1,function(a){this.parentNode.insertBefore(a,this.nextSibling)});if(arguments.length){var a=this.pushStack(this,"after",arguments);a.push.apply(a,f.clean(arguments));return a}},remove:function(a,b){for(var c=0,d;(d=this[c])!=null;c++)if(!a||f.filter(a,[d]).length)!b&&d.nodeType===1&&(f.cleanData(d.getElementsByTagName("*")),f.cleanData([d])),d.parentNode&&d.parentNode.removeChild(d);return this},empty:function()
{for(var a=0,b;(b=this[a])!=null;a++){b.nodeType===1&&f.cleanData(b.getElementsByTagName("*"));while(b.firstChild)b.removeChild(b.firstChild)}return this},clone:function(a,b){a=a==null?!1:a,b=b==null?a:b;return this.map(function(){return f.clone(this,a,b)})},html:function(a){if(a===b)return this[0]&&this[0].nodeType===1?this[0].innerHTML.replace(W,""):null;if(typeof a=="string"&&!ba.test(a)&&(f.support.leadingWhitespace||!X.test(a))&&!bg[(Z.exec(a)||["",""])[1].toLowerCase()]){a=a.replace(Y,"<$1></$2>");try{for(var c=0,d=this.length;c<d;c++)this[c].nodeType===1&&(f.cleanData(this[c].getElementsByTagName("*")),this[c].innerHTML=a)}catch(e){this.empty().append(a)}}else f.isFunction(a)?this.each(function(b){var c=f(this);c.html(a.call(this,b,c.html()))}):this.empty().append(a);return this},replaceWith:function(a){if(this[0]&&this[0].parentNode){if(f.isFunction(a))return this.each(function(b){var c=f(this),d=c.html();c.replaceWith(a.call(this,b,d))});typeof a!="string"&&(a=f(a).detach());return this.each(function(){var b=this.nextSibling,c=this.parentNode;f(this).remove(),b?f(b).before(a):f(c).append(a)})}return this.length?this.pushStack(f(f.isFunction(a)?a():a),"replaceWith",a):this},detach:function(a){return this.remove(a,!0)},domManip:function(a,c,d){var e,g,h,i,j=a[0],k=[];if(!f.support.checkClone&&arguments.length===3&&typeof j=="string"&&bd.test(j))return this.each(function(){f(this).domManip(a,c,d,!0)});if(f.isFunction(j))return this.each(function(e){var g=f(this);a[0]=j.call(this,e,c?g.html():b),g.domManip(a,c,d)});if(this[0]){i=j&&j.parentNode,f.support.parentNode&&i&&i.nodeType===11&&i.childNodes.length===this.length?e={fragment:i}:e=f.buildFragment(a,this,k),h=e.fragment,h.childNodes.length===1?g=h=h.firstChild:g=h.firstChild;if(g){c=c&&f.nodeName(g,"tr");for(var l=0,m=this.length,n=m-1;l<m;l++)d.call(c?bi(this[l],g):this[l],e.cacheable||m>1&&l<n?f.clone(h,!0,!0):h)}k.length&&f.each(k,bp)}return this}}),f.buildFragment=function(a,b,d){var e,g,h,i,j=a[0];b&&b[0]&&(i=b[0].ownerDocument||b[0]),i.createDocumentFragment||(i=c),a.length===1&&typeof j=="string"&&j.length<512&&i===c&&j.charAt(0)==="<"&&!bb.test(j)&&(f.support.checkClone||!bd.test(j))&&(f.support.html5Clone||!bc.test(j))&&(g=!0,h=f.fragments[j],h&&h!==1&&(e=h)),e||(e=i.createDocumentFragment(),f.clean(a,i,e,d)),g&&(f.fragments[j]=h?e:1);return{fragment:e,cacheable:g}},f.fragments={},f.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(a,b){f.fn[a]=function(c){var d=[],e=f(c),g=this.length===1&&this[0].parentNode;if(g&&g.nodeType===11&&g.childNodes.length===1&&e.length===1){e[b](this[0]);return this}for(var h=0,i=e.length;h<i;h++){var j=(h>0?this.clone(!0):this).get();f(e[h])[b](j),d=d.concat(j)}return this.pushStack(d,a,e.selector)}}),f.extend({clone:function(a,b,c){var d,e,g,h=f.support.html5Clone||!bc.test("<"+a.nodeName)?a.cloneNode(!0):bo(a);if((!f.support.noCloneEvent||!f.support.noCloneChecked)&&(a.nodeType===1||a.nodeType===11)&&!f.isXMLDoc(a)){bk(a,h),d=bl(a),e=bl(h);for(g=0;d[g];++g)e[g]&&bk(d[g],e[g])}if(b){bj(a,h);if(c){d=bl(a),e=bl(h);for(g=0;d[g];++g)bj(d[g],e[g])}}d=e=null;return h},clean:function(a,b,d,e){var g;b=b||c,typeof b.createElement=="undefined"&&(b=b.ownerDocument||b[0]&&b[0].ownerDocument||c);var h=[],i;for(var j=0,k;(k=a[j])!=null;j++){typeof k=="number"&&(k+="");if(!k)continue;if(typeof k=="string")if(!_.test(k))k=b.createTextNode(k);else{k=k.replace(Y,"<$1></$2>");var l=(Z.exec(k)||["",""])[1].toLowerCase(),m=bg[l]||bg._default,n=m[0],o=b.createElement("div");b===c?bh.appendChild(o):U(b).appendChild(o),o.innerHTML=m[1]+k+m[2];while(n--)o=o.lastChild;if(!f.support.tbody){var p=$.test(k),q=l==="table"&&!p?o.firstChild&&o.firstChild.childNodes:m[1]==="<table>"&&!p?o.childNodes:[];for(i=q.length-1;i>=0;--i)f.nodeName(q[i],"tbody")&&!q[i].childNodes.length&&q[i].parentNode.removeChild(q[i])}!f.support.leadingWhitespace&&X.test(k)&&o.insertBefore(b.createTextNode(X.exec(k)[0]),o.firstChild),k=o.childNodes}var r;if(!f.support.appendChecked)if(k[0]&&typeof (r=k.length)=="number")for(i=0;i<r;i++)bn(k[i]);else bn(k);k.nodeType?h.push(k):h=f.merge(h,k)}if(d){g=function(a){return!a.type||be.test(a.type)};for(j=0;h[j];j++)if(e&&f.nodeName(h[j],"script")&&(!h[j].type||h[j].type.toLowerCase()==="text/javascript"))e.push(h[j].parentNode?h[j].parentNode.removeChild(h[j]):h[j]);else{if(h[j].nodeType===1){var s=f.grep(h[j].getElementsByTagName("script"),g);h.splice.apply(h,[j+1,0].concat(s))}d.appendChild(h[j])}}return h},cleanData:function(a){var b,c,d=f.cache,e=f.event.special,g=f.support.deleteExpando;for(var h=0,i;(i=a[h])!=null;h++){if(i.nodeName&&f.noData[i.nodeName.toLowerCase()])continue;c=i[f.expando];if(c){b=d[c];if(b&&b.events){for(var j in b.events)e[j]?f.event.remove(i,j):f.removeEvent(i,j,b.handle);b.handle&&(b.handle.elem=null)}g?delete i[f.expando]:i.removeAttribute&&i.removeAttribute(f.expando),delete d[c]}}}});var bq=/alpha\([^)]*\)/i,br=/opacity=([^)]*)/,bs=/([A-Z]|^ms)/g,bt=/^-?\d+(?:px)?$/i,bu=/^-?\d/,bv=/^([\-+])=([\-+.\de]+)/,bw={position:"absolute",visibility:"hidden",display:"block"},bx=["Left","Right"],by=["Top","Bottom"],bz,bA,bB;f.fn.css=function(a,c){if(arguments.length===2&&c===b)return this;return f.access(this,a,c,!0,function(a,c,d){return d!==b?f.style(a,c,d):f.css(a,c)})},f.extend({cssHooks:{opacity:{get:function(a,b){if(b){var c=bz(a,"opacity","opacity");return c===""?"1":c}return a.style.opacity}}},cssNumber:{fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":f.support.cssFloat?"cssFloat":"styleFloat"},style:function(a,c,d,e){if(!!a&&a.nodeType!==3&&a.nodeType!==8&&!!a.style){var g,h,i=f.camelCase(c),j=a.style,k=f.cssHooks[i];c=f.cssProps[i]||i;if(d===b){if(k&&"get"in k&&(g=k.get(a,!1,e))!==b)return g;return j[c]}h=typeof d,h==="string"&&(g=bv.exec(d))&&(d=+(g[1]+1)*+g[2]+parseFloat(f.css(a,c)),h="number");if(d==null||h==="number"&&isNaN(d))return;h==="number"&&!f.cssNumber[i]&&(d+="px");if(!k||!("set"in k)||(d=k.set(a,d))!==b)try{j[c]=d}catch(l){}}},css:function(a,c,d){var e,g;c=f.camelCase(c),g=f.cssHooks[c],c=f.cssProps[c]||c,c==="cssFloat"&&(c="float");if(g&&"get"in g&&(e=g.get(a,!0,d))!==b)return e;if(bz)return bz(a,c)},swap:function(a,b,c){var d={};for(var e in b)d[e]=a.style[e],a.style[e]=b[e];c.call(a);for(e in b)a.style[e]=d[e]}}),f.curCSS=f.css,f.each(["height","width"],function(a,b){f.cssHooks[b]={get:function(a,c,d){var e;if(c){if(a.offsetWidth!==0)return bC(a,b,d);f.swap(a,bw,function(){e=bC(a,b,d)});return e}},set:function(a,b){if(!bt.test(b))return b;b=parseFloat(b);if(b>=0)return b+"px"}}}),f.support.opacity||(f.cssHooks.opacity={get:function(a,b){return br.test((b&&a.currentStyle?a.currentStyle.filter:a.style.filter)||"")?parseFloat(RegExp.$1)/100+"":b?"1":""},set:function(a,b){var c=a.style,d=a.currentStyle,e=f.isNumeric(b)?"alpha(opacity="+b*100+")":"",g=d&&d.filter||c.filter||"";c.zoom=1;if(b>=1&&f.trim(g.replace(bq,""))===""){c.removeAttribute("filter");if(d&&!d.filter)return}c.filter=bq.test(g)?g.replace(bq,e):g+" "+e}}),f(function(){f.support.reliableMarginRight||(f.cssHooks.marginRight={get:function(a,b){var c;f.swap(a,{display:"inline-block"},function(){b?c=bz(a,"margin-right","marginRight"):c=a.style.marginRight});return c}})}),c.defaultView&&c.defaultView.getComputedStyle&&(bA=function(a,b){var c,d,e;b=b.replace(bs,"-$1").toLowerCase(),(d=a.ownerDocument.defaultView)&&(e=d.getComputedStyle(a,null))&&(c=e.getPropertyValue(b),c===""&&!f.contains(a.ownerDocument.documentElement,a)&&(c=f.style(a,b)));return c}),c.documentElement.currentStyle&&(bB=function(a,b){var c,d,e,f=a.currentStyle&&a.currentStyle[b],g=a.style;f===null&&g&&(e=g[b])&&(f=e),!bt.test(f)&&bu.test(f)&&(c=g.left,d=a.runtimeStyle&&a.runtimeStyle.left,d&&(a.runtimeStyle.left=a.currentStyle.left),g.left=b==="fontSize"?"1em":f||0,f=g.pixelLeft+"px",g.left=c,d&&(a.runtimeStyle.left=d));return f===""?"auto":f}),bz=bA||bB,f.expr&&f.expr.filters&&(f.expr.filters.hidden=function(a){var b=a.offsetWidth,c=a.offsetHeight;return b===0&&c===0||!f.support.reliableHiddenOffsets&&(a.style&&a.style.display||f.css(a,"display"))==="none"},f.expr.filters.visible=function(a){return!f.expr.filters.hidden(a)});var bD=/%20/g,bE=/\[\]$/,bF=/\r?\n/g,bG=/#.*$/,bH=/^(.*?):[ \t]*([^\r\n]*)\r?$/mg,bI=/^(?:color|date|datetime|datetime-local|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i,bJ=/^(?:about|app|app\-storage|.+\-extension|file|res|widget):$/,bK=/^(?:GET|HEAD)$/,bL=/^\/\//,bM=/\?/,bN=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,bO=/^(?:select|textarea)/i,bP=/\s+/,bQ=/([?&])_=[^&]*/,bR=/^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+))?)?/,bS=f.fn.load,bT={},bU={},bV,bW,bX=["*/"]+["*"];try{bV=e.href}catch(bY){bV=c.createElement("a"),bV.href="",bV=bV.href}bW=bR.exec(bV.toLowerCase())||[],f.fn.extend({load:function(a,c,d){if(typeof a!="string"&&bS)return bS.apply(this,arguments);if(!this.length)return this;var e=a.indexOf(" ");if(e>=0){var g=a.slice(e,a.length);a=a.slice(0,e)}var h="GET";c&&(f.isFunction(c)?(d=c,c=b):typeof c=="object"&&(c=f.param(c,f.ajaxSettings.traditional),h="POST"));var i=this;f.ajax({url:a,type:h,dataType:"html",data:c,complete:function(a,b,c){c=a.responseText,a.isResolved()&&(a.done(function(a){c=a}),i.html(g?f("<div>").append(c.replace(bN,"")).find(g):c)),d&&i.each(d,[c,b,a])}});return this},serialize:function(){return f.param(this.serializeArray())},serializeArray:function(){return this.map(function(){return this.elements?f.makeArray(this.elements):this}).filter(function(){return this.name&&!this.disabled&&(this.checked||bO.test(this.nodeName)||bI.test(this.type))}).map(function(a,b){var c=f(this).val();return c==null?null:f.isArray(c)?f.map(c,function(a,c){return{name:b.name,value:a.replace(bF,"\r\n")}}):{name:b.name,value:c.replace(bF,"\r\n")}}).get()}}),f.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(a,b){f.fn[b]=function(a){return this.on(b,a)}}),f.each(["get","post"],function(a,c){f[c]=function(a,d,e,g){f.isFunction(d)&&(g=g||e,e=d,d=b);return f.ajax({type:c,url:a,data:d,success:e,dataType:g})}}),f.extend({getScript:function(a,c){return f.get(a,b,c,"script")},getJSON:function(a,b,c){return f.get(a,b,c,"json")},ajaxSetup:function(a,b){b?b_(a,f.ajaxSettings):(b=a,a=f.ajaxSettings),b_(a,b);return a},ajaxSettings:{url:bV,isLocal:bJ.test(bW[1]),global:!0,type:"GET",contentType:"application/x-www-form-urlencoded",processData:!0,async:!0,accepts:{xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript","*":bX},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText"},converters:{"* text":a.String,"text html":!0,"text json":f.parseJSON,"text xml":f.parseXML},flatOptions:{context:!0,url:!0}},ajaxPrefilter:bZ(bT),ajaxTransport:bZ(bU),ajax:function(a,c){function w(a,c,l,m){if(s!==2){s=2,q&&clearTimeout(q),p=b,n=m||"",v.readyState=a>0?4:0;var o,r,u,w=c,x=l?cb(d,v,l):b,y,z;if(a>=200&&a<300||a===304){if(d.ifModified){if(y=v.getResponseHeader("Last-Modified"))f.lastModified[k]=y;if(z=v.getResponseHeader("Etag"))f.etag[k]=z}if(a===304)w="notmodified",o=!0;else try{r=cc(d,x),w="success",o=!0}catch(A){w="parsererror",u=A}}else{u=w;if(!w||a)w="error",a<0&&(a=0)}v.status=a,v.statusText=""+(c||w),o?h.resolveWith(e,[r,w,v]):h.rejectWith(e,[v,w,u]),v.statusCode(j),j=b,t&&g.trigger("ajax"+(o?"Success":"Error"),[v,d,o?r:u]),i.fireWith(e,[v,w]),t&&(g.trigger("ajaxComplete",[v,d]),--f.active||f.event.trigger("ajaxStop"))}}typeof a=="object"&&(c=a,a=b),c=c||{};var d=f.ajaxSetup({},c),e=d.context||d,g=e!==d&&(e.nodeType||e instanceof f)?f(e):f.event,h=f.Deferred(),i=f.Callbacks("once memory"),j=d.statusCode||{},k,l={},m={},n,o,p,q,r,s=0,t,u,v={readyState:0,setRequestHeader:function(a,b){if(!s){var c=a.toLowerCase();a=m[c]=m[c]||a,l[a]=b}return this},getAllResponseHeaders:function(){return s===2?n:null},getResponseHeader:function(a){var c;if(s===2){if(!o){o={};while(c=bH.exec(n))o[c[1].toLowerCase()]=c[2]}c=o[a.toLowerCase()]}return c===b?null:c},overrideMimeType:function(a){s||(d.mimeType=a);return this},abort:function(a){a=a||"abort",p&&p.abort(a),w(0,a);return this}};h.promise(v),v.success=v.done,v.error=v.fail,v.complete=i.add,v.statusCode=function(a){if(a){var b;if(s<2)for(b in a)j[b]=[j[b],a[b]];else b=a[v.status],v.then(b,b)}return this},d.url=((a||d.url)+"").replace(bG,"").replace(bL,bW[1]+"//"),d.dataTypes=f.trim(d.dataType||"*").toLowerCase().split(bP),d.crossDomain==null&&(r=bR.exec(d.url.toLowerCase()),d.crossDomain=!(!r||r[1]==bW[1]&&r[2]==bW[2]&&(r[3]||(r[1]==="http:"?80:443))==(bW[3]||(bW[1]==="http:"?80:443)))),d.data&&d.processData&&typeof d.data!="string"&&(d.data=f.param(d.data,d.traditional)),b$(bT,d,c,v);if(s===2)return!1;t=d.global,d.type=d.type.toUpperCase(),d.hasContent=!bK.test(d.type),t&&f.active++===0&&f.event.trigger("ajaxStart");if(!d.hasContent){d.data&&(d.url+=(bM.test(d.url)?"&":"?")+d.data,delete d.data),k=d.url;if(d.cache===!1){var x=f.now(),y=d.url.replace(bQ,"$1_="+x);d.url=y+(y===d.url?(bM.test(d.url)?"&":"?")+"_="+x:"")}}(d.data&&d.hasContent&&d.contentType!==!1||c.contentType)&&v.setRequestHeader("Content-Type",d.contentType),d.ifModified&&(k=k||d.url,f.lastModified[k]&&v.setRequestHeader("If-Modified-Since",f.lastModified[k]),f.etag[k]&&v.setRequestHeader("If-None-Match",f.etag[k])),v.setRequestHeader("Accept",d.dataTypes[0]&&d.accepts[d.dataTypes[0]]?d.accepts[d.dataTypes[0]]+(d.dataTypes[0]!=="*"?", "+bX+"; q=0.01":""):d.accepts["*"]);for(u in d.headers)v.setRequestHeader(u,d.headers[u]);if(d.beforeSend&&(d.beforeSend.call(e,v,d)===!1||s===2)){v.abort();return!1}for(u in{success:1,error:1,complete:1})v[u](d[u]);p=b$(bU,d,c,v);if(!p)w(-1,"No Transport");else{v.readyState=1,t&&g.trigger("ajaxSend",[v,d]),d.async&&d.timeout>0&&(q=setTimeout(function(){v.abort("timeout")},d.timeout));try{s=1,p.send(l,w)}catch(z){if(s<2)w(-1,z);else throw z}}return v},param:function(a,c){var d=[],e=function(a,b){b=f.isFunction(b)?b():b,d[d.length]=encodeURIComponent(a)+"="+encodeURIComponent(b)};c===b&&(c=f.ajaxSettings.traditional);if(f.isArray(a)||a.jquery&&!f.isPlainObject(a))f.each(a,function(){e(this.name,this.value)});else for(var g in a)ca(g,a[g],c,e);return d.join("&").replace(bD,"+")}}),f.extend({active:0,lastModified:{},etag:{}});var cd=f.now(),ce=/(\=)\?(&|$)|\?\?/i;f.ajaxSetup({jsonp:"callback",jsonpCallback:function(){return f.expando+"_"+cd++}}),f.ajaxPrefilter("json jsonp",function(b,c,d){var e=b.contentType==="application/x-www-form-urlencoded"&&typeof b.data=="string";if(b.dataTypes[0]==="jsonp"||b.jsonp!==!1&&(ce.test(b.url)||e&&ce.test(b.data))){var g,h=b.jsonpCallback=f.isFunction(b.jsonpCallback)?b.jsonpCallback():b.jsonpCallback,i=a[h],j=b.url,k=b.data,l="$1"+h+"$2";b.jsonp!==!1&&(j=j.replace(ce,l),b.url===j&&(e&&(k=k.replace(ce,l)),b.data===k&&(j+=(/\?/.test(j)?"&":"?")+b.jsonp+"="+h))),b.url=j,b.data=k,a[h]=function(a){g=[a]},d.always(function(){a[h]=i,g&&f.isFunction(i)&&a[h](g[0])}),b.converters["script json"]=function(){g||f.error(h+" was not called");return g[0]},b.dataTypes[0]="json";return"script"}}),f.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/javascript|ecmascript/},converters:{"text script":function(a){f.globalEval(a);return a}}}),f.ajaxPrefilter("script",function(a){a.cache===b&&(a.cache=!1),a.crossDomain&&(a.type="GET",a.global=!1)}),f.ajaxTransport("script",function(a){if(a.crossDomain){var d,e=c.head||c.getElementsByTagName("head")[0]||c.documentElement;return{send:function(f,g){d=c.createElement("script"),d.async="async",a.scriptCharset&&(d.charset=a.scriptCharset),d.src=a.url,d.onload=d.onreadystatechange=function(a,c){if(c||!d.readyState||/loaded|complete/.test(d.readyState))d.onload=d.onreadystatechange=null,e&&d.parentNode&&e.removeChild(d),d=b,c||g(200,"success")},e.insertBefore(d,e.firstChild)},abort:function(){d&&d.onload(0,1)}}}});var cf=a.ActiveXObject?function(){for(var a in ch)ch[a](0,1)}:!1,cg=0,ch;f.ajaxSettings.xhr=a.ActiveXObject?function(){return!this.isLocal&&ci()||cj()}:ci,function(a){f.extend(f.support,{ajax:!!a,cors:!!a&&"withCredentials"in a})}(f.ajaxSettings.xhr()),f.support.ajax&&f.ajaxTransport(function(c){if(!c.crossDomain||f.support.cors){var d;return{send:function(e,g){var h=c.xhr(),i,j;c.username?h.open(c.type,c.url,c.async,c.username,c.password):h.open(c.type,c.url,c.async);if(c.xhrFields)for(j in c.xhrFields)h[j]=c.xhrFields[j];c.mimeType&&h.overrideMimeType&&h.overrideMimeType(c.mimeType),!c.crossDomain&&!e["X-Requested-With"]&&(e["X-Requested-With"]="XMLHttpRequest");try{for(j in e)h.setRequestHeader(j,e[j])}catch(k){}h.send(c.hasContent&&c.data||null),d=function(a,e){var j,k,l,m,n;try{if(d&&(e||h.readyState===4)){d=b,i&&(h.onreadystatechange=f.noop,cf&&delete ch[i]);if(e)h.readyState!==4&&h.abort();else{j=h.status,l=h.getAllResponseHeaders(),m={},n=h.responseXML,n&&n.documentElement&&(m.xml=n),m.text=h.responseText;try{k=h.statusText}catch(o){k=""}!j&&c.isLocal&&!c.crossDomain?j=m.text?200:404:j===1223&&(j=204)}}}catch(p){e||g(-1,p)}m&&g(j,k,m,l)},!c.async||h.readyState===4?d():(i=++cg,cf&&(ch||(ch={},f(a).unload(cf)),ch[i]=d),h.onreadystatechange=d)},abort:function(){d&&d(0,1)}}}});var ck={},cl,cm,cn=/^(?:toggle|show|hide)$/,co=/^([+\-]=)?([\d+.\-]+)([a-z%]*)$/i,cp,cq=[["height","marginTop","marginBottom","paddingTop","paddingBottom"],["width","marginLeft","marginRight","paddingLeft","paddingRight"],["opacity"]],cr;f.fn.extend({show:function(a,b,c){var d,e;if(a||a===0)return this.animate(cu("show",3),a,b,c);for(var g=0,h=this.length;g<h;g++)d=this[g],d.style&&(e=d.style.display,!f._data(d,"olddisplay")&&e==="none"&&(e=d.style.display=""),e===""&&f.css(d,"display")==="none"&&f._data(d,"olddisplay",cv(d.nodeName)));for(g=0;g<h;g++){d=this[g];if(d.style){e=d.style.display;if(e===""||e==="none")d.style.display=f._data(d,"olddisplay")||""}}return this},hide:function(a,b,c){if(a||a===0)return this.animate(cu("hide",3),a,b,c);var d,e,g=0,h=this.length;for(;g<h;g++)d=this[g],d.style&&(e=f.css(d,"display"),e!=="none"&&!f._data(d,"olddisplay")&&f._data(d,"olddisplay",e));for(g=0;g<h;g++)this[g].style&&(this[g].style.display="none");return this},_toggle:f.fn.toggle,toggle:function(a,b,c){var d=typeof a=="boolean";f.isFunction(a)&&f.isFunction(b)?this._toggle.apply(this,arguments):a==null||d?this.each(function(){var b=d?a:f(this).is(":hidden");f(this)[b?"show":"hide"]()}):this.animate(cu("toggle",3),a,b,c);return this},fadeTo:function(a,b,c,d){return this.filter(":hidden").css("opacity",0).show().end().animate({opacity:b},a,c,d)},animate:function(a,b,c,d){function g(){e.queue===!1&&f._mark(this);var b=f.extend({},e),c=this.nodeType===1,d=c&&f(this).is(":hidden"),g,h,i,j,k,l,m,n,o;b.animatedProperties={};for(i in a){g=f.camelCase(i),i!==g&&(a[g]=a[i],delete a[i]),h=a[g],f.isArray(h)?(b.animatedProperties[g]=h[1],h=a[g]=h[0]):b.animatedProperties[g]=b.specialEasing&&b.specialEasing[g]||b.easing||"swing";if(h==="hide"&&d||h==="show"&&!d)return b.complete.call(this);c&&(g==="height"||g==="width")&&(b.overflow=[this.style.overflow,this.style.overflowX,this.style.overflowY],f.css(this,"display")==="inline"&&f.css(this,"float")==="none"&&(!f.support.inlineBlockNeedsLayout||cv(this.nodeName)==="inline"?this.style.display="inline-block":this.style.zoom=1))}b.overflow!=null&&(this.style.overflow="hidden");for(i in a)j=new f.fx(this,b,i),h=a[i],cn.test(h)?(o=f._data(this,"toggle"+i)||(h==="toggle"?d?"show":"hide":0),o?(f._data(this,"toggle"+i,o==="show"?"hide":"show"),j[o]()):j[h]()):(k=co.exec(h),l=j.cur(),k?(m=parseFloat(k[2]),n=k[3]||(f.cssNumber[i]?"":"px"),n!=="px"&&(f.style(this,i,(m||1)+n),l=(m||1)/j.cur()*l,f.style(this,i,l+n)),k[1]&&(m=(k[1]==="-="?-1:1)*m+l),j.custom(l,m,n)):j.custom(l,h,""));return!0}var e=f.speed(b,c,d);if(f.isEmptyObject(a))return this.each(e.complete,[!1]);a=f.extend({},a);return e.queue===!1?this.each(g):this.queue(e.queue,g)},stop:function(a,c,d){typeof a!="string"&&(d=c,c=a,a=b),c&&a!==!1&&this.queue(a||"fx",[]);return this.each(function(){function h(a,b,c){var e=b[c];f.removeData(a,c,!0),e.stop(d)}var b,c=!1,e=f.timers,g=f._data(this);d||f._unmark(!0,this);if(a==null)for(b in g)g[b]&&g[b].stop&&b.indexOf(".run")===b.length-4&&h(this,g,b);else g[b=a+".run"]&&g[b].stop&&h(this,g,b);for(b=e.length;b--;)e[b].elem===this&&(a==null||e[b].queue===a)&&(d?e[b](!0):e[b].saveState(),c=!0,e.splice(b,1));(!d||!c)&&f.dequeue(this,a)})}}),f.each({slideDown:cu("show",1),slideUp:cu("hide",1),slideToggle:cu("toggle",1),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(a,b){f.fn[a]=function(a,c,d){return this.animate(b,a,c,d)}}),f.extend({speed:function(a,b,c){var d=a&&typeof a=="object"?f.extend({},a):{complete:c||!c&&b||f.isFunction(a)&&a,duration:a,easing:c&&b||b&&!f.isFunction(b)&&b};d.duration=f.fx.off?0:typeof d.duration=="number"?d.duration:d.duration in f.fx.speeds?f.fx.speeds[d.duration]:f.fx.speeds._default;if(d.queue==null||d.queue===!0)d.queue="fx";d.old=d.complete,d.complete=function(a){f.isFunction(d.old)&&d.old.call(this),d.queue?f.dequeue(this,d.queue):a!==!1&&f._unmark(this)};return d},easing:{linear:function(a,b,c,d){return c+d*a},swing:function(a,b,c,d){return(-Math.cos(a*Math.PI)/2+.5)*d+c}},timers:[],fx:function(a,b,c){this.options=b,this.elem=a,this.prop=c,b.orig=b.orig||{}}}),f.fx.prototype={update:function(){this.options.step&&this.options.step.call(this.elem,this.now,this),(f.fx.step[this.prop]||f.fx.step._default)(this)},cur:function(){if(this.elem[this.prop]!=null&&(!this.elem.style||this.elem.style[this.prop]==null))return this.elem[this.prop];var a,b=f.css(this.elem,this.prop);return isNaN(a=parseFloat(b))?!b||b==="auto"?0:b:a},custom:function(a,c,d){function h(a){return e.step(a)}var e=this,g=f.fx;this.startTime=cr||cs(),this.end=c,this.now=this.start=a,this.pos=this.state=0,this.unit=d||this.unit||(f.cssNumber[this.prop]?"":"px"),h.queue=this.options.queue,h.elem=this.elem,h.saveState=function(){e.options.hide&&f._data(e.elem,"fxshow"+e.prop)===b&&f._data(e.elem,"fxshow"+e.prop,e.start)},h()&&f.timers.push(h)&&!cp&&(cp=setInterval(g.tick,g.interval))},show:function(){var a=f._data(this.elem,"fxshow"+this.prop);this.options.orig[this.prop]=a||f.style(this.elem,this.prop),this.options.show=!0,a!==b?this.custom(this.cur(),a):this.custom(this.prop==="width"||this.prop==="height"?1:0,this.cur()),f(this.elem).show()},hide:function(){this.options.orig[this.prop]=f._data(this.elem,"fxshow"+this.prop)||f.style(this.elem,this.prop),this.options.hide=!0,this.custom(this.cur(),0)},step:function(a){var b,c,d,e=cr||cs(),g=!0,h=this.elem,i=this.options;if(a||e>=i.duration+this.startTime){this.now=this.end,this.pos=this.state=1,this.update(),i.animatedProperties[this.prop]=!0;for(b in i.animatedProperties)i.animatedProperties[b]!==!0&&(g=!1);if(g){i.overflow!=null&&!f.support.shrinkWrapBlocks&&f.each(["","X","Y"],function(a,b){h.style["overflow"+b]=i.overflow[a]}),i.hide&&f(h).hide();if(i.hide||i.show)for(b in i.animatedProperties)f.style(h,b,i.orig[b]),f.removeData(h,"fxshow"+b,!0),f.removeData(h,"toggle"+b,!0);d=i.complete,d&&(i.complete=!1,d.call(h))}return!1}i.duration==Infinity?this.now=e:(c=e-this.startTime,this.state=c/i.duration,this.pos=f.easing[i.animatedProperties[this.prop]](this.state,c,0,1,i.duration),this.now=this.start+(this.end-this.start)*this.pos),this.update();return!0}},f.extend(f.fx,{tick:function(){var a,b=f.timers,c=0;for(;c<b.length;c++)a=b[c],!a()&&b[c]===a&&b.splice(c--,1);b.length||f.fx.stop()},interval:13,stop:function(){clearInterval(cp),cp=null},speeds:{slow:600,fast:200,_default:400},step:{opacity:function(a){f.style(a.elem,"opacity",a.now)},_default:function(a){a.elem.style&&a.elem.style[a.prop]!=null?a.elem.style[a.prop]=a.now+a.unit:a.elem[a.prop]=a.now}}}),f.each(["width","height"],function(a,b){f.fx.step[b]=function(a){f.style(a.elem,b,Math.max(0,a.now)+a.unit)}}),f.expr&&f.expr.filters&&(f.expr.filters.animated=function(a){return f.grep(f.timers,function(b){return a===b.elem}).length});var cw=/^t(?:able|d|h)$/i,cx=/^(?:body|html)$/i;"getBoundingClientRect"in c.documentElement?f.fn.offset=function(a){var b=this[0],c;if(a)return this.each(function(b){f.offset.setOffset(this,a,b)});if(!b||!b.ownerDocument)return null;if(b===b.ownerDocument.body)return f.offset.bodyOffset(b);try{c=b.getBoundingClientRect()}catch(d){}var e=b.ownerDocument,g=e.documentElement;if(!c||!f.contains(g,b))return c?{top:c.top,left:c.left}:{top:0,left:0};var h=e.body,i=cy(e),j=g.clientTop||h.clientTop||0,k=g.clientLeft||h.clientLeft||0,l=i.pageYOffset||f.support.boxModel&&g.scrollTop||h.scrollTop,m=i.pageXOffset||f.support.boxModel&&g.scrollLeft||h.scrollLeft,n=c.top+l-j,o=c.left+m-k;return{top:n,left:o}}:f.fn.offset=function(a){var b=this[0];if(a)return this.each(function(b){f.offset.setOffset(this,a,b)});if(!b||!b.ownerDocument)return null;if(b===b.ownerDocument.body)return f.offset.bodyOffset(b);var c,d=b.offsetParent,e=b,g=b.ownerDocument,h=g.documentElement,i=g.body,j=g.defaultView,k=j?j.getComputedStyle(b,null):b.currentStyle,l=b.offsetTop,m=b.offsetLeft;while((b=b.parentNode)&&b!==i&&b!==h){if(f.support.fixedPosition&&k.position==="fixed")break;c=j?j.getComputedStyle(b,null):b.currentStyle,l-=b.scrollTop,m-=b.scrollLeft,b===d&&(l+=b.offsetTop,m+=b.offsetLeft,f.support.doesNotAddBorder&&(!f.support.doesAddBorderForTableAndCells||!cw.test(b.nodeName))&&(l+=parseFloat(c.borderTopWidth)||0,m+=parseFloat(c.borderLeftWidth)||0),e=d,d=b.offsetParent),f.support.subtractsBorderForOverflowNotVisible&&c.overflow!=="visible"&&(l+=parseFloat(c.borderTopWidth)||0,m+=parseFloat(c.borderLeftWidth)||0),k=c}if(k.position==="relative"||k.position==="static")l+=i.offsetTop,m+=i.offsetLeft;f.support.fixedPosition&&k.position==="fixed"&&(l+=Math.max(h.scrollTop,i.scrollTop),m+=Math.max(h.scrollLeft,i.scrollLeft));return{top:l,left:m}},f.offset={bodyOffset:function(a){var b=a.offsetTop,c=a.offsetLeft;f.support.doesNotIncludeMarginInBodyOffset&&(b+=parseFloat(f.css(a,"marginTop"))||0,c+=parseFloat(f.css(a,"marginLeft"))||0);return{top:b,left:c}},setOffset:function(a,b,c){var d=f.css(a,"position");d==="static"&&(a.style.position="relative");var e=f(a),g=e.offset(),h=f.css(a,"top"),i=f.css(a,"left"),j=(d==="absolute"||d==="fixed")&&f.inArray("auto",[h,i])>-1,k={},l={},m,n;j?(l=e.position(),m=l.top,n=l.left):(m=parseFloat(h)||0,n=parseFloat(i)||0),f.isFunction(b)&&(b=b.call(a,c,g)),b.top!=null&&(k.top=b.top-g.top+m),b.left!=null&&(k.left=b.left-g.left+n),"using"in b?b.using.call(a,k):e.css(k)}},f.fn.extend({position:function(){if(!this[0])return null;var a=this[0],b=this.offsetParent(),c=this.offset(),d=cx.test(b[0].nodeName)?{top:0,left:0}:b.offset();c.top-=parseFloat(f.css(a,"marginTop"))||0,c.left-=parseFloat(f.css(a,"marginLeft"))||0,d.top+=parseFloat(f.css(b[0],"borderTopWidth"))||0,d.left+=parseFloat(f.css(b[0],"borderLeftWidth"))||0;return{top:c.top-d.top,left:c.left-d.left}},offsetParent:function(){return this.map(function(){var a=this.offsetParent||c.body;while(a&&!cx.test(a.nodeName)&&f.css(a,"position")==="static")a=a.offsetParent;return a})}}),f.each(["Left","Top"],function(a,c){var d="scroll"+c;f.fn[d]=function(c){var e,g;if(c===b){e=this[0];if(!e)return null;g=cy(e);return g?"pageXOffset"in g?g[a?"pageYOffset":"pageXOffset"]:f.support.boxModel&&g.document.documentElement[d]||g.document.body[d]:e[d]}return this.each(function(){g=cy(this),g?g.scrollTo(a?f(g).scrollLeft():c,a?c:f(g).scrollTop()):this[d]=c})}}),f.each(["Height","Width"],function(a,c){var d=c.toLowerCase();f.fn["inner"+c]=function(){var a=this[0];return a?a.style?parseFloat(f.css(a,d,"padding")):this[d]():null},f.fn["outer"+c]=function(a){var b=this[0];return b?b.style?parseFloat(f.css(b,d,a?"margin":"border")):this[d]():null},f.fn[d]=function(a){var e=this[0];if(!e)return a==null?null:this;if(f.isFunction(a))return this.each(function(b){var c=f(this);c[d](a.call(this,b,c[d]()))});if(f.isWindow(e)){var g=e.document.documentElement["client"+c],h=e.document.body;return e.document.compatMode==="CSS1Compat"&&g||h&&h["client"+c]||g}if(e.nodeType===9)return Math.max(e.documentElement["client"+c],e.body["scroll"+c],e.documentElement["scroll"+c],e.body["offset"+c],e.documentElement["offset"+c]);if(a===b){var i=f.css(e,d),j=parseFloat(i);return f.isNumeric(j)?j:i}return this.css(d,typeof a=="string"?a:a+"px")}}),a.jQuery=a.$=f,typeof define=="function"&&define.amd&&define.amd.jQuery&&define("jquery",[],function(){return f})})(window);

//SCRIPT: ../../vendor/js/json_path_0.8.0.js
/* JSONPath 0.8.0 - XPath for JSON
 *
 * Copyright (c) 2007 Stefan Goessner (goessner.net)
 * Licensed under the MIT (MIT-LICENSE.txt) licence.
 */
function jsonPath(obj, expr, arg) {
   var P = {
      resultType: arg && arg.resultType || "VALUE",
      result: [],
      normalize: function(expr) {
         var subx = [];
         return expr.replace(/[\['](\??\(.*?\))[\]']/g, function($0,$1){return "[#"+(subx.push($1)-1)+"]";})
                    .replace(/'?\.'?|\['?/g, ";")
                    .replace(/;;;|;;/g, ";..;")
                    .replace(/;$|'?\]|'$/g, "")
                    .replace(/#([0-9]+)/g, function($0,$1){return subx[$1];});
      },
      asPath: function(path) {
         var x = path.split(";"), p = "$";
         for (var i=1,n=x.length; i<n; i++)
            p += /^[0-9*]+$/.test(x[i]) ? ("["+x[i]+"]") : ("['"+x[i]+"']");
         return p;
      },
      store: function(p, v) {
         if (p) P.result[P.result.length] = P.resultType == "PATH" ? P.asPath(p) : v;
         return !!p;
      },
      trace: function(expr, val, path) {
         if (expr) {
            var x = expr.split(";"), loc = x.shift();
            x = x.join(";");
            if (val && val.hasOwnProperty(loc))
               P.trace(x, val[loc], path + ";" + loc);
            else if (loc === "*")
               P.walk(loc, x, val, path, function(m,l,x,v,p) { P.trace(m+";"+x,v,p); });
            else if (loc === "..") {
               P.trace(x, val, path);
               P.walk(loc, x, val, path, function(m,l,x,v,p) { typeof v[m] === "object" && P.trace("..;"+x,v[m],p+";"+m); });
            }
            else if (/,/.test(loc)) { // [name1,name2,...]
               for (var s=loc.split(/'?,'?/),i=0,n=s.length; i<n; i++)
                  P.trace(s[i]+";"+x, val, path);
            }
            else if (/^\(.*?\)$/.test(loc)) // [(expr)]
               P.trace(P.eval(loc, val, path.substr(path.lastIndexOf(";")+1))+";"+x, val, path);
            else if (/^\?\(.*?\)$/.test(loc)) // [?(expr)]
               P.walk(loc, x, val, path, function(m,l,x,v,p) { if (P.eval(l.replace(/^\?\((.*?)\)$/,"$1"),v[m],m)) P.trace(m+";"+x,v,p); });
            else if (/^(-?[0-9]*):(-?[0-9]*):?([0-9]*)$/.test(loc)) // [start:end:step]  phyton slice syntax
               P.slice(loc, x, val, path);
         }
         else
            P.store(path, val);
      },
      walk: function(loc, expr, val, path, f) {
         if (val instanceof Array) {
            for (var i=0,n=val.length; i<n; i++)
               if (i in val)
                  f(i,loc,expr,val,path);
         }
         else if (typeof val === "object") {
            for (var m in val)
               if (val.hasOwnProperty(m))
                  f(m,loc,expr,val,path);
         }
      },
      slice: function(loc, expr, val, path) {
         if (val instanceof Array) {
            var len=val.length, start=0, end=len, step=1;
            loc.replace(/^(-?[0-9]*):(-?[0-9]*):?(-?[0-9]*)$/g, function($0,$1,$2,$3){start=parseInt($1||start);end=parseInt($2||end);step=parseInt($3||step);});
            start = (start < 0) ? Math.max(0,start+len) : Math.min(len,start);
            end   = (end < 0)   ? Math.max(0,end+len)   : Math.min(len,end);
            for (var i=start; i<end; i+=step)
               P.trace(i+";"+expr, val, path);
         }
      },
      eval: function(x, _v, _vname) {
         try { return $ && _v && eval(x.replace(/@/g, "_v")); }
         catch(e) { throw new SyntaxError("jsonPath: " + e.message + ": " + x.replace(/@/g, "_v").replace(/\^/g, "_a")); }
      }
   };

   var $ = obj;
   if (expr && obj && (P.resultType == "VALUE" || P.resultType == "PATH")) {
      P.trace(P.normalize(expr).replace(/^\$;/,""), obj, "$");
      return P.result.length ? P.result : false;
   }
} 


//SCRIPT: ../../vendor/js/interface/modernizr.js
/* Modernizr 2.8.3 (Custom Build) | MIT & BSD
 * Build: http://modernizr.com/download/#-backgroundsize-borderimage-borderradius-boxshadow-flexbox-flexboxlegacy-hsla-multiplebgs-opacity-rgba-textshadow-cssanimations-csscolumns-generatedcontent-cssgradients-cssreflections-csstransforms-csstransforms3d-csstransitions-applicationcache-canvas-canvastext-draganddrop-hashchange-history-audio-video-indexeddb-input-inputtypes-localstorage-postmessage-sessionstorage-websockets-websqldatabase-webworkers-touch-webgl-cssclasses-addtest-prefixed-teststyles-testprop-testallprops-hasevent-prefixes-domprefixes-battery_api-battery_level-css_backgroundsizecover-css_boxsizing-css_displaytable-css_overflow_scrolling-css_pointerevents-css_positionsticky-css_vhunit-css_vmaxunit-css_vminunit-css_vwunit-performance
 */
;window.Modernizr=function(a,b,c){function B(a){j.cssText=a}function C(a,b){return B(n.join(a+";")+(b||""))}function D(a,b){return typeof a===b}function E(a,b){return!!~(""+a).indexOf(b)}function F(a,b){for(var d in a){var e=a[d];if(!E(e,"-")&&j[e]!==c)return b=="pfx"?e:!0}return!1}function G(a,b,d){for(var e in a){var f=b[a[e]];if(f!==c)return d===!1?a[e]:D(f,"function")?f.bind(d||b):f}return!1}function H(a,b,c){var d=a.charAt(0).toUpperCase()+a.slice(1),e=(a+" "+p.join(d+" ")+d).split(" ");return D(b,"string")||D(b,"undefined")?F(e,b):(e=(a+" "+q.join(d+" ")+d).split(" "),G(e,b,c))}function I(){e.input=function(c){for(var d=0,e=c.length;d<e;d++)t[c[d]]=c[d]in k;return t.list&&(t.list=!!b.createElement("datalist")&&!!a.HTMLDataListElement),t}("autocomplete autofocus list placeholder max min multiple pattern required step".split(" ")),e.inputtypes=function(a){for(var d=0,e,f,h,i=a.length;d<i;d++)k.setAttribute("type",f=a[d]),e=k.type!=="text",e&&(k.value=l,k.style.cssText="position:absolute;visibility:hidden;",/^range$/.test(f)&&k.style.WebkitAppearance!==c?(g.appendChild(k),h=b.defaultView,e=h.getComputedStyle&&h.getComputedStyle(k,null).WebkitAppearance!=="textfield"&&k.offsetHeight!==0,g.removeChild(k)):/^(search|tel)$/.test(f)||(/^(url|email)$/.test(f)?e=k.checkValidity&&k.checkValidity()===!1:e=k.value!=l)),s[a[d]]=!!e;return s}("search tel url email datetime date month week time datetime-local number range color".split(" "))}var d="2.8.3",e={},f=!0,g=b.documentElement,h="modernizr",i=b.createElement(h),j=i.style,k=b.createElement("input"),l=":)",m={}.toString,n=" -webkit- -moz- -o- -ms- ".split(" "),o="Webkit Moz O ms",p=o.split(" "),q=o.toLowerCase().split(" "),r={},s={},t={},u=[],v=u.slice,w,x=function(a,c,d,e){var f,i,j,k,l=b.createElement("div"),m=b.body,n=m||b.createElement("body");if(parseInt(d,10))while(d--)j=b.createElement("div"),j.id=e?e[d]:h+(d+1),l.appendChild(j);return f=["&#173;",'<style id="s',h,'">',a,"</style>"].join(""),l.id=h,(m?l:n).innerHTML+=f,n.appendChild(l),m||(n.style.background="",n.style.overflow="hidden",k=g.style.overflow,g.style.overflow="hidden",g.appendChild(n)),i=c(l,a),m?l.parentNode.removeChild(l):(n.parentNode.removeChild(n),g.style.overflow=k),!!i},y=function(){function d(d,e){e=e||b.createElement(a[d]||"div"),d="on"+d;var f=d in e;return f||(e.setAttribute||(e=b.createElement("div")),e.setAttribute&&e.removeAttribute&&(e.setAttribute(d,""),f=D(e[d],"function"),D(e[d],"undefined")||(e[d]=c),e.removeAttribute(d))),e=null,f}var a={select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img"};return d}(),z={}.hasOwnProperty,A;!D(z,"undefined")&&!D(z.call,"undefined")?A=function(a,b){return z.call(a,b)}:A=function(a,b){return b in a&&D(a.constructor.prototype[b],"undefined")},Function.prototype.bind||(Function.prototype.bind=function(b){var c=this;if(typeof c!="function")throw new TypeError;var d=v.call(arguments,1),e=function(){if(this instanceof e){var a=function(){};a.prototype=c.prototype;var f=new a,g=c.apply(f,d.concat(v.call(arguments)));return Object(g)===g?g:f}return c.apply(b,d.concat(v.call(arguments)))};return e}),r.flexbox=function(){return H("flexWrap")},r.flexboxlegacy=function(){return H("boxDirection")},r.canvas=function(){var a=b.createElement("canvas");return!!a.getContext&&!!a.getContext("2d")},r.canvastext=function(){return!!e.canvas&&!!D(b.createElement("canvas").getContext("2d").fillText,"function")},r.webgl=function(){return!!a.WebGLRenderingContext},r.touch=function(){var c;return"ontouchstart"in a||a.DocumentTouch&&b instanceof DocumentTouch?c=!0:x(["@media (",n.join("touch-enabled),("),h,")","{#modernizr{top:9px;position:absolute}}"].join(""),function(a){c=a.offsetTop===9}),c},r.postmessage=function(){return!!a.postMessage},r.websqldatabase=function(){return!!a.openDatabase},r.indexedDB=function(){return!!H("indexedDB",a)},r.hashchange=function(){return y("hashchange",a)&&(b.documentMode===c||b.documentMode>7)},r.history=function(){return!!a.history&&!!history.pushState},r.draganddrop=function(){var a=b.createElement("div");return"draggable"in a||"ondragstart"in a&&"ondrop"in a},r.websockets=function(){return"WebSocket"in a||"MozWebSocket"in a},r.rgba=function(){return B("background-color:rgba(150,255,150,.5)"),E(j.backgroundColor,"rgba")},r.hsla=function(){return B("background-color:hsla(120,40%,100%,.5)"),E(j.backgroundColor,"rgba")||E(j.backgroundColor,"hsla")},r.multiplebgs=function(){return B("background:url(https://),url(https://),red url(https://)"),/(url\s*\(.*?){3}/.test(j.background)},r.backgroundsize=function(){return H("backgroundSize")},r.borderimage=function(){return H("borderImage")},r.borderradius=function(){return H("borderRadius")},r.boxshadow=function(){return H("boxShadow")},r.textshadow=function(){return b.createElement("div").style.textShadow===""},r.opacity=function(){return C("opacity:.55"),/^0.55$/.test(j.opacity)},r.cssanimations=function(){return H("animationName")},r.csscolumns=function(){return H("columnCount")},r.cssgradients=function(){var a="background-image:",b="gradient(linear,left top,right bottom,from(#9f9),to(white));",c="linear-gradient(left top,#9f9, white);";return B((a+"-webkit- ".split(" ").join(b+a)+n.join(c+a)).slice(0,-a.length)),E(j.backgroundImage,"gradient")},r.cssreflections=function(){return H("boxReflect")},r.csstransforms=function(){return!!H("transform")},r.csstransforms3d=function(){var a=!!H("perspective");return a&&"webkitPerspective"in g.style&&x("@media (transform-3d),(-webkit-transform-3d){#modernizr{left:9px;position:absolute;height:3px;}}",function(b,c){a=b.offsetLeft===9&&b.offsetHeight===3}),a},r.csstransitions=function(){return H("transition")},r.generatedcontent=function(){var a;return x(["#",h,"{font:0/0 a}#",h,':after{content:"',l,'";visibility:hidden;font:3px/1 a}'].join(""),function(b){a=b.offsetHeight>=3}),a},r.video=function(){var a=b.createElement("video"),c=!1;try{if(c=!!a.canPlayType)c=new Boolean(c),c.ogg=a.canPlayType('video/ogg; codecs="theora"').replace(/^no$/,""),c.h264=a.canPlayType('video/mp4; codecs="avc1.42E01E"').replace(/^no$/,""),c.webm=a.canPlayType('video/webm; codecs="vp8, vorbis"').replace(/^no$/,"")}catch(d){}return c},r.audio=function(){var a=b.createElement("audio"),c=!1;try{if(c=!!a.canPlayType)c=new Boolean(c),c.ogg=a.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),c.mp3=a.canPlayType("audio/mpeg;").replace(/^no$/,""),c.wav=a.canPlayType('audio/wav; codecs="1"').replace(/^no$/,""),c.m4a=(a.canPlayType("audio/x-m4a;")||a.canPlayType("audio/aac;")).replace(/^no$/,"")}catch(d){}return c},r.localstorage=function(){try{return localStorage.setItem(h,h),localStorage.removeItem(h),!0}catch(a){return!1}},r.sessionstorage=function(){try{return sessionStorage.setItem(h,h),sessionStorage.removeItem(h),!0}catch(a){return!1}},r.webworkers=function(){return!!a.Worker},r.applicationcache=function(){return!!a.applicationCache};for(var J in r)A(r,J)&&(w=J.toLowerCase(),e[w]=r[J](),u.push((e[w]?"":"no-")+w));return e.input||I(),e.addTest=function(a,b){if(typeof a=="object")for(var d in a)A(a,d)&&e.addTest(d,a[d]);else{a=a.toLowerCase();if(e[a]!==c)return e;b=typeof b=="function"?b():b,typeof f!="undefined"&&f&&(g.className+=" "+(b?"":"no-")+a),e[a]=b}return e},B(""),i=k=null,e._version=d,e._prefixes=n,e._domPrefixes=q,e._cssomPrefixes=p,e.hasEvent=y,e.testProp=function(a){return F([a])},e.testAllProps=H,e.testStyles=x,e.prefixed=function(a,b,c){return b?H(a,b,c):H(a,"pfx")},g.className=g.className.replace(/(^|\s)no-js(\s|$)/,"$1$2")+(f?" js "+u.join(" "):""),e}(this,this.document),Modernizr.addTest("battery",!!Modernizr.prefixed("battery",navigator)),Modernizr.addTest("lowbattery",function(){var a=.2,b=Modernizr.prefixed("battery",navigator);return!!(b&&!b.charging&&b.level<=a)}),Modernizr.addTest("display-table",function(){var a=window.document,b=a.documentElement,c=a.createElement("div"),d=a.createElement("div"),e=a.createElement("div"),f;return c.style.cssText="display: table",d.style.cssText=e.style.cssText="display: table-cell; padding: 10px",c.appendChild(d),c.appendChild(e),b.insertBefore(c,b.firstChild),f=d.offsetLeft<e.offsetLeft,b.removeChild(c),f}),Modernizr.addTest("boxsizing",function(){return Modernizr.testAllProps("boxSizing")&&(document.documentMode===undefined||document.documentMode>7)}),Modernizr.addTest("overflowscrolling",function(){return Modernizr.testAllProps("overflowScrolling")}),Modernizr.testStyles("#modernizr{background-size:cover}",function(a){var b=window.getComputedStyle?window.getComputedStyle(a,null):a.currentStyle;Modernizr.addTest("bgsizecover",b.backgroundSize=="cover")}),Modernizr.addTest("pointerevents",function(){var a=document.createElement("x"),b=document.documentElement,c=window.getComputedStyle,d;return"pointerEvents"in a.style?(a.style.pointerEvents="auto",a.style.pointerEvents="x",b.appendChild(a),d=c&&c(a,"").pointerEvents==="auto",b.removeChild(a),!!d):!1}),Modernizr.addTest("csspositionsticky",function(){var a="position:",b="sticky",c=document.createElement("modernizr"),d=c.style;return d.cssText=a+Modernizr._prefixes.join(b+";"+a).slice(0,-a.length),d.position.indexOf(b)!==-1}),Modernizr.addTest("cssvhunit",function(){var a;return Modernizr.testStyles("#modernizr { height: 50vh; }",function(b,c){var d=parseInt(window.innerHeight/2,10),e=parseInt((window.getComputedStyle?getComputedStyle(b,null):b.currentStyle).height,10);a=e==d}),a}),Modernizr.addTest("cssvminunit",function(){var a;return Modernizr.testStyles("#modernizr { width: 50vmin; }",function(b,c){var d=window.innerWidth/100,e=window.innerHeight/100,f=parseInt((window.getComputedStyle?getComputedStyle(b,null):b.currentStyle).width,10);a=parseInt(Math.min(d,e)*50,10)==f}),a}),Modernizr.addTest("cssvwunit",function(){var a;return Modernizr.testStyles("#modernizr { width: 50vw; }",function(b,c){var d=parseInt(window.innerWidth/2,10),e=parseInt((window.getComputedStyle?getComputedStyle(b,null):b.currentStyle).width,10);a=e==d}),a}),Modernizr.addTest("cssvmaxunit",function(){var a;return Modernizr.testStyles("#modernizr { width: 50vmax; }",function(b,c){var d=window.innerWidth/100,e=window.innerHeight/100,f=parseInt((window.getComputedStyle?getComputedStyle(b,null):b.currentStyle).width,10);a=parseInt(Math.max(d,e)*50,10)==f}),a}),Modernizr.addTest("performance",!!Modernizr.prefixed("performance",window));
/**
* @Scroll bar test | @Dean Salleyman
* Tests wheether the page creates scrolls bars on elements, which should equal true for Windows OS
*/
Modernizr.addTest('scrollbar', function () {

      // Create the measurement node
      var scrollDiv = document.createElement("div");
      scrollDiv.className = "scrollbar-measure";
      scrollDiv.style.width = "100px";
      scrollDiv.style.height = "100px";
      scrollDiv.style.overflow = "scroll";
      scrollDiv.style.position = "absolute";
      scrollDiv.style.top = "-9999px";

      var fake = false,
      root = document.body || (function () {
          fake = true;
          return document.documentElement.appendChild(document.createElement('body'));
      }());

      root.appendChild(scrollDiv);

      // Get the scrollbar width
      var scrollbarWidth = scrollDiv.offsetWidth - scrollDiv.clientWidth;

      // Delete the DIV 
      root.removeChild(scrollDiv);
    
      if (fake) {
        document.documentElement.removeChild(root);
    }

      return scrollbarWidth;
 
});

//SCRIPT: ../../vendor/js/interface/html5shiv.js
/**
* @preserve HTML5 Shiv v3.6.2 | @afarkas @jdalton @jon_neal @rem | MIT/GPL2 Licensed
*/
;(function(window, document) {
/*jshint evil:true */
  /** version */
  var version = '3.6.2';

  /** Preset options */
  var options = window.html5 || {};

  /** Used to skip problem elements */
  var reSkip = /^<|^(?:button|map|select|textarea|object|iframe|option|optgroup)$/i;

  /** Not all elements can be cloned in IE **/
  var saveClones = /^(?:a|b|code|div|fieldset|h1|h2|h3|h4|h5|h6|i|label|li|ol|p|q|span|strong|style|table|tbody|td|th|tr|ul)$/i;

  /** Detect whether the browser supports default html5 styles */
  var supportsHtml5Styles;

  /** Name of the expando, to work with multiple documents or to re-shiv one document */
  var expando = '_html5shiv';

  /** The id for the the documents expando */
  var expanID = 0;

  /** Cached data for each document */
  var expandoData = {};

  /** Detect whether the browser supports unknown elements */
  var supportsUnknownElements;

  (function() {
    try {
        var a = document.createElement('a');
        a.innerHTML = '<xyz></xyz>';
        //if the hidden property is implemented we can assume, that the browser supports basic HTML5 Styles
        supportsHtml5Styles = ('hidden' in a);

        supportsUnknownElements = a.childNodes.length == 1 || (function() {
          // assign a false positive if unable to shiv
          (document.createElement)('a');
          var frag = document.createDocumentFragment();
          return (
            typeof frag.cloneNode == 'undefined' ||
            typeof frag.createDocumentFragment == 'undefined' ||
            typeof frag.createElement == 'undefined'
          );
        }());
    } catch(e) {
      // assign a false positive if detection fails => unable to shiv
      supportsHtml5Styles = true;
      supportsUnknownElements = true;
    }

  }());

  /*--------------------------------------------------------------------------*/

  /**
   * Creates a style sheet with the given CSS text and adds it to the document.
   * @private
   * @param {Document} ownerDocument The document.
   * @param {String} cssText The CSS text.
   * @returns {StyleSheet} The style element.
   */
  function addStyleSheet(ownerDocument, cssText) {
    var p = ownerDocument.createElement('p'),
        parent = ownerDocument.getElementsByTagName('head')[0] || ownerDocument.documentElement;

    p.innerHTML = 'x<style>' + cssText + '</style>';
    return parent.insertBefore(p.lastChild, parent.firstChild);
  }

  /**
   * Returns the value of `html5.elements` as an array.
   * @private
   * @returns {Array} An array of shived element node names.
   */
  function getElements() {
    var elements = html5.elements;
    return typeof elements == 'string' ? elements.split(' ') : elements;
  }

    /**
   * Returns the data associated to the given document
   * @private
   * @param {Document} ownerDocument The document.
   * @returns {Object} An object of data.
   */
  function getExpandoData(ownerDocument) {
    var data = expandoData[ownerDocument[expando]];
    if (!data) {
        data = {};
        expanID++;
        ownerDocument[expando] = expanID;
        expandoData[expanID] = data;
    }
    return data;
  }

  /**
   * returns a shived element for the given nodeName and document
   * @memberOf html5
   * @param {String} nodeName name of the element
   * @param {Document} ownerDocument The context document.
   * @returns {Object} The shived element.
   */
  function createElement(nodeName, ownerDocument, data){
    if (!ownerDocument) {
        ownerDocument = document;
    }
    if(supportsUnknownElements){
        return ownerDocument.createElement(nodeName);
    }
    if (!data) {
        data = getExpandoData(ownerDocument);
    }
    var node;

    if (data.cache[nodeName]) {
        node = data.cache[nodeName].cloneNode();
    } else if (saveClones.test(nodeName)) {
        node = (data.cache[nodeName] = data.createElem(nodeName)).cloneNode();
    } else {
        node = data.createElem(nodeName);
    }

    // Avoid adding some elements to fragments in IE < 9 because
    // * Attributes like `name` or `type` cannot be set/changed once an element
    //   is inserted into a document/fragment
    // * Link elements with `src` attributes that are inaccessible, as with
    //   a 403 response, will cause the tab/window to crash
    // * Script elements appended to fragments will execute when their `src`
    //   or `text` property is set
    return node.canHaveChildren && !reSkip.test(nodeName) ? data.frag.appendChild(node) : node;
  }

  /**
   * returns a shived DocumentFragment for the given document
   * @memberOf html5
   * @param {Document} ownerDocument The context document.
   * @returns {Object} The shived DocumentFragment.
   */
  function createDocumentFragment(ownerDocument, data){
    if (!ownerDocument) {
        ownerDocument = document;
    }
    if(supportsUnknownElements){
        return ownerDocument.createDocumentFragment();
    }
    data = data || getExpandoData(ownerDocument);
    var clone = data.frag.cloneNode(),
        i = 0,
        elems = getElements(),
        l = elems.length;
    for(;i<l;i++){
        clone.createElement(elems[i]);
    }
    return clone;
  }

  /**
   * Shivs the `createElement` and `createDocumentFragment` methods of the document.
   * @private
   * @param {Document|DocumentFragment} ownerDocument The document.
   * @param {Object} data of the document.
   */
  function shivMethods(ownerDocument, data) {
    if (!data.cache) {
        data.cache = {};
        data.createElem = ownerDocument.createElement;
        data.createFrag = ownerDocument.createDocumentFragment;
        data.frag = data.createFrag();
    }


    ownerDocument.createElement = function(nodeName) {
      //abort shiv
      if (!html5.shivMethods) {
          return data.createElem(nodeName);
      }
      return createElement(nodeName, ownerDocument, data);
    };

    ownerDocument.createDocumentFragment = Function('h,f', 'return function(){' +
      'var n=f.cloneNode(),c=n.createElement;' +
      'h.shivMethods&&(' +
        // unroll the `createElement` calls
        getElements().join().replace(/\w+/g, function(nodeName) {
          data.createElem(nodeName);
          data.frag.createElement(nodeName);
          return 'c("' + nodeName + '")';
        }) +
      ');return n}'
    )(html5, data.frag);
  }

  /*--------------------------------------------------------------------------*/

  /**
   * Shivs the given document.
   * @memberOf html5
   * @param {Document} ownerDocument The document to shiv.
   * @returns {Document} The shived document.
   */
  function shivDocument(ownerDocument) {
    if (!ownerDocument) {
        ownerDocument = document;
    }
    var data = getExpandoData(ownerDocument);

    if (html5.shivCSS && !supportsHtml5Styles && !data.hasCSS) {
      data.hasCSS = !!addStyleSheet(ownerDocument,
        // corrects block display not defined in IE6/7/8/9
        'article,aside,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}' +
        // adds styling not present in IE6/7/8/9
        'mark{background:#FF0;color:#000}' +
        // hides non-rendered elements
        'template{display:none}'
      );
    }
    if (!supportsUnknownElements) {
      shivMethods(ownerDocument, data);
    }
    return ownerDocument;
  }

  /*--------------------------------------------------------------------------*/

  /**
   * The `html5` object is exposed so that more elements can be shived and
   * existing shiving can be detected on iframes.
   * @type Object
   * @example
   *
   * // options can be changed before the script is included
   * html5 = { 'elements': 'mark section', 'shivCSS': false, 'shivMethods': false };
   */
  var html5 = {

    /**
     * An array or space separated string of node names of the elements to shiv.
     * @memberOf html5
     * @type Array|String
     */
    'elements': options.elements || 'abbr article aside audio bdi canvas data datalist details figcaption figure footer header hgroup main mark meter nav output progress section summary template time video',

    /**
     * current version of html5shiv
     */
    'version': version,

    /**
     * A flag to indicate that the HTML5 style sheet should be inserted.
     * @memberOf html5
     * @type Boolean
     */
    'shivCSS': (options.shivCSS !== false),

    /**
     * Is equal to true if a browser supports creating unknown/HTML5 elements
     * @memberOf html5
     * @type boolean
     */
    'supportsUnknownElements': supportsUnknownElements,

    /**
     * A flag to indicate that the document's `createElement` and `createDocumentFragment`
     * methods should be overwritten.
     * @memberOf html5
     * @type Boolean
     */
    'shivMethods': (options.shivMethods !== false),

    /**
     * A string to describe the type of `html5` object ("default" or "default print").
     * @memberOf html5
     * @type String
     */
    'type': 'default',

    // shivs the document according to the specified `html5` object options
    'shivDocument': shivDocument,

    //creates a shived element
    createElement: createElement,

    //creates a shived documentFragment
    createDocumentFragment: createDocumentFragment
  };

  /*--------------------------------------------------------------------------*/

  // expose html5
  window.html5 = html5;

  // shiv the document
  shivDocument(document);

}(this, document));


//SCRIPT: ../../vendor/js/interface/html5shiv-printshiv.js
/**
* @preserve HTML5 Shiv v3.6.2 | @afarkas @jdalton @jon_neal @rem | MIT/GPL2 Licensed
*/
;(function(window, document) {
/*jshint evil:true */
  /** version */
  var version = '3.6.2';

  /** Preset options */
  var options = window.html5 || {};

  /** Used to skip problem elements */
  var reSkip = /^<|^(?:button|map|select|textarea|object|iframe|option|optgroup)$/i;

  /** Not all elements can be cloned in IE **/
  var saveClones = /^(?:a|b|code|div|fieldset|h1|h2|h3|h4|h5|h6|i|label|li|ol|p|q|span|strong|style|table|tbody|td|th|tr|ul)$/i;

  /** Detect whether the browser supports default html5 styles */
  var supportsHtml5Styles;

  /** Name of the expando, to work with multiple documents or to re-shiv one document */
  var expando = '_html5shiv';

  /** The id for the the documents expando */
  var expanID = 0;

  /** Cached data for each document */
  var expandoData = {};

  /** Detect whether the browser supports unknown elements */
  var supportsUnknownElements;

  (function() {
    try {
        var a = document.createElement('a');
        a.innerHTML = '<xyz></xyz>';
        //if the hidden property is implemented we can assume, that the browser supports basic HTML5 Styles
        supportsHtml5Styles = ('hidden' in a);

        supportsUnknownElements = a.childNodes.length == 1 || (function() {
          // assign a false positive if unable to shiv
          (document.createElement)('a');
          var frag = document.createDocumentFragment();
          return (
            typeof frag.cloneNode == 'undefined' ||
            typeof frag.createDocumentFragment == 'undefined' ||
            typeof frag.createElement == 'undefined'
          );
        }());
    } catch(e) {
      // assign a false positive if detection fails => unable to shiv
      supportsHtml5Styles = true;
      supportsUnknownElements = true;
    }

  }());

  /*--------------------------------------------------------------------------*/

  /**
   * Creates a style sheet with the given CSS text and adds it to the document.
   * @private
   * @param {Document} ownerDocument The document.
   * @param {String} cssText The CSS text.
   * @returns {StyleSheet} The style element.
   */
  function addStyleSheet(ownerDocument, cssText) {
    var p = ownerDocument.createElement('p'),
        parent = ownerDocument.getElementsByTagName('head')[0] || ownerDocument.documentElement;

    p.innerHTML = 'x<style>' + cssText + '</style>';
    return parent.insertBefore(p.lastChild, parent.firstChild);
  }

  /**
   * Returns the value of `html5.elements` as an array.
   * @private
   * @returns {Array} An array of shived element node names.
   */
  function getElements() {
    var elements = html5.elements;
    return typeof elements == 'string' ? elements.split(' ') : elements;
  }

    /**
   * Returns the data associated to the given document
   * @private
   * @param {Document} ownerDocument The document.
   * @returns {Object} An object of data.
   */
  function getExpandoData(ownerDocument) {
    var data = expandoData[ownerDocument[expando]];
    if (!data) {
        data = {};
        expanID++;
        ownerDocument[expando] = expanID;
        expandoData[expanID] = data;
    }
    return data;
  }

  /**
   * returns a shived element for the given nodeName and document
   * @memberOf html5
   * @param {String} nodeName name of the element
   * @param {Document} ownerDocument The context document.
   * @returns {Object} The shived element.
   */
  function createElement(nodeName, ownerDocument, data){
    if (!ownerDocument) {
        ownerDocument = document;
    }
    if(supportsUnknownElements){
        return ownerDocument.createElement(nodeName);
    }
    if (!data) {
        data = getExpandoData(ownerDocument);
    }
    var node;

    if (data.cache[nodeName]) {
        node = data.cache[nodeName].cloneNode();
    } else if (saveClones.test(nodeName)) {
        node = (data.cache[nodeName] = data.createElem(nodeName)).cloneNode();
    } else {
        node = data.createElem(nodeName);
    }

    // Avoid adding some elements to fragments in IE < 9 because
    // * Attributes like `name` or `type` cannot be set/changed once an element
    //   is inserted into a document/fragment
    // * Link elements with `src` attributes that are inaccessible, as with
    //   a 403 response, will cause the tab/window to crash
    // * Script elements appended to fragments will execute when their `src`
    //   or `text` property is set
    return node.canHaveChildren && !reSkip.test(nodeName) ? data.frag.appendChild(node) : node;
  }

  /**
   * returns a shived DocumentFragment for the given document
   * @memberOf html5
   * @param {Document} ownerDocument The context document.
   * @returns {Object} The shived DocumentFragment.
   */
  function createDocumentFragment(ownerDocument, data){
    if (!ownerDocument) {
        ownerDocument = document;
    }
    if(supportsUnknownElements){
        return ownerDocument.createDocumentFragment();
    }
    data = data || getExpandoData(ownerDocument);
    var clone = data.frag.cloneNode(),
        i = 0,
        elems = getElements(),
        l = elems.length;
    for(;i<l;i++){
        clone.createElement(elems[i]);
    }
    return clone;
  }

  /**
   * Shivs the `createElement` and `createDocumentFragment` methods of the document.
   * @private
   * @param {Document|DocumentFragment} ownerDocument The document.
   * @param {Object} data of the document.
   */
  function shivMethods(ownerDocument, data) {
    if (!data.cache) {
        data.cache = {};
        data.createElem = ownerDocument.createElement;
        data.createFrag = ownerDocument.createDocumentFragment;
        data.frag = data.createFrag();
    }


    ownerDocument.createElement = function(nodeName) {
      //abort shiv
      if (!html5.shivMethods) {
          return data.createElem(nodeName);
      }
      return createElement(nodeName, ownerDocument, data);
    };

    ownerDocument.createDocumentFragment = Function('h,f', 'return function(){' +
      'var n=f.cloneNode(),c=n.createElement;' +
      'h.shivMethods&&(' +
        // unroll the `createElement` calls
        getElements().join().replace(/\w+/g, function(nodeName) {
          data.createElem(nodeName);
          data.frag.createElement(nodeName);
          return 'c("' + nodeName + '")';
        }) +
      ');return n}'
    )(html5, data.frag);
  }

  /*--------------------------------------------------------------------------*/

  /**
   * Shivs the given document.
   * @memberOf html5
   * @param {Document} ownerDocument The document to shiv.
   * @returns {Document} The shived document.
   */
  function shivDocument(ownerDocument) {
    if (!ownerDocument) {
        ownerDocument = document;
    }
    var data = getExpandoData(ownerDocument);

    if (html5.shivCSS && !supportsHtml5Styles && !data.hasCSS) {
      data.hasCSS = !!addStyleSheet(ownerDocument,
        // corrects block display not defined in IE6/7/8/9
        'article,aside,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}' +
        // adds styling not present in IE6/7/8/9
        'mark{background:#FF0;color:#000}' +
        // hides non-rendered elements
        'template{display:none}'
      );
    }
    if (!supportsUnknownElements) {
      shivMethods(ownerDocument, data);
    }
    return ownerDocument;
  }

  /*--------------------------------------------------------------------------*/

  /**
   * The `html5` object is exposed so that more elements can be shived and
   * existing shiving can be detected on iframes.
   * @type Object
   * @example
   *
   * // options can be changed before the script is included
   * html5 = { 'elements': 'mark section', 'shivCSS': false, 'shivMethods': false };
   */
  var html5 = {

    /**
     * An array or space separated string of node names of the elements to shiv.
     * @memberOf html5
     * @type Array|String
     */
    'elements': options.elements || 'abbr article aside audio bdi canvas data datalist details figcaption figure footer header hgroup main mark meter nav output progress section summary template time video',

    /**
     * current version of html5shiv
     */
    'version': version,

    /**
     * A flag to indicate that the HTML5 style sheet should be inserted.
     * @memberOf html5
     * @type Boolean
     */
    'shivCSS': (options.shivCSS !== false),

    /**
     * Is equal to true if a browser supports creating unknown/HTML5 elements
     * @memberOf html5
     * @type boolean
     */
    'supportsUnknownElements': supportsUnknownElements,

    /**
     * A flag to indicate that the document's `createElement` and `createDocumentFragment`
     * methods should be overwritten.
     * @memberOf html5
     * @type Boolean
     */
    'shivMethods': (options.shivMethods !== false),

    /**
     * A string to describe the type of `html5` object ("default" or "default print").
     * @memberOf html5
     * @type String
     */
    'type': 'default',

    // shivs the document according to the specified `html5` object options
    'shivDocument': shivDocument,

    //creates a shived element
    createElement: createElement,

    //creates a shived documentFragment
    createDocumentFragment: createDocumentFragment
  };

  /*--------------------------------------------------------------------------*/

  // expose html5
  window.html5 = html5;

  // shiv the document
  shivDocument(document);

  /*------------------------------- Print Shiv -------------------------------*/

  /** Used to filter media types */
  var reMedia = /^$|\b(?:all|print)\b/;

  /** Used to namespace printable elements */
  var shivNamespace = 'html5shiv';

  /** Detect whether the browser supports shivable style sheets */
  var supportsShivableSheets = !supportsUnknownElements && (function() {
    // assign a false negative if unable to shiv
    var docEl = document.documentElement;
    return !(
      typeof document.namespaces == 'undefined' ||
      typeof document.parentWindow == 'undefined' ||
      typeof docEl.applyElement == 'undefined' ||
      typeof docEl.removeNode == 'undefined' ||
      typeof window.attachEvent == 'undefined'
    );
  }());

  /*--------------------------------------------------------------------------*/

  /**
   * Wraps all HTML5 elements in the given document with printable elements.
   * (eg. the "header" element is wrapped with the "html5shiv:header" element)
   * @private
   * @param {Document} ownerDocument The document.
   * @returns {Array} An array wrappers added.
   */
  function addWrappers(ownerDocument) {
    var node,
        nodes = ownerDocument.getElementsByTagName('*'),
        index = nodes.length,
        reElements = RegExp('^(?:' + getElements().join('|') + ')$', 'i'),
        result = [];

    while (index--) {
      node = nodes[index];
      if (reElements.test(node.nodeName)) {
        result.push(node.applyElement(createWrapper(node)));
      }
    }
    return result;
  }

  /**
   * Creates a printable wrapper for the given element.
   * @private
   * @param {Element} element The element.
   * @returns {Element} The wrapper.
   */
  function createWrapper(element) {
    var node,
        nodes = element.attributes,
        index = nodes.length,
        wrapper = element.ownerDocument.createElement(shivNamespace + ':' + element.nodeName);

    // copy element attributes to the wrapper
    while (index--) {
      node = nodes[index];
      node.specified && wrapper.setAttribute(node.nodeName, node.nodeValue);
    }
    // copy element styles to the wrapper
    wrapper.style.cssText = element.style.cssText;
    return wrapper;
  }

  /**
   * Shivs the given CSS text.
   * (eg. header{} becomes html5shiv\:header{})
   * @private
   * @param {String} cssText The CSS text to shiv.
   * @returns {String} The shived CSS text.
   */
  function shivCssText(cssText) {
    var pair,
        parts = cssText.split('{'),
        index = parts.length,
        reElements = RegExp('(^|[\\s,>+~])(' + getElements().join('|') + ')(?=[[\\s,>+~#.:]|$)', 'gi'),
        replacement = '$1' + shivNamespace + '\\:$2';

    while (index--) {
      pair = parts[index] = parts[index].split('}');
      pair[pair.length - 1] = pair[pair.length - 1].replace(reElements, replacement);
      parts[index] = pair.join('}');
    }
    return parts.join('{');
  }

  /**
   * Removes the given wrappers, leaving the original elements.
   * @private
   * @params {Array} wrappers An array of printable wrappers.
   */
  function removeWrappers(wrappers) {
    var index = wrappers.length;
    while (index--) {
      wrappers[index].removeNode();
    }
  }

  /*--------------------------------------------------------------------------*/

  /**
   * Shivs the given document for print.
   * @memberOf html5
   * @param {Document} ownerDocument The document to shiv.
   * @returns {Document} The shived document.
   */
  function shivPrint(ownerDocument) {
    var shivedSheet,
        wrappers,
        data = getExpandoData(ownerDocument),
        namespaces = ownerDocument.namespaces,
        ownerWindow = ownerDocument.parentWindow;

    if (!supportsShivableSheets || ownerDocument.printShived) {
      return ownerDocument;
    }
    if (typeof namespaces[shivNamespace] == 'undefined') {
      namespaces.add(shivNamespace);
    }

    function removeSheet() {
      clearTimeout(data._removeSheetTimer);
      if (shivedSheet) {
          shivedSheet.removeNode(true);
      }
      shivedSheet= null;
    }

    ownerWindow.attachEvent('onbeforeprint', function() {

      removeSheet();

      var imports,
          length,
          sheet,
          collection = ownerDocument.styleSheets,
          cssText = [],
          index = collection.length,
          sheets = Array(index);

      // convert styleSheets collection to an array
      while (index--) {
        sheets[index] = collection[index];
      }
      // concat all style sheet CSS text
      while ((sheet = sheets.pop())) {
        // IE does not enforce a same origin policy for external style sheets...
        // but has trouble with some dynamically created stylesheets
        if (!sheet.disabled && reMedia.test(sheet.media)) {

          try {
            imports = sheet.imports;
            length = imports.length;
          } catch(er){
            length = 0;
          }

          for (index = 0; index < length; index++) {
            sheets.push(imports[index]);
          }

          try {
            cssText.push(sheet.cssText);
          } catch(er){}
        }
      }

      // wrap all HTML5 elements with printable elements and add the shived style sheet
      cssText = shivCssText(cssText.reverse().join(''));
      wrappers = addWrappers(ownerDocument);
      shivedSheet = addStyleSheet(ownerDocument, cssText);

    });

    ownerWindow.attachEvent('onafterprint', function() {
      // remove wrappers, leaving the original elements, and remove the shived style sheet
      removeWrappers(wrappers);
      clearTimeout(data._removeSheetTimer);
      data._removeSheetTimer = setTimeout(removeSheet, 500);
    });

    ownerDocument.printShived = true;
    return ownerDocument;
  }

  /*--------------------------------------------------------------------------*/

  // expose API
  html5.type += ' print';
  html5.shivPrint = shivPrint;

  // shiv for print
  shivPrint(document);

}(this, document));


//SCRIPT: ../../vendor/js/matchMedia.js
/*! matchMedia() polyfill - Test a CSS media type/query in JS. Authors & copyright (c) 2012: Scott Jehl, Paul Irish, Nicholas Zakas, David Knight. Dual MIT/BSD license */

window.matchMedia || (window.matchMedia = function() {
    "use strict";

    // For browsers that support matchMedium api such as IE 9 and webkit
    var styleMedia = (window.styleMedia || window.media);

    // For those that don't support matchMedium
    if (!styleMedia) {
        var style       = document.createElement('style'),
            script      = document.getElementsByTagName('script')[0],
            info        = null;

        style.type  = 'text/css';
        style.id    = 'matchmediajs-test';

        script.parentNode.insertBefore(style, script);

        // 'style.currentStyle' is used by IE <= 8 and 'window.getComputedStyle' for all other browsers
        info = ('getComputedStyle' in window) && window.getComputedStyle(style, null) || style.currentStyle;

        styleMedia = {
            matchMedium: function(media) {
                var text = '@media ' + media + '{ #matchmediajs-test { width: 1px; } }';

                // 'style.styleSheet' is used by IE <= 8 and 'style.textContent' for all other browsers
                if (style.styleSheet) {
                    style.styleSheet.cssText = text;
                } else {
                    style.textContent = text;
                }

                // Test if media query is true or false
                return info.width === '1px';
            }
        };
    }

    return function(media) {
        return {
            matches: styleMedia.matchMedium(media || 'all'),
            media: media || 'all'
        };
    };
}());


//SCRIPT: ../../vendor/js/video.js
/*!
Video.js - HTML5 Video Player
Version 3.2.3

LGPL v3 LICENSE INFO
This file is part of Video.js. Copyright 2011 Zencoder, Inc.

Video.js is free software: you can redistribute it and/or modify
it under the terms of the GNU Lesser General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.

Video.js is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU Lesser General Public License for more details.

You should have received a copy of the GNU Lesser General Public License
along with Video.js.  If not, see <http://www.gnu.org/licenses/>.
*/

// Self-executing function to prevent global vars and help with minification
;(function(window, undefined){
  var document = window.document;// HTML5 Shiv. Must be in <head> to support older browsers.
document.createElement("video");document.createElement("audio");

var VideoJS = function(id, addOptions, ready){
  var tag; // Element of ID

  // Allow for element or ID to be passed in
  // String ID
  if (typeof id == "string") {

    // Adjust for jQuery ID syntax
    if (id.indexOf("#") === 0) {
      id = id.slice(1);
    }

    // If a player instance has already been created for this ID return it.
    if (_V_.players[id]) {
      return _V_.players[id];

    // Otherwise get element for ID
    } else {
      tag = _V_.el(id)
    }

  // ID is a media element
  } else {
    tag = id;
  }

  // Check for a useable element
  if (!tag || !tag.nodeName) { // re: nodeName, could be a box div also
    throw new TypeError("The element or ID supplied is not valid. (VideoJS)"); // Returns
  }

  // Element may have a player attr referring to an already created player instance.
  // If not, set up a new player and return the instance.
  return tag.player || new _V_.Player(tag, addOptions, ready);
},

// Shortcut
_V_ = VideoJS,

// CDN Version. Used to target right flash swf.
CDN_VERSION = "GENERATED_CDN_VSN";

VideoJS.players = {};

VideoJS.options = {

  // Default order of fallback technology
  techOrder: ["html5","flash"],
  // techOrder: ["flash","html5"],

  html5: {},
  flash: { swf: "http://vjs.zencdn.net/c/video-js.swf" },

  // Default of web browser is 300x150. Should rely on source width/height.
  width: 300,
  height: 150,

  // defaultVolume: 0.85,
  defaultVolume: 0.00, // The freakin seaguls are driving me crazy!

  // Included control sets
  components: {
    "posterImage": {},
    "textTrackDisplay": {},
    "loadingSpinner": {},
    "bigPlayButton": {},
    "controlBar": {}
  }

  // components: [
  //   "poster",
  //   "loadingSpinner",
  //   "bigPlayButton",
  //   { name: "controlBar", options: {
  //     components: [
  //       "playToggle",
  //       "fullscreenToggle",
  //       "currentTimeDisplay",
  //       "timeDivider",
  //       "durationDisplay",
  //       "remainingTimeDisplay",
  //       { name: "progressControl", options: {
  //         components: [
  //           { name: "seekBar", options: {
  //             components: [
  //               "loadProgressBar",
  //               "playProgressBar",
  //               "seekHandle"
  //             ]}
  //           }
  //         ]}
  //       },
  //       { name: "volumeControl", options: {
  //         components: [
  //           { name: "volumeBar", options: {
  //             components: [
  //               "volumeLevel",
  //               "volumeHandle"
  //             ]}
  //           }
  //         ]}
  //       },
  //       "muteToggle"
  //     ]
  //   }},
  //   "subtitlesDisplay"/*, "replay"*/
  // ]
};

// Set CDN Version of swf
if (CDN_VERSION != "GENERATED_CDN_VSN") {
  _V_.options.flash.swf = "http://vjs.zencdn.net/"+CDN_VERSION+"/video-js.swf"
}_V_.merge = function(obj1, obj2, safe){
  // Make sure second object exists
  if (!obj2) { obj2 = {}; };

  for (var attrname in obj2){
    if (obj2.hasOwnProperty(attrname) && (!safe || !obj1.hasOwnProperty(attrname))) { obj1[attrname]=obj2[attrname]; }
  }
  return obj1;
};
_V_.extend = function(obj){ this.merge(this, obj, true); };

_V_.extend({
  tech: {}, // Holder for playback technology settings
  controlSets: {}, // Holder for control set definitions

  // Device Checks
  isIE: function(){ return !+"\v1"; },
  isFF: function(){ return !!_V_.ua.match("Firefox") },
  isIPad: function(){ return navigator.userAgent.match(/iPad/i) !== null; },
  isIPhone: function(){ return navigator.userAgent.match(/iPhone/i) !== null; },
  isIOS: function(){ return VideoJS.isIPhone() || VideoJS.isIPad(); },
  iOSVersion: function() {
    var match = navigator.userAgent.match(/OS (\d+)_/i);
    if (match && match[1]) { return match[1]; }
  },
  isAndroid: function(){ return navigator.userAgent.match(/Android.*AppleWebKit/i) !== null; },
  androidVersion: function() {
    var match = navigator.userAgent.match(/Android (\d+)\./i);
    if (match && match[1]) { return match[1]; }
  },

  testVid: document.createElement("video"),
  ua: navigator.userAgent,
  support: {},

  each: function(arr, fn){
    if (!arr || arr.length === 0) { return; }
    for (var i=0,j=arr.length; i<j; i++) {
      fn.call(this, arr[i], i);
    }
  },

  eachProp: function(obj, fn){
    if (!obj) { return; }
    for (var name in obj) {
      if (obj.hasOwnProperty(name)) {
        fn.call(this, name, obj[name]);
      }
    }
  },

  el: function(id){ return document.getElementById(id); },
  createElement: function(tagName, attributes){
    var el = document.createElement(tagName),
        attrname;
    for (attrname in attributes){
      if (attributes.hasOwnProperty(attrname)) {
        if (attrname.indexOf("-") !== -1) {
          el.setAttribute(attrname, attributes[attrname]);
        } else {
          el[attrname] = attributes[attrname];
        }
      }
        if (el.className.indexOf("play")!==-1 || el.className.indexOf("pause")!==-1) { el.setAttribute('role','button');} //This is required to set role=button so that iOS7 can click these items
    }
    return el;
  },

  insertFirst: function(node, parent){
    if (parent.firstChild) {
      parent.insertBefore(node, parent.firstChild);
    } else {
      parent.appendChild(node);
    }
  },

  addClass: function(element, classToAdd){
    if ((" "+element.className+" ").indexOf(" "+classToAdd+" ") == -1) {
      element.className = element.className === "" ? classToAdd : element.className + " " + classToAdd;
    }
  },

  removeClass: function(element, classToRemove){
    if (element.className.indexOf(classToRemove) == -1) { return; }
    var classNames = element.className.split(" ");
    classNames.splice(classNames.indexOf(classToRemove),1);
    element.className = classNames.join(" ");
  },
  
  remove: function(item, array){
    if (!array) return;
    var i = array.indexOf(item);
    if (i != -1) { 
      return array.splice(i, 1)
    };
  },

  // Attempt to block the ability to select text while dragging controls
  blockTextSelection: function(){
    document.body.focus();
    document.onselectstart = function () { return false; };
  },
  // Turn off text selection blocking
  unblockTextSelection: function(){ document.onselectstart = function () { return true; }; },

  // Return seconds as H:MM:SS or M:SS
  // Supplying a guide (in seconds) will include enough leading zeros to cover the length of the guide
  formatTime: function(seconds, guide) {
    guide = Math.abs(guide || seconds); // Default to using seconds as guide
    var seconds = Math.abs(seconds),
        s = Math.floor(seconds % 60),
        m = Math.floor(seconds / 60 % 60),
        h = Math.floor(seconds / 3600),
        gm = Math.floor(guide / 60 % 60),
        gh = Math.floor(guide / 3600);

    // Check if we need to show hours
    h = (h > 0 || gh > 0) ? h + ":" : "";

    // If hours are showing, we may need to add a leading zero.
    // Always show at least one digit of minutes.
    m = (((h || gm >= 10) && m < 10) ? "0" + m : m) + ":";

    // Check if leading zero is need for seconds
    s = (s < 10) ? "0" + s : s;

    return h + m + s;
  },

  uc: function(string){
    return string.charAt(0).toUpperCase() + string.slice(1);
  },

  // Return the relative horizonal position of an event as a value from 0-1
  getRelativePosition: function(x, relativeElement){
    return Math.max(0, Math.min(1, (x - _V_.findPosX(relativeElement)) / relativeElement.offsetWidth));
  },
  
  getComputedStyleValue: function(element, style){
    return window.getComputedStyle(element, null).getPropertyValue(style);
  },

  trim: function(string){ return string.toString().replace(/^\s+/, "").replace(/\s+$/, ""); },
  round: function(num, dec) {
    if (!dec) { dec = 0; }
    return Math.round(num*Math.pow(10,dec))/Math.pow(10,dec);
  },

  isEmpty: function(object) {
    for (var prop in object) {
      return false;
    }
    return true;
  },

  // Mimic HTML5 TimeRange Spec.
  createTimeRange: function(start, end){
    return {
      length: 1,
      start: function() { return start; },
      end: function() { return end; }
    };
  },

  /* Element Data Store. Allows for binding data to an element without putting it directly on the element.
     Ex. Event listneres are stored here.
     (also from jsninja.com)
  ================================================================================ */
  cache: {}, // Where the data is stored
  guid: 1, // Unique ID for the element
  expando: "vdata" + (new Date).getTime(), // Unique attribute to store element's guid in

  // Returns the cache object where data for the element is stored
  getData: function(elem){
    var id = elem[_V_.expando];
    if (!id) {
      id = elem[_V_.expando] = _V_.guid++;
      _V_.cache[id] = {};
    }
    return _V_.cache[id];
  },
  // Delete data for the element from the cache and the guid attr from element
  removeData: function(elem){
    var id = elem[_V_.expando];
    if (!id) { return; }
    // Remove all stored data
    delete _V_.cache[id];
    // Remove the expando property from the DOM node
    try {
      delete elem[_V_.expando];
    } catch(e) {
      if (elem.removeAttribute) {
        elem.removeAttribute(_V_.expando);
      } else {
        // IE doesn't appear to support removeAttribute on the document element
        elem[_V_.expando] = null;
      }
    }
  },

  /* Proxy (a.k.a Bind or Context). A simple method for changing the context of a function
     It also stores a unique id on the function so it can be easily removed from events
  ================================================================================ */
  proxy: function(context, fn, uid) {
    // Make sure the function has a unique ID
    if (!fn.guid) { fn.guid = _V_.guid++; }

    // Create the new function that changes the context
    var ret = function() {
      return fn.apply(context, arguments);
    }

    // Allow for the ability to individualize this function
    // Needed in the case where multiple objects might share the same prototype
    // IF both items add an event listener with the same function, then you try to remove just one
    // it will remove both because they both have the same guid.
    // when using this, you need to use the proxy method when you remove the listener as well.
    ret.guid = (uid) ? uid + "_" + fn.guid : fn.guid;

    return ret;
  },

  get: function(url, onSuccess, onError){
    // if (netscape.security.PrivilegeManager.enablePrivilege) {
    //   netscape.security.PrivilegeManager.enablePrivilege("UniversalBrowserRead");
    // }

    var local = (url.indexOf("file:") == 0 || (window.location.href.indexOf("file:") == 0 && url.indexOf("http:") == -1));

    if (typeof XMLHttpRequest == "undefined") {
      XMLHttpRequest = function () {
        try { return new ActiveXObject("Msxml2.XMLHTTP.6.0"); } catch (e) {}
        try { return new ActiveXObject("Msxml2.XMLHTTP.3.0"); } catch (f) {}
        try { return new ActiveXObject("Msxml2.XMLHTTP"); } catch (g) {}
        throw new Error("This browser does not support XMLHttpRequest.");
      };
    }

    var request = new XMLHttpRequest();

    try {
      request.open("GET", url);
    } catch(e) {
      _V_.log("VideoJS XMLHttpRequest (open)", e);
      // onError(e);
      return false;
    }

    request.onreadystatechange = _V_.proxy(this, function() {
      if (request.readyState == 4) {
        if (request.status == 200 || local && request.status == 0) {
          onSuccess(request.responseText);
        } else {
          if (onError) {
            onError();
          }
        }
      }
    });

    try {
      request.send();
    } catch(e) {
      _V_.log("VideoJS XMLHttpRequest (send)", e);
      if (onError) {
        onError(e);
      }
    }
  },

  /* Local Storage
  ================================================================================ */
  setLocalStorage: function(key, value){
    // IE was throwing errors referencing the var anywhere without this
    var localStorage = window.localStorage || false;
    if (!localStorage) { return; }
    try {
      localStorage[key] = value;
    } catch(e) {
      if (e.code == 22 || e.code == 1014) { // Webkit == 22 / Firefox == 1014
        _V_.log("LocalStorage Full (VideoJS)", e);
      } else {
        _V_.log("LocalStorage Error (VideoJS)", e);
      }
    }
  },

  // Get abosolute version of relative URL. Used to tell flash correct URL.
  // http://stackoverflow.com/questions/470832/getting-an-absolute-url-from-a-relative-one-ie6-issue
  getAbsoluteURL: function(url){

    // Check if absolute URL
    if (!url.match(/^https?:\/\//)) {
      // Convert to absolute URL. Flash hosted off-site needs an absolute URL.
      url = _V_.createElement('div', {
        innerHTML: '<a href="'+url+'">x</a>'
      }).firstChild.href;
    }

    return url;
  }

});

// usage: log('inside coolFunc', this, arguments);
// paulirish.com/2009/log-a-lightweight-wrapper-for-consolelog/
_V_.log = function(){
  _V_.log.history = _V_.log.history || [];// store logs to an array for reference
  _V_.log.history.push(arguments);
  if(window.console) {
    arguments.callee = arguments.callee.caller;
    var newarr = [].slice.call(arguments);
    (typeof console.log === 'object' ? _V_.log.apply.call(console.log, console, newarr) : console.log.apply(console, newarr));
  }
};

// make it safe to use console.log always
(function(b){function c(){}for(var d="assert,count,debug,dir,dirxml,error,exception,group,groupCollapsed,groupEnd,info,log,timeStamp,profile,profileEnd,time,timeEnd,trace,warn".split(","),a;a=d.pop();){b[a]=b[a]||c}})((function(){try
{console.log();return window.console;}catch(err){return window.console={};}})());

// Offset Left
// getBoundingClientRect technique from John Resig http://ejohn.org/blog/getboundingclientrect-is-awesome/
if ("getBoundingClientRect" in document.documentElement) {
  _V_.findPosX = function(el) {
    var box;

    try {
      box = el.getBoundingClientRect();
    } catch(e) {}

    if (!box) { return 0; }

    var docEl = document.documentElement,
        body = document.body,
        clientLeft = docEl.clientLeft || body.clientLeft || 0,
        scrollLeft = window.pageXOffset || body.scrollLeft,
        left = box.left + scrollLeft - clientLeft;

    return left;
  };
} else {
  _V_.findPosX = function(el) {
    var curleft = el.offsetLeft;
    // _V_.log(obj.className, obj.offsetLeft)
    while(el = obj.offsetParent) {
      if (el.className.indexOf("video-js") == -1) {
        // _V_.log(el.offsetParent, "OFFSETLEFT", el.offsetLeft)
        // _V_.log("-webkit-full-screen", el.webkitMatchesSelector("-webkit-full-screen"));
        // _V_.log("-webkit-full-screen", el.querySelectorAll(".video-js:-webkit-full-screen"));
      } else {
      }
      curleft += el.offsetLeft;
    }
    return curleft;
  };
}
// Using John Resig's Class implementation http://ejohn.org/blog/simple-javascript-inheritance/
// (function(){var initializing=false, fnTest=/xyz/.test(function(){xyz;}) ? /\b_super\b/ : /.*/; _V_.Class = function(){}; _V_.Class.extend = function(prop) { var _super = this.prototype; initializing = true; var prototype = new this(); initializing = false; for (var name in prop) { prototype[name] = typeof prop[name] == "function" && typeof _super[name] == "function" && fnTest.test(prop[name]) ? (function(name, fn){ return function() { var tmp = this._super; this._super = _super[name]; var ret = fn.apply(this, arguments); this._super = tmp; return ret; }; })(name, prop[name]) : prop[name]; } function Class() { if ( !initializing && this.init ) this.init.apply(this, arguments); } Class.prototype = prototype; Class.constructor = Class; Class.extend = arguments.callee; return Class;};})();
(function(){
  var initializing = false, fnTest = /xyz/.test(function(){xyz;}) ? /\b_super\b/ : /.*/;
  _V_.Class = function(){};
  _V_.Class.extend = function(prop) {
    var _super = this.prototype;
    initializing = true;
    var prototype = new this();
    initializing = false;
    for (var name in prop) {
      prototype[name] = typeof prop[name] == "function" &&
        typeof _super[name] == "function" && fnTest.test(prop[name]) ?
        (function(name, fn){
          return function() {
            var tmp = this._super;
            this._super = _super[name];
            var ret = fn.apply(this, arguments);
            this._super = tmp;
            return ret;
          };
        })(name, prop[name]) :
        prop[name];
    }
    function Class() {
      if ( !initializing && this.init ) {
        return this.init.apply(this, arguments);

      // Attempting to recreate accessing function form of class.
      } else if (!initializing) {
        return arguments.callee.prototype.init()
      }
    }
    Class.prototype = prototype;
    Class.constructor = Class;
    Class.extend = arguments.callee;
    return Class;
  };
})();

/* Player Component- Base class for all UI objects
================================================================================ */
_V_.Component = _V_.Class.extend({

  init: function(player, options){
    this.player = player;

    // Allow for overridding default component options
    options = this.options = _V_.merge(this.options || {}, options);

    // Create element if one wasn't provided in options
    if (options.el) {
      this.el = options.el;
    } else {
      this.el = this.createElement();
    }

    // Add any components in options
    this.initComponents();
  },

  destroy: function(){},

  createElement: function(type, attrs){
    return _V_.createElement(type || "div", attrs);
  },

  buildCSSClass: function(){
    // Child classes can include a function that does:
    // return "CLASS NAME" + this._super();
    return "";
  },

  initComponents: function(){
    var options = this.options;
    if (options && options.components) {
      // Loop through components and add them to the player
      this.eachProp(options.components, function(name, opts){

        // Allow waiting to add components until a specific event is called
        var tempAdd = this.proxy(function(){
          // Set property name on player. Could cause conflicts with other prop names, but it's worth making refs easy.
          this[name] = this.addComponent(name, opts);
        });

        if (opts.loadEvent) {
          this.one(opts.loadEvent, tempAdd)
        } else {
          tempAdd();
        }
      });
    }
  },

  // Add child components to this component.
  // Will generate a new child component and then append child component's element to this component's element.
  // Takes either the name of the UI component class, or an object that contains a name, UI Class, and options.
  addComponent: function(name, options){
    var component, componentClass;

    // If string, create new component with options
    if (typeof name == "string") {

      // Make sure options is at least an empty object to protect against errors
      options = options || {};

      // Assume name of set is a lowercased name of the UI Class (PlayButton, etc.)
      componentClass = options.componentClass || _V_.uc(name);

      // Create a new object & element for this controls set
      // If there's no .player, this is a player
      component = new _V_[componentClass](this.player || this, options);

    } else {
      component = name;
    }

    // Add the UI object's element to the container div (box)
    this.el.appendChild(component.el);

    // Return so it can stored on parent object if desired.
    return component;
  },

  removeComponent: function(component){
    this.el.removeChild(component.el);
  },

  /* Display
  ================================================================================ */
  show: function(){
    this.el.style.display = "block";
  },

  hide: function(){
    this.el.style.display = "none";
  },
  
  fadeIn: function(){
    this.removeClass("vjs-fade-out");
    this.addClass("vjs-fade-in");
  },

  fadeOut: function(){
    this.removeClass("vjs-fade-in");
    this.addClass("vjs-fade-out");
  },

  lockShowing: function(){
    var style = this.el.style;
    style.display = "block";
    style.opacity = 1;
    style.visiblity = "visible";
  },

  unlockShowing: function(){
    var style = this.el.style;
    style.display = "";
    style.opacity = "";
    style.visiblity = "";
  },

  addClass: function(classToAdd){
    _V_.addClass(this.el, classToAdd);
  },

  removeClass: function(classToRemove){
    _V_.removeClass(this.el, classToRemove);
  },

  /* Events
  ================================================================================ */
  addEvent: function(type, fn, uid){
    return _V_.addEvent(this.el, type, _V_.proxy(this, fn));
  },
  removeEvent: function(type, fn){
    return _V_.removeEvent(this.el, type, fn);
  },
  triggerEvent: function(type, e){
    return _V_.triggerEvent(this.el, type, e);
  },
  one: function(type, fn) {
    _V_.one(this.el, type, _V_.proxy(this, fn));
  },

  /* Ready - Trigger functions when component is ready
  ================================================================================ */
  ready: function(fn){
    if (!fn) return this;

    if (this.isReady) {
      fn.call(this);
    } else {
      if (this.readyQueue === undefined) {
        this.readyQueue = [];
      }
      this.readyQueue.push(fn);
    }

    return this;
  },

  triggerReady: function(){
    this.isReady = true;
    if (this.readyQueue && this.readyQueue.length > 0) {
      // Call all functions in ready queue
      this.each(this.readyQueue, function(fn){
        fn.call(this);
      });

      // Reset Ready Queue
      this.readyQueue = [];

      // Allow for using event listeners also, in case you want to do something everytime a source is ready.
      this.triggerEvent("ready");
    }
  },

  /* Utility
  ================================================================================ */
  each: function(arr, fn){ _V_.each.call(this, arr, fn); },

  eachProp: function(obj, fn){ _V_.eachProp.call(this, obj, fn); },

  extend: function(obj){ _V_.merge(this, obj) },

  // More easily attach 'this' to functions
  proxy: function(fn, uid){  return _V_.proxy(this, fn, uid); }

});/* Control - Base class for all control elements
================================================================================ */
_V_.Control = _V_.Component.extend({

  buildCSSClass: function(){
    return "vjs-control " + this._super();
  }

});

/* Control Bar
================================================================================ */
_V_.ControlBar = _V_.Component.extend({

  options: {
    loadEvent: "play",
    components: {
      "playToggle": {},
      "fullscreenToggle": {},
      "currentTimeDisplay": {},
      "timeDivider": {},
      "durationDisplay": {},
      "remainingTimeDisplay": {},
      "progressControl": {},
      "volumeControl": {},
      "muteToggle": {}
    }
  },

  init: function(player, options){
    this._super(player, options);

    player.one("play", this.proxy(function(){
      this.player.addEvent("mouseover", this.proxy(this.fadeIn));
      this.player.addEvent("mouseout", this.proxy(this.fadeOut));
    }));

    player.addEvent("play", this.proxy(this.fadeIn));
    player.addEvent("stop", this.proxy(this.fadeOut));
    // player.one("pause", this.proxy(this.fadeOut));
    // player.one("ended", this.proxy(this.fadeOut));
  },

  createElement: function(){
    return _V_.createElement("div", {
      className: "vjs-controls"
    });
  },

  fadeIn: function(){
    this._super();
    this.player.triggerEvent("controlsvisible");
  },

  fadeOut: function(){
    this._super();
    this.player.triggerEvent("controlshidden");
  },

  lockShowing: function(){
    this.el.style.opacity = "1";
  }

});

/* Button - Base class for all buttons
================================================================================ */
_V_.Button = _V_.Control.extend({

  init: function(player, options){
    this._super(player, options);

    this.addEvent("click", this.onClick);
    this.addEvent("focus", this.onFocus);
    this.addEvent("blur", this.onBlur);
  },

  createElement: function(type, attrs){
    // Add standard Aria and Tabindex info
    attrs = _V_.merge({
      className: this.buildCSSClass(),
      innerHTML: '<div><span class="vjs-control-text">' + (this.buttonText || "Need Text") + '</span></div>',
      role: "button",
      tabIndex: 0
    }, attrs);

    return this._super(type, attrs);
  },

  // Click - Override with specific functionality for button
  onClick: function(){},

  // Focus - Add keyboard functionality to element
  onFocus: function(){
    _V_.addEvent(document, "keyup", _V_.proxy(this, this.onKeyPress));
  },

  // KeyPress (document level) - Trigger click when keys are pressed
  onKeyPress: function(event){
    // Check for space bar (32) or enter (13) keys
    if (event.which == 32 || event.which == 13) {
      event.preventDefault();
      this.onClick();
    }
  },

  // Blur - Remove keyboard triggers
  onBlur: function(){
    _V_.removeEvent(document, "keyup", _V_.proxy(this, this.onKeyPress));
  }

});

/* Play Button
================================================================================ */
_V_.PlayButton = _V_.Button.extend({

  buttonText: "Play",

  buildCSSClass: function(){
    return "vjs-play-button " + this._super();
  },

  onClick: function(){
    this.player.play();
  }

});

/* Pause Button
================================================================================ */
_V_.PauseButton = _V_.Button.extend({

  buttonText: "Pause",

  buildCSSClass: function(){
    return "vjs-pause-button " + this._super();
  },

  onClick: function(){
    this.player.pause();
  }

});

/* Play Toggle - Play or Pause Media
================================================================================ */
_V_.PlayToggle = _V_.Button.extend({

  buttonText: "Play/Pause",

  init: function(player, options){
    this._super(player, options);

    player.addEvent("play", _V_.proxy(this, this.onPlay));
    player.addEvent("pause", _V_.proxy(this, this.onPause));
  },

  buildCSSClass: function(){
    return "vjs-play-control " + this._super();
  },

  // OnClick - Toggle between play and pause
  onClick: function(){
    if (this.player.paused()) {
      this.player.play();
    } else {
      this.player.pause();
    }
  },

  // OnPlay - Add the vjs-playing class to the element so it can change appearance
  onPlay: function(){
    _V_.removeClass(this.el, "vjs-paused");
    _V_.addClass(this.el, "vjs-playing");
  },

  // OnPause - Add the vjs-paused class to the element so it can change appearance
  onPause: function(){
    _V_.removeClass(this.el, "vjs-playing");
    _V_.addClass(this.el, "vjs-paused");
  }

});


/* Fullscreen Toggle Behaviors
================================================================================ */
_V_.FullscreenToggle = _V_.Button.extend({

  buttonText: "Fullscreen",

  buildCSSClass: function(){
    return "vjs-fullscreen-control " + this._super();
  },

  onClick: function(){
    if (!this.player.isFullScreen) {
      this.player.requestFullScreen();
    } else {
      this.player.cancelFullScreen();
    }
  }

});

/* Big Play Button
================================================================================ */
_V_.BigPlayButton = _V_.Button.extend({
  init: function(player, options){
    this._super(player, options);

    player.addEvent("play", _V_.proxy(this, this.hide));
    player.addEvent("stop", _V_.proxy(this, this.show));
    player.addEvent("pause", _V_.proxy(this, this.show));
    player.addEvent("ended", _V_.proxy(this, this.show));
  },

  createElement: function(){
    return this._super("div", {
      className: "vjs-big-play-button",
      innerHTML: '<span class="aria-focus" tabindex="1" aria-labelledby="videoplay" role="button"></span><div id="videoplay" style="display:none;" >Play</div>' //Need this in order for voiceover to be able to access the play button, and read out label. Inline style to ensure that there are no dependencies
    });
  },

  onClick: function(){
    // Go back to the beginning if big play button is showing at the end.
    // Have to check for current time otherwise it might throw a 'not ready' error.
    // 
    // These lines are removed in order to be able to continue the playback instead of restarting it from the beginnging.
    // See also: https://github.com/videojs/video.js/blob/4.0.0/src/js/big-play-button.js#L35
    // 
    // if(this.player.currentTime()) {
    //   this.player.currentTime(0);
    // }
    this.player.play();
  }
});

/* Loading Spinner
================================================================================ */
_V_.LoadingSpinner = _V_.Component.extend({
  init: function(player, options){
    this._super(player, options);

    player.addEvent("canplay", _V_.proxy(this, this.hide));
    player.addEvent("canplaythrough", _V_.proxy(this, this.hide));
    player.addEvent("playing", _V_.proxy(this, this.hide));

    player.addEvent("seeking", _V_.proxy(this, this.show));

    // in some browsers seeking does not trigger the 'playing' event,
    // so we also need to trap 'seeked' if we are going to set a
    // 'seeking' event
    player.addEvent("seeked", _V_.proxy(this, this.hide));

    player.addEvent("error", _V_.proxy(this, this.show));

    // Not showing spinner on stalled any more. Browsers may stall and then not trigger any events that would remove the spinner.
    // Checked in Chrome 16 and Safari 5.1.2. http://help.videojs.com/discussions/problems/883-why-is-the-download-progress-showing
    // player.addEvent("stalled", _V_.proxy(this, this.show));

    player.addEvent("waiting", _V_.proxy(this, this.show));
  },

  createElement: function(){

    var classNameSpinner, innerHtmlSpinner;

    if ( typeof this.player.el.style.WebkitBorderRadius == "string"
         || typeof this.player.el.style.MozBorderRadius == "string"
         || typeof this.player.el.style.KhtmlBorderRadius == "string"
         || typeof this.player.el.style.borderRadius == "string")
      {
        classNameSpinner = "vjs-loading-spinner";
        innerHtmlSpinner = "<div class='ball1'></div><div class='ball2'></div><div class='ball3'></div><div class='ball4'></div><div class='ball5'></div><div class='ball6'></div><div class='ball7'></div><div class='ball8'></div>";
      } else {
        classNameSpinner = "vjs-loading-spinner-fallback";
        innerHtmlSpinner = "";
      }

    return this._super("div", {
      className: classNameSpinner,
      innerHTML: innerHtmlSpinner
    });
  }
});

/* Time
================================================================================ */
_V_.CurrentTimeDisplay = _V_.Component.extend({

  init: function(player, options){
    this._super(player, options);

    player.addEvent("timeupdate", _V_.proxy(this, this.updateContent));
  },

  createElement: function(){
    var el = this._super("div", {
      className: "vjs-current-time vjs-time-controls vjs-control"
    });

    this.content = _V_.createElement("div", {
      className: "vjs-current-time-display",
      innerHTML: '0:00'
    });

    el.appendChild(_V_.createElement("div").appendChild(this.content));
    return el;
  },

  updateContent: function(){
    // Allows for smooth scrubbing, when player can't keep up.
    var time = (this.player.scrubbing) ? this.player.values.currentTime : this.player.currentTime();
    this.content.innerHTML = _V_.formatTime(time, this.player.duration());
  }

});

_V_.DurationDisplay = _V_.Component.extend({

  init: function(player, options){
    this._super(player, options);

    player.addEvent("timeupdate", _V_.proxy(this, this.updateContent));
  },

  createElement: function(){
    var el = this._super("div", {
      className: "vjs-duration vjs-time-controls vjs-control"
    });

    this.content = _V_.createElement("div", {
      className: "vjs-duration-display",
      innerHTML: '0:00'
    });

    el.appendChild(_V_.createElement("div").appendChild(this.content));
    return el;
  },

  updateContent: function(){
    if (this.player.duration()) { this.content.innerHTML = _V_.formatTime(this.player.duration()); }
  }

});

// Time Separator (Not used in main skin, but still available, and could be used as a 'spare element')
_V_.TimeDivider = _V_.Component.extend({

  createElement: function(){
    return this._super("div", {
      className: "vjs-time-divider",
      innerHTML: '<div aria-hidden="true"><span>/</span></div>'
    });
  }

});

_V_.RemainingTimeDisplay = _V_.Component.extend({

  init: function(player, options){
    this._super(player, options);

    player.addEvent("timeupdate", _V_.proxy(this, this.updateContent));
  },

  createElement: function(){
    var el = this._super("div", {
      className: "vjs-remaining-time vjs-time-controls vjs-control"
    });

    this.content = _V_.createElement("div", {
      className: "vjs-remaining-time-display",
      innerHTML: '-0:00'
    });

    el.appendChild(_V_.createElement("div").appendChild(this.content));
    return el;
  },

  updateContent: function(){
    if (this.player.duration()) { this.content.innerHTML = "-"+_V_.formatTime(this.player.remainingTime()); }

    // Allows for smooth scrubbing, when player can't keep up.
    // var time = (this.player.scrubbing) ? this.player.values.currentTime : this.player.currentTime();
    // this.content.innerHTML = _V_.formatTime(time, this.player.duration());
  }

});

/* Slider - Parent for seek bar and volume slider
================================================================================ */
_V_.Slider = _V_.Component.extend({

  init: function(player, options){
    this._super(player, options);

    player.addEvent(this.playerEvent, _V_.proxy(this, this.update));

    this.addEvent("mousedown", this.onMouseDown);
    this.addEvent("focus", this.onFocus);
    this.addEvent("blur", this.onBlur);

    this.player.addEvent("controlsvisible", this.proxy(this.update));

    // This is actually to fix the volume handle position. http://twitter.com/#!/gerritvanaaken/status/159046254519787520
    // this.player.one("timeupdate", this.proxy(this.update));

    this.update();
  },

  createElement: function(type, attrs) {
    attrs = _V_.merge({
      role: "slider",
      "aria-valuenow": 0,
      "aria-valuemin": 0,
      "aria-valuemax": 100,
      tabIndex: 0
    }, attrs);

    return this._super(type, attrs);
  },

  onMouseDown: function(event){
    event.preventDefault();
    _V_.blockTextSelection();

    _V_.addEvent(document, "mousemove", _V_.proxy(this, this.onMouseMove));
    _V_.addEvent(document, "mouseup", _V_.proxy(this, this.onMouseUp));

    this.onMouseMove(event);
  },

  onMouseUp: function(event) {
    _V_.unblockTextSelection();
    _V_.removeEvent(document, "mousemove", this.onMouseMove, false);
    _V_.removeEvent(document, "mouseup", this.onMouseUp, false);

    this.update();
  },

  update: function(){
    // If scrubbing, we could use a cached value to make the handle keep up with the user's mouse.
    // On HTML5 browsers scrubbing is really smooth, but some flash players are slow, so we might want to utilize this later.
    // var progress =  (this.player.scrubbing) ? this.player.values.currentTime / this.player.duration() : this.player.currentTime() / this.player.duration();

    var barProgress,
        progress = this.getPercent();
        handle = this.handle,
        bar = this.bar;

    // Protect against no duration and other division issues
    if (isNaN(progress)) { progress = 0; }

    barProgress = progress;

    // If there is a handle, we need to account for the handle in our calculation for progress bar
    // so that it doesn't fall short of or extend past the handle.
    if (handle) {

      var box = this.el,
          boxWidth = box.offsetWidth,

          handleWidth = handle.el.offsetWidth,

          // The width of the handle in percent of the containing box
          // In IE, widths may not be ready yet causing NaN
          handlePercent = (handleWidth) ? handleWidth / boxWidth : 0,

          // Get the adjusted size of the box, considering that the handle's center never touches the left or right side.
          // There is a margin of half the handle's width on both sides.
          boxAdjustedPercent = 1 - handlePercent;

          // Adjust the progress that we'll use to set widths to the new adjusted box width
          adjustedProgress = progress * boxAdjustedPercent,

          // The bar does reach the left side, so we need to account for this in the bar's width
          barProgress = adjustedProgress + (handlePercent / 2);

      // Move the handle from the left based on the adjected progress
      handle.el.style.left = _V_.round(adjustedProgress * 100, 2) + "%";
    }

    // Set the new bar width
    bar.el.style.width = _V_.round(barProgress * 100, 2) + "%";
  },

  calculateDistance: function(event){
    var box = this.el,
        boxX = _V_.findPosX(box),
        boxW = box.offsetWidth,
        handle = this.handle;

    if (handle) {
      var handleW = handle.el.offsetWidth;

      // Adjusted X and Width, so handle doesn't go outside the bar
      boxX = boxX + (handleW / 2);
      boxW = boxW - handleW;
    }

    // Percent that the click is through the adjusted area
    return Math.max(0, Math.min(1, (event.pageX - boxX) / boxW));
  },

  onFocus: function(event){
    _V_.addEvent(document, "keyup", _V_.proxy(this, this.onKeyPress));
  },

  onKeyPress: function(event){
    if (event.which == 37) { // Left Arrow
      event.preventDefault();
      this.stepBack();
    } else if (event.which == 39) { // Right Arrow
      event.preventDefault();
      this.stepForward();
    }
  },

  onBlur: function(event){
    _V_.removeEvent(document, "keyup", _V_.proxy(this, this.onKeyPress));
  }
});


/* Progress
================================================================================ */

// Progress Control: Seek, Load Progress, and Play Progress
_V_.ProgressControl = _V_.Component.extend({

  options: {
    components: {
      "seekBar": {}
    }
  },

  createElement: function(){
    return this._super("div", {
      className: "vjs-progress-control vjs-control"
    });
  }

});

// Seek Bar and holder for the progress bars
_V_.SeekBar = _V_.Slider.extend({

  options: {
    components: {
      "loadProgressBar": {},

      // Set property names to bar and handle to match with the parent Slider class is looking for
      "bar": { componentClass: "PlayProgressBar" },
      "handle": { componentClass: "SeekHandle" }
    }
  },

  playerEvent: "timeupdate",

  init: function(player, options){
    this._super(player, options);
  },

  createElement: function(){
    return this._super("div", {
      className: "vjs-progress-holder"
    });
  },

  getPercent: function(){
    return this.player.currentTime() / this.player.duration();
  },

  onMouseDown: function(event){
    this._super(event);

    this.player.scrubbing = true;

    this.videoWasPlaying = !this.player.paused();
    this.player.pause();
  },

  onMouseMove: function(event){
    var newTime = this.calculateDistance(event) * this.player.duration();

    // Don't let video end while scrubbing.
    if (newTime == this.player.duration()) { newTime = newTime - 0.1; }

    // Set new time (tell player to seek to new time)
    this.player.currentTime(newTime);
  },

  onMouseUp: function(event){
    this._super(event);

    this.player.scrubbing = false;
    if (this.videoWasPlaying) {
      this.player.play();
    }
  },

  stepForward: function(){
    this.player.currentTime(this.player.currentTime() + 1);
  },

  stepBack: function(){
    this.player.currentTime(this.player.currentTime() - 1);
  }

});

// Load Progress Bar
_V_.LoadProgressBar = _V_.Component.extend({

  init: function(player, options){
    this._super(player, options);
    player.addEvent("progress", _V_.proxy(this, this.update));
  },

  createElement: function(){
    return this._super("div", {
      className: "vjs-load-progress",
      innerHTML: '<span class="vjs-control-text" aria-hidden="true">Loaded: 0%</span>'
    });
  },

  update: function(){
    if (this.el.style) { this.el.style.width = _V_.round(this.player.bufferedPercent() * 100, 2) + "%"; }
  }

});

// Play Progress Bar
_V_.PlayProgressBar = _V_.Component.extend({

  createElement: function(){
    return this._super("div", {
      className: "vjs-play-progress",
      innerHTML: '<span class="vjs-control-text" aria-hidden="true">Progress: 0%</span>'
    });
  }

});

// Seek Handle
// SeekBar Behavior includes play progress bar, and seek handle
// Needed so it can determine seek position based on handle position/size
_V_.SeekHandle = _V_.Component.extend({

  createElement: function(){
    return this._super("div", {
      className: "vjs-seek-handle",
      innerHTML: '<span class="vjs-control-text" aria-hidden="true">00:00</span>'
    });
  }

});

/* Volume Scrubber
================================================================================ */
// Progress Control: Seek, Load Progress, and Play Progress
_V_.VolumeControl = _V_.Component.extend({

  options: {
    components: {
      "volumeBar": {}
    }
  },

  createElement: function(){
    return this._super("div", {
      className: "vjs-volume-control vjs-control"
    });
  }

});

_V_.VolumeBar = _V_.Slider.extend({

  options: {
    components: {
      "bar": { componentClass: "VolumeLevel" },
      "handle": { componentClass: "VolumeHandle" }
    }
  },

  playerEvent: "volumechange",

  createElement: function(){
    return this._super("div", {
      className: "vjs-volume-bar"
    });
  },

  onMouseMove: function(event) {
    this.player.volume(this.calculateDistance(event));
  },

  getPercent: function(){
   return this.player.volume();
  },

  stepForward: function(){
    this.player.volume(this.player.volume() + 0.1);
  },

  stepBack: function(){
    this.player.volume(this.player.volume() - 0.1);
  }
});

_V_.VolumeLevel = _V_.Component.extend({

  createElement: function(){
    return this._super("div", {
      className: "vjs-volume-level",
      innerHTML: '<span class="vjs-control-text"></span>'
    });
  }

});

_V_.VolumeHandle = _V_.Component.extend({

  createElement: function(){
    return this._super("div", {
      className: "vjs-volume-handle",
      innerHTML: '<span class="vjs-control-text"></span>'
      // tabindex: 0,
      // role: "slider", "aria-valuenow": 0, "aria-valuemin": 0, "aria-valuemax": 100
    });
  }

});

_V_.MuteToggle = _V_.Button.extend({

  init: function(player, options){
    this._super(player, options);

    player.addEvent("volumechange", _V_.proxy(this, this.update));
  },

  createElement: function(){
    return this._super("div", {
      className: "vjs-mute-control vjs-control",
      innerHTML: '<div><span class="vjs-control-text">Mute</span></div>'
    });
  },

  onClick: function(event){
    this.player.muted( this.player.muted() ? false : true );
  },

  update: function(event){
    var vol = this.player.volume(),
        level = 3;

    if (vol == 0 || this.player.muted()) {
      level = 0;
    } else if (vol < 0.33) {
      level = 1;
    } else if (vol < 0.67) {
      level = 2;
    }

    /* TODO improve muted icon classes */
    _V_.each.call(this, [0,1,2,3], function(i){
      _V_.removeClass(this.el, "vjs-vol-"+i);
    });
    _V_.addClass(this.el, "vjs-vol-"+level);
  }

});


/* Poster Image
================================================================================ */
_V_.PosterImage = _V_.Button.extend({
  init: function(player, options){
    this._super(player, options);

    if (!this.player.options.poster) {
      this.hide();
    }

    player.addEvent("play", _V_.proxy(this, this.hide));
    //player.addEvent("pause", _V_.proxy(this, this.show));
    player.addEvent("ended", _V_.proxy(this, this.show));

    player.addEvent("playlistchange", _V_.proxy(this, function(){
      this.el.setAttribute('src', this.player.tag.poster);
      this.show();
    }));

  },

  createElement: function(){
    return _V_.createElement("img", {
      className: "vjs-poster",
      src: this.player.options.poster,

      // Don't want poster to be tabbable.
      tabIndex: -1
    });
  },

  onClick: function(){
    this.player.play();
  }
});


/* Menu
================================================================================ */
// The base for text track and settings menu buttons.
_V_.Menu = _V_.Component.extend({

  init: function(player, options){
    this._super(player, options);
  },

  addItem: function(component){
    this.addComponent(component);
    component.addEvent("click", this.proxy(function(){
      this.unlockShowing();
    }));
  },

  createElement: function(){
    return this._super("ul", {
      className: "vjs-menu"
    });
  }

});

_V_.MenuItem = _V_.Button.extend({

  init: function(player, options){
    this._super(player, options);

    if (options.selected) {
      this.addClass("vjs-selected");
    }
  },

  createElement: function(type, attrs){
    return this._super("li", _V_.merge({
      className: "vjs-menu-item",
      innerHTML: this.options.label
    }, attrs));
  },

  onClick: function(){
    this.selected(true);
  },

  selected: function(selected){
    if (selected) {
      this.addClass("vjs-selected");
    } else {
      this.removeClass("vjs-selected")
    }
  }

});
// ECMA-262 is the standard for javascript.
// The following methods are impelemented EXACTLY as described in the standard (according to Mozilla Docs), and do not override the default method if one exists.
// This may conflict with other libraries that modify the array prototype, but those libs should update to use the standard.

// [].indexOf
// https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/indexOf
if (!Array.prototype.indexOf) {
    Array.prototype.indexOf = function (searchElement /*, fromIndex */ ) {
        "use strict";
        if (this === void 0 || this === null) {
            throw new TypeError();
        }
        var t = Object(this);
        var len = t.length >>> 0;
        if (len === 0) {
            return -1;
        }
        var n = 0;
        if (arguments.length > 0) {
            n = Number(arguments[1]);
            if (n !== n) { // shortcut for verifying if it's NaN
                n = 0;
            } else if (n !== 0 && n !== (1 / 0) && n !== -(1 / 0)) {
                n = (n > 0 || -1) * Math.floor(Math.abs(n));
            }
        }
        if (n >= len) {
            return -1;
        }
        var k = n >= 0 ? n : Math.max(len - Math.abs(n), 0);
        for (; k < len; k++) {
            if (k in t && t[k] === searchElement) {
                return k;
            }
        }
        return -1;
    }
}

// NOT NEEDED YET
// [].lastIndexOf
// https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/lastIndexOf
// if (!Array.prototype.lastIndexOf)
// {
//   Array.prototype.lastIndexOf = function(searchElement /*, fromIndex*/)
//   {
//     "use strict";
// 
//     if (this === void 0 || this === null)
//       throw new TypeError();
// 
//     var t = Object(this);
//     var len = t.length >>> 0;
//     if (len === 0)
//       return -1;
// 
//     var n = len;
//     if (arguments.length > 1)
//     {
//       n = Number(arguments[1]);
//       if (n !== n)
//         n = 0;
//       else if (n !== 0 && n !== (1 / 0) && n !== -(1 / 0))
//         n = (n > 0 || -1) * Math.floor(Math.abs(n));
//     }
// 
//     var k = n >= 0
//           ? Math.min(n, len - 1)
//           : len - Math.abs(n);
// 
//     for (; k >= 0; k--)
//     {
//       if (k in t && t[k] === searchElement)
//         return k;
//     }
//     return -1;
//   };
// }


// NOT NEEDED YET
// Array forEach per ECMA standard https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/array/foreach
// Production steps of ECMA-262, Edition 5, 15.4.4.18
// Reference: http://es5.github.com/#x15.4.4.18
// if ( !Array.prototype.forEach ) {
// 
//   Array.prototype.forEach = function( callback, thisArg ) {
// 
//     var T, k;
// 
//     if ( this == null ) {
//       throw new TypeError( " this is null or not defined" );
//     }
// 
//     // 1. Let O be the result of calling ToObject passing the |this| value as the argument.
//     var O = Object(this);
// 
//     // 2. Let lenValue be the result of calling the Get internal method of O with the argument "length".
//     // 3. Let len be ToUint32(lenValue).
//     var len = O.length >>> 0;
// 
//     // 4. If IsCallable(callback) is false, throw a TypeError exception.
//     // See: http://es5.github.com/#x9.11
//     if ( {}.toString.call(callback) != "[object Function]" ) {
//       throw new TypeError( callback + " is not a function" );
//     }
// 
//     // 5. If thisArg was supplied, let T be thisArg; else let T be undefined.
//     if ( thisArg ) {
//       T = thisArg;
//     }
// 
//     // 6. Let k be 0
//     k = 0;
// 
//     // 7. Repeat, while k < len
//     while( k < len ) {
// 
//       var kValue;
// 
//       // a. Let Pk be ToString(k).
//       //   This is implicit for LHS operands of the in operator
//       // b. Let kPresent be the result of calling the HasProperty internal method of O with argument Pk.
//       //   This step can be combined with c
//       // c. If kPresent is true, then
//       if ( k in O ) {
// 
//         // i. Let kValue be the result of calling the Get internal method of O with argument Pk.
//         kValue = O[ Pk ];
// 
//         // ii. Call the Call internal method of callback with T as the this value and
//         // argument list containing kValue, k, and O.
//         callback.call( T, kValue, k, O );
//       }
//       // d. Increase k by 1.
//       k++;
//     }
//     // 8. return undefined
//   };
// }


// NOT NEEDED YET
// https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/map
// Production steps of ECMA-262, Edition 5, 15.4.4.19
// Reference: http://es5.github.com/#x15.4.4.19
// if (!Array.prototype.map) {
//   Array.prototype.map = function(callback, thisArg) {
// 
//     var T, A, k;
// 
//     if (this == null) {
//       throw new TypeError(" this is null or not defined");
//     }
// 
//     // 1. Let O be the result of calling ToObject passing the |this| value as the argument.
//     var O = Object(this);
// 
//     // 2. Let lenValue be the result of calling the Get internal method of O with the argument "length".
//     // 3. Let len be ToUint32(lenValue).
//     var len = O.length >>> 0;
// 
//     // 4. If IsCallable(callback) is false, throw a TypeError exception.
//     // See: http://es5.github.com/#x9.11
//     if ({}.toString.call(callback) != "[object Function]") {
//       throw new TypeError(callback + " is not a function");
//     }
// 
//     // 5. If thisArg was supplied, let T be thisArg; else let T be undefined.
//     if (thisArg) {
//       T = thisArg;
//     }
// 
//     // 6. Let A be a new array created as if by the expression new Array(len) where Array is
//     // the standard built-in constructor with that name and len is the value of len.
//     A = new Array(len);
// 
//     // 7. Let k be 0
//     k = 0;
// 
//     // 8. Repeat, while k < len
//     while(k < len) {
// 
//       var kValue, mappedValue;
// 
//       // a. Let Pk be ToString(k).
//       //   This is implicit for LHS operands of the in operator
//       // b. Let kPresent be the result of calling the HasProperty internal method of O with argument Pk.
//       //   This step can be combined with c
//       // c. If kPresent is true, then
//       if (k in O) {
// 
//         // i. Let kValue be the result of calling the Get internal method of O with argument Pk.
//         kValue = O[ k ];
// 
//         // ii. Let mappedValue be the result of calling the Call internal method of callback
//         // with T as the this value and argument list containing kValue, k, and O.
//         mappedValue = callback.call(T, kValue, k, O);
// 
//         // iii. Call the DefineOwnProperty internal method of A with arguments
//         // Pk, Property Descriptor {Value: mappedValue, Writable: true, Enumerable: true, Configurable: true},
//         // and false.
// 
//         // In browsers that support Object.defineProperty, use the following:
//         // Object.defineProperty(A, Pk, { value: mappedValue, writable: true, enumerable: true, configurable: true });
// 
//         // For best browser support, use the following:
//         A[ k ] = mappedValue;
//       }
//       // d. Increase k by 1.
//       k++;
//     }
// 
//     // 9. return A
//     return A;
//   };      
// }
// Event System (J.Resig - Secrets of a JS Ninja http://jsninja.com/ [Go read it, really])
// (Book version isn't completely usable, so fixed some things and borrowed from jQuery where it's working)
// 
// This should work very similarly to jQuery's events, however it's based off the book version which isn't as
// robust as jquery's, so there's probably some differences.
// 
// When you add an event listener using _V_.addEvent, 
//   it stores the handler function in seperate cache object, 
//   and adds a generic handler to the element's event,
//   along with a unique id (guid) to the element.

_V_.extend({

  // Add an event listener to element
  // It stores the handler function in a separate cache object
  // and adds a generic handler to the element's event,
  // along with a unique id (guid) to the element.
  addEvent: function(elem, type, fn){
    var data = _V_.getData(elem), handlers;

    // We only need to generate one handler per element
    if (data && !data.handler) {
      // Our new meta-handler that fixes the event object and the context
      data.handler = function(event){
        event = _V_.fixEvent(event);
        var handlers = _V_.getData(elem).events[event.type];
        // Go through and call all the real bound handlers
        if (handlers) {
          
          // Copy handlers so if handlers are added/removed during the process it doesn't throw everything off.
          var handlersCopy = [];
          _V_.each(handlers, function(handler, i){
            handlersCopy[i] = handler;
          })
          
          for (var i = 0, l = handlersCopy.length; i < l; i++) {
            handlersCopy[i].call(elem, event);
          }
        }
      };
    }

    // We need a place to store all our event data
    if (!data.events) { data.events = {}; }

    // And a place to store the handlers for this event type
    handlers = data.events[type];

    if (!handlers) {
      handlers = data.events[ type ] = [];

      // Attach our meta-handler to the element, since one doesn't exist
      if (document.addEventListener || elem.addEventListener) {
        elem.addEventListener(type, data.handler, false);
      } else if (document.attachEvent && elem.attachEvent) {
        elem.attachEvent("on" + type, data.handler);
      }
    }

    if (!fn.guid) { fn.guid = _V_.guid++; }

    handlers.push(fn);
  },

  removeEvent: function(elem, type, fn) {
    var data = _V_.getData(elem), handlers;
    // If no events exist, nothing to unbind
    if (!data.events) { return; }

    // Are we removing all bound events?
    if (!type) {
      for (type in data.events) {
        _V_.cleanUpEvents(elem, type);
      }
      return;
    }

    // And a place to store the handlers for this event type
    handlers = data.events[type];

    // If no handlers exist, nothing to unbind
    if (!handlers) { return; }

    // See if we're only removing a single handler
    if (fn && fn.guid) {
      for (var i = 0; i < handlers.length; i++) {
        // We found a match (don't stop here, there could be a couple bound)
        if (handlers[i].guid === fn.guid) {
          // Remove the handler from the array of handlers
          handlers.splice(i--, 1);
        }
      }
    }

    _V_.cleanUpEvents(elem, type);
  },

  cleanUpEvents: function(elem, type) {
    var data = _V_.getData(elem);
    // Remove the events of a particular type if there are none left

    if (data.events[type].length === 0) {
      delete data.events[type];

      // Remove the meta-handler from the element
      if (document.removeEventListener || elem.removeEventListener) {
        elem.removeEventListener(type, data.handler, false);
      } else if (document.detachEvent || elem.detachEvent) {
        elem.detachEvent("on" + type, data.handler);
      }
    }

    // Remove the events object if there are no types left
    if (_V_.isEmpty(data.events)) {
      delete data.events;
      delete data.handler;
    }

    // Finally remove the expando if there is no data left
    if (_V_.isEmpty(data)) {
      _V_.removeData(elem);
    }
  },

  fixEvent: function(event) {
    if (event[_V_.expando]) { return event; }
    // store a copy of the original event object
    // and "clone" to set read-only properties
    var originalEvent = event;
    event = new _V_.Event(originalEvent);

    for ( var i = _V_.Event.props.length, prop; i; ) {
      prop = _V_.Event.props[ --i ];
      event[prop] = originalEvent[prop];
    }

    // Fix target property, if necessary
    if (!event.target) { event.target = event.srcElement || document; }

    // check if target is a textnode (safari)
    if (event.target.nodeType === 3) { event.target = event.target.parentNode; }

    // Add relatedTarget, if necessary
    if (!event.relatedTarget && event.fromElement) {
      event.relatedTarget = event.fromElement === event.target ? event.toElement : event.fromElement;
    }

    // Calculate pageX/Y if missing and clientX/Y available
    if ( event.pageX == null && event.clientX != null ) {
      var eventDocument = event.target.ownerDocument || document,
        doc = eventDocument.documentElement,
        body = eventDocument.body;

      event.pageX = event.clientX + (doc && doc.scrollLeft || body && body.scrollLeft || 0) - (doc && doc.clientLeft || body && body.clientLeft || 0);
      event.pageY = event.clientY + (doc && doc.scrollTop  || body && body.scrollTop  || 0) - (doc && doc.clientTop  || body && body.clientTop  || 0);
    }

    // Add which for key events
    if (event.which == null && (event.charCode != null || event.keyCode != null)) {
      event.which = event.charCode != null ? event.charCode : event.keyCode;
    }

    // Add metaKey to non-Mac browsers (use ctrl for PC's and Meta for Macs)
    if ( !event.metaKey && event.ctrlKey ) {
      event.metaKey = event.ctrlKey;
    }

    // Add which for click: 1 === left; 2 === middle; 3 === right
    // Note: button is not normalized, so don't use it
    if ( !event.which && event.button !== undefined ) {
      event.which = (event.button & 1 ? 1 : ( event.button & 2 ? 3 : ( event.button & 4 ? 2 : 0 ) ));
    }

    return event;
  },

  triggerEvent: function(elem, event) {
    var data = _V_.getData(elem),
        parent = elem.parentNode || elem.ownerDocument,
        type = event.type || event,
        handler;

    if (data) { handler = data.handler }

    // Added in attion to book. Book code was broke.
    event = typeof event === "object" ?
      event[_V_.expando] ? 
        event :
        new _V_.Event(type, event) :
      new _V_.Event(type);

    event.type = type;
    if (handler) {
      handler.call(elem, event);
    }

    // Clean up the event in case it is being reused
    event.result = undefined;
    event.target = elem;

    // Bubble the event up the tree to the document,
    // Unless it's been explicitly stopped
    // if (parent && !event.isPropagationStopped()) {
    //   _V_.triggerEvent(parent, event);
    // 
    // // We're at the top document so trigger the default action
    // } else if (!parent && !event.isDefaultPrevented()) {
    //   // log(type);
    //   var targetData = _V_.getData(event.target);
    //   // log(targetData);
    //   var targetHandler = targetData.handler;
    //   // log("2");
    //   if (event.target[event.type]) {
    //     // Temporarily disable the bound handler,
    //     // don't want to execute it twice
    //     if (targetHandler) {
    //       targetData.handler = function(){};
    //     }
    // 
    //     // Trigger the native event (click, focus, blur)
    //     event.target[event.type]();
    // 
    //     // Restore the handler
    //     if (targetHandler) {
    //       targetData.handler = targetHandler;
    //     }
    //   }
    // }
  },
  
  one: function(elem, type, fn) {
    _V_.addEvent(elem, type, function(){
      _V_.removeEvent(elem, type, arguments.callee)
      fn.apply(this, arguments);
    });
  }
});

// Custom Event object for standardizing event objects between browsers.
_V_.Event = function(src, props){
  // Event object
  if (src && src.type) {
    this.originalEvent = src;
    this.type = src.type;

    // Events bubbling up the document may have been marked as prevented
    // by a handler lower down the tree; reflect the correct value.
    this.isDefaultPrevented = (src.defaultPrevented || src.returnValue === false ||
      src.getPreventDefault && src.getPreventDefault()) ? returnTrue : returnFalse;

  // Event type
  } else {
    this.type = src;
  }

  // Put explicitly provided properties onto the event object
  if (props) { _V_.merge(this, props); }

  this.timeStamp = (new Date).getTime();

  // Mark it as fixed
  this[_V_.expando] = true;
};

_V_.Event.prototype = {
  preventDefault: function() {
    this.isDefaultPrevented = returnTrue;

    var e = this.originalEvent;
    if (!e) { return; }

    // if preventDefault exists run it on the original event
    if (e.preventDefault) { 
      e.preventDefault();
    // otherwise set the returnValue property of the original event to false (IE)
    } else {
      e.returnValue = false;
    }
  },
  stopPropagation: function() {
    this.isPropagationStopped = returnTrue;

    var e = this.originalEvent;
    if (!e) { return; }
    // if stopPropagation exists run it on the original event
    if (e.stopPropagation) { e.stopPropagation(); }
    // otherwise set the cancelBubble property of the original event to true (IE)
    e.cancelBubble = true;
  },
  stopImmediatePropagation: function() {
    this.isImmediatePropagationStopped = returnTrue;
    this.stopPropagation();
  },
  isDefaultPrevented: returnFalse,
  isPropagationStopped: returnFalse,
  isImmediatePropagationStopped: returnFalse
};
_V_.Event.props = "altKey attrChange attrName bubbles button cancelable charCode clientX clientY ctrlKey currentTarget data detail eventPhase fromElement handler keyCode metaKey newValue offsetX offsetY pageX pageY prevValue relatedNode relatedTarget screenX screenY shiftKey srcElement target toElement view wheelDelta which".split(" ");

function returnTrue(){ return true; }
function returnFalse(){ return false; }

// Javascript JSON implementation
// (Parse Method Only)
// https://github.com/douglascrockford/JSON-js/blob/master/json2.js

var JSON;
if (!JSON) { JSON = {}; }

(function(){
  var cx = /[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;

  if (typeof JSON.parse !== 'function') {
      JSON.parse = function (text, reviver) {
          var j;

          function walk(holder, key) {
              var k, v, value = holder[key];
              if (value && typeof value === 'object') {
                  for (k in value) {
                      if (Object.prototype.hasOwnProperty.call(value, k)) {
                          v = walk(value, k);
                          if (v !== undefined) {
                              value[k] = v;
                          } else {
                              delete value[k];
                          }
                      }
                  }
              }
              return reviver.call(holder, key, value);
          }
          text = String(text);
          cx.lastIndex = 0;
          if (cx.test(text)) {
              text = text.replace(cx, function (a) {
                  return '\\u' +
                      ('0000' + a.charCodeAt(0).toString(16)).slice(-4);
              });
          }

          if (/^[\],:{}\s]*$/
                  .test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g, '@')
                      .replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g, ']')
                      .replace(/(?:^|:|,)(?:\s*\[)+/g, ''))) {

              j = eval('(' + text + ')');

              return typeof reviver === 'function' ?
                  walk({'': j}, '') : j;
          }

          throw new SyntaxError('JSON.parse');
      };
  }
}());
/* UI Component- Base class for all UI objects
================================================================================ */
_V_.Player = _V_.Component.extend({

  init: function(tag, addOptions, ready){

    this.tag = tag; // Store the original tag used to set options

    var el = this.el = _V_.createElement("div"), // Div to contain video and controls
        options = this.options = {};

    // Set Options
    _V_.merge(options, _V_.options); // Copy Global Defaults
    _V_.merge(options, this.getVideoTagSettings()); // Override with Video Tag Options
    _V_.merge(options, addOptions); // Override/extend with options from setup call

    // Add callback to ready queue
    this.ready(ready);

    // Store controls setting, and then remove immediately so native controls don't flash.
    tag.removeAttribute("controls");

    // Poster will be handled by a manual <img>
    //tag.removeAttribute("poster");

    // Make player findable on elements
    tag.player = el.player = this;

    // Wrap video tag in div (el/box) container
    tag.parentNode.insertBefore(el, tag);
    el.appendChild(tag); // Breaks iPhone, fixed in HTML5 setup.

    // Give video tag properties to box
    // ID will now reference box, not the video tag
    this.id = el.id = tag.id;
    el.className = tag.className;

    // Update tag id/class for use as HTML5 playback tech
    tag.id += "_html5_api";
    tag.className = "vjs-tech";

    // Make player easily findable by ID
    _V_.players[el.id] = this;

    // Make box use width/height of tag, or default 300x150
    el.setAttribute("width", options.width);
    el.setAttribute("height", options.height);

    // Enforce with CSS since width/height attrs don't work on divs
    el.style.width = options.width+"px";
    el.style.height = options.height+"px";

    // Remove width/height attrs from tag so CSS can make it 100% width/height
    tag.removeAttribute("width");
    tag.removeAttribute("height");

    // Empty video tag sources and tracks so the built-in player doesn't use them also.
    if (tag.hasChildNodes()) {
      for (var i=0,j=tag.childNodes;i<j.length;i++) {
        if (j[i].nodeName == "SOURCE" || j[i].nodeName == "TRACK") {
          tag.removeChild(j[i]);
        }
      }
    }

    // Cache for video property values.
    this.values = {};

    this.addClass("vjs-paused");

    this.addEvent("ended", this.onEnded);
    this.addEvent("play", this.onPlay);
    this.addEvent("pause", this.onPause);
    this.addEvent("progress", this.onProgress);
    this.addEvent("error", this.onError);

    // When the API is ready, loop through the components and add to the player.
    if (options.controls) {
      this.ready(function(){
        this.initComponents();
      });
    }

    // Tracks defined in tracks.js
    this.textTracks = [];
    if (options.tracks && options.tracks.length > 0) {
      this.addTextTracks(options.tracks);
    }

    // If there are no sources when the player is initialized,
    // load the first supported playback technology.
    if (!options.sources || options.sources.length == 0) {
      for (var i=0,j=options.techOrder; i<j.length; i++) {
        var techName = j[i],
            tech = _V_[techName];

        // Check if the browser supports this technology
        if (tech.isSupported()) {
          this.loadTech(techName);
          break;
        }
      }
    } else {
      // Loop through playback technologies (HTML5, Flash) and check for support. Then load the best source.
      // A few assumptions here:
      //   All playback technologies respect preload false.
      this.src(options.sources);
    }
  },

  // Cache for video property values.
  values: {},

  destroy: function(){
    // Ensure that tracking progress and time progress will stop and plater deleted
    this.stopTrackingProgress();
    this.stopTrackingCurrentTime();
    _V_.players[this.id] = null;
    delete _V_.players[this.id];
    this.tech.destroy();
    this.el.parentNode.removeChild(this.el);
  },

  createElement: function(type, options){},

  getVideoTagSettings: function(){
    var options = {
      sources: [],
      tracks: []
    },
    tag = this.tag,
    getAttribute = "getAttribute"; // For better minification

    options.src = tag[getAttribute]("src");
    options.controls = tag[getAttribute]("controls") !== null;
    options.poster = tag[getAttribute]("poster");
    options.preload = tag[getAttribute]("preload");
    options.autoplay = tag[getAttribute]("autoplay") !== null; // hasAttribute not IE <8 compatible
    options.loop = tag[getAttribute]("loop") !== null;
    options.muted = tag[getAttribute]("muted") !== null;

    if (this.tag.hasChildNodes()) {
      for (var c,i=0,j=this.tag.childNodes;i<j.length;i++) {
        c = j[i];
        if (c.nodeName == "SOURCE") {
          options.sources.push({
            src: c[getAttribute]('src'),
            type: c[getAttribute]('type'),
            media: c[getAttribute]('media'),
            title: c[getAttribute]('title')
          });
        }
        if (c.nodeName == "TRACK") {
          options.tracks.push({
            src: c[getAttribute]("src"),
            kind: c[getAttribute]("kind"),
            srclang: c[getAttribute]("srclang"),
            label: c[getAttribute]("label"),
            'default': c[getAttribute]("default") !== null,
            title: c[getAttribute]("title")
          });
        }
      }
    }
    return options;
  },

  /* PLayback Technology (tech)
  ================================================================================ */
  // Load/Create an instance of playback technlogy including element and API methods
  // And append playback element in player div.
  loadTech: function(techName, source){

    // Pause and remove current playback technology
    if (this.tech) {
      this.unloadTech();

    // If the first time loading, HTML5 tag will exist but won't be initialized
    // So we need to remove it if we're not loading HTML5
    } else if (techName != "html5" && this.tag) {
      this.el.removeChild(this.tag);
      this.tag = false;
    }

    this.techName = techName;

    // Turn off API access because we're loading a new tech that might load asynchronously
    this.isReady = false;

    var techReady = function(){
      this.player.triggerReady();

      // Manually track progress in cases where the browser/flash player doesn't report it.
      if (!this.support.progressEvent) {
        this.player.manualProgressOn();
      }

      // Manually track timeudpates in cases where the browser/flash player doesn't report it.
      if (!this.support.timeupdateEvent) {
        this.player.manualTimeUpdatesOn();
      }
    }

    // Grab tech-specific options from player options and add source and parent element to use.
    var techOptions = _V_.merge({ source: source, parentEl: this.el }, this.options[techName])

    if (source) {
      if (source.src == this.values.src && this.values.currentTime > 0) {
        techOptions.startTime = this.values.currentTime;
      }

      this.values.src = source.src;
    }

    // Initialize tech instance
    this.tech = new _V_[techName](this, techOptions);
    this.tech.ready(techReady);
  },

  unloadTech: function(){
    this.tech.destroy();

    // Turn off any manual progress or timeupdate tracking
    if (this.manualProgress) { this.manualProgressOff(); }

    if (this.manualTimeUpdates) { this.manualTimeUpdatesOff(); }

    this.tech = false;
  },

  // There's many issues around changing the size of a Flash (or other plugin) object.
  // First is a plugin reload issue in Firefox that has been around for 11 years: https://bugzilla.mozilla.org/show_bug.cgi?id=90268
  // Then with the new fullscreen API, Mozilla and webkit browsers will reload the flash object after going to fullscreen.
  // To get around this, we're unloading the tech, caching source and currentTime values, and reloading the tech once the plugin is resized.
  // reloadTech: function(betweenFn){
  //   _V_.log("unloadingTech")
  //   this.unloadTech();
  //   _V_.log("unloadedTech")
  //   if (betweenFn) { betweenFn.call(); }
  //   _V_.log("LoadingTech")
  //   this.loadTech(this.techName, { src: this.values.src })
  //   _V_.log("loadedTech")
  // },

  /* Fallbacks for unsupported event types
  ================================================================================ */
  // Manually trigger progress events based on changes to the buffered amount
  // Many flash players and older HTML5 browsers don't send progress or progress-like events
  manualProgressOn: function(){
    this.manualProgress = true;

    // Trigger progress watching when a source begins loading
    this.trackProgress();

    // Watch for a native progress event call on the tech element
    // In HTML5, some older versions don't support the progress event
    // So we're assuming they don't, and turning off manual progress if they do.
    this.tech.addEvent("progress", function(){

      // Remove this listener from the element
      this.removeEvent("progress", arguments.callee);

      // Update known progress support for this playback technology
      this.support.progressEvent = true;

      // Turn off manual progress tracking
      this.player.manualProgressOff();
    });
  },

  manualProgressOff: function(){
    this.manualProgress = false;
    this.stopTrackingProgress();
  },

  trackProgress: function(){
    this.progressInterval = setInterval(_V_.proxy(this, function(){
      // Don't trigger unless buffered amount is greater than last time
      // log(this.values.bufferEnd, this.buffered().end(0), this.duration())
      /* TODO: update for multiple buffered regions */
      if (this.values.bufferEnd < this.buffered().end(0)) {
        this.triggerEvent("progress");
      } else if (this.bufferedPercent() == 1) {
        this.stopTrackingProgress();
        this.triggerEvent("progress"); // Last update
      }
    }), 500);
  },
  stopTrackingProgress: function(){ clearInterval(this.progressInterval); },

  /* Time Tracking -------------------------------------------------------------- */
  manualTimeUpdatesOn: function(){
    this.manualTimeUpdates = true;

    this.addEvent("play", this.trackCurrentTime);
    this.addEvent("pause", this.stopTrackingCurrentTime);
    // timeupdate is also called by .currentTime whenever current time is set

    // Watch for native timeupdate event
    this.tech.addEvent("timeupdate", function(){

      // Remove this listener from the element
      this.removeEvent("timeupdate", arguments.callee);

      // Update known progress support for this playback technology
      this.support.timeupdateEvent = true;

      // Turn off manual progress tracking
      this.player.manualTimeUpdatesOff();
    });
  },

  manualTimeUpdatesOff: function(){
    this.manualTimeUpdates = false;
    this.stopTrackingCurrentTime();
    this.removeEvent("play", this.trackCurrentTime);
    this.removeEvent("pause", this.stopTrackingCurrentTime);
  },

  trackCurrentTime: function(){
    if (this.currentTimeInterval) { this.stopTrackingCurrentTime(); }
    this.currentTimeInterval = setInterval(_V_.proxy(this, function(){
      this.triggerEvent("timeupdate");
    }), 250); // 42 = 24 fps // 250 is what Webkit uses // FF uses 15
  },

  // Turn off play progress tracking (when paused or dragging)
  stopTrackingCurrentTime: function(){ clearInterval(this.currentTimeInterval); },

  /* Player event handlers (how the player reacts to certain events)
  ================================================================================ */
  onEnded: function(){
    if (this.options.loop) {
      this.currentTime(0);
      this.play();
    }
    /*
     * To clarify, we did some testing to make sure things were working properly but I would recommend we do some more regression testing with the player.
     *
     * The issue was that when an audio track was finishing playing, the player dispatched an "end" event to indicate the end of track. The video skin listens for the end event and pauses the player, seeks to 0, then pauses again.
     *
     * In the OS shell app, we were noticing that the track would change and then the video js file would pause the player after so it would be stuck in that paused state.
     */
    /* else {
      this.pause();
      this.currentTime(0);
      this.pause();
    }*/
  },

  onPlay: function(){
    _V_.removeClass(this.el, "vjs-paused");
    _V_.addClass(this.el, "vjs-playing");
  },

  onPause: function(){
    _V_.removeClass(this.el, "vjs-playing");
    _V_.addClass(this.el, "vjs-paused");
  },

  onProgress: function(){
    // Add custom event for when source is finished downloading.
    if (this.bufferedPercent() == 1) {
      this.triggerEvent("loadedalldata");
    }
  },

  onError: function(e) {
    _V_.log("Video Error", e);
  },

/* Player API
================================================================================ */

  // Pass values to the playback tech
  techCall: function(method, arg){

    // If it's not ready yet, call method when it is
    if (!this.tech.isReady) {
      this.tech.ready(function(){
        this[method](arg);
      });

    // Otherwise call method now
    } else {
      try {
        this.tech[method](arg);
      } catch(e) {
        _V_.log(e);
      }
    }
  },

  // Get calls can't wait for the tech, and sometimes don't need to.
  techGet: function(method){

    // Make sure tech is ready
    if (this.tech.isReady) {

      // Flash likes to die and reload when you hide or reposition it.
      // In these cases the object methods go away and we get errors.
      // When that happens we'll catch the errors and inform tech that it's not ready any more.
      try {
        return this.tech[method]();
      } catch(e) {

        // When building additional tech libs, an expected method may not be defined yet
        if (this.tech[method] === undefined) {
          _V_.log("Video.js: " + method + " method not defined for "+this.techName+" playback technology.", e);

        } else {

          // When a method isn't available on the object it throws a TypeError
          if (e.name == "TypeError") {
            _V_.log("Video.js: " + method + " unavailable on "+this.techName+" playback technology element.", e);
            this.tech.isReady = false;

          } else {
            _V_.log(e);
          }
        }
      }
    }

    return;
  },

  // Method for calling methods on the current playback technology
  // techCall: function(method, arg){
  // 
  //   // if (this.isReady) {
  //   //   
  //   // } else {
  //   //   _V_.log("The playback technology API is not ready yet. Use player.ready(myFunction)."+" ["+method+"]", arguments.callee.caller.arguments.callee.caller.arguments.callee.caller)
  //   //   return false;
  //   //   // throw new Error("The playback technology API is not ready yet. Use player.ready(myFunction)."+" ["+method+"]");
  //   // }
  // },

  // http://dev.w3.org/html5/spec/video.html#dom-media-play
  play: function(){
    this.techCall("play");
    return this;
  },

  // http://dev.w3.org/html5/spec/video.html#dom-media-pause
  pause: function(){
    this.techCall("pause");
    return this;
  },
  
  // http://dev.w3.org/html5/spec/video.html#dom-media-paused
  // The initial state of paused should be true (in Safari it's actually false)
  paused: function(){
    return (this.techGet("paused") === false) ? false : true;
  },

  // http://dev.w3.org/html5/spec/video.html#dom-media-currenttime
  currentTime: function(seconds){
    if (seconds !== undefined) {

      // Cache the last set value for smoother scrubbing.
      this.values.lastSetCurrentTime = seconds;

      this.techCall("setCurrentTime", seconds);

      // Improve the accuracy of manual timeupdates
      if (this.manualTimeUpdates) { this.triggerEvent("timeupdate"); }

      return this;
    }

    // Cache last currentTime and return
    // Default to 0 seconds
    return this.values.currentTime = (this.techGet("currentTime") || 0);
  },

  // http://dev.w3.org/html5/spec/video.html#dom-media-duration
  // Duration should return NaN if not available. ParseFloat will turn false-ish values to NaN.
  duration: function(){
    return parseFloat(this.techGet("duration"));
  },

  // Calculates how much time is left. Not in spec, but useful.
  remainingTime: function(){
    return this.duration() - this.currentTime();
  },

  // http://dev.w3.org/html5/spec/video.html#dom-media-buffered
  // Buffered returns a timerange object. Kind of like an array of portions of the video that have been downloaded.
  // So far no browsers return more than one range (portion)
  buffered: function(){
    var buffered = this.techGet("buffered"),
        start = 0,
        end = this.values.bufferEnd = this.values.bufferEnd || 0, // Default end to 0 and store in values
        timeRange;

    if (buffered && buffered.length > 0 && buffered.end(0) !== end) {
      end = buffered.end(0);
      // Storing values allows them be overridden by setBufferedFromProgress
      this.values.bufferEnd = end;
    }

    return _V_.createTimeRange(start, end);
  },

  // Calculates amount of buffer is full. Not in spec but useful.
  bufferedPercent: function(){
    return (this.duration()) ? this.buffered().end(0) / this.duration() : 0;
  },

  // http://dev.w3.org/html5/spec/video.html#dom-media-volume
  volume: function(percentAsDecimal){
    var vol;

    if (percentAsDecimal !== undefined) {
      vol = Math.max(0, Math.min(1, parseFloat(percentAsDecimal))); // Force value to between 0 and 1
      this.values.volume = vol;
      this.techCall("setVolume", vol);
      _V_.setLocalStorage("volume", vol);
      return this;
    }

    // Default to 1 when returning current volume.
    vol = parseFloat(this.techGet("volume"));
    return (isNaN(vol)) ? 1 : vol;
  },

  // http://dev.w3.org/html5/spec/video.html#attr-media-muted
  muted: function(muted){
    if (muted !== undefined) {
      this.techCall("setMuted", muted);
      return this;
    }
    return this.techGet("muted") || false; // Default to false
  },

  // http://dev.w3.org/html5/spec/dimension-attributes.html#attr-dim-height
  // Video tag width/height only work in pixels. No percents.
  // We could potentially allow percents but won't for now until we can do testing around it.
  width: function(width, skipListeners){
    if (width !== undefined) {
      this.el.width = width;
      this.el.style.width = width+"px";

      // skipListeners allows us to avoid triggering the resize event when setting both width and height
      if (!skipListeners) { this.triggerEvent("resize"); }
      return this;
    }
    return parseInt(this.el.getAttribute("width"));
  },
  height: function(height){
    if (height !== undefined) {
      this.el.height = height;
      this.el.style.height = height+"px";
      this.triggerEvent("resize");
      return this;
    }
    return parseInt(this.el.getAttribute("height"));
  },
  // Set both width and height at the same time.
  size: function(width, height){
    // Skip resize listeners on width for optimization
    return this.width(width, true).height(height);
  },

  // Check if current tech can support native fullscreen (e.g. with built in controls lik iOS, so not our flash swf)
  supportsFullScreen: function(){ return this.techGet("supportsFullScreen") || false; },

  // Turn on fullscreen (or window) mode
  requestFullScreen: function(){
    var requestFullScreen = _V_.support.requestFullScreen;

    this.isFullScreen = true;

    // Check for browser element fullscreen support
    if (requestFullScreen) {

      // Trigger fullscreenchange event after change
      _V_.addEvent(document, requestFullScreen.eventName, this.proxy(function(){
        this.isFullScreen = document[requestFullScreen.isFullScreen];

        // If cancelling fullscreen, remove event listener.
        if (this.isFullScreen == false) {
          _V_.removeEvent(document, requestFullScreen.eventName, arguments.callee);
        }

        this.triggerEvent("fullscreenchange");
      }));

      // Flash and other plugins get reloaded when you take their parent to fullscreen.
      // To fix that we'll remove the tech, and reload it after the resize has finished.
      if (this.tech.support.fullscreenResize === false && this.options.flash.iFrameMode != true) {

        this.pause();
        this.unloadTech();

        _V_.addEvent(document, requestFullScreen.eventName, this.proxy(function(){
          _V_.removeEvent(document, requestFullScreen.eventName, arguments.callee);
          this.loadTech(this.techName, { src: this.values.src });
        }));

        this.el[requestFullScreen.requestFn]();

      } else {
        this.el[requestFullScreen.requestFn]();
      }

    } else if (this.tech.supportsFullScreen()) {
      this.triggerEvent("fullscreenchange");
      this.techCall("enterFullScreen");

    } else {
      this.triggerEvent("fullscreenchange");
      this.enterFullWindow();
    }

     return this;
   },

   cancelFullScreen: function(){
    var requestFullScreen = _V_.support.requestFullScreen;

    this.isFullScreen = false;

    // Check for browser element fullscreen support
    if (requestFullScreen) {

     // Flash and other plugins get reloaded when you take their parent to fullscreen.
     // To fix that we'll remove the tech, and reload it after the resize has finished.
     if (this.tech.support.fullscreenResize === false && this.options.flash.iFrameMode != true) {

       this.pause();
       this.unloadTech();

       _V_.addEvent(document, requestFullScreen.eventName, this.proxy(function(){
         _V_.removeEvent(document, requestFullScreen.eventName, arguments.callee);
         this.loadTech(this.techName, { src: this.values.src })
       }));

       document[requestFullScreen.cancelFn]();

     } else {
       document[requestFullScreen.cancelFn]();
     }

    } else if (this.tech.supportsFullScreen()) {
     this.techCall("exitFullScreen");
     this.triggerEvent("fullscreenchange");

    } else {
     this.exitFullWindow();
     this.triggerEvent("fullscreenchange");
    }

    return this;
  },

  // When fullscreen isn't supported we can stretch the video container to as wide as the browser will let us.
  enterFullWindow: function(){
    this.isFullWindow = true;

    // Storing original doc overflow value to return to when fullscreen is off
    this.docOrigOverflow = document.documentElement.style.overflow;

    // Add listener for esc key to exit fullscreen
    _V_.addEvent(document, "keydown", _V_.proxy(this, this.fullWindowOnEscKey));

    // Hide any scroll bars
    document.documentElement.style.overflow = 'hidden';

    // Apply fullscreen styles
    _V_.addClass(document.body, "vjs-full-window");
    _V_.addClass(this.el, "vjs-fullscreen");

    this.triggerEvent("enterFullWindow");
  },
  fullWindowOnEscKey: function(event){
    if (event.keyCode == 27) {
      if (this.isFullScreen == true) {
        this.cancelFullScreen();
      } else {
        this.exitFullWindow();
      }
    }
  },

  exitFullWindow: function(){
    this.isFullWindow = false;
    _V_.removeEvent(document, "keydown", this.fullWindowOnEscKey);

    // Unhide scroll bars.
    document.documentElement.style.overflow = this.docOrigOverflow;

    // Remove fullscreen styles
    _V_.removeClass(document.body, "vjs-full-window");
    _V_.removeClass(this.el, "vjs-fullscreen");

    // Resize the box, controller, and poster to original sizes
    // this.positionAll();
    this.triggerEvent("exitFullWindow");
  },

  selectSource: function(sources){

    // Loop through each playback technology in the options order
    for (var i=0,j=this.options.techOrder;i<j.length;i++) {
      var techName = j[i],
          tech = _V_[techName];
          // tech = _V_.tech[techName];

      // Check if the browser supports this technology
      if (tech.isSupported()) {

        // Loop through each source object
        for (var a=0,b=sources;a<b.length;a++) {
          var source = b[a];

          // Check if source can be played with this technology
          if (tech.canPlaySource.call(this, source)) {

            return { source: source, tech: techName };

          }
        }
      }
    }

    return false;
  },

  // src is a pretty powerful function
  // If you pass it an array of source objects, it will find the best source to play and use that object.src
  //   If the new source requires a new playback technology, it will switch to that.
  // If you pass it an object, it will set the source to object.src
  // If you pass it anything else (url string) it will set the video source to that
  src: function(source){
    // Case: Array of source objects to choose from and pick the best to play
    if (source instanceof Array) {

      var sourceTech = this.selectSource(source),
          source,
          techName;

      if (sourceTech) {
          source = sourceTech.source;
          techName = sourceTech.tech;

        // If this technology is already loaded, set source
        if (techName == this.techName) {
          this.src(source); // Passing the source object

        // Otherwise load this technology with chosen source
        } else {
          this.loadTech(techName, source);
        }
      } else {
        _V_.log("No compatible source and playback technology were found.")
      }

    // Case: Source object { src: "", type: "" ... }
    } else if (source instanceof Object) {

      if (_V_[this.techName].canPlaySource(source)) {
        this.src(source.src);
      } else {
        // Send through tech loop to check for a compatible technology.
        this.src([source]);
      }

    // Case: URL String (http://myvideo...)
    } else {
      // Cache for getting last set source
      this.values.src = source;

      if (!this.isReady) {
        this.ready(function(){
          this.src(source);
        });
      } else {
        this.techCall("src", source);
        if (this.options.preload == "auto") {
          this.load();
        }
        if (this.options.autoplay) {
          this.play();
        }
      }
    }
    return this;
  },

  // Begin loading the src data
  // http://dev.w3.org/html5/spec/video.html#dom-media-load
  load: function(){
    this.techCall("load");
    return this;
  },

  // http://dev.w3.org/html5/spec/video.html#dom-media-currentsrc
  currentSrc: function(){
    return this.techGet("currentSrc") || this.values.src || "";
  },

  // Attributes/Options
  preload: function(value){
    if (value !== undefined) {
      this.techCall("setPreload", value);
      this.options.preload = value;
      return this;
    }
    return this.techGet("preload");
  },
  autoplay: function(value){
    if (value !== undefined) {
      this.techCall("setAutoplay", value);
      this.options.autoplay = value;
      return this;
    }
    return this.techGet("autoplay", value);
  },
  loop: function(value){
    if (value !== undefined) {
      this.techCall("setLoop", value);
      this.options.loop = value;
      return this;
    }
    return this.techGet("loop");
  },

  controls: function(){ return this.options.controls; },
  poster: function(){ return this.techGet("poster"); },
  error: function(){ return this.techGet("error"); },
  ended: function(){ return this.techGet("ended"); }

  // Methods to add support for
  // networkState: function(){ return this.techCall("networkState"); },
  // readyState: function(){ return this.techCall("readyState"); },
  // seeking: function(){ return this.techCall("seeking"); },
  // initialTime: function(){ return this.techCall("initialTime"); },
  // startOffsetTime: function(){ return this.techCall("startOffsetTime"); },
  // played: function(){ return this.techCall("played"); },
  // seekable: function(){ return this.techCall("seekable"); },
  // videoTracks: function(){ return this.techCall("videoTracks"); },
  // audioTracks: function(){ return this.techCall("audioTracks"); },
  // videoWidth: function(){ return this.techCall("videoWidth"); },
  // videoHeight: function(){ return this.techCall("videoHeight"); },
  // defaultPlaybackRate: function(){ return this.techCall("defaultPlaybackRate"); },
  // playbackRate: function(){ return this.techCall("playbackRate"); },
  // mediaGroup: function(){ return this.techCall("mediaGroup"); },
  // controller: function(){ return this.techCall("controller"); },
  // defaultMuted: function(){ return this.techCall("defaultMuted"); }
});

// RequestFullscreen API
(function(){
  var requestFn,
      cancelFn,
      eventName,
      isFullScreen,
      playerProto = _V_.Player.prototype;

  // Current W3C Spec
  // http://dvcs.w3.org/hg/fullscreen/raw-file/tip/Overview.html#api
  // Mozilla Draft: https://wiki.mozilla.org/Gecko:FullScreenAPI#fullscreenchange_event
  if (document.cancelFullscreen !== undefined) {
    requestFn = "requestFullscreen";
    cancelFn = "exitFullscreen";
    eventName = "fullscreenchange";
    isFullScreen = "fullScreen";

  // Webkit (Chrome/Safari) and Mozilla (Firefox) have working implementaitons
  // that use prefixes and vary slightly from the new W3C spec. Specifically, using 'exit' instead of 'cancel',
  // and lowercasing the 'S' in Fullscreen.
  // Other browsers don't have any hints of which version they might follow yet, so not going to try to predict by loopeing through all prefixes.
  } else {

    _V_.each(["moz", "webkit"], function(prefix){

      // https://github.com/zencoder/video-js/pull/128
      if ((prefix != "moz" || document.mozFullScreenEnabled) && document[prefix + "CancelFullScreen"] !== undefined) {
        requestFn = prefix + "RequestFullScreen";
        cancelFn = prefix + "CancelFullScreen";
        eventName = prefix + "fullscreenchange";

        if (prefix == "webkit") {
          isFullScreen = prefix + "IsFullScreen";
        } else {
          isFullScreen = prefix + "FullScreen";
        }
      }

    });

  }

  if (requestFn) {
    _V_.support.requestFullScreen = {
      requestFn: requestFn,
      cancelFn: cancelFn,
      eventName: eventName,
      isFullScreen: isFullScreen
    };
  }

})();/* Playback Technology - Base class for playback technologies
================================================================================ */
_V_.PlaybackTech = _V_.Component.extend({
  init: function(player, options){
    // this._super(player, options);

    // Make playback element clickable
    // _V_.addEvent(this.el, "click", _V_.proxy(this, _V_.PlayToggle.prototype.onClick));

    // this.addEvent("click", this.proxy(this.onClick));

    // player.triggerEvent("techready");
  },
  // destroy: function(){},
  // createElement: function(){},
  onClick: function(){
    if (this.player.options.controls) {
      _V_.PlayToggle.prototype.onClick.call(this);
    }
  }
});

// Create placeholder methods for each that warn when a method isn't supported by the current playback technology
_V_.apiMethods = "play,pause,paused,currentTime,setCurrentTime,duration,buffered,volume,setVolume,muted,setMuted,width,height,supportsFullScreen,enterFullScreen,src,load,currentSrc,preload,setPreload,autoplay,setAutoplay,loop,setLoop,error,networkState,readyState,seeking,initialTime,startOffsetTime,played,seekable,ended,videoTracks,audioTracks,videoWidth,videoHeight,textTracks,defaultPlaybackRate,playbackRate,mediaGroup,controller,controls,defaultMuted".split(",");
_V_.each(_V_.apiMethods, function(methodName){
  _V_.PlaybackTech.prototype[methodName] = function(){
    throw new Error("The '"+methodName+"' method is not available on the playback technology's API");
  }
});

/* HTML5 Playback Technology - Wrapper for HTML5 Media API
================================================================================ */
_V_.html5 = _V_.PlaybackTech.extend({

  init: function(player, options, ready){
    this.player = player;
    this.el = this.createElement();
    this.ready(ready);

    this.addEvent("click", this.proxy(this.onClick));

    var source = options.source;

    // If the element source is already set, we may have missed the loadstart event, and want to trigger it.
    // We don't want to set the source again and interrupt playback.
    if (source && this.el.currentSrc == source.src) {
      player.triggerEvent("loadstart");

    // Otherwise set the source if one was provided.
    } else if (source) {
      this.el.src = source.src;
    }

    // Chrome and Safari both have issues with autoplay.
    // In Safari (5.1.1), when we move the video element into the container div, autoplay doesn't work.
    // In Chrome (15), if you have autoplay + a poster + no controls, the video gets hidden (but audio plays)
    // This fixes both issues. Need to wait for API, so it updates displays correctly
    player.ready(function(){
      if (this.options.autoplay && this.paused()) {
        this.tag.poster = null; // Chrome Fix. Fixed in Chrome v16.
        this.play();
      }
    });

    this.setupTriggers();

    this.triggerReady();
  },

  destroy: function(){
    this.player.tag = false;
    this.removeTriggers();
    this.el.parentNode.removeChild(this.el);
  },

  createElement: function(){
    var html5 = _V_.html5,
        player = this.player,

        // If possible, reuse original tag for HTML5 playback technology element
        el = player.tag,
        newEl;

    // Check if this browser supports moving the element into the box.
    // On the iPhone video will break if you move the element,
    // So we have to create a brand new element.
    if (!el || this.support.movingElementInDOM === false) {

      // If the original tag is still there, remove it.
      if (el) {
        player.el.removeChild(el);
      }

      newEl = _V_.createElement("video", {
        id: el.id || player.el.id + "_html5_api",
        className: el.className || "vjs-tech"
      });

      el = newEl;
      _V_.insertFirst(el, player.el);
    }

    // Update tag settings, in case they were overridden
    _V_.each(["autoplay","preload","loop","muted"], function(attr){ // ,"poster"
      if (player.options[attr] !== null) {
        el[attr] = player.options[attr];
      }
    }, this);

    return el;
  },

  // Make video events trigger player events
  // May seem verbose here, but makes other APIs possible.
  setupTriggers: function(){
    _V_.each.call(this, _V_.html5.events, function(type){
      _V_.addEvent(this.el, type, _V_.proxy(this.player, this.eventHandler));
    });
  },
  removeTriggers: function(){
    _V_.each.call(this, _V_.html5.events, function(type){
      _V_.removeEvent(this.el, type, _V_.proxy(this.player, this.eventHandler));
    });
  },
  eventHandler: function(e){
    e.stopPropagation();
    this.triggerEvent(e);
  },

  play: function(){ this.el.play(); },
  pause: function(){ this.el.pause(); },
  paused: function(){ return this.el.paused; },

  currentTime: function(){ return this.el.currentTime; },
  setCurrentTime: function(seconds){
    try {
      this.el.currentTime = seconds;
      } catch(e) {
        _V_.log(e, "Video isn't ready. (VideoJS)");
      // this.warning(VideoJS.warnings.videoNotReady);
    }
  },

  duration: function(){ return this.el.duration || 0; },
  buffered: function(){ return this.el.buffered; },

  volume: function(){ return this.el.volume; },
  setVolume: function(percentAsDecimal){ this.el.volume = percentAsDecimal; },
  muted: function(){ return this.el.muted; },
  setMuted: function(muted){ this.el.muted = muted },

  width: function(){ return this.el.offsetWidth; },
  height: function(){ return this.el.offsetHeight; },

  supportsFullScreen: function(){
    if (typeof this.el.webkitEnterFullScreen == 'function') {

      // Seems to be broken in Chromium/Chrome && Safari in Leopard
      if (!navigator.userAgent.match("Chrome") && !navigator.userAgent.match("Mac OS X 10.5")) {
        return true;
      }
    }
    return false;
  },

  enterFullScreen: function(){
      try {
        this.el.webkitEnterFullScreen();
      } catch (e) {
        if (e.code == 11) {
          // this.warning(VideoJS.warnings.videoNotReady);
          _V_.log("VideoJS: Video not ready.")
        }
      }
  },
  src: function(src){ this.el.src = src; },
  load: function(){ this.el.load(); },
  currentSrc: function(){ return this.el.currentSrc; },

  preload: function(){ return this.el.preload; },
  setPreload: function(val){ this.el.preload = val; },
  autoplay: function(){ return this.el.autoplay; },
  setAutoplay: function(val){ this.el.autoplay = val; },
  loop: function(){ return this.el.loop; },
  setLoop: function(val){ this.el.loop = val; },

  error: function(){ return this.el.error; },
  // networkState: function(){ return this.el.networkState; },
  // readyState: function(){ return this.el.readyState; },
  seeking: function(){ return this.el.seeking; },
  // initialTime: function(){ return this.el.initialTime; },
  // startOffsetTime: function(){ return this.el.startOffsetTime; },
  // played: function(){ return this.el.played; },
  // seekable: function(){ return this.el.seekable; },
  ended: function(){ return this.el.ended; },
  // videoTracks: function(){ return this.el.videoTracks; },
  // audioTracks: function(){ return this.el.audioTracks; },
  // videoWidth: function(){ return this.el.videoWidth; },
  // videoHeight: function(){ return this.el.videoHeight; },
  // textTracks: function(){ return this.el.textTracks; },
  // defaultPlaybackRate: function(){ return this.el.defaultPlaybackRate; },
  // playbackRate: function(){ return this.el.playbackRate; },
  // mediaGroup: function(){ return this.el.mediaGroup; },
  // controller: function(){ return this.el.controller; },
  controls: function(){ return this.player.options.controls; },
  defaultMuted: function(){ return this.el.defaultMuted; }
});

/* HTML5 Support Testing -------------------------------------------------------- */

_V_.html5.isSupported = function(){
  return !!document.createElement("video").canPlayType;
};

_V_.html5.canPlaySource = function(srcObj){
  return !!document.createElement("video").canPlayType(srcObj.type);
  // TODO: Check Type
  // If no Type, check ext
  // Check Media Type
};

// List of all HTML5 events (various uses).
_V_.html5.events = "loadstart,suspend,abort,error,emptied,stalled,loadedmetadata,loadeddata,canplay,canplaythrough,playing,waiting,seeking,seeked,ended,durationchange,timeupdate,progress,play,pause,ratechange,volumechange".split(",");

/* HTML5 Device Fixes ---------------------------------------------------------- */

_V_.html5.prototype.support = {

  // Support for tech specific full screen. (webkitEnterFullScreen, not requestFullscreen)
  // http://developer.apple.com/library/safari/#documentation/AudioVideo/Reference/HTMLVideoElementClassReference/HTMLVideoElement/HTMLVideoElement.html
  // Seems to be broken in Chromium/Chrome && Safari in Leopard
  fullscreen: (typeof _V_.testVid.webkitEnterFullScreen !== undefined) ? (!_V_.ua.match("Chrome") && !_V_.ua.match("Mac OS X 10.5") ? true : false) : false,

  // In iOS, if you move a video element in the DOM, it breaks video playback.
  movingElementInDOM: !_V_.isIOS()

};

// Android
if (_V_.isAndroid()) {

  // Override Android 2.2 and less canPlayType method which is broken
  if (_V_.androidVersion() < 3) {
    document.createElement("video").constructor.prototype.canPlayType = function(type){
      return (type && type.toLowerCase().indexOf("video/mp4") != -1) ? "maybe" : "";
    };
  }
}


/* VideoJS-SWF - Custom Flash Player with HTML5-ish API - https://github.com/zencoder/video-js-swf
================================================================================ */
_V_.flash = _V_.PlaybackTech.extend({

  init: function(player, options){
    this.player = player;

    var source = options.source,

        // Which element to embed in
        parentEl = options.parentEl,

        // Create a temporary element to be replaced by swf object
        placeHolder = this.el = _V_.createElement("div", { id: parentEl.id + "_temp_flash" }),

        // Generate ID for swf object
        objId = player.el.id+"_flash_api",

        // Store player options in local var for optimization
        playerOptions = player.options,

        // Merge default flashvars with ones passed in to init
        flashVars = _V_.merge({

          // SWF Callback Functions
          readyFunction: "_V_.flash.onReady",
          eventProxyFunction: "_V_.flash.onEvent",
          errorEventProxyFunction: "_V_.flash.onError",

          // Player Settings
          autoplay: playerOptions.autoplay,
          preload: playerOptions.preload,
          loop: playerOptions.loop,
          muted: playerOptions.muted

        }, options.flashVars),

        // Merge default parames with ones passed in
        params = _V_.merge({
          wmode: "opaque", // Opaque is needed to overlay controls, but can affect playback performance
          bgcolor: "#000000" // Using bgcolor prevents a white flash when the object is loading
        }, options.params),

        // Merge default attributes with ones passed in
        attributes = _V_.merge({
          id: objId,
          name: objId, // Both ID and Name needed or swf to identifty itself
          'class': 'vjs-tech'
        }, options.attributes)
    ;

    // If source was supplied pass as a flash var.
    if (source) {
      flashVars.src = encodeURIComponent(_V_.getAbsoluteURL(source.src));
    }

    // Add placeholder to player div
    _V_.insertFirst(placeHolder, parentEl);

    // Having issues with Flash reloading on certain page actions (hide/resize/fullscreen) in certain browsers
    // This allows resetting the playhead when we catch the reload
    if (options.startTime) {
      this.ready(function(){
        this.load();
        this.play();
        this.currentTime(options.startTime);
      });
    }

    // Flash iFrame Mode
    // In web browsers there are multiple instances where changing the parent element or visibility of a plugin causes the plugin to reload.
    // - Firefox just about always. https://bugzilla.mozilla.org/show_bug.cgi?id=90268 (might be fixed by version 13)
    // - Webkit when hiding the plugin
    // - Webkit and Firefox when using requestFullScreen on a parent element
    // Loading the flash plugin into a dynamically generated iFrame gets around most of these issues.
    // Issues that remain include hiding the element and requestFullScreen in Firefox specifically

    // There's on particularly annoying issue with this method which is that Firefox throws a security error on an offsite Flash object loaded into a dynamically created iFrame.
    // Even though the iframe was inserted into a page on the web, Firefox + Flash considers it a local app trying to access an internet file.
    // I tried mulitple ways of setting the iframe src attribute but couldn't find a src that worked well. Tried a real/fake source, in/out of domain.
    // Also tried a method from stackoverflow that caused a security error in all browsers. http://stackoverflow.com/questions/2486901/how-to-set-document-domain-for-a-dynamically-generated-iframe
    // In the end the solution I found to work was setting the iframe window.location.href right before doing a document.write of the Flash object.
    // The only downside of this it seems to trigger another http request to the original page (no matter what's put in the href). Not sure why that is.

    // NOTE (2012-01-29): Cannot get Firefox to load the remote hosted SWF into a dynamically created iFrame
    // Firefox 9 throws a security error, unleess you call location.href right before doc.write.
    //    Not sure why that even works, but it causes the browser to look like it's continuously trying to load the page.
    // Firefox 3.6 keeps calling the iframe onload function anytime I write to it, causing an endless loop.

    if (options.iFrameMode == true && !_V_.isFF) {

      // Create iFrame with vjs-tech class so it's 100% width/height
      var iFrm = _V_.createElement("iframe", {
        id: objId + "_iframe",
        name: objId + "_iframe",
        className: "vjs-tech",
        scrolling: "no",
        marginWidth: 0,
        marginHeight: 0,
        frameBorder: 0
      });

      // Update ready function names in flash vars for iframe window
      flashVars.readyFunction = "ready";
      flashVars.eventProxyFunction = "events";
      flashVars.errorEventProxyFunction = "errors";

      // Tried multiple methods to get this to work in all browsers

      // Tried embedding the flash object in the page first, and then adding a place holder to the iframe, then replacing the placeholder with the page object.
      // The goal here was to try to load the swf URL in the parent page first and hope that got around the firefox security error
      // var newObj = _V_.flash.embed(options.swf, placeHolder, flashVars, params, attributes);
      // (in onload)
      //  var temp = _V_.createElement("a", { id:"asdf", innerHTML: "asdf" } );
      //  iDoc.body.appendChild(temp);

      // Tried embedding the flash object through javascript in the iframe source.
      // This works in webkit but still triggers the firefox security error
      // iFrm.src = "javascript: document.write('"+_V_.flash.getEmbedCode(options.swf, flashVars, params, attributes)+"');";

      // Tried an actual local iframe just to make sure that works, but it kills the easiness of the CDN version if you require the user to host an iframe
      // We should add an option to host the iframe locally though, because it could help a lot of issues.
      // iFrm.src = "iframe.html";

      // Wait until iFrame has loaded to write into it.
      _V_.addEvent(iFrm, "load", _V_.proxy(this, function(){

        var iDoc, objTag, swfLoc,
            iWin = iFrm.contentWindow,
            varString = "";


        // The one working method I found was to use the iframe's document.write() to create the swf object
        // This got around the security issue in all browsers except firefox.
        // I did find a hack where if I call the iframe's window.location.href="", it would get around the security error
        // However, the main page would look like it was loading indefinitely (URL bar loading spinner would never stop)
        // Plus Firefox 3.6 didn't work no matter what I tried.
        // if (_V_.ua.match("Firefox")) {
        //   iWin.location.href = "";
        // }

        // Get the iFrame's document depending on what the browser supports
        iDoc = iFrm.contentDocument ? iFrm.contentDocument : iFrm.contentWindow.document;

        // Tried ensuring both document domains were the same, but they already were, so that wasn't the issue.
        // Even tried adding /. that was mentioned in a browser security writeup
        // document.domain = document.domain+"/.";
        // iDoc.domain = document.domain+"/.";

        // Tried adding the object to the iframe doc's innerHTML. Security error in all browsers.
        // iDoc.body.innerHTML = swfObjectHTML;

        // Tried appending the object to the iframe doc's body. Security error in all browsers.
        // iDoc.body.appendChild(swfObject);

        // Using document.write actually got around the security error that browsers were throwing.
        // Again, it's a dynamically generated (same domain) iframe, loading an external Flash swf.
        // Not sure why that's a security issue, but apparently it is.
        iDoc.write(_V_.flash.getEmbedCode(options.swf, flashVars, params, attributes));

        // Setting variables on the window needs to come after the doc write because otherwise they can get reset in some browsers
        // So far no issues with swf ready event being called before it's set on the window.
        iWin.player = this.player;

        // Create swf ready function for iFrame window
        iWin.ready = _V_.proxy(this.player, function(currSwf){
          var el = iDoc.getElementById(currSwf),
              player = this,
              tech = player.tech;

          // Update reference to playback technology element
          tech.el = el;

          // Now that the element is ready, make a click on the swf play the video
          _V_.addEvent(el, "click", tech.proxy(tech.onClick));

          // Make sure swf is actually ready. Sometimes the API isn't actually yet.
          _V_.flash.checkReady(tech);
        });

        // Create event listener for all swf events
        iWin.events = _V_.proxy(this.player, function(swfID, eventName, other){
          var player = this;
          if (player && player.techName == "flash") {
            player.triggerEvent(eventName);
          }
        });

        // Create error listener for all swf errors
        iWin.errors = _V_.proxy(this.player, function(swfID, eventName){
          _V_.log("Flash Error", eventName);
        });

      }));

      // Replace placeholder with iFrame (it will load now)
      placeHolder.parentNode.replaceChild(iFrm, placeHolder);

    // If not using iFrame mode, embed as normal object
    } else {
      _V_.flash.embed(options.swf, placeHolder, flashVars, params, attributes);
    }
  },

  destroy: function(){
    this.el.parentNode.removeChild(this.el);
  },

  // setupTriggers: function(){}, // Using global onEvent func to distribute events

  play: function(){ this.el.vjs_play(); },
  pause: function(){ this.el.vjs_pause(); },
  src: function(src){
    // Make sure source URL is abosolute.
    src = _V_.getAbsoluteURL(src);

    this.el.vjs_src(src);

    // Currently the SWF doesn't autoplay if you load a source later.
    // e.g. Load player w/ no source, wait 2s, set src.
    if (this.player.autoplay()) {
      var tech = this;
      setTimeout(function(){ tech.play(); }, 0);
    }
  },
  load: function(){ this.el.vjs_load(); },
  poster: function(){ this.el.vjs_getProperty("poster"); },

  buffered: function(){
    return _V_.createTimeRange(0, this.el.vjs_getProperty("buffered"));
  },

  supportsFullScreen: function(){
    return false; // Flash does not allow fullscreen through javascript
  },
  enterFullScreen: function(){
    return false;
  }
});

// Create setters and getters for attributes
(function(){

  var api = _V_.flash.prototype,
      readWrite = "preload,currentTime,defaultPlaybackRate,playbackRate,autoplay,loop,mediaGroup,controller,controls,volume,muted,defaultMuted".split(","),
      readOnly = "error,currentSrc,networkState,readyState,seeking,initialTime,duration,startOffsetTime,paused,played,seekable,ended,videoTracks,audioTracks,videoWidth,videoHeight,textTracks".split(","),
      callOnly = "load,play,pause".split(",");
      // Overridden: buffered

      createSetter = function(attr){
        var attrUpper = attr.charAt(0).toUpperCase() + attr.slice(1);
        api["set"+attrUpper] = function(val){ return this.el.vjs_setProperty(attr, val); };
      },

      createGetter = function(attr){
        api[attr] = function(){ return this.el.vjs_getProperty(attr); };
      }
  ;

  // Create getter and setters for all read/write attributes
  _V_.each(readWrite, function(attr){
    createGetter(attr);
    createSetter(attr);
  });

  // Create getters for read-only attributes
  _V_.each(readOnly, function(attr){
    createGetter(attr);
  });

})();

/* Flash Support Testing -------------------------------------------------------- */

_V_.flash.isSupported = function(){
  return _V_.flash.version()[0] >= 10;
  // return swfobject.hasFlashPlayerVersion("10");
};

_V_.flash.canPlaySource = function(srcObj){
  if (srcObj.type in _V_.flash.prototype.support.formats) { return "maybe"; }
};

_V_.flash.prototype.support = {
  formats: {
    "video/flv": "FLV",
    "video/x-flv": "FLV",
    "video/mp4": "MP4",
    "video/m4v": "MP4"
  },

  // Optional events that we can manually mimic with timers
  progressEvent: false,
  timeupdateEvent: false,

  // Resizing plugins using request fullscreen reloads the plugin
  fullscreenResize: false,

  // Resizing plugins in Firefox always reloads the plugin (e.g. full window mode)
  parentResize: !(_V_.ua.match("Firefox"))
};

_V_.flash.onReady = function(currSwf){

  var el = _V_.el(currSwf);

  // Get player from box
  // On firefox reloads, el might already have a player
  var player = el.player || el.parentNode.player,
      tech = player.tech;

  // Reference player on tech element
  el.player = player;

  // Update reference to playback technology element
  tech.el = el;

  // Now that the element is ready, make a click on the swf play the video
  tech.addEvent("click", tech.onClick);

  _V_.flash.checkReady(tech);
};

// The SWF isn't alwasy ready when it says it is. Sometimes the API functions still need to be added to the object.
// If it's not ready, we set a timeout to check again shortly.
_V_.flash.checkReady = function(tech){

  // Check if API property exists
  if (tech.el.vjs_getProperty) {

    // If so, tell tech it's ready
    tech.triggerReady();

  // Otherwise wait longer.
  } else {

    setTimeout(function(){
      _V_.flash.checkReady(tech);
    }, 50);

  }
};

// Trigger events from the swf on the player
_V_.flash.onEvent = function(swfID, eventName){
  var player = _V_.el(swfID).player;
  player.triggerEvent(eventName);
};

// Log errors from the swf
_V_.flash.onError = function(swfID, err){
  var player = _V_.el(swfID).player;
  player.triggerEvent("error");
  _V_.log("Flash Error", err, swfID);
};

// Flash Version Check
_V_.flash.version = function(){
  var version = '0,0,0'

  // IE
  try {
    version = new ActiveXObject('ShockwaveFlash.ShockwaveFlash').GetVariable('$version').replace(/\D+/g, ',').match(/^,?(.+),?$/)[1];

  // other browsers
  } catch(e) {
    try {
      if (navigator.mimeTypes["application/x-shockwave-flash"].enabledPlugin){
        version = (navigator.plugins["Shockwave Flash 2.0"] || navigator.plugins["Shockwave Flash"]).description.replace(/\D+/g, ",").match(/^,?(.+),?$/)[1];
      }
    } catch(e) {}
  }
  return version.split(",");
}

// Flash embedding method. Only used in non-iframe mode
_V_.flash.embed = function(swf, placeHolder, flashVars, params, attributes){
  var code = _V_.flash.getEmbedCode(swf, flashVars, params, attributes),

      // Get element by embedding code and retrieving created element
      obj = _V_.createElement("div", { innerHTML: code }).childNodes[0],

      par = placeHolder.parentNode
  ;

  placeHolder.parentNode.replaceChild(obj, placeHolder);

  // IE6 seems to have an issue where it won't initialize the swf object after injecting it.
  // This is a dumb temporary fix
  if (_V_.isIE()) {
    var newObj = par.childNodes[0];
    setTimeout(function(){
      newObj.style.display = "block";
    }, 1000);
  }

  return obj;

};

_V_.flash.getEmbedCode = function(swf, flashVars, params, attributes){

  var objTag = '<object type="application/x-shockwave-flash"',
      flashVarsString = '',
      paramsString = ''
      attrsString = '';

  // Convert flash vars to string
  if (flashVars) {
    _V_.eachProp(flashVars, function(key, val){
      flashVarsString += (key + "=" + val + "&amp;");
    });
  }

  // Add swf, flashVars, and other default params
  params = _V_.merge({
    movie: swf,
    flashvars: flashVarsString,
    allowScriptAccess: "always", // Required to talk to swf
    allowNetworking: "all" // All should be default, but having security issues.
  }, params);

  // Create param tags string
  _V_.eachProp(params, function(key, val){
    paramsString += '<param name="'+key+'" value="'+val+'" />';
  });

  attributes = _V_.merge({
    // Add swf to attributes (need both for IE and Others to work)
    data: swf,

    // Default to 100% width/height
    width: "100%",
    height: "100%"

  }, attributes);

  // Create Attributes string
  _V_.eachProp(attributes, function(key, val){
    attrsString += (key + '="' + val + '" ');
  });

  return objTag + attrsString + '>' + paramsString + '</object>';
}
// TEXT TRACKS
// Text tracks are tracks of timed text events.
//    Captions - text displayed over the video for the hearing impared
//    Subtitles - text displayed over the video for those who don't understand langauge in the video
//    Chapters - text displayed in a menu allowing the user to jump to particular points (chapters) in the video
//    Descriptions (not supported yet) - audio descriptions that are read back to the user by a screen reading device

// Player Track Functions - Functions add to the player object for easier access to tracks
_V_.merge(_V_.Player.prototype, {

  // Add an array of text tracks. captions, subtitles, chapters, descriptions
  // Track objects will be stored in the player.textTracks array
  addTextTracks: function(trackObjects){
    var tracks = this.textTracks = (this.textTracks) ? this.textTracks : [],
        i = 0, j = trackObjects.length, track, Kind;

    for (;i<j;i++) {
      // HTML5 Spec says default to subtitles.
      // Uppercase (uc) first letter to match class names
      Kind = _V_.uc(trackObjects[i].kind || "subtitles");

      // Create correct texttrack class. CaptionsTrack, etc.
      track = new _V_[Kind + "Track"](this, trackObjects[i]);

      tracks.push(track);

      // If track.default is set, start showing immediately
      // TODO: Add a process to deterime the best track to show for the specific kind
      // Incase there are mulitple defaulted tracks of the same kind
      // Or the user has a set preference of a specific language that should override the default
      if (track['default']) {
        this.ready(_V_.proxy(track, track.show));
      }
    }

    // Return the track so it can be appended to the display component
    return this;
  },

  // Show a text track
  // disableSameKind: disable all other tracks of the same kind. Value should be a track kind (captions, etc.)
  showTextTrack: function(id, disableSameKind){
    var tracks = this.textTracks,
        i = 0,
        j = tracks.length,
        track, showTrack, kind;

    // Find Track with same ID
    for (;i<j;i++) {
      track = tracks[i];
      if (track.id === id) {
        track.show();
        showTrack = track;

      // Disable tracks of the same kind
      } else if (disableSameKind && track.kind == disableSameKind && track.mode > 0) {
        track.disable();
      }
    }

    // Get track kind from shown track or disableSameKind
    kind = (showTrack) ? showTrack.kind : ((disableSameKind) ? disableSameKind : false);

    // Trigger trackchange event, captionstrackchange, subtitlestrackchange, etc.
    if (kind) {
      this.triggerEvent(kind+"trackchange");
    }

    return this;
  }

});

// Track Class
// Contains track methods for loading, showing, parsing cues of tracks
_V_.Track = _V_.Component.extend({

  init: function(player, options){
    this._super(player, options);

    // Apply track info to track object
    // Options will often be a track element
    _V_.merge(this, {
      // Build ID if one doesn't exist
      id: options.id || ("vjs_" + options.kind + "_" + options.language + "_" + _V_.guid++),

      src: options.src,

      // If default is used, subtitles/captions to start showing
      "default": options["default"], // 'default' is reserved-ish
      title: options.title,

      // Language - two letter string to represent track language, e.g. "en" for English
      // readonly attribute DOMString language;
      language: options.srclang,

      // Track label e.g. "English"
      // readonly attribute DOMString label;
      label: options.label,

      // All cues of the track. Cues have a startTime, endTime, text, and other properties.
      // readonly attribute TextTrackCueList cues;
      cues: [],

      // ActiveCues is all cues that are currently showing
      // readonly attribute TextTrackCueList activeCues;
      activeCues: [],

      // ReadyState describes if the text file has been loaded
      // const unsigned short NONE = 0;
      // const unsigned short LOADING = 1;
      // const unsigned short LOADED = 2;
      // const unsigned short ERROR = 3;
      // readonly attribute unsigned short readyState;
      readyState: 0,

      // Mode describes if the track is showing, hidden, or disabled
      // const unsigned short OFF = 0;
      // const unsigned short HIDDEN = 1; (still triggering cuechange events, but not visible)
      // const unsigned short SHOWING = 2;
      // attribute unsigned short mode;
      mode: 0
    });
  },

  // Create basic div to hold cue text
  createElement: function(){
    return this._super("div", {
      className: "vjs-" + this.kind + " vjs-text-track"
    });
  },

  // Show: Mode Showing (2)
  // Indicates that the text track is active. If no attempt has yet been made to obtain the track's cues, the user agent will perform such an attempt momentarily.
  // The user agent is maintaining a list of which cues are active, and events are being fired accordingly.
  // In addition, for text tracks whose kind is subtitles or captions, the cues are being displayed over the video as appropriate;
  // for text tracks whose kind is descriptions, the user agent is making the cues available to the user in a non-visual fashion;
  // and for text tracks whose kind is chapters, the user agent is making available to the user a mechanism by which the user can navigate to any point in the media resource by selecting a cue.
  // The showing by default state is used in conjunction with the default attribute on track elements to indicate that the text track was enabled due to that attribute.
  // This allows the user agent to override the state if a later track is discovered that is more appropriate per the user's preferences.
  show: function(){
    this.activate();

    this.mode = 2;

    // Show element.
    this._super();
  },

  // Hide: Mode Hidden (1)
  // Indicates that the text track is active, but that the user agent is not actively displaying the cues.
  // If no attempt has yet been made to obtain the track's cues, the user agent will perform such an attempt momentarily.
  // The user agent is maintaining a list of which cues are active, and events are being fired accordingly.
  hide: function(){
    // When hidden, cues are still triggered. Disable to stop triggering.
    this.activate();

    this.mode = 1;

    // Hide element.
    this._super();
  },

  // Disable: Mode Off/Disable (0)
  // Indicates that the text track is not active. Other than for the purposes of exposing the track in the DOM, the user agent is ignoring the text track.
  // No cues are active, no events are fired, and the user agent will not attempt to obtain the track's cues.
  disable: function(){
    // If showing, hide.
    if (this.mode == 2) { this.hide(); }

    // Stop triggering cues
    this.deactivate();

    // Switch Mode to Off
    this.mode = 0;
  },

  // Turn on cue tracking. Tracks that are showing OR hidden are active.
  activate: function(){
    // Load text file if it hasn't been yet.
    if (this.readyState == 0) { this.load(); }

    // Only activate if not already active.
    if (this.mode == 0) {
      // Update current cue on timeupdate
      // Using unique ID for proxy function so other tracks don't remove listener
      this.player.addEvent("timeupdate", this.proxy(this.update, this.id));

      // Reset cue time on media end
      this.player.addEvent("ended", this.proxy(this.reset, this.id));

      // Add to display
      if (this.kind == "captions" || this.kind == "subtitles") {
        this.player.textTrackDisplay.addComponent(this);
      }
    }
  },

  // Turn off cue tracking.
  deactivate: function(){
    // Using unique ID for proxy function so other tracks don't remove listener
    this.player.removeEvent("timeupdate", this.proxy(this.update, this.id));
    this.player.removeEvent("ended", this.proxy(this.reset, this.id));
    this.reset(); // Reset

    // Remove from display
    this.player.textTrackDisplay.removeComponent(this);
  },

  // A readiness state
  // One of the following:
  //
  // Not loaded
  // Indicates that the text track is known to exist (e.g. it has been declared with a track element), but its cues have not been obtained.
  //
  // Loading
  // Indicates that the text track is loading and there have been no fatal errors encountered so far. Further cues might still be added to the track.
  //
  // Loaded
  // Indicates that the text track has been loaded with no fatal errors. No new cues will be added to the track except if the text track corresponds to a MutableTextTrack object.
  //
  // Failed to load
  // Indicates that the text track was enabled, but when the user agent attempted to obtain it, this failed in some way (e.g. URL could not be resolved, network error, unknown text track format). Some or all of the cues are likely missing and will not be obtained.
  load: function(){

    // Only load if not loaded yet.
    if (this.readyState == 0) {
      this.readyState = 1;
      _V_.get(this.src, this.proxy(this.parseCues), this.proxy(this.onError));
    }

  },

  onError: function(err){
    this.error = err;
    this.readyState = 3;
    this.triggerEvent("error");
  },

  // Parse the WebVTT text format for cue times.
  // TODO: Separate parser into own class so alternative timed text formats can be used. (TTML, DFXP)
  parseCues: function(srcContent) {
    var cue, time, text,
        lines = srcContent.split("\n"),
        line = "", id;

    for (var i=1, j=lines.length; i<j; i++) {
      // Line 0 should be 'WEBVTT', so skipping i=0

      line = _V_.trim(lines[i]); // Trim whitespace and linebreaks

      if (line) { // Loop until a line with content

        // First line could be an optional cue ID
        // Check if line has the time separator
        if (line.indexOf("-->") == -1) {
          id = line;
          // Advance to next line for timing.
          line = _V_.trim(lines[++i]);
        } else {
          id = this.cues.length;
        }

        // First line - Number
        cue = {
          id: id, // Cue Number
          index: this.cues.length // Position in Array
        };

        // Timing line
        time = line.split(" --> ");
        cue.startTime = this.parseCueTime(time[0]);
        cue.endTime = this.parseCueTime(time[1]);

        // Additional lines - Cue Text
        text = [];

        // Loop until a blank line or end of lines
        // Assumeing trim("") returns false for blank lines
        while (lines[++i] && (line = _V_.trim(lines[i]))) {
          text.push(line);
        }

        cue.text = text.join('<br/>');

        // Add this cue
        this.cues.push(cue);
      }
    }

    this.readyState = 2;
    this.triggerEvent("loaded");
  },

  parseCueTime: function(timeText) {
    var parts = timeText.split(':'),
        time = 0,
        hours, minutes, other, seconds, ms, flags;

    // Check if optional hours place is included
    // 00:00:00.000 vs. 00:00.000
    if (parts.length == 3) {
      hours = parts[0];
      minutes = parts[1];
      other = parts[2];
    } else {
      hours = 0;
      minutes = parts[0];
      other = parts[1];
    }

    // Break other (seconds, milliseconds, and flags) by spaces
    // TODO: Make additional cue layout settings work with flags
    other = other.split(/\s+/)
    // Remove seconds. Seconds is the first part before any spaces.
    seconds = other.splice(0,1)[0];
    // Could use either . or , for decimal
    seconds = seconds.split(/\.|,/);
    // Get milliseconds
    ms = parseFloat(seconds[1]);
    seconds = seconds[0];

    // hours => seconds
    time += parseFloat(hours) * 3600;
    // minutes => seconds
    time += parseFloat(minutes) * 60;
    // Add seconds
    time += parseFloat(seconds);
    // Add milliseconds
    if (ms) { time += ms/1000; }

    return time;
  },

  // Update active cues whenever timeupdate events are triggered on the player.
  update: function(){
    if (this.cues.length > 0) {

      // Get curent player time
      var time = this.player.currentTime();

      // Check if the new time is outside the time box created by the the last update.
      if (this.prevChange === undefined || time < this.prevChange || this.nextChange <= time) {
        var cues = this.cues,

            // Create a new time box for this state.
            newNextChange = this.player.duration(), // Start at beginning of the timeline
            newPrevChange = 0, // Start at end

            reverse = false, // Set the direction of the loop through the cues. Optimized the cue check.
            newCues = [], // Store new active cues.

            // Store where in the loop the current active cues are, to provide a smart starting point for the next loop.
            firstActiveIndex, lastActiveIndex,

            html = "", // Create cue text HTML to add to the display
            cue, i, j; // Loop vars

        // Check if time is going forwards or backwards (scrubbing/rewinding)
        // If we know the direction we can optimize the starting position and direction of the loop through the cues array.
        if (time >= this.nextChange || this.nextChange === undefined) { // NextChange should happen
          // Forwards, so start at the index of the first active cue and loop forward
          i = (this.firstActiveIndex !== undefined) ? this.firstActiveIndex : 0;
        } else {
          // Backwards, so start at the index of the last active cue and loop backward
          reverse = true;
          i = (this.lastActiveIndex !== undefined) ? this.lastActiveIndex : cues.length - 1;
        }

        while (true) { // Loop until broken
          cue = cues[i];

          // Cue ended at this point
          if (cue.endTime <= time) {
            newPrevChange = Math.max(newPrevChange, cue.endTime);

            if (cue.active) {
              cue.active = false;
            }

            // No earlier cues should have an active start time.
            // Nevermind. Assume first cue could have a duration the same as the video.
            // In that case we need to loop all the way back to the beginning.
            // if (reverse && cue.startTime) { break; }

          // Cue hasn't started
          } else if (time < cue.startTime) {
            newNextChange = Math.min(newNextChange, cue.startTime);

            if (cue.active) {
              cue.active = false;
            }

            // No later cues should have an active start time.
            if (!reverse) { break; }

          // Cue is current
          } else {

            if (reverse) {
              // Add cue to front of array to keep in time order
              newCues.splice(0,0,cue);

              // If in reverse, the first current cue is our lastActiveCue
              if (lastActiveIndex === undefined) { lastActiveIndex = i; }
              firstActiveIndex = i;
            } else {
              // Add cue to end of array
              newCues.push(cue);

              // If forward, the first current cue is our firstActiveIndex
              if (firstActiveIndex === undefined) { firstActiveIndex = i; }
              lastActiveIndex = i;
            }

            newNextChange = Math.min(newNextChange, cue.endTime);
            newPrevChange = Math.max(newPrevChange, cue.startTime);

            cue.active = true;
          }

          if (reverse) {
            // Reverse down the array of cues, break if at first
            if (i === 0) { break; } else { i--; }
          } else {
            // Walk up the array fo cues, break if at last
            if (i === cues.length - 1) { break; } else { i++; }
          }

        }

        this.activeCues = newCues;
        this.nextChange = newNextChange;
        this.prevChange = newPrevChange;
        this.firstActiveIndex = firstActiveIndex;
        this.lastActiveIndex = lastActiveIndex;

        this.updateDisplay();

        this.triggerEvent("cuechange");
      }
    }
  },

  // Add cue HTML to display
  updateDisplay: function(){
    var cues = this.activeCues,
        html = "",
        i=0,j=cues.length;

    for (;i<j;i++) {
      html += "<span class='vjs-tt-cue'>"+cues[i].text+"</span>";
    }

    this.el.innerHTML = html;
  },

  // Set all loop helper values back
  reset: function(){
    this.nextChange = 0;
    this.prevChange = this.player.duration();
    this.firstActiveIndex = 0;
    this.lastActiveIndex = 0;
  }

});

// Create specific track types
_V_.CaptionsTrack = _V_.Track.extend({
  kind: "captions"
});

_V_.SubtitlesTrack = _V_.Track.extend({
  kind: "subtitles"
});

_V_.ChaptersTrack = _V_.Track.extend({
  kind: "chapters"
});


/* Text Track Display
================================================================================ */
// Global container for both subtitle and captions text. Simple div container.
_V_.TextTrackDisplay = _V_.Component.extend({

  createElement: function(){
    return this._super("div", {
      className: "vjs-text-track-display"
    });
  }

});

/* Text Track Menu Items
================================================================================ */
_V_.TextTrackMenuItem = _V_.MenuItem.extend({

  init: function(player, options){
    var track = this.track = options.track;

    // Modify options for parent MenuItem class's init.
    options.label = track.label;
    options.selected = track["default"];
    this._super(player, options);

    this.player.addEvent(track.kind + "trackchange", _V_.proxy(this, this.update));
  },

  onClick: function(){
    this._super();
    this.player.showTextTrack(this.track.id, this.track.kind);
  },

  update: function(){
    if (this.track.mode == 2) {
      this.selected(true);
    } else {
      this.selected(false);
    }
  }

});

_V_.OffTextTrackMenuItem = _V_.TextTrackMenuItem.extend({

  init: function(player, options){
    // Create pseudo track info
    // Requires options.kind
    options.track = { kind: options.kind, player: player, label: "Off" }
    this._super(player, options);
  },

  onClick: function(){
    this._super();
    this.player.showTextTrack(this.track.id, this.track.kind);
  },

  update: function(){
    var tracks = this.player.textTracks,
        i=0, j=tracks.length, track,
        off = true;

    for (;i<j;i++) {
      track = tracks[i];
      if (track.kind == this.track.kind && track.mode == 2) {
        off = false;
      }
    }

    if (off) {
      this.selected(true);
    } else {
      this.selected(false);
    }
  }

});

/* Captions Button
================================================================================ */
_V_.TextTrackButton = _V_.Button.extend({

  init: function(player, options){
    this._super(player, options);

    this.menu = this.createMenu();

    if (this.items.length === 0) {
      this.hide();
    }
  },

  createMenu: function(){
    var menu = new _V_.Menu(this.player);

    // Add a title list item to the top
    menu.el.appendChild(_V_.createElement("li", {
      className: "vjs-menu-title",
      innerHTML: _V_.uc(this.kind)
    }));

    // Add an OFF menu item to turn all tracks off
    menu.addItem(new _V_.OffTextTrackMenuItem(this.player, { kind: this.kind }))

    this.items = this.createItems();

    // Add menu items to the menu
    this.each(this.items, function(item){
      menu.addItem(item);
    });

    // Add list to element
    this.addComponent(menu);

    return menu;
  },

  // Create a menu item for each text track
  createItems: function(){
    var items = [];
    this.each(this.player.textTracks, function(track){
      if (track.kind === this.kind) {
        items.push(new _V_.TextTrackMenuItem(this.player, {
          track: track
        }));
      }
    });
    return items;
  },

  buildCSSClass: function(){
    return this.className + " vjs-menu-button " + this._super();
  },

  // Focus - Add keyboard functionality to element
  onFocus: function(){
    // Show the menu, and keep showing when the menu items are in focus
    this.menu.lockShowing();
    // this.menu.el.style.display = "block";

    // When tabbing through, the menu should hide when focus goes from the last menu item to the next tabbed element.
    _V_.one(this.menu.el.childNodes[this.menu.el.childNodes.length - 1], "blur", this.proxy(function(){
      this.menu.unlockShowing();
    }));
  },
  // Can't turn off list display that we turned on with focus, because list would go away.
  onBlur: function(){},

  onClick: function(){
    // When you click the button it adds focus, which will show the menu indefinitely.
    // So we'll remove focus when the mouse leaves the button.
    // Focus is needed for tab navigation.
    this.one("mouseout", this.proxy(function(){
      this.menu.unlockShowing();
      this.el.blur();
    }));
  }

});

_V_.CaptionsButton = _V_.TextTrackButton.extend({
  kind: "captions",
  buttonText: "Captions",
  className: "vjs-captions-button"
});

_V_.SubtitlesButton = _V_.TextTrackButton.extend({
  kind: "subtitles",
  buttonText: "Subtitles",
  className: "vjs-subtitles-button"
});

// Chapters act much differently than other text tracks
// Cues are navigation vs. other tracks of alternative languages
_V_.ChaptersButton = _V_.TextTrackButton.extend({
  kind: "chapters",
  buttonText: "Chapters",
  className: "vjs-chapters-button",

  // Create a menu item for each text track
  createItems: function(chaptersTrack){
    var items = [];

    this.each(this.player.textTracks, function(track){
      if (track.kind === this.kind) {
        items.push(new _V_.TextTrackMenuItem(this.player, {
          track: track
        }));
      }
    });

    return items;
  },

  createMenu: function(){
    var tracks = this.player.textTracks,
        i = 0,
        j = tracks.length,
        track, chaptersTrack,
        items = this.items = [];

    for (;i<j;i++) {
      track = tracks[i];
      if (track.kind == this.kind && track["default"]) {
        if (track.readyState < 2) {
          this.chaptersTrack = track;
          track.addEvent("loaded", this.proxy(this.createMenu));
          return;
        } else {
          chaptersTrack = track;
          break;
        }
      }
    }

    var menu = this.menu = new _V_.Menu(this.player);

    menu.el.appendChild(_V_.createElement("li", {
      className: "vjs-menu-title",
      innerHTML: _V_.uc(this.kind)
    }));

    if (chaptersTrack) {
      var cues = chaptersTrack.cues,
          i = 0, j = cues.length, cue, mi;

      for (;i<j;i++) {
        cue = cues[i];

        mi = new _V_.ChaptersTrackMenuItem(this.player, {
          track: chaptersTrack,
          cue: cue
        });

        items.push(mi);

        menu.addComponent(mi);
      }
    }

    // Add list to element
    this.addComponent(menu);

    if (this.items.length > 0) {
      this.show();
    }

    return menu;
  }

});

_V_.ChaptersTrackMenuItem = _V_.MenuItem.extend({

  init: function(player, options){
    var track = this.track = options.track,
        cue = this.cue = options.cue,
        currentTime = player.currentTime();

    // Modify options for parent MenuItem class's init.
    options.label = cue.text;
    options.selected = (cue.startTime <= currentTime && currentTime < cue.endTime);
    this._super(player, options);

    track.addEvent("cuechange", _V_.proxy(this, this.update));
  },

  onClick: function(){
    this._super();
    this.player.currentTime(this.cue.startTime);
    this.update(this.cue.startTime);
  },

  update: function(time){
    var cue = this.cue,
        currentTime = this.player.currentTime();

    // _V_.log(currentTime, cue.startTime);
    if (cue.startTime <= currentTime && currentTime < cue.endTime) {
      this.selected(true);
    } else {
      this.selected(false);
    }
  }

});

// Add Buttons to controlBar
_V_.merge(_V_.ControlBar.prototype.options.components, {
  "subtitlesButton": {},
  "captionsButton": {},
  "chaptersButton": {}
});

// _V_.Cue = _V_.Component.extend({
//   init: function(player, options){
//     this._super(player, options);
//   }
// });

// Automatically set up any tags that have a data-setup attribute
_V_.autoSetup = function(){
  var options, vid, player,
      vids = document.getElementsByTagName("video");

  // Check if any media elements exist
  if (vids && vids.length > 0) {

    for (var i=0,j=vids.length; i<j; i++) {
      vid = vids[i];

      // Check if element exists, has getAttribute func.
      // IE seems to consider typeof el.getAttribute == "object" instead of "function" like expected, at least when loading the player immediately.
      if (vid && vid.getAttribute) {

        // Make sure this player hasn't already been set up.
        if (vid.player === undefined) {
          options = vid.getAttribute("data-setup");

          // Check if data-setup attr exists. 
          // We only auto-setup if they've added the data-setup attr.
          if (options !== null) {

            // Parse options JSON
            // If empty string, make it a parsable json object.
            options = JSON.parse(options || "{}");

            // Create new video.js instance.
            player = _V_(vid, options);
          }
        }

      // If getAttribute isn't defined, we need to wait for the DOM.
      } else {
        _V_.autoSetupTimeout(1);
        break;
      }
    }

  // No videos were found, so keep looping unless page is finisehd loading.
  } else if (!_V_.windowLoaded) {
    _V_.autoSetupTimeout(1);
  }
};

// Pause to let the DOM keep processing
_V_.autoSetupTimeout = function(wait){
  setTimeout(_V_.autoSetup, wait);
};

_V_.addEvent(window, "load", function(){
  _V_.windowLoaded = true;
});

// Run Auto-load players
_V_.autoSetup();
// Expose to global
window.VideoJS = window._V_ = VideoJS;

// End self-executing function
})(window);


//SCRIPT: ../../vendor/js/matchMedia.addListener.js
/*! matchMedia() polyfill addListener/removeListener extension. Author & copyright (c) 2012: Scott Jehl. Dual MIT/BSD license */
(function(){
    // Bail out for browsers that have addListener support
    if (window.matchMedia && window.matchMedia('all').addListener) {
        return false;
    }

    var localMatchMedia = window.matchMedia,
        hasMediaQueries = localMatchMedia('only all').matches,
        isListening     = false,
        timeoutID       = 0,    // setTimeout for debouncing 'handleChange'
        queries         = [],   // Contains each 'mql' and associated 'listeners' if 'addListener' is used
        handleChange    = function(evt) {
            // Debounce
            clearTimeout(timeoutID);

            timeoutID = setTimeout(function() {
                for (var i = 0, il = queries.length; i < il; i++) {
                    var mql         = queries[i].mql,
                        listeners   = queries[i].listeners || [],
                        matches     = localMatchMedia(mql.media).matches;

                    // Update mql.matches value and call listeners
                    // Fire listeners only if transitioning to or from matched state
                    if (matches !== mql.matches) {
                        mql.matches = matches;

                        for (var j = 0, jl = listeners.length; j < jl; j++) {
                            listeners[j].call(window, mql);
                        }
                    }
                }
            }, 30);
        };

    window.matchMedia = function(media) {
        var mql         = localMatchMedia(media),
            listeners   = [],
            index       = 0;

        mql.addListener = function(listener) {
            // Changes would not occur to css media type so return now (Affects IE <= 8)
            if (!hasMediaQueries) {
                return;
            }

            // Set up 'resize' listener for browsers that support CSS3 media queries (Not for IE <= 8)
            // There should only ever be 1 resize listener running for performance
            if (!isListening) {
                isListening = true;
                window.addEventListener('resize', handleChange, true);
            }

            // Push object only if it has not been pushed already
            if (index === 0) {
                index = queries.push({
                    mql         : mql,
                    listeners   : listeners
                });
            }

            listeners.push(listener);
        };

        mql.removeListener = function(listener) {
            for (var i = 0, il = listeners.length; i < il; i++){
                if (listeners[i] === listener){
                    listeners.splice(i, 1);
                }
            }
        };

        return mql;
    };
}());


//SCRIPT: ../../vendor/js/panasonic-video-js-inflight.js
/* InFlight Playback Technology - Wrapper for InFlight AVOD Media API
================================================================================ */
_V_.html5 = _V_.PlaybackTech.extend({

  init: function(player, options, ready){
    this.player = player;
    var tempDiv;

    // reference to PAC media player
    if (player.options.PACPlayer) {
      
    _V_.support.requestFullScreen = false;
      this.el = player.options.PACPlayer;

      // Currently the player's 'el' is the video tag.  Remove events
    // currently on this video tag then setup triggers to ensure that 
    // all events are dispatched from AVOD object
    player.removeEvent("ended", player.onEnded);
      player.removeEvent("play", player.onPlay);
      player.removeEvent("pause", player.onPause);
      player.removeEvent("progress", player.onProgress);
      player.removeEvent("error", player.onError);
        this.setupTriggers();

      // swap video tag position and reset player.el
      tempDiv = player.el;
    player.el.parentNode.appendChild(player.tag);
    
      if(player.options.PACPlayer.isAOD() && player.options.playerControls)
      {
        player.el = player.options.playerControls;
      }
      else
      {

        player.el = player.tag.parentNode;

        var timeout;

        // Fade out controls after 3 seconds of inactivity
        player.addEvent('touchend', function() {
          clearTimeout(timeout);
          timeout = window.setTimeout(function () { player.controlBar.fadeOut() }, 3000);
        });
        
        // Fade in the controls when touched
        player.addEvent('touchstart', function() {
          player.controlBar.fadeIn();
        })

        // iOS 7 hack to ensure that elements that take up the fullscreen (height:100%) will register touch events
        player.el.addEventListener('touchstart', function (event) {});
      }
      
    tempDiv.parentNode.removeChild(tempDiv);
    player.tag.id = player.options.PACPlayer.target;
    
    player.addClass('video-js');
    player.addClass('vjs-default-skin');
    player.addClass('vjs-paused');
      player.addEvent("ended", player.onEnded);
      player.addEvent("play", player.onPlay);
      player.addEvent("pause", player.onPause);
      player.addEvent("progress", player.onProgress);
      player.addEvent("error", player.onError);
      player.addEvent("durationchange", this.proxy(function() { 
        this.player.triggerEvent('timeupdate');
      }));
      
      player.addEvent("loadeddata", function() {
        player.triggerEvent("playlistchange");
      });
      
      this.addEvent('fullscreenchange', this.proxy(function() {
        this.player.isFullScreen = (this.el.getDisplayState() != 'normal');
      }));
    
      this.addEvent('remove', this.player.proxy(this.player.destroy));
        
        this.ready(ready);
        this.ready(function() {
          /*
           * Trigger the playlistchange event manually once the player is 
           * available to update the previous/next buttons.  Add a timeout to
           * ensure that the event is triggered in a new callstack after all
           * buttons have been created
           */ 
          setTimeout(function() {
            player.triggerEvent('volumechange');
            //player.triggerEvent('playlistchange');
          }, 0);
        });
        
        this.addEvent("click", this.proxy(this.onClick));
    }
    else
    {
      this.el = this.createElement();
    }
    
  this.triggerReady();
  },

  destroy: function(){
    this.player.tag = false;
    this.removeTriggers();
    this.player.el = document.createElement('div');
    document.getElementsByTagName('body')[0].appendChild(this.player.el);
  },

  createElement: function(){
  // CreateElement should never be called on the PAC AVOD Player Tech.  The player should only be instantiated by the IFAPI
    if (!this.el) {
      _V_.log("** ERROR ** AVOD Object must be instantiated before Video JS Skin is applied");
      this.el = this.player.tag;
    }

    return this.el;
  },
  
  // Make video events trigger player events
  // May seem verbose here, but makes other APIs possible.
  setupTriggers: function(){
    _V_.each.call(this, _V_.html5.events, function(type){
      _V_.addEvent(this.el, type, _V_.proxy(this.player, this.eventHandler));
    });
  },
  removeTriggers: function(){
    _V_.each.call(this, _V_.html5.events, function(type){
      _V_.removeEvent(this.el, type, _V_.proxy(this.player, this.eventHandler));
    });
  },
  eventHandler: function(e){
    this.triggerEvent(e.type);
  },

  play: function(){ this.el.play(); },
  pause: function(){ this.el.pause(); },
  paused: function(){ return this.el.paused(); },

  currentTime: function(){
    var currentTime = 0;
    if(typeof(this.el.getCurrentTime) === 'function')
    {
      currentTime = this.el.getCurrentTime();
    }
    return currentTime;
  },
  setCurrentTime: function(seconds){ return this.el.seek(seconds); },

  duration: function() {
    var duration = 0;
    if(typeof(this.el.getDuration) === 'function')
    {
      duration = this.el.getDuration();
    }
    return duration;
  },
  buffered: function() {
    var bufferRange = null;
    
    if(typeof(this.el.buffered) === 'function')
    {
      bufferRange = this.el.buffered();
    }
    
    if(bufferRange) {
      bufferRange = _V_.createTimeRange(bufferRange.start(0), bufferRange.end(bufferRange.length - 1));
    }
    
    return bufferRange;
  },

  volume: function(){
    var volume = 0; 
    if(typeof(this.el.getVolume) === 'function')
    {
      volume = this.el.getVolume();
    }
    return volume;
  },
  setVolume: function(percentAsDecimal){ this.el.setVolume(percentAsDecimal); },
  muted: function(){ return (this.el.getVolume() == 0); },
  setMuted: function(muted){ this.el.setVolume((muted)? 0 : 1); },

  width: function(){ return this.el.offsetWidth; },
  height: function(){ return this.el.offsetHeight; },

  supportsFullScreen: function(){
    // Use InFlight API for FullScreen modes
    return true;
  },
  enterFullScreen: function(){
    this.el.requestFullScreen();
  },
  exitFullScreen: function(){
    this.el.cancelFullScreen();
  },
  src: function(src){
    switch(typeof(Object.prototype.toString.apply(src)))
    {
    case '[object Array]':
      break;
    case 'string':
      src = [src];
      break;
    default:
      _V_.warn('src must be of type string or array');
      src = null;
    }
    
    if(src !== null)
    {
      this.el.load({media_uris: src});
    }
  },
  load: function(){ this.el.stop(); },
  //currentSrc: function(){ return this.el.currentSrc; },

  // preload: function(){ return this.el.preload; },
  // setPreload: function(val){ this.el.preload = val; },
  // autoplay: function(){ return this.el.getAutoplay(); },
  // setAutoplay: function(val){ this.el.setAutoplay(val); },
  // loop: function(){ return this.el.loop; },
  // setLoop: function(val){ this.el.loop = val; },

  // error: function(){ return this.el.error; },
  // networkState: function(){ return this.el.networkState; },
  // readyState: function(){ return this.el.readyState; },
  seeking: function(){ return this.el.seeking(); },
  // initialTime: function(){ return this.el.initialTime; },
  // startOffsetTime: function(){ return this.el.startOffsetTime; },
  // played: function(){ return this.el.played; },
  seekable: function(){
    var seekRange = this.el.seekable();
    _V_.createTimeRange(seekRange.start(0), seekRange.end(seekRange.length - 1));
  },
  ended: function(){ return this.el.ended(); },
  // videoTracks: function(){ return this.el.videoTracks; },
  // audioTracks: function(){ return this.el.audioTracks; },
  // videoWidth: function(){ return this.el.videoWidth; },
  // videoHeight: function(){ return this.el.videoHeight; },
  // textTracks: function(){ return this.el.textTracks; },
  // defaultPlaybackRate: function(){ return this.el.defaultPlaybackRate; },
  // playbackRate: function(){ return this.el.playbackRate; },
  // mediaGroup: function(){ return this.el.mediaGroup; },
  // controller: function(){ return this.el.controller; },
  controls: function(){ return this.player.options.controls; },
  // defaultMuted: function(){ return this.el.defaultMuted; }
  
  playlistPlayPrevious: function() { this.el.playlistPlayPrevious(); },
  playlistPlayNext: function() { this.el.playlistPlayNext(); },
  playlistGetInfo: function() {
    var playlist = [];
    if(typeof(this.el.playlistGetInfo) === 'function')
    {
      playlist = this.el.playlistGetInfo();
    }
    return playlist; 
  },
  playlistGetCurrentItemIndex: function() {
    var currentItemIndex = 0;
    if(typeof(this.el.playlistGetCurrentItemIndex) === 'function')
    {
      currentItemIndex = this.el.playlistGetCurrentItemIndex();
    }
    return currentItemIndex;
  }
});

/* PAC Support Testing -------------------------------------------------------- */

_V_.html5.isSupported = function(){
  // Support testing is done within IFAPI
  return true;
};

_V_.html5.canPlaySource = function(srcObj){
  // src detection is done within IFAPI
  return true;
};

_V_.html5.prototype.support = {
  progressEvent: false,
  timeUpdateEvent:false
};

// List of all PAC events (various uses).
_V_.html5.events = "loadstart,suspend,abort,error,emptied,stalled,loadedmetadata,loadeddata,canplay,canplaythrough,playing,waiting,seeking,seeked,ended,durationchange,timeupdate,progress,play,pause,ratechange,volumechange,stop,playlistchange,playlistindexchange,playlistend".split(",");


/* Stop Button
================================================================================ */
_V_.StopButton = _V_.Button.extend({

  buttonText: "Stop",

  buildCSSClass: function(){
    return "vjs-stop-control " + this._super();
  },

  onClick: function(){
  this.player.techCall('stop');
  }

});

/* MessageContainer - Container for all messages to be displayed in
================================================================================ */
_V_.MessageContainer = _V_.Component.extend({

  init: function(player, options){
    this._super(player, options);
  },

  createElement: function(){

    return this._super("div", {
      className: 'vjs-message',
      innerHTML: ''
    });
  }

});

/* Previous Button - Start Previous Item in Playlist
================================================================================ */
_V_.PreviousButton = _V_.Button.extend({

  buttonText: "Previous",

  init: function(player, options){
    this._super(player, options);
  this.addClass('vjs-inactive');

    player.addEvent('playlistchange', this.proxy(this.onPlaylistChangeHandler));
    player.addEvent('playlistindexchange', this.proxy(this.onPlaylistChangeHandler));
  },

  buildCSSClass: function(){
    return "vjs-previous-control " + this._super();
  },

  // OnClick - Toggle between play and pause
  onClick: function(){
    this.player.techCall('playlistPlayPrevious');
  },

  // onPlaylistChangeHandler - If there is a playlist, then show the button, add/remove the vjs-disabled class to allow appearance to change based on its state
  onPlaylistChangeHandler: function(){
    var playlist = this.player.techGet('playlistGetInfo');
    var currentIndex = this.player.techGet('playlistGetCurrentItemIndex');
  
  if(playlist.length > 1)
  {
    this.removeClass('vjs-inactive');
    if(currentIndex > 0) {
        _V_.removeClass(this.el, "vjs-disabled");
    }
    else
    {
        _V_.addClass(this.el, "vjs-disabled");
    }
  }
  else
  {
    this.addClass('vjs-inactive');
  }
  }

});

/* Next Button - Start Previous Item in Playlist
================================================================================ */
_V_.NextButton = _V_.Button.extend({

  buttonText: "Next",

  init: function(player, options){
    this._super(player, options);
    this.addClass('vjs-inactive');
    
    player.addEvent('playlistchange', this.proxy(this.onPlaylistChangeHandler));
    player.addEvent('playlistindexchange', this.proxy(this.onPlaylistChangeHandler));
    
  },

  buildCSSClass: function(){
    return "vjs-next-control " + this._super();
  },

  // OnClick - Toggle between play and pause
  onClick: function(){
    this.player.techCall('playlistPlayNext');
  },

  // onPlaylistChangeHandler - If there is a playlist, then show the button, add/remove the vjs-disabled class to allow appearance to change based on its state
  onPlaylistChangeHandler: function(){
    var playlist     = this.player.techGet('playlistGetInfo');
    var currentIndex = this.player.techGet('playlistGetCurrentItemIndex');

    if(playlist.length > 1)
    {
      this.removeClass('vjs-inactive');
      if(currentIndex < playlist.length - 1) {
          _V_.removeClass(this.el, "vjs-disabled");
      }
      else
      {
          _V_.addClass(this.el, "vjs-disabled");
      }
    }
    else
    {
      this.addClass('vjs-inactive');
    }
  }

});

(function() {
  
  _V_.merge(_V_.options || {}, { techOrder: ['html5'] });

  _V_.merge(_V_.ControlBar.prototype.options.components, {
      "stopButton": {},
      "previousButton": {},
      "nextButton": {}
    }
  );
  
  (function() {
    var temp = _V_.BigPlayButton.prototype.init;
    _V_.BigPlayButton.prototype.init = function(player, options) {
      temp.call(this, player, options);
      
      // Always display controls for AODPlayer
      if(this.player.tech.el.isAOD && this.player.tech.el.isAOD())
      {
        this.hide();
        player.removeEvent('ended', this.proxy(this.show));
      }
      else
      {
        player.addEvent('playing', this.proxy(this.hide));
      }
    };
  })();

  (function() {
    var temp = _V_.ControlBar.prototype.init;
    _V_.ControlBar.prototype.init = function(player, options) {
      temp.call(this, player, options);
      
      // Always display controls for AODPlayer
      if(this.player.tech.el.isAOD && this.player.tech.el.isAOD())
      {
          player.one("play", this.proxy(function(){
              this.player.removeEvent("mouseout", this.proxy(this.fadeOut));
          }));
          this.show();
      }
      else if(this.player.tech.el.isTV && this.player.tech.el.isTV())
      {
        this.addClass("live");
      }
    };
  })();

  (function() {
    var temp = _V_.VolumeControl.prototype.init;
    _V_.VolumeControl.prototype.init = function(player, options) {
      temp.call(this, player, options);
      
      // Mark Volume controls as inactive if unavailable
      if(this.player.tech.el.canSetVolume && !this.player.tech.el.canSetVolume())
      {
          this.addClass('vjs-inactive');
      }
    };
  })();

  (function() {
    var temp = _V_.PlayToggle.prototype.init;
    _V_.PlayToggle.prototype.init = function(player, options) {
      temp.call(this, player, options);
      player.addEvent('playing', player.proxy(this.onPlay));
      player.addEvent('play', player.proxy(this.onPlay));
      player.addEvent('pause', player.proxy(this.onPause));
    };
  })();
  
  (function() {
    var temp = _V_.Slider.prototype.init;
    _V_.Slider.prototype.init = function(player, options) {
      temp.call(this, player, options);
      this.addEvent('touchstart', this.proxy(this.onMouseDown));
    };
  })();

  (function() {
    var temp = _V_.Slider.prototype.onMouseDown;
    _V_.Slider.prototype.onMouseDown = function(event) {
      temp.call(this, event);
        _V_.addEvent(document, 'touchmove', _V_.proxy(this, this.onMouseMove));
        _V_.addEvent(document, 'touchend', _V_.proxy(this, this.onMouseUp));
    };
  })();
  
  (function() {
    var temp = _V_.Slider.prototype.onMouseUp;
    _V_.Slider.prototype.onMouseUp = function(event) {
      temp.call(this, event);
        _V_.removeEvent(document, 'touchmove', this.onMouseMove, false);
        _V_.removeEvent(document, 'touchend', this.onMouseUp, false);
    };
  })();

  (function() {
    var temp = _V_.Button.prototype.init;
    _V_.Button.prototype.init = function(player, options){
      temp.call(this, player, options);
      
      if(this.el.ontouchend !== undefined)
      {
        this.addEvent("touchend", this.onClick);
        this.removeEvent("click", this.onClick);
      }
    };
  })();

  (function() {
    var temp = _V_.SeekBar.prototype.init;
    _V_.SeekBar.prototype.init = function(player, options) {
      temp.call(this, player, options);
        this.player.addEvent("seeked", _V_.proxy(this, this.update));
    };
  })();

  (function() {
    var temp = _V_.SeekBar.prototype.onMouseDown;
    _V_.SeekBar.prototype.onMouseDown = function(event) {
      this.player.scrubbing = true;
      temp.call(this, event);
    };
  })();

  (function() {
    var temp = _V_.SeekBar.prototype.onMouseUp;
    _V_.SeekBar.prototype.onMouseUp = function(event) {
        temp.call(this, event);
        this.player.currentTime(this.player.values.currentTime);
    };
  })();

  (function() {
    var temp = _V_.RemainingTimeDisplay.prototype.init;
    _V_.RemainingTimeDisplay.prototype.init = function(player, options){
      temp.call(this, player, options);
        player.addEvent("seeked", _V_.proxy(this, this.updateContent));
    }
  })();

  (function() {
    var temp = _V_.CurrentTimeDisplay.prototype.init;
    _V_.CurrentTimeDisplay.prototype.init = function(player, options){
      temp.call(this, player, options);
        player.addEvent("seeked", _V_.proxy(this, this.updateContent));
    }
  })();

  _V_.Slider.prototype.update = function() {
    var progress = this.getPercent(),
      handle = this.handle;
      bar = this.bar;
      
    if(isNaN(progress))
    {
      progress = 0;
    }
    
    if(handle) {
      handle.el.style.left = _V_.round(progress * 100, 2) + "%";
    }
    
    bar.el.style.width = _V_.round(progress * 100, 2) + "%";
  };

  _V_.SeekBar.prototype.getPercent = function() {
    return (this.player.scrubbing) ? this.player.values.currentTime / this.player.duration() : this.player.currentTime() / this.player.duration();
  }

  _V_.Player.prototype.remainingTime = function() {
      var time = (this.scrubbing) ? this.values.currentTime : this.currentTime();
      return this.duration() - time;
  };
  
  _V_.Slider.prototype.calculateDistance = function(event){
    var box = this.el,
        pageX = 0,
        boxX = _V_.findPosX(box),
        boxW = box.offsetWidth;

    if(event.originalEvent != undefined)
    {
      event = event.originalEvent;
    }
    if(event.targetTouches != undefined)
    {
      pageX = event.targetTouches[0].pageX;
    }
    else
    {
      pageX = event.pageX;
    }
      
    // Percent that the click is through the adjusted area
    return Math.max(0, Math.min(1, (pageX - boxX) / boxW));
  };

  _V_.Player.prototype.currentTime = function(seconds) {

    if (seconds !== undefined)
    {
      // Cache the last set value for smoother scrubbing.
      this.values.currentTime = seconds;

      if(!this.scrubbing)
      {
        this.techCall("setCurrentTime", seconds);
      }
      else
      {
      // Improve the accuracy of manual timeupdates
        this.triggerEvent("timeupdate");
      }

      return this;
    }

    // Cache last currentTime and return
    // Default to 0 seconds
    this.values.currentTime = (this.scrubbing || this.tech.seeking())? this.values.currentTime : (this.techGet("currentTime") || 0);

    return this.values.currentTime;
  };

})();


//SCRIPT: ../../vendor/js/backbone-min.js
(function(){var u=this;var B=u.Backbone;var g=[];var D=g.push;var n=g.slice;var t=g.splice;var z;if(typeof exports!=="undefined"){z=exports}else{z=u.Backbone={}}z.VERSION="1.0.0";var L=u._;if(!L&&(typeof require!=="undefined")){L=require("underscore")}z.$=u.jQuery||u.Zepto||u.ender||u.$;z.noConflict=function(){u.Backbone=B;return this};z.emulateHTTP=false;z.emulateJSON=false;var J=z.Events={on:function(M,P,O){if(!x(this,"on",M,[P,O])||!P){return this}this._events||(this._events={});var N=this._events[M]||(this._events[M]=[]);N.push({callback:P,context:O,ctx:O||this});return this},once:function(N,Q,O){if(!x(this,"once",N,[Q,O])||!Q){return this}var M=this;var P=L.once(function(){M.off(N,P);Q.apply(this,arguments)});P._callback=Q;return this.on(N,P,O)},off:function(M,V,N){var T,U,W,S,R,O,Q,P;if(!this._events||!x(this,"off",M,[V,N])){return this}if(!M&&!V&&!N){this._events={};return this}S=M?[M]:L.keys(this._events);for(R=0,O=S.length;R<O;R++){M=S[R];if(W=this._events[M]){this._events[M]=T=[];if(V||N){for(Q=0,P=W.length;Q<P;Q++){U=W[Q];if((V&&V!==U.callback&&V!==U.callback._callback)||(N&&N!==U.context)){T.push(U)}}}if(!T.length){delete this._events[M]}}}return this},trigger:function(O){if(!this._events){return this}var N=n.call(arguments,1);if(!x(this,"trigger",O,N)){return this}var P=this._events[O];var M=this._events.all;if(P){b(P,N)}if(M){b(M,arguments)}return this},stopListening:function(P,M,R){var N=this._listeners;if(!N){return this}var O=!M&&!R;if(typeof M==="object"){R=this}if(P){(N={})[P._listenerId]=P}for(var Q in N){N[Q].off(M,R,this);if(O){delete this._listeners[Q]}}return this}};var w=/\s+/;var x=function(T,R,N,Q){if(!N){return true}if(typeof N==="object"){for(var P in N){T[R].apply(T,[P,N[P]].concat(Q))}return false}if(w.test(N)){var S=N.split(w);for(var O=0,M=S.length;O<M;O++){T[R].apply(T,[S[O]].concat(Q))}return false}return true};var b=function(R,P){var S,Q=-1,O=R.length,N=P[0],M=P[1],T=P[2];switch(P.length){case 0:while(++Q<O){(S=R[Q]).callback.call(S.ctx)}return;case 1:while(++Q<O){(S=R[Q]).callback.call(S.ctx,N)}return;case 2:while(++Q<O){(S=R[Q]).callback.call(S.ctx,N,M)}return;case 3:while(++Q<O){(S=R[Q]).callback.call(S.ctx,N,M,T)}return;default:while(++Q<O){(S=R[Q]).callback.apply(S.ctx,P)}}};var C={listenTo:"on",listenToOnce:"once"};L.each(C,function(M,N){J[N]=function(Q,O,S){var P=this._listeners||(this._listeners={});var R=Q._listenerId||(Q._listenerId=L.uniqueId("l"));P[R]=Q;if(typeof O==="object"){S=this}Q[M](O,S,this);return this}});J.bind=J.on;J.unbind=J.off;L.extend(z,J);var E=z.Model=function(M,O){var P;var N=M||{};O||(O={});this.cid=L.uniqueId("c");this.attributes={};L.extend(this,L.pick(O,F));if(O.parse){N=this.parse(N,O)||{}}if(P=L.result(this,"defaults")){N=L.defaults({},N,P)}this.set(N,O);this.changed={};this.initialize.apply(this,arguments)};var F=["url","urlRoot","collection"];L.extend(E.prototype,J,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(M){return L.clone(this.attributes)},sync:function(){return z.sync.apply(this,arguments)},get:function(M){return this.attributes[M]},escape:function(M){return L.escape(this.get(M))},has:function(M){return this.get(M)!=null},set:function(U,M,Y){var S,V,W,T,R,X,O,Q;if(U==null){return this}if(typeof U==="object"){V=U;Y=M}else{(V={})[U]=M}Y||(Y={});if(!this._validate(V,Y)){return false}W=Y.unset;R=Y.silent;T=[];X=this._changing;this._changing=true;if(!X){this._previousAttributes=L.clone(this.attributes);this.changed={}}Q=this.attributes,O=this._previousAttributes;if(this.idAttribute in V){this.id=V[this.idAttribute]}for(S in V){M=V[S];if(!L.isEqual(Q[S],M)){T.push(S)}if(!L.isEqual(O[S],M)){this.changed[S]=M}else{delete this.changed[S]}W?delete Q[S]:Q[S]=M}if(!R){if(T.length){this._pending=true}for(var P=0,N=T.length;P<N;P++){this.trigger("change:"+T[P],this,Q[T[P]],Y)}}if(X){return this}if(!R){while(this._pending){this._pending=false;this.trigger("change",this,Y)}}this._pending=false;this._changing=false;return this},unset:function(M,N){return this.set(M,void 0,L.extend({},N,{unset:true}))},clear:function(N){var M={};for(var O in this.attributes){M[O]=void 0}return this.set(M,L.extend({},N,{unset:true}))},hasChanged:function(M){if(M==null){return !L.isEmpty(this.changed)}return L.has(this.changed,M)},changedAttributes:function(O){if(!O){return this.hasChanged()?L.clone(this.changed):false}var Q,P=false;var N=this._changing?this._previousAttributes:this.attributes;for(var M in O){if(L.isEqual(N[M],(Q=O[M]))){continue}(P||(P={}))[M]=Q}return P},previous:function(M){if(M==null||!this._previousAttributes){return null}return this._previousAttributes[M]},previousAttributes:function(){return L.clone(this._previousAttributes)},fetch:function(N){N=N?L.clone(N):{};if(N.parse===void 0){N.parse=true}var M=this;var O=N.success;N.success=function(P){if(!M.set(M.parse(P,N),N)){return false}if(O){O(M,P,N)}M.trigger("sync",M,P,N)};H(this,N);return this.sync("read",this,N)},save:function(Q,N,U){var R,M,T,O=this.attributes;if(Q==null||typeof Q==="object"){R=Q;U=N}else{(R={})[Q]=N}if(R&&(!U||!U.wait)&&!this.set(R,U)){return false}U=L.extend({validate:true},U);if(!this._validate(R,U)){return false}if(R&&U.wait){this.attributes=L.extend({},O,R)}if(U.parse===void 0){U.parse=true}var P=this;var S=U.success;U.success=function(W){P.attributes=O;var V=P.parse(W,U);if(U.wait){V=L.extend(R||{},V)}if(L.isObject(V)&&!P.set(V,U)){return false}if(S){S(P,W,U)}P.trigger("sync",P,W,U)};H(this,U);M=this.isNew()?"create":(U.patch?"patch":"update");if(M==="patch"){U.attrs=R}T=this.sync(M,this,U);if(R&&U.wait){this.attributes=O}return T},destroy:function(N){N=N?L.clone(N):{};var M=this;var Q=N.success;var O=function(){M.trigger("destroy",M,M.collection,N)};N.success=function(R){if(N.wait||M.isNew()){O()}if(Q){Q(M,R,N)}if(!M.isNew()){M.trigger("sync",M,R,N)}};if(this.isNew()){N.success();return false}H(this,N);var P=this.sync("delete",this,N);if(!N.wait){O()}return P},url:function(){var M=L.result(this,"urlRoot")||L.result(this.collection,"url")||r();if(this.isNew()){return M}return M+(M.charAt(M.length-1)==="/"?"":"/")+encodeURIComponent(this.id)},parse:function(N,M){return N},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return this.id==null},isValid:function(M){return this._validate({},L.extend(M||{},{validate:true}))},_validate:function(O,N){if(!N.validate||!this.validate){return true}O=L.extend({},this.attributes,O);var M=this.validationError=this.validate(O,N)||null;if(!M){return true}this.trigger("invalid",this,M,L.extend(N||{},{validationError:M}));return false}});var a=["keys","values","pairs","invert","pick","omit"];L.each(a,function(M){E.prototype[M]=function(){var N=n.call(arguments);N.unshift(this.attributes);return L[M].apply(L,N)}});var c=z.Collection=function(N,M){M||(M={});if(M.url){this.url=M.url}if(M.model){this.model=M.model}if(M.comparator!==void 0){this.comparator=M.comparator}this._reset();this.initialize.apply(this,arguments);if(N){this.reset(N,L.extend({silent:true},M))}};var o={add:true,remove:true,merge:true};var K={add:true,merge:false,remove:false};L.extend(c.prototype,J,{model:E,initialize:function(){},toJSON:function(M){return this.map(function(N){return N.toJSON(M)})},sync:function(){return z.sync.apply(this,arguments)},add:function(N,M){return this.set(N,L.defaults(M||{},K))},remove:function(R,P){R=L.isArray(R)?R.slice():[R];P||(P={});var Q,M,O,N;for(Q=0,M=R.length;Q<M;Q++){N=this.get(R[Q]);if(!N){continue}delete this._byId[N.id];delete this._byId[N.cid];O=this.indexOf(N);this.models.splice(O,1);this.length--;if(!P.silent){P.index=O;N.trigger("remove",N,this,P)}this._removeReference(N)}return this},set:function(ae,N){N=L.defaults({},N,o);if(N.parse){ae=this.parse(ae,N)}if(!L.isArray(ae)){ae=ae?[ae]:[]}var ab,Y,O,V,T,ad;var Q=N.at;var Z=N.isEqual||false;var M=this.comparator&&(Q==null)&&N.sort!==false;var ac=L.isString(this.comparator)?this.comparator:null;var ag=[],W=[],U={},R=[];var S=N.add,P=N.merge,af=N.remove;var aa=!M&&S&&af?[]:false;for(ab=0,Y=ae.length;ab<Y;ab++){if(!(O=this._prepareModel(V=ae[ab],N))){continue}T=undefined;if(L.isFunction(Z)){var X=L.filter(this.models,function(ah){return Z(ah,O)});X=L.difference(X,R);if(X.length>0){T=X[0]}}if(T||(T=this.get(O))){R.push(T);if(af){U[T.cid]=true}if(P){V=V===O?O.attributes:N._attrs;T.set(V,N);if(M&&!ad&&T.hasChanged(ac)){ad=true}}}else{if(S){ag.push(O);O.on("all",this._onModelEvent,this);this._byId[O.cid]=O;if(O.id!=null){this._byId[O.id]=O}}}if(aa){aa.push(T||O)}delete N._attrs}if(af){for(ab=0,Y=this.length;ab<Y;++ab){if(!U[(O=this.models[ab]).cid]){W.push(O)}}if(W.length){this.remove(W,N)}}if(ag.length||(aa&&aa.length)){if(M){ad=true}this.length+=ag.length;if(Q!=null){t.apply(this.models,[Q,0].concat(ag))}else{if(aa){this.models.length=0}D.apply(this.models,aa||ag)}}if(ad){this.sort({silent:true})}if(N.silent){return this}for(ab=0,Y=ag.length;ab<Y;ab++){(O=ag[ab]).trigger("add",O,this,N)}if(ad||(aa&&aa.length)){this.trigger("sort",this,N)}return this},reset:function(P,N){N||(N={});for(var O=0,M=this.models.length;O<M;O++){this._removeReference(this.models[O])}N.previousModels=this.models;this._reset();this.add(P,L.extend({silent:true},N));if(!N.silent){this.trigger("reset",this,N)}return this},push:function(N,M){N=this._prepareModel(N,M);this.add(N,L.extend({at:this.length},M));return N},pop:function(N){var M=this.at(this.length-1);this.remove(M,N);return M},unshift:function(N,M){N=this._prepareModel(N,M);this.add(N,L.extend({at:0},M));return N},shift:function(N){var M=this.at(0);this.remove(M,N);return M},slice:function(N,M){return this.models.slice(N,M)},get:function(M){if(M==null){return void 0}return this._byId[M.id!=null?M.id:M.cid||M]},at:function(M){return this.models[M]},where:function(M,N){if(L.isEmpty(M)){return N?void 0:[]}return this[N?"find":"filter"](function(O){for(var P in M){if(M[P]!==O.get(P)){return false}}return true})},findWhere:function(M){return this.where(M,true)},sort:function(M){if(!this.comparator){throw new Error("Cannot sort a set without a comparator")}M||(M={});if(L.isString(this.comparator)||this.comparator.length===1){this.models=this.sortBy(this.comparator,this)}else{this.models.sort(L.bind(this.comparator,this))}if(!M.silent){this.trigger("sort",this,M)}return this},sortedIndex:function(M,P,N){P||(P=this.comparator);var O=L.isFunction(P)?P:function(Q){return Q.get(P)};return L.sortedIndex(this.models,M,O,N)},pluck:function(M){return L.invoke(this.models,"get",M)},fetch:function(M){M=M?L.clone(M):{};if(M.parse===void 0){M.parse=true}var O=M.success;var N=this;M.success=function(P){var Q=M.reset?"reset":"set";N[Q](P,M);if(O){O(N,P,M)}N.trigger("sync",N,P,M)};H(this,M);return this.sync("read",this,M)},create:function(N,M){M=M?L.clone(M):{};if(!(N=this._prepareModel(N,M))){return false}if(!M.wait){this.add(N,M)}var P=this;var O=M.success;M.success=function(Q){if(M.wait){P.add(N,M)}if(O){O(N,Q,M)}};N.save(null,M);return N},parse:function(N,M){return N},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0;this.models=[];this._byId={}},_prepareModel:function(O,N){if(O instanceof E){if(!O.collection){O.collection=this}return O}N||(N={});N.collection=this;var M=new this.model(O,N);if(!M._validate(O,N)){this.trigger("invalid",this,O,N);return false}return M},_removeReference:function(M){if(this===M.collection){delete M.collection}M.off("all",this._onModelEvent,this)},_onModelEvent:function(O,N,P,M){if((O==="add"||O==="remove")&&P!==this){return}if(O==="destroy"){this.remove(N,M)}if(N&&O==="change:"+N.idAttribute){delete this._byId[N.previous(N.idAttribute)];if(N.id!=null){this._byId[N.id]=N}}this.trigger.apply(this,arguments)}});var y=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","indexOf","shuffle","lastIndexOf","isEmpty","chain"];L.each(y,function(M){c.prototype[M]=function(){var N=n.call(arguments);N.unshift(this.models);return L[M].apply(L,N)}});var k=["groupBy","countBy","sortBy"];L.each(k,function(M){c.prototype[M]=function(P,N){var O=L.isFunction(P)?P:function(Q){return Q.get(P)};return L[M](this.models,O,N)}});var G=z.View=function(M){this.cid=L.uniqueId("view");this._configure(M||{});this._ensureElement();this.initialize.apply(this,arguments);this.delegateEvents()};var v=/^(\S+)\s*(.*)$/;var e=["model","collection","el","id","attributes","className","tagName","events"];L.extend(G.prototype,J,{tagName:"div",$:function(M){return this.$el.find(M)},initialize:function(){},render:function(){return this},remove:function(){this.$el.remove();this.stopListening();return this},setElement:function(M,N){if(this.$el){this.undelegateEvents()}this.$el=M instanceof z.$?M:z.$(M);this.el=this.$el[0];if(N!==false){this.delegateEvents()}return this},delegateEvents:function(Q){if(!(Q||(Q=L.result(this,"events")))){return this}this.undelegateEvents();for(var P in Q){var R=Q[P];if(!L.isFunction(R)){R=this[Q[P]]}if(!R){continue}var O=P.match(v);var N=O[1],M=O[2];R=L.bind(R,this);N+=".delegateEvents"+this.cid;if(M===""){this.$el.on(N,R)}else{this.$el.on(N,M,R)}}return this},undelegateEvents:function(){this.$el.off(".delegateEvents"+this.cid);return this},_configure:function(M){if(this.options){M=L.extend({},L.result(this,"options"),M)}L.extend(this,L.pick(M,e));this.options=M},_ensureElement:function(){if(!this.el){var M=L.extend({},L.result(this,"attributes"));if(this.id){M.id=L.result(this,"id")}if(this.className){M["class"]=L.result(this,"className")}var N=z.$("<"+L.result(this,"tagName")+">").attr(M);this.setElement(N,false)}else{this.setElement(L.result(this,"el"),false)}}});z.sync=function(S,N,M){var P=j[S];L.defaults(M||(M={}),{emulateHTTP:z.emulateHTTP,emulateJSON:z.emulateJSON});var R={type:P,dataType:"json"};if(!M.url){R.url=L.result(N,"url")||r()}if(M.data==null&&N&&(S==="create"||S==="update"||S==="patch")){R.contentType="application/json";R.data=JSON.stringify(M.attrs||N.toJSON(M))}if(M.emulateJSON){R.contentType="application/x-www-form-urlencoded";R.data=R.data?{model:R.data}:{}}if(M.emulateHTTP&&(P==="PUT"||P==="DELETE"||P==="PATCH")){R.type="POST";if(M.emulateJSON){R.data._method=P}var O=M.beforeSend;M.beforeSend=function(T){T.setRequestHeader("X-HTTP-Method-Override",P);if(O){return O.apply(this,arguments)}}}if(R.type!=="GET"&&!M.emulateJSON){R.processData=false}if(R.type==="PATCH"&&window.ActiveXObject&&!(window.external&&window.external.msActiveXFilteringEnabled)){R.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")}}var Q=M.xhr=z.ajax(L.extend(R,M));N.trigger("request",N,Q,M);return Q};var j={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};z.ajax=function(){return z.$.ajax.apply(z.$,arguments)};var p=z.Router=function(M){M||(M={});if(M.routes){this.routes=M.routes}this._bindRoutes();this.initialize.apply(this,arguments)};var q=/\((.*?)\)/g;var s=/(\(\?)?:\w+/g;var d=/\*\w+/g;var h=/[\-{}\[\]+?.,\\\^$|#\s]/g;L.extend(p.prototype,J,{initialize:function(){},route:function(N,O,P){if(!L.isRegExp(N)){N=this._routeToRegExp(N)}if(L.isFunction(O)){P=O;O=""}if(!P){P=this[O]}var M=this;z.history.route(N,function(R){var Q=M._extractParameters(N,R);P&&P.apply(M,Q);M.trigger.apply(M,["route:"+O].concat(Q));M.trigger("route",O,Q);z.history.trigger("route",M,O,Q)});return this},navigate:function(N,M){z.history.navigate(N,M);return this},_bindRoutes:function(){if(!this.routes){return}this.routes=L.result(this,"routes");var N,M=L.keys(this.routes);while((N=M.pop())!=null){this.route(N,this.routes[N])}},_routeToRegExp:function(M){M=M.replace(h,"\\$&").replace(q,"(?:$1)?").replace(s,function(O,N){return N?O:"([^/]+)"}).replace(d,"(.*?)");return new RegExp("^"+M+"$")},_extractParameters:function(M,N){var O=M.exec(N).slice(1);return L.map(O,function(P){return P?decodeURIComponent(P):null})}});var i=z.History=function(){this.handlers=[];L.bindAll(this,"checkUrl");if(typeof window!=="undefined"){this.location=window.location;this.history=window.history}};var A=/^[#\/]|\s+$/g;var f=/^\/+|\/+$/g;var I=/msie [\w.]+/;var m=/\/$/;i.started=false;L.extend(i.prototype,J,{interval:50,getHash:function(N){var M=(N||this).location.href.match(/#(.*)$/);return M?M[1]:""},getFragment:function(O,N){if(O==null){if(this._hasPushState||!this._wantsHashChange||N){O=this.location.pathname;var M=this.root.replace(m,"");if(!O.indexOf(M)){O=O.substr(M.length)}}else{O=this.getHash()}}return O.replace(A,"")},start:function(O){if(i.started){throw new Error("Backbone.history has already been started")}i.started=true;this.options=L.extend({},{root:"/"},this.options,O);this.root=this.options.root;this._wantsHashChange=this.options.hashChange!==false;this._wantsPushState=!!this.options.pushState;this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var N=this.getFragment();var M=document.documentMode;var Q=(I.exec(navigator.userAgent.toLowerCase())&&(!M||M<=7));this.root=("/"+this.root+"/").replace(f,"/");if(Q&&this._wantsHashChange){this.iframe=z.$('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow;this.navigate(N)}if(this._hasPushState){z.$(window).on("popstate",this.checkUrl)}else{if(this._wantsHashChange&&("onhashchange" in window)&&!Q){z.$(window).on("hashchange",this.checkUrl)}else{if(this._wantsHashChange){this._checkUrlInterval=setInterval(this.checkUrl,this.interval)}}}this.fragment=N;var R=this.location;var P=R.pathname.replace(/[^\/]$/,"$&/")===this.root;if(this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!P){this.fragment=this.getFragment(null,true);this.location.replace(this.root+this.location.search+"#"+this.fragment);return true}else{if(this._wantsPushState&&this._hasPushState&&P&&R.hash){this.fragment=this.getHash().replace(A,"");this.history.replaceState({},document.title,this.root+this.fragment+R.search)}}if(!this.options.silent){return this.loadUrl()}},stop:function(){z.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl);clearInterval(this._checkUrlInterval);i.started=false},route:function(M,N){this.handlers.unshift({route:M,callback:N})},checkUrl:function(N){var M=this.getFragment();if(M===this.fragment&&this.iframe){M=this.getFragment(this.getHash(this.iframe))}if(M===this.fragment){return false}if(this.iframe){this.navigate(M)}this.loadUrl()||this.loadUrl(this.getHash())},loadUrl:function(O){var N=this.fragment=this.getFragment(O);var M=L.any(this.handlers,function(P){if(P.route.test(N)){P.callback(N);return true}});return M},navigate:function(O,N){if(!i.started){return false}if(!N||N===true){N={trigger:N}}O=this.getFragment(O||"");if(this.fragment===O){return}this.fragment=O;var M=this.root+O;if(this._hasPushState){this.history[N.replace?"replaceState":"pushState"]({},document.title,M)}else{if(this._wantsHashChange){this._updateHash(this.location,O,N.replace);if(this.iframe&&(O!==this.getFragment(this.getHash(this.iframe)))){if(!N.replace){this.iframe.document.open().close()}this._updateHash(this.iframe.location,O,N.replace)}}else{return this.location.assign(M)}}if(N.trigger){this.loadUrl(O)}},_updateHash:function(M,O,P){if(P){var N=M.href.replace(/(javascript:|#).*$/,"");M.replace(N+"#"+O)}else{M.hash="#"+O}}});z.history=new i;var l=function(M,O){var N=this;var Q;if(M&&L.has(M,"constructor")){Q=M.constructor}else{Q=function(){return N.apply(this,arguments)}}L.extend(Q,N,O);var P=function(){this.constructor=Q};P.prototype=N.prototype;Q.prototype=new P;if(M){L.extend(Q.prototype,M)}Q.__super__=N.prototype;return Q};E.extend=c.extend=p.extend=G.extend=i.extend=l;var r=function(){throw new Error('A "url" property or function must be specified')};var H=function(O,N){var M=N.error;N.error=function(P){if(M){M(O,P,N)}O.trigger("error",O,P,N)}}}).call(this);

//SCRIPT: ../../vendor/js/jquery/jquery.fancybox-1.3.4.js
/*
 * FancyBox - jQuery Plugin
 * Simple and fancy lightbox alternative
 *
 * Examples and documentation at: http://fancybox.net
 *
 * Copyright (c) 2008 - 2010 Janis Skarnelis
 * That said, it is hardly a one-person project. Many people have submitted bugs, code, and offered their advice freely. Their support is greatly appreciated.
 *
 * Version: 1.3.4 (11/11/2010)
 * Requires: jQuery v1.3+
 *
 * Dual licensed under the MIT and GPL licenses:
 *   http://www.opensource.org/licenses/mit-license.php
 *   http://www.gnu.org/licenses/gpl.html
 */

;(function($) {
	var tmp, loading, overlay, wrap, outer, content, close, title, nav_left, nav_right,

		selectedIndex = 0, selectedOpts = {}, selectedArray = [], currentIndex = 0, currentOpts = {}, currentArray = [],

		ajaxLoader = null, imgPreloader = new Image(), imgRegExp = /\.(jpg|gif|png|bmp|jpeg)(.*)?$/i, swfRegExp = /[^\.]\.(swf)\s*$/i,

		loadingTimer, loadingFrame = 1,

		titleHeight = 0, titleStr = '', start_pos, final_pos, busy = false, fx = $.extend($('<div/>')[0], { prop: 0 }),

		isIE6 = $.browser.msie && $.browser.version < 7 && !window.XMLHttpRequest,

		/*
		 * Private methods 
		 */

		_abort = function() {
			loading.hide();

			imgPreloader.onerror = imgPreloader.onload = null;

			if (ajaxLoader) {
				ajaxLoader.abort();
			}

			tmp.empty();
		},

		_error = function() {
			if (false === selectedOpts.onError(selectedArray, selectedIndex, selectedOpts)) {
				loading.hide();
				busy = false;
				return;
			}

			selectedOpts.titleShow = false;

			selectedOpts.width = 'auto';
			selectedOpts.height = 'auto';

			tmp.html( '<p id="fancybox-error">The requested content cannot be loaded.<br />Please try again later.</p>' );

			_process_inline();
		},

		_start = function() {
			var obj = selectedArray[ selectedIndex ],
				href, 
				type, 
				title,
				str,
				emb,
				ret;

			_abort();

			selectedOpts = $.extend({}, $.fn.fancybox.defaults, (typeof $(obj).data('fancybox') == 'undefined' ? selectedOpts : $(obj).data('fancybox')));

			ret = selectedOpts.onStart(selectedArray, selectedIndex, selectedOpts);

			if (ret === false) {
				busy = false;
				return;
			} else if (typeof ret == 'object') {
				selectedOpts = $.extend(selectedOpts, ret);
			}

			title = selectedOpts.title || (obj.nodeName ? $(obj).attr('title') : obj.title) || '';

			if (obj.nodeName && !selectedOpts.orig) {
				selectedOpts.orig = $(obj).children("img:first").length ? $(obj).children("img:first") : $(obj);
			}

			if (title === '' && selectedOpts.orig && selectedOpts.titleFromAlt) {
				title = selectedOpts.orig.attr('alt');
			}

			href = selectedOpts.href || (obj.nodeName ? $(obj).attr('href') : obj.href) || null;

			if ((/^(?:javascript)/i).test(href) || href == '#') {
				href = null;
			}

			if (selectedOpts.type) {
				type = selectedOpts.type;

				if (!href) {
					href = selectedOpts.content;
				}

			} else if (selectedOpts.content) {
				type = 'html';

			} else if (href) {
				if (href.match(imgRegExp)) {
					type = 'image';

				} else if (href.match(swfRegExp)) {
					type = 'swf';

				} else if ($(obj).hasClass("iframe")) {
					type = 'iframe';

				} else if (href.indexOf("#") === 0) {
					type = 'inline';

				} else {
					type = 'ajax';
				}
			}

			if (!type) {
				_error();
				return;
			}

			if (type == 'inline') {
				obj	= href.substr(href.indexOf("#"));
				type = $(obj).length > 0 ? 'inline' : 'ajax';
			}

			selectedOpts.type = type;
			selectedOpts.href = href;
			selectedOpts.title = title;

			if (selectedOpts.autoDimensions) {
				if (selectedOpts.type == 'html' || selectedOpts.type == 'inline' || selectedOpts.type == 'ajax') {
					selectedOpts.width = 'auto';
					selectedOpts.height = 'auto';
				} else {
					selectedOpts.autoDimensions = false;	
				}
			}

			if (selectedOpts.modal) {
				selectedOpts.overlayShow = true;
				selectedOpts.hideOnOverlayClick = false;
				selectedOpts.hideOnContentClick = false;
				selectedOpts.enableEscapeButton = false;
				selectedOpts.showCloseButton = false;
			}

			selectedOpts.padding = parseInt(selectedOpts.padding, 10);
			selectedOpts.margin = parseInt(selectedOpts.margin, 10);

			tmp.css('padding', (selectedOpts.padding + selectedOpts.margin));

			$('.fancybox-inline-tmp').unbind('fancybox-cancel').bind('fancybox-change', function() {
				$(this).replaceWith(content.children());				
			});

			switch (type) {
				case 'html' :
					tmp.html( selectedOpts.content );
					_process_inline();
				break;

				case 'inline' :
					if ( $(obj).parent().is('#fancybox-content') === true) {
						busy = false;
						return;
					}

					$('<div class="fancybox-inline-tmp" />')
						.hide()
						.insertBefore( $(obj) )
						.bind('fancybox-cleanup', function() {
							$(this).replaceWith(content.children());
						}).bind('fancybox-cancel', function() {
							$(this).replaceWith(tmp.children());
						});

					$(obj).appendTo(tmp);

					_process_inline();
				break;

				case 'image':
					busy = false;

					$.fancybox.showActivity();

					imgPreloader = new Image();

					imgPreloader.onerror = function() {
						_error();
					};

					imgPreloader.onload = function() {
						busy = true;

						imgPreloader.onerror = imgPreloader.onload = null;

						_process_image();
					};

					imgPreloader.src = href;
				break;

				case 'swf':
					selectedOpts.scrolling = 'no';

					str = '<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="' + selectedOpts.width + '" height="' + selectedOpts.height + '"><param name="movie" value="' + href + '"></param>';
					emb = '';

					$.each(selectedOpts.swf, function(name, val) {
						str += '<param name="' + name + '" value="' + val + '"></param>';
						emb += ' ' + name + '="' + val + '"';
					});

					str += '<embed src="' + href + '" type="application/x-shockwave-flash" width="' + selectedOpts.width + '" height="' + selectedOpts.height + '"' + emb + '></embed></object>';

					tmp.html(str);

					_process_inline();
				break;

				case 'ajax':
					busy = false;

					$.fancybox.showActivity();

					selectedOpts.ajax.win = selectedOpts.ajax.success;

					ajaxLoader = $.ajax($.extend({}, selectedOpts.ajax, {
						url	: href,
						data : selectedOpts.ajax.data || {},
						error : function(XMLHttpRequest, textStatus, errorThrown) {
							if ( XMLHttpRequest.status > 0 ) {
								_error();
							}
						},
						success : function(data, textStatus, XMLHttpRequest) {
							var o = typeof XMLHttpRequest == 'object' ? XMLHttpRequest : ajaxLoader;
							if (o.status == 200) {
								if ( typeof selectedOpts.ajax.win == 'function' ) {
									ret = selectedOpts.ajax.win(href, data, textStatus, XMLHttpRequest);

									if (ret === false) {
										loading.hide();
										return;
									} else if (typeof ret == 'string' || typeof ret == 'object') {
										data = ret;
									}
								}

								tmp.html( data );
								_process_inline();
							}
						}
					}));

				break;

				case 'iframe':
					_show();
				break;
			}
		},

		_process_inline = function() {
			var
				w = selectedOpts.width,
				h = selectedOpts.height;

			if (w.toString().indexOf('%') > -1) {
				w = parseInt( ($(window).width() - (selectedOpts.margin * 2)) * parseFloat(w) / 100, 10) + 'px';

			} else {
				w = w == 'auto' ? 'auto' : w + 'px';	
			}

			if (h.toString().indexOf('%') > -1) {
				h = parseInt( ($(window).height() - (selectedOpts.margin * 2)) * parseFloat(h) / 100, 10) + 'px';

			} else {
				h = h == 'auto' ? 'auto' : h + 'px';	
			}

			tmp.wrapInner('<div style="width:' + w + ';height:' + h + ';overflow: ' + (selectedOpts.scrolling == 'auto' ? 'auto' : (selectedOpts.scrolling == 'yes' ? 'scroll' : 'hidden')) + ';position:relative;"></div>');

			selectedOpts.width = tmp.width();
			selectedOpts.height = tmp.height();

			_show();
		},

		_process_image = function() {
			selectedOpts.width = imgPreloader.width;
			selectedOpts.height = imgPreloader.height;

			$("<img />").attr({
				'id' : 'fancybox-img',
				'src' : imgPreloader.src,
				'alt' : selectedOpts.title
			}).appendTo( tmp );

			_show();
		},

		_show = function() {
			var pos, equal;

			loading.hide();

			if (wrap.is(":visible") && false === currentOpts.onCleanup(currentArray, currentIndex, currentOpts)) {
				$.event.trigger('fancybox-cancel');

				busy = false;
				return;
			}

			busy = true;

			$(content.add( overlay )).unbind();

			$(window).unbind("resize.fb scroll.fb");
			$(document).unbind('keydown.fb');

			if (wrap.is(":visible") && currentOpts.titlePosition !== 'outside') {
				wrap.css('height', wrap.height());
			}

			currentArray = selectedArray;
			currentIndex = selectedIndex;
			currentOpts = selectedOpts;

			if (currentOpts.overlayShow) {
				overlay.css({
					'background-color' : currentOpts.overlayColor,
					'opacity' : currentOpts.overlayOpacity,
					'cursor' : currentOpts.hideOnOverlayClick ? 'pointer' : 'auto',
					'height' : $(document).height()
				});

				if (!overlay.is(':visible')) {
					if (isIE6) {
						$('select:not(#fancybox-tmp select)').filter(function() {
							return this.style.visibility !== 'hidden';
						}).css({'visibility' : 'hidden'}).one('fancybox-cleanup', function() {
							this.style.visibility = 'inherit';
						});
					}

					overlay.show();
				}
			} else {
				overlay.hide();
			}

			final_pos = _get_zoom_to();

			_process_title();

			if (wrap.is(":visible")) {
				$( close.add( nav_left ).add( nav_right ) ).hide();

				pos = wrap.position(),

				start_pos = {
					top	 : pos.top,
					left : pos.left,
					width : wrap.width(),
					height : wrap.height()
				};

				equal = (start_pos.width == final_pos.width && start_pos.height == final_pos.height);

				content.fadeTo(currentOpts.changeFade, 0.3, function() {
					var finish_resizing = function() {
						content.html( tmp.contents() ).fadeTo(currentOpts.changeFade, 1, _finish);
					};

					$.event.trigger('fancybox-change');

					content
						.empty()
						.removeAttr('filter')
						.css({
							'border-width' : currentOpts.padding,
							'width'	: final_pos.width - currentOpts.padding * 2,
							'height' : selectedOpts.autoDimensions ? 'auto' : final_pos.height - titleHeight - currentOpts.padding * 2
						});

					if (equal) {
						finish_resizing();

					} else {
						fx.prop = 0;

						$(fx).animate({prop: 1}, {
							 duration : currentOpts.changeSpeed,
							 easing : currentOpts.easingChange,
							 step : _draw,
							 complete : finish_resizing
						});
					}
				});

				return;
			}

			wrap.removeAttr("style");

			content.css('border-width', currentOpts.padding);

			if (currentOpts.transitionIn == 'elastic') {
				start_pos = _get_zoom_from();

				content.html( tmp.contents() );

				wrap.show();

				if (currentOpts.opacity) {
					final_pos.opacity = 0;
				}

				fx.prop = 0;

				$(fx).animate({prop: 1}, {
					 duration : currentOpts.speedIn,
					 easing : currentOpts.easingIn,
					 step : _draw,
					 complete : _finish
				});

				return;
			}

			if (currentOpts.titlePosition == 'inside' && titleHeight > 0) {	
				title.show();	
			}

			content
				.css({
					'width' : final_pos.width - currentOpts.padding * 2,
					'height' : selectedOpts.autoDimensions ? 'auto' : final_pos.height - titleHeight - currentOpts.padding * 2
				})
				.html( tmp.contents() );

			wrap
				.css(final_pos)
				.fadeIn( currentOpts.transitionIn == 'none' ? 0 : currentOpts.speedIn, _finish );
		},

		_format_title = function(title) {
			if (title && title.length) {
				if (currentOpts.titlePosition == 'float') {
					return '<table id="fancybox-title-float-wrap" cellpadding="0" cellspacing="0"><tr><td id="fancybox-title-float-left"></td><td id="fancybox-title-float-main">' + title + '</td><td id="fancybox-title-float-right"></td></tr></table>';
				}

				return '<div id="fancybox-title-' + currentOpts.titlePosition + '">' + title + '</div>';
			}

			return false;
		},

		_process_title = function() {
			titleStr = currentOpts.title || '';
			titleHeight = 0;

			title
				.empty()
				.removeAttr('style')
				.removeClass();

			if (currentOpts.titleShow === false) {
				title.hide();
				return;
			}

			titleStr = $.isFunction(currentOpts.titleFormat) ? currentOpts.titleFormat(titleStr, currentArray, currentIndex, currentOpts) : _format_title(titleStr);

			if (!titleStr || titleStr === '') {
				title.hide();
				return;
			}

			title
				.addClass('fancybox-title-' + currentOpts.titlePosition)
				.html( titleStr )
				.appendTo( '#wrapper' )
				.show();

			switch (currentOpts.titlePosition) {
				case 'inside':
					title
						.css({
							'width' : final_pos.width - (currentOpts.padding * 2),
							'marginLeft' : currentOpts.padding,
							'marginRight' : currentOpts.padding
						});

					titleHeight = title.outerHeight(true);

					title.appendTo( outer );

					final_pos.height += titleHeight;
				break;

				case 'over':
					title
						.css({
							'marginLeft' : currentOpts.padding,
							'width'	: final_pos.width - (currentOpts.padding * 2),
							'bottom' : currentOpts.padding
						})
						.appendTo( outer );
				break;

				case 'float':
					title
						.css('left', parseInt((title.width() - final_pos.width - 40)/ 2, 10) * -1)
						.appendTo( wrap );
				break;

				default:
					title
						.css({
							'width' : final_pos.width - (currentOpts.padding * 2),
							'paddingLeft' : currentOpts.padding,
							'paddingRight' : currentOpts.padding
						})
						.appendTo( wrap );
				break;
			}

			title.hide();
		},

		_set_navigation = function() {
			if (currentOpts.enableEscapeButton || currentOpts.enableKeyboardNav) {
				$(document).bind('keydown.fb', function(e) {
					if (e.keyCode == 27 && currentOpts.enableEscapeButton) {
						e.preventDefault();
						$.fancybox.close();

					} else if ((e.keyCode == 37 || e.keyCode == 39) && currentOpts.enableKeyboardNav && e.target.tagName !== 'INPUT' && e.target.tagName !== 'TEXTAREA' && e.target.tagName !== 'SELECT') {
						e.preventDefault();
						$.fancybox[ e.keyCode == 37 ? 'prev' : 'next']();
					}
				});
			}

			if (!currentOpts.showNavArrows) { 
				nav_left.hide();
				nav_right.hide();
				return;
			}

			if ((currentOpts.cyclic && currentArray.length > 1) || currentIndex !== 0) {
				nav_left.show();
			}

			if ((currentOpts.cyclic && currentArray.length > 1) || currentIndex != (currentArray.length -1)) {
				nav_right.show();
			}
		},

		_finish = function () {
			if (!$.support.opacity) {
				content.get(0).style.removeAttribute('filter');
				wrap.get(0).style.removeAttribute('filter');
			}

			if (selectedOpts.autoDimensions) {
				content.css('height', 'auto');
			}

			wrap.css('height', 'auto');

			if (titleStr && titleStr.length) {
				title.show();
			}

			if (currentOpts.showCloseButton) {
				close.show();
			}

			_set_navigation();
	
			if (currentOpts.hideOnContentClick)	{
				content.bind('click', $.fancybox.close);
			}

			if (currentOpts.hideOnOverlayClick)	{
				overlay.bind('click', $.fancybox.close);
			}

			$(window).bind("resize.fb", $.fancybox.resize);

			if (currentOpts.centerOnScroll) {
				$(window).bind("scroll.fb", $.fancybox.center);
			}

			if (currentOpts.type == 'iframe') {
				$('<iframe id="fancybox-frame" name="fancybox-frame' + new Date().getTime() + '" frameborder="0" hspace="0" ' + ($.browser.msie ? 'allowtransparency="true""' : '') + ' scrolling="' + selectedOpts.scrolling + '" src="' + currentOpts.href + '"></iframe>').appendTo(content);
			}

			wrap.show();

			busy = false;

			$.fancybox.center();

			currentOpts.onComplete(currentArray, currentIndex, currentOpts);

			_preload_images();
		},

		_preload_images = function() {
			var href, 
				objNext;

			if ((currentArray.length -1) > currentIndex) {
				href = currentArray[ currentIndex + 1 ].href;

				if (typeof href !== 'undefined' && href.match(imgRegExp)) {
					objNext = new Image();
					objNext.src = href;
				}
			}

			if (currentIndex > 0) {
				href = currentArray[ currentIndex - 1 ].href;

				if (typeof href !== 'undefined' && href.match(imgRegExp)) {
					objNext = new Image();
					objNext.src = href;
				}
			}
		},

		_draw = function(pos) {
			var dim = {
				width : parseInt(start_pos.width + (final_pos.width - start_pos.width) * pos, 10),
				height : parseInt(start_pos.height + (final_pos.height - start_pos.height) * pos, 10),

				top : parseInt(start_pos.top + (final_pos.top - start_pos.top) * pos, 10),
				left : parseInt(start_pos.left + (final_pos.left - start_pos.left) * pos, 10)
			};

			if (typeof final_pos.opacity !== 'undefined') {
				dim.opacity = pos < 0.5 ? 0.5 : pos;
			}

			wrap.css(dim);

			content.css({
				'width' : dim.width - currentOpts.padding * 2,
				'height' : dim.height - (titleHeight * pos) - currentOpts.padding * 2
			});
		},

		_get_viewport = function() {
			return [
				$(window).width() - (currentOpts.margin * 2),
				$(window).height() - (currentOpts.margin * 2),
				$(document).scrollLeft() + currentOpts.margin,
				$(document).scrollTop() + currentOpts.margin
			];
		},

		_get_zoom_to = function () {
			var view = _get_viewport(),
				to = {},
				resize = currentOpts.autoScale,
				double_padding = currentOpts.padding * 2,
				ratio;

			if (currentOpts.width.toString().indexOf('%') > -1) {
				to.width = parseInt((view[0] * parseFloat(currentOpts.width)) / 100, 10);
			} else {
				to.width = currentOpts.width + double_padding;
			}

			if (currentOpts.height.toString().indexOf('%') > -1) {
				to.height = parseInt((view[1] * parseFloat(currentOpts.height)) / 100, 10);
			} else {
				to.height = currentOpts.height + double_padding;
			}

			if (resize && (to.width > view[0] || to.height > view[1])) {
				if (selectedOpts.type == 'image' || selectedOpts.type == 'swf') {
					ratio = (currentOpts.width ) / (currentOpts.height );

					if ((to.width ) > view[0]) {
						to.width = view[0];
						to.height = parseInt(((to.width - double_padding) / ratio) + double_padding, 10);
					}

					if ((to.height) > view[1]) {
						to.height = view[1];
						to.width = parseInt(((to.height - double_padding) * ratio) + double_padding, 10);
					}

				} else {
					to.width = Math.min(to.width, view[0]);
					to.height = Math.min(to.height, view[1]);
				}
			}

			to.top = parseInt(Math.max(view[3] - 20, view[3] + ((view[1] - to.height - 40) * 0.5)), 10);
			to.left = parseInt(Math.max(view[2] - 20, view[2] + ((view[0] - to.width - 40) * 0.5)), 10);

			return to;
		},

		_get_obj_pos = function(obj) {
			var pos = obj.offset();

			pos.top += parseInt( obj.css('paddingTop'), 10 ) || 0;
			pos.left += parseInt( obj.css('paddingLeft'), 10 ) || 0;

			pos.top += parseInt( obj.css('border-top-width'), 10 ) || 0;
			pos.left += parseInt( obj.css('border-left-width'), 10 ) || 0;

			pos.width = obj.width();
			pos.height = obj.height();

			return pos;
		},

		_get_zoom_from = function() {
			var orig = selectedOpts.orig ? $(selectedOpts.orig) : false,
				from = {},
				pos,
				view;

			if (orig && orig.length) {
				pos = _get_obj_pos(orig);

				from = {
					width : pos.width + (currentOpts.padding * 2),
					height : pos.height + (currentOpts.padding * 2),
					top	: pos.top - currentOpts.padding - 20,
					left : pos.left - currentOpts.padding - 20
				};

			} else {
				view = _get_viewport();

				from = {
					width : currentOpts.padding * 2,
					height : currentOpts.padding * 2,
					top	: parseInt(view[3] + view[1] * 0.5, 10),
					left : parseInt(view[2] + view[0] * 0.5, 10)
				};
			}

			return from;
		},

		_animate_loading = function() {
			if (!loading.is(':visible')){
				clearInterval(loadingTimer);
				return;
			}

			$('div', loading).css('top', (loadingFrame * -40) + 'px');

			loadingFrame = (loadingFrame + 1) % 12;
		};

	/*
	 * Public methods 
	 */

	$.fn.fancybox = function(options) {
		if (!$(this).length) {
			return this;
		}

		$(this)
			.data('fancybox', $.extend({}, options, ($.metadata ? $(this).metadata() : {})))
			.unbind('click.fb')
			.bind('click.fb', function(e) {
				e.preventDefault();

				if (busy) {
					return;
				}

				busy = true;

				$(this).blur();

				selectedArray = [];
				selectedIndex = 0;

				var rel = $(this).attr('rel') || '';

				if (!rel || rel == '' || rel === 'nofollow') {
					selectedArray.push(this);

				} else {
					selectedArray = $("a[rel=" + rel + "], area[rel=" + rel + "]");
					selectedIndex = selectedArray.index( this );
				}

				_start();

				return;
			});

		return this;
	};

	$.fancybox = function(obj) {
		var opts;

		if (busy) {
			return;
		}

		busy = true;
		opts = typeof arguments[1] !== 'undefined' ? arguments[1] : {};

		selectedArray = [];
		selectedIndex = parseInt(opts.index, 10) || 0;

		if ($.isArray(obj)) {
			for (var i = 0, j = obj.length; i < j; i++) {
				if (typeof obj[i] == 'object') {
					$(obj[i]).data('fancybox', $.extend({}, opts, obj[i]));
				} else {
					obj[i] = $({}).data('fancybox', $.extend({content : obj[i]}, opts));
				}
			}

			selectedArray = jQuery.merge(selectedArray, obj);

		} else {
			if (typeof obj == 'object') {
				$(obj).data('fancybox', $.extend({}, opts, obj));
			} else {
				obj = $({}).data('fancybox', $.extend({content : obj}, opts));
			}

			selectedArray.push(obj);
		}

		if (selectedIndex > selectedArray.length || selectedIndex < 0) {
			selectedIndex = 0;
		}

		_start();
	};

	$.fancybox.showActivity = function() {
		clearInterval(loadingTimer);

		loading.show();
		loadingTimer = setInterval(_animate_loading, 66);
	};

	$.fancybox.hideActivity = function() {
		loading.hide();
	};

	$.fancybox.next = function() {
		return $.fancybox.pos( currentIndex + 1);
	};

	$.fancybox.prev = function() {
		return $.fancybox.pos( currentIndex - 1);
	};

	$.fancybox.pos = function(pos) {
		if (busy) {
			return;
		}

		pos = parseInt(pos);

		selectedArray = currentArray;

		if (pos > -1 && pos < currentArray.length) {
			selectedIndex = pos;
			_start();

		} else if (currentOpts.cyclic && currentArray.length > 1) {
			selectedIndex = pos >= currentArray.length ? 0 : currentArray.length - 1;
			_start();
		}

		return;
	};

	$.fancybox.cancel = function() {
		if (busy) {
			return;
		}

		busy = true;

		$.event.trigger('fancybox-cancel');

		_abort();

		selectedOpts.onCancel(selectedArray, selectedIndex, selectedOpts);

		busy = false;
	};

	// Note: within an iframe use - parent.$.fancybox.close();
	$.fancybox.close = function() {
		if (busy || wrap.is(':hidden')) {
			return;
		}

		busy = true;

		if (currentOpts && false === currentOpts.onCleanup(currentArray, currentIndex, currentOpts)) {
			busy = false;
			return;
		}

		_abort();

		$(close.add( nav_left ).add( nav_right )).hide();

		$(content.add( overlay )).unbind();

		$(window).unbind("resize.fb scroll.fb");
		$(document).unbind('keydown.fb');

		content.find('iframe').attr('src', isIE6 && /^https/i.test(window.location.href || '') ? 'javascript:void(false)' : 'about:blank');

		if (currentOpts.titlePosition !== 'inside') {
			title.empty();
		}

		wrap.stop();

		function _cleanup() {
			overlay.fadeOut('fast');

			title.empty().hide();
			wrap.hide();

			$.event.trigger('fancybox-cleanup');

			content.empty();

			currentOpts.onClosed(currentArray, currentIndex, currentOpts);

			currentArray = selectedOpts	= [];
			currentIndex = selectedIndex = 0;
			currentOpts = selectedOpts	= {};

			busy = false;
		}

		if (currentOpts.transitionOut == 'elastic') {
			start_pos = _get_zoom_from();

			var pos = wrap.position();

			final_pos = {
				top	 : pos.top ,
				left : pos.left,
				width :	wrap.width(),
				height : wrap.height()
			};

			if (currentOpts.opacity) {
				final_pos.opacity = 1;
			}

			title.empty().hide();

			fx.prop = 1;

			$(fx).animate({ prop: 0 }, {
				 duration : currentOpts.speedOut,
				 easing : currentOpts.easingOut,
				 step : _draw,
				 complete : _cleanup
			});

		} else {
			wrap.fadeOut( currentOpts.transitionOut == 'none' ? 0 : currentOpts.speedOut, _cleanup);
		}
	};

	$.fancybox.resize = function() {
		if (overlay.is(':visible')) {
			overlay.css('height', $(document).height());
		}

		$.fancybox.center(true);
	};

	$.fancybox.center = function() {
		var view, align;

		if (busy) {
			return;	
		}

		align = arguments[0] === true ? 1 : 0;
		view = _get_viewport();

		if (!align && (wrap.width() > view[0] || wrap.height() > view[1])) {
			return;	
		}

		wrap
			.stop()
			.animate({
				'top' : parseInt(Math.max(view[3] - 20, view[3] + ((view[1] - content.height() - 40) * 0.5) - currentOpts.padding)),
				'left' : parseInt(Math.max(view[2] - 20, view[2] + ((view[0] - content.width() - 40) * 0.5) - currentOpts.padding))
			}, typeof arguments[0] == 'number' ? arguments[0] : 200);
	};

	$.fancybox.init = function() {
		if ($("#fancybox-wrap").length) {
			return;
		}

		$('#wrapper').append(
			tmp	= $('<div id="fancybox-tmp"></div>'),
			loading	= $('<div id="fancybox-loading"><div></div></div>'),
			overlay	= $('<div id="fancybox-overlay"></div>'),
			wrap = $('<div id="fancybox-wrap"></div>')
		);

		outer = $('<div id="fancybox-outer"></div>')
			.append('<div class="fancybox-bg" id="fancybox-bg-n"></div><div class="fancybox-bg" id="fancybox-bg-ne"></div><div class="fancybox-bg" id="fancybox-bg-e"></div><div class="fancybox-bg" id="fancybox-bg-se"></div><div class="fancybox-bg" id="fancybox-bg-s"></div><div class="fancybox-bg" id="fancybox-bg-sw"></div><div class="fancybox-bg" id="fancybox-bg-w"></div><div class="fancybox-bg" id="fancybox-bg-nw"></div>')
			.appendTo( wrap );

		outer.append(
			content = $('<div id="fancybox-content"></div>'),
			close = $('<a id="fancybox-close"></a>'),
			title = $('<div id="fancybox-title"></div>'),

			nav_left = $('<a href="javascript:;" id="fancybox-left"><span class="fancy-ico" id="fancybox-left-ico"></span></a>'),
			nav_right = $('<a href="javascript:;" id="fancybox-right"><span class="fancy-ico" id="fancybox-right-ico"></span></a>')
		);

		close.click($.fancybox.close);
		loading.click($.fancybox.cancel);

		nav_left.click(function(e) {
			e.preventDefault();
			$.fancybox.prev();
		});

		nav_right.click(function(e) {
			e.preventDefault();
			$.fancybox.next();
		});

		if ($.fn.mousewheel) {
			wrap.bind('mousewheel.fb', function(e, delta) {
				if (busy) {
					e.preventDefault();

				} else if ($(e.target).get(0).clientHeight == 0 || $(e.target).get(0).scrollHeight === $(e.target).get(0).clientHeight) {
					e.preventDefault();
					$.fancybox[ delta > 0 ? 'prev' : 'next']();
				}
			});
		}

		if (!$.support.opacity) {
			wrap.addClass('fancybox-ie');
		}

		if (isIE6) {
			loading.addClass('fancybox-ie6');
			wrap.addClass('fancybox-ie6');

			$('<iframe id="fancybox-hide-sel-frame" src="' + (/^https/i.test(window.location.href || '') ? 'javascript:void(false)' : 'about:blank' ) + '" scrolling="no" border="0" frameborder="0" tabindex="-1"></iframe>').prependTo(outer);
		}
	};

	$.fn.fancybox.defaults = {
		padding : 10,
		margin : 40,
		opacity : false,
		modal : false,
		cyclic : false,
		scrolling : 'auto',	// 'auto', 'yes' or 'no'

		width : 560,
		height : 340,

		autoScale : true,
		autoDimensions : true,
		centerOnScroll : false,

		ajax : {},
		swf : { wmode: 'transparent' },

		hideOnOverlayClick : true,
		hideOnContentClick : false,

		overlayShow : true,
		overlayOpacity : 0.7,
		overlayColor : '#777',

		titleShow : true,
		titlePosition : 'float', // 'float', 'outside', 'inside' or 'over'
		titleFormat : null,
		titleFromAlt : false,

		transitionIn : 'fade', // 'elastic', 'fade' or 'none'
		transitionOut : 'fade', // 'elastic', 'fade' or 'none'

		speedIn : 300,
		speedOut : 300,

		changeSpeed : 300,
		changeFade : 'fast',

		easingIn : 'swing',
		easingOut : 'swing',

		showCloseButton	 : true,
		showNavArrows : true,
		enableEscapeButton : true,
		enableKeyboardNav : true,

		onStart : function(){},
		onCancel : function(){},
		onComplete : function(){},
		onCleanup : function(){},
		onClosed : function(){},
		onError : function(){}
	};

	$(document).ready(function() {
		$.fancybox.init();
	});

})(jQuery);

//SCRIPT: ../../vendor/js/jquery/jquery.jscrollpane.min.js
/*!
 * jScrollPane - v2.0.14 - 2013-05-01
 * http://jscrollpane.kelvinluck.com/
 *
 * Copyright (c) 2010 Kelvin Luck
 * Dual licensed under the MIT or GPL licenses.
 */
(function(b,a,c){b.fn.jScrollPane=function(e){function d(D,O){var ay,Q=this,Y,aj,v,al,T,Z,y,q,az,aE,au,i,I,h,j,aa,U,ap,X,t,A,aq,af,am,G,l,at,ax,x,av,aH,f,L,ai=true,P=true,aG=false,k=false,ao=D.clone(false,false).empty(),ac=b.fn.mwheelIntent?"mwheelIntent.jsp":"mousewheel.jsp";aH=D.css("paddingTop")+" "+D.css("paddingRight")+" "+D.css("paddingBottom")+" "+D.css("paddingLeft");f=(parseInt(D.css("paddingLeft"),10)||0)+(parseInt(D.css("paddingRight"),10)||0);function ar(aQ){var aL,aN,aM,aJ,aI,aP,aO=false,aK=false;ay=aQ;if(Y===c){aI=D.scrollTop();aP=D.scrollLeft();D.css({overflow:"hidden",padding:0});aj=D.innerWidth()+f;v=D.innerHeight();D.width(aj);Y=b('<div class="jspPane" />').css("padding",aH).append(D.children());al=b('<div class="jspContainer" />').css({width:aj+"px",height:v+"px"}).append(Y).appendTo(D)}else{D.css("width","");aO=ay.stickToBottom&&K();aK=ay.stickToRight&&B();aJ=D.innerWidth()+f!=aj||D.outerHeight()!=v;if(aJ){aj=D.innerWidth()+f;v=D.innerHeight();al.css({width:aj+"px",height:v+"px"})}if(!aJ&&L==T&&Y.outerHeight()==Z){D.width(aj);return}L=T;Y.css("width","");D.width(aj);al.find(">.jspVerticalBar,>.jspHorizontalBar").remove().end()}Y.css("overflow","auto");if(aQ.contentWidth){T=aQ.contentWidth}else{T=Y[0].scrollWidth}Z=Y[0].scrollHeight;Y.css("overflow","");y=T/aj;q=Z/v;az=q>1;aE=y>1;if(!(aE||az)){D.removeClass("jspScrollable");Y.css({top:0,width:al.width()-f});n();E();R();w()}else{D.addClass("jspScrollable");aL=ay.maintainPosition&&(I||aa);if(aL){aN=aC();aM=aA()}aF();z();F();if(aL){N(aK?(T-aj):aN,false);M(aO?(Z-v):aM,false)}J();ag();an();if(ay.enableKeyboardNavigation){S()}if(ay.clickOnTrack){p()}C();if(ay.hijackInternalLinks){m()}}if(ay.autoReinitialise&&!av){av=setInterval(function(){ar(ay)},ay.autoReinitialiseDelay)}else{if(!ay.autoReinitialise&&av){clearInterval(av)}}aI&&D.scrollTop(0)&&M(aI,false);aP&&D.scrollLeft(0)&&N(aP,false);D.trigger("jsp-initialised",[aE||az])}function aF(){if(az){al.append(b('<div class="jspVerticalBar" />').append(b('<div class="jspCap jspCapTop" />'),b('<div class="jspTrack" />').append(b('<div class="jspDrag" />').append(b('<div class="jspDragTop" />'),b('<div class="jspDragBottom" />'))),b('<div class="jspCap jspCapBottom" />')));U=al.find(">.jspVerticalBar");ap=U.find(">.jspTrack");au=ap.find(">.jspDrag");if(ay.showArrows){aq=b('<a class="jspArrow jspArrowUp" />').bind("mousedown.jsp",aD(0,-1)).bind("click.jsp",aB);af=b('<a class="jspArrow jspArrowDown" />').bind("mousedown.jsp",aD(0,1)).bind("click.jsp",aB);if(ay.arrowScrollOnHover){aq.bind("mouseover.jsp",aD(0,-1,aq));af.bind("mouseover.jsp",aD(0,1,af))}ak(ap,ay.verticalArrowPositions,aq,af)}t=v;al.find(">.jspVerticalBar>.jspCap:visible,>.jspVerticalBar>.jspArrow").each(function(){t-=b(this).outerHeight()});au.hover(function(){au.addClass("jspHover")},function(){au.removeClass("jspHover")}).bind("mousedown.jsp",function(aI){b("html").bind("dragstart.jsp selectstart.jsp",aB);au.addClass("jspActive");var s=aI.pageY-au.position().top;b("html").bind("mousemove.jsp",function(aJ){V(aJ.pageY-s,false)}).bind("mouseup.jsp mouseleave.jsp",aw);return false});o()}}function o(){ap.height(t+"px");I=0;X=ay.verticalGutter+ap.outerWidth();Y.width(aj-X-f);try{if(U.position().left===0){Y.css("margin-left",X+"px")}}catch(s){}}function z(){if(aE){al.append(b('<div class="jspHorizontalBar" />').append(b('<div class="jspCap jspCapLeft" />'),b('<div class="jspTrack" />').append(b('<div class="jspDrag" />').append(b('<div class="jspDragLeft" />'),b('<div class="jspDragRight" />'))),b('<div class="jspCap jspCapRight" />')));am=al.find(">.jspHorizontalBar");G=am.find(">.jspTrack");h=G.find(">.jspDrag");if(ay.showArrows){ax=b('<a class="jspArrow jspArrowLeft" />').bind("mousedown.jsp",aD(-1,0)).bind("click.jsp",aB);x=b('<a class="jspArrow jspArrowRight" />').bind("mousedown.jsp",aD(1,0)).bind("click.jsp",aB);
if(ay.arrowScrollOnHover){ax.bind("mouseover.jsp",aD(-1,0,ax));x.bind("mouseover.jsp",aD(1,0,x))}ak(G,ay.horizontalArrowPositions,ax,x)}h.hover(function(){h.addClass("jspHover")},function(){h.removeClass("jspHover")}).bind("mousedown.jsp",function(aI){b("html").bind("dragstart.jsp selectstart.jsp",aB);h.addClass("jspActive");var s=aI.pageX-h.position().left;b("html").bind("mousemove.jsp",function(aJ){W(aJ.pageX-s,false)}).bind("mouseup.jsp mouseleave.jsp",aw);return false});l=al.innerWidth();ah()}}function ah(){al.find(">.jspHorizontalBar>.jspCap:visible,>.jspHorizontalBar>.jspArrow").each(function(){l-=b(this).outerWidth()});G.width(l+"px");aa=0}function F(){if(aE&&az){var aI=G.outerHeight(),s=ap.outerWidth();t-=aI;b(am).find(">.jspCap:visible,>.jspArrow").each(function(){l+=b(this).outerWidth()});l-=s;v-=s;aj-=aI;G.parent().append(b('<div class="jspCorner" />').css("width",aI+"px"));o();ah()}if(aE){Y.width((al.outerWidth()-f)+"px")}Z=Y.outerHeight();q=Z/v;if(aE){at=Math.ceil(1/y*l);if(at>ay.horizontalDragMaxWidth){at=ay.horizontalDragMaxWidth}else{if(at<ay.horizontalDragMinWidth){at=ay.horizontalDragMinWidth}}h.width(at+"px");j=l-at;ae(aa)}if(az){A=Math.ceil(1/q*t);if(A>ay.verticalDragMaxHeight){A=ay.verticalDragMaxHeight}else{if(A<ay.verticalDragMinHeight){A=ay.verticalDragMinHeight}}au.height(A+"px");i=t-A;ad(I)}}function ak(aJ,aL,aI,s){var aN="before",aK="after",aM;if(aL=="os"){aL=/Mac/.test(navigator.platform)?"after":"split"}if(aL==aN){aK=aL}else{if(aL==aK){aN=aL;aM=aI;aI=s;s=aM}}aJ[aN](aI)[aK](s)}function aD(aI,s,aJ){return function(){H(aI,s,this,aJ);this.blur();return false}}function H(aL,aK,aO,aN){aO=b(aO).addClass("jspActive");var aM,aJ,aI=true,s=function(){if(aL!==0){Q.scrollByX(aL*ay.arrowButtonSpeed)}if(aK!==0){Q.scrollByY(aK*ay.arrowButtonSpeed)}aJ=setTimeout(s,aI?ay.initialDelay:ay.arrowRepeatFreq);aI=false};s();aM=aN?"mouseout.jsp":"mouseup.jsp";aN=aN||b("html");aN.bind(aM,function(){aO.removeClass("jspActive");aJ&&clearTimeout(aJ);aJ=null;aN.unbind(aM)})}function p(){w();if(az){ap.bind("mousedown.jsp",function(aN){if(aN.originalTarget===c||aN.originalTarget==aN.currentTarget){var aL=b(this),aO=aL.offset(),aM=aN.pageY-aO.top-I,aJ,aI=true,s=function(){var aR=aL.offset(),aS=aN.pageY-aR.top-A/2,aP=v*ay.scrollPagePercent,aQ=i*aP/(Z-v);if(aM<0){if(I-aQ>aS){Q.scrollByY(-aP)}else{V(aS)}}else{if(aM>0){if(I+aQ<aS){Q.scrollByY(aP)}else{V(aS)}}else{aK();return}}aJ=setTimeout(s,aI?ay.initialDelay:ay.trackClickRepeatFreq);aI=false},aK=function(){aJ&&clearTimeout(aJ);aJ=null;b(document).unbind("mouseup.jsp",aK)};s();b(document).bind("mouseup.jsp",aK);return false}})}if(aE){G.bind("mousedown.jsp",function(aN){if(aN.originalTarget===c||aN.originalTarget==aN.currentTarget){var aL=b(this),aO=aL.offset(),aM=aN.pageX-aO.left-aa,aJ,aI=true,s=function(){var aR=aL.offset(),aS=aN.pageX-aR.left-at/2,aP=aj*ay.scrollPagePercent,aQ=j*aP/(T-aj);if(aM<0){if(aa-aQ>aS){Q.scrollByX(-aP)}else{W(aS)}}else{if(aM>0){if(aa+aQ<aS){Q.scrollByX(aP)}else{W(aS)}}else{aK();return}}aJ=setTimeout(s,aI?ay.initialDelay:ay.trackClickRepeatFreq);aI=false},aK=function(){aJ&&clearTimeout(aJ);aJ=null;b(document).unbind("mouseup.jsp",aK)};s();b(document).bind("mouseup.jsp",aK);return false}})}}function w(){if(G){G.unbind("mousedown.jsp")}if(ap){ap.unbind("mousedown.jsp")}}function aw(){b("html").unbind("dragstart.jsp selectstart.jsp mousemove.jsp mouseup.jsp mouseleave.jsp");if(au){au.removeClass("jspActive")}if(h){h.removeClass("jspActive")}}function V(s,aI){if(!az){return}if(s<0){s=0}else{if(s>i){s=i}}if(aI===c){aI=ay.animateScroll}if(aI){Q.animate(au,"top",s,ad)}else{au.css("top",s);ad(s)}}function ad(aI){if(aI===c){aI=au.position().top}al.scrollTop(0);I=aI;var aL=I===0,aJ=I==i,aK=aI/i,s=-aK*(Z-v);if(ai!=aL||aG!=aJ){ai=aL;aG=aJ;D.trigger("jsp-arrow-change",[ai,aG,P,k])}u(aL,aJ);Y.css("top",s);D.trigger("jsp-scroll-y",[-s,aL,aJ]).trigger("scroll")}function W(aI,s){if(!aE){return}if(aI<0){aI=0}else{if(aI>j){aI=j}}if(s===c){s=ay.animateScroll}if(s){Q.animate(h,"left",aI,ae)
}else{h.css("left",aI);ae(aI)}}function ae(aI){if(aI===c){aI=h.position().left}al.scrollTop(0);aa=aI;var aL=aa===0,aK=aa==j,aJ=aI/j,s=-aJ*(T-aj);if(P!=aL||k!=aK){P=aL;k=aK;D.trigger("jsp-arrow-change",[ai,aG,P,k])}r(aL,aK);Y.css("left",s);D.trigger("jsp-scroll-x",[-s,aL,aK]).trigger("scroll")}function u(aI,s){if(ay.showArrows){aq[aI?"addClass":"removeClass"]("jspDisabled");af[s?"addClass":"removeClass"]("jspDisabled")}}function r(aI,s){if(ay.showArrows){ax[aI?"addClass":"removeClass"]("jspDisabled");x[s?"addClass":"removeClass"]("jspDisabled")}}function M(s,aI){var aJ=s/(Z-v);V(aJ*i,aI)}function N(aI,s){var aJ=aI/(T-aj);W(aJ*j,s)}function ab(aV,aQ,aJ){var aN,aK,aL,s=0,aU=0,aI,aP,aO,aS,aR,aT;try{aN=b(aV)}catch(aM){return}aK=aN.outerHeight();aL=aN.outerWidth();al.scrollTop(0);al.scrollLeft(0);while(!aN.is(".jspPane")){s+=aN.position().top;aU+=aN.position().left;aN=aN.offsetParent();if(/^body|html$/i.test(aN[0].nodeName)){return}}aI=aA();aO=aI+v;if(s<aI||aQ){aR=s-ay.verticalGutter}else{if(s+aK>aO){aR=s-v+aK+ay.verticalGutter}}if(aR){M(aR,aJ)}aP=aC();aS=aP+aj;if(aU<aP||aQ){aT=aU-ay.horizontalGutter}else{if(aU+aL>aS){aT=aU-aj+aL+ay.horizontalGutter}}if(aT){N(aT,aJ)}}function aC(){return -Y.position().left}function aA(){return -Y.position().top}function K(){var s=Z-v;return(s>20)&&(s-aA()<10)}function B(){var s=T-aj;return(s>20)&&(s-aC()<10)}function ag(){al.unbind(ac).bind(ac,function(aL,aM,aK,aI){var aJ=aa,s=I;Q.scrollBy(aK*ay.mouseWheelSpeed,-aI*ay.mouseWheelSpeed,false);return aJ==aa&&s==I})}function n(){al.unbind(ac)}function aB(){return false}function J(){Y.find(":input,a").unbind("focus.jsp").bind("focus.jsp",function(s){ab(s.target,false)})}function E(){Y.find(":input,a").unbind("focus.jsp")}function S(){var s,aI,aK=[];aE&&aK.push(am[0]);az&&aK.push(U[0]);Y.focus(function(){D.focus()});D.attr("tabindex",0).unbind("keydown.jsp keypress.jsp").bind("keydown.jsp",function(aN){if(aN.target!==this&&!(aK.length&&b(aN.target).closest(aK).length)){return}var aM=aa,aL=I;switch(aN.keyCode){case 40:case 38:case 34:case 32:case 33:case 39:case 37:s=aN.keyCode;aJ();break;case 35:M(Z-v);s=null;break;case 36:M(0);s=null;break}aI=aN.keyCode==s&&aM!=aa||aL!=I;return !aI}).bind("keypress.jsp",function(aL){if(aL.keyCode==s){aJ()}return !aI});if(ay.hideFocus){D.css("outline","none");if("hideFocus" in al[0]){D.attr("hideFocus",true)}}else{D.css("outline","");if("hideFocus" in al[0]){D.attr("hideFocus",false)}}function aJ(){var aM=aa,aL=I;switch(s){case 40:Q.scrollByY(ay.keyboardSpeed,false);break;case 38:Q.scrollByY(-ay.keyboardSpeed,false);break;case 34:case 32:Q.scrollByY(v*ay.scrollPagePercent,false);break;case 33:Q.scrollByY(-v*ay.scrollPagePercent,false);break;case 39:Q.scrollByX(ay.keyboardSpeed,false);break;case 37:Q.scrollByX(-ay.keyboardSpeed,false);break}aI=aM!=aa||aL!=I;return aI}}function R(){D.attr("tabindex","-1").removeAttr("tabindex").unbind("keydown.jsp keypress.jsp")}function C(){if(location.hash&&location.hash.length>1){var aK,aI,aJ=escape(location.hash.substr(1));try{aK=b("#"+aJ+', a[name="'+aJ+'"]')}catch(s){return}if(aK.length&&Y.find(aJ)){if(al.scrollTop()===0){aI=setInterval(function(){if(al.scrollTop()>0){ab(aK,true);b(document).scrollTop(al.position().top);clearInterval(aI)}},50)}else{ab(aK,true);b(document).scrollTop(al.position().top)}}}}function m(){if(b(document.body).data("jspHijack")){return}b(document.body).data("jspHijack",true);b(document.body).delegate("a[href*=#]","click",function(s){var aI=this.href.substr(0,this.href.indexOf("#")),aK=location.href,aO,aP,aJ,aM,aL,aN;if(location.href.indexOf("#")!==-1){aK=location.href.substr(0,location.href.indexOf("#"))}if(aI!==aK){return}aO=escape(this.href.substr(this.href.indexOf("#")+1));aP;try{aP=b("#"+aO+', a[name="'+aO+'"]')}catch(aQ){return}if(!aP.length){return}aJ=aP.closest(".jspScrollable");aM=aJ.data("jsp");aM.scrollToElement(aP,true);if(aJ[0].scrollIntoView){aL=b(a).scrollTop();aN=aP.offset().top;if(aN<aL||aN>aL+b(a).height()){aJ[0].scrollIntoView()}}s.preventDefault()
})}function an(){var aJ,aI,aL,aK,aM,s=false;al.unbind("touchstart.jsp touchmove.jsp touchend.jsp click.jsp-touchclick").bind("touchstart.jsp",function(aN){var aO=aN.originalEvent.touches[0];aJ=aC();aI=aA();aL=aO.pageX;aK=aO.pageY;aM=false;s=true}).bind("touchmove.jsp",function(aQ){if(!s){return}var aP=aQ.originalEvent.touches[0],aO=aa,aN=I;Q.scrollTo(aJ+aL-aP.pageX,aI+aK-aP.pageY);aM=aM||Math.abs(aL-aP.pageX)>5||Math.abs(aK-aP.pageY)>5;return aO==aa&&aN==I}).bind("touchend.jsp",function(aN){s=false}).bind("click.jsp-touchclick",function(aN){if(aM){aM=false;return false}})}function g(){var s=aA(),aI=aC();D.removeClass("jspScrollable").unbind(".jsp");D.replaceWith(ao.append(Y.children()));ao.scrollTop(s);ao.scrollLeft(aI);if(av){clearInterval(av)}}b.extend(Q,{reinitialise:function(aI){aI=b.extend({},ay,aI);ar(aI)},scrollToElement:function(aJ,aI,s){ab(aJ,aI,s)},scrollTo:function(aJ,s,aI){N(aJ,aI);M(s,aI)},scrollToX:function(aI,s){N(aI,s)},scrollToY:function(s,aI){M(s,aI)},scrollToPercentX:function(aI,s){N(aI*(T-aj),s)},scrollToPercentY:function(aI,s){M(aI*(Z-v),s)},scrollBy:function(aI,s,aJ){Q.scrollByX(aI,aJ);Q.scrollByY(s,aJ)},scrollByX:function(s,aJ){var aI=aC()+Math[s<0?"floor":"ceil"](s),aK=aI/(T-aj);W(aK*j,aJ)},scrollByY:function(s,aJ){var aI=aA()+Math[s<0?"floor":"ceil"](s),aK=aI/(Z-v);V(aK*i,aJ)},positionDragX:function(s,aI){W(s,aI)},positionDragY:function(aI,s){V(aI,s)},animate:function(aI,aL,s,aK){var aJ={};aJ[aL]=s;aI.animate(aJ,{duration:ay.animateDuration,easing:ay.animateEase,queue:false,step:aK})},getContentPositionX:function(){return aC()},getContentPositionY:function(){return aA()},getContentWidth:function(){return T},getContentHeight:function(){return Z},getPercentScrolledX:function(){return aC()/(T-aj)},getPercentScrolledY:function(){return aA()/(Z-v)},getIsScrollableH:function(){return aE},getIsScrollableV:function(){return az},getContentPane:function(){return Y},scrollToBottom:function(s){V(i,s)},hijackInternalLinks:b.noop,destroy:function(){g()}});ar(O)}e=b.extend({},b.fn.jScrollPane.defaults,e);b.each(["arrowButtonSpeed","trackClickSpeed","keyboardSpeed"],function(){e[this]=e[this]||e.speed});return this.each(function(){var f=b(this),g=f.data("jsp");if(g){g.reinitialise(e)}else{b("script",f).filter('[type="text/javascript"],:not([type])').remove();g=new d(f,e);f.data("jsp",g)}})};b.fn.jScrollPane.defaults={showArrows:false,maintainPosition:true,stickToBottom:false,stickToRight:false,clickOnTrack:true,autoReinitialise:false,autoReinitialiseDelay:500,verticalDragMinHeight:0,verticalDragMaxHeight:99999,horizontalDragMinWidth:0,horizontalDragMaxWidth:99999,contentWidth:c,animateScroll:false,animateDuration:300,animateEase:"linear",hijackInternalLinks:false,verticalGutter:4,horizontalGutter:4,mouseWheelSpeed:3,arrowButtonSpeed:0,arrowRepeatFreq:50,arrowScrollOnHover:false,trackClickSpeed:0,trackClickRepeatFreq:70,verticalArrowPositions:"split",horizontalArrowPositions:"split",enableKeyboardNavigation:true,hideFocus:false,keyboardSpeed:0,initialDelay:300,speed:30,scrollPagePercent:0.8}})(jQuery,this);

//SCRIPT: ../../vendor/js/jquery/jquery.mousewheel.js
/*! Copyright (c) 2013 Brandon Aaron (http://brandonaaron.net)
 * Licensed under the MIT License (LICENSE.txt).
 *
 * Thanks to: http://adomas.org/javascript-mouse-wheel/ for some pointers.
 * Thanks to: Mathias Bank(http://www.mathias-bank.de) for a scope bug fix.
 * Thanks to: Seamus Leahy for adding deltaX and deltaY
 *
 * Version: 3.1.3
 *
 * Requires: 1.2.2+
 */

(function (factory) {
    if ( typeof define === 'function' && define.amd ) {
        // AMD. Register as an anonymous module.
        define(['jquery'], factory);
    } else if (typeof exports === 'object') {
        // Node/CommonJS style for Browserify
        module.exports = factory;
    } else {
        // Browser globals
        factory(jQuery);
    }
}(function ($) {

    var toFix = ['wheel', 'mousewheel', 'DOMMouseScroll', 'MozMousePixelScroll'];
    var toBind = 'onwheel' in document || document.documentMode >= 9 ? ['wheel'] : ['mousewheel', 'DomMouseScroll', 'MozMousePixelScroll'];
    var lowestDelta, lowestDeltaXY;

    if ( $.event.fixHooks ) {
        for ( var i = toFix.length; i; ) {
            $.event.fixHooks[ toFix[--i] ] = $.event.mouseHooks;
        }
    }

    $.event.special.mousewheel = {
        setup: function() {
            if ( this.addEventListener ) {
                for ( var i = toBind.length; i; ) {
                    this.addEventListener( toBind[--i], handler, false );
                }
            } else {
                this.onmousewheel = handler;
            }
        },

        teardown: function() {
            if ( this.removeEventListener ) {
                for ( var i = toBind.length; i; ) {
                    this.removeEventListener( toBind[--i], handler, false );
                }
            } else {
                this.onmousewheel = null;
            }
        }
    };

    $.fn.extend({
        mousewheel: function(fn) {
            return fn ? this.bind("mousewheel", fn) : this.trigger("mousewheel");
        },

        unmousewheel: function(fn) {
            return this.unbind("mousewheel", fn);
        }
    });


    function handler(event) {
        var orgEvent = event || window.event,
            args = [].slice.call(arguments, 1),
            delta = 0,
            deltaX = 0,
            deltaY = 0,
            absDelta = 0,
            absDeltaXY = 0,
            fn;
        event = $.event.fix(orgEvent);
        event.type = "mousewheel";

        // Old school scrollwheel delta
        if ( orgEvent.wheelDelta ) { delta = orgEvent.wheelDelta; }
        if ( orgEvent.detail )     { delta = orgEvent.detail * -1; }

        // New school wheel delta (wheel event)
        if ( orgEvent.deltaY ) {
            deltaY = orgEvent.deltaY * -1;
            delta  = deltaY;
        }
        if ( orgEvent.deltaX ) {
            deltaX = orgEvent.deltaX;
            delta  = deltaX * -1;
        }

        // Webkit
        if ( orgEvent.wheelDeltaY !== undefined ) { deltaY = orgEvent.wheelDeltaY; }
        if ( orgEvent.wheelDeltaX !== undefined ) { deltaX = orgEvent.wheelDeltaX * -1; }

        // Look for lowest delta to normalize the delta values
        absDelta = Math.abs(delta);
        if ( !lowestDelta || absDelta < lowestDelta ) { lowestDelta = absDelta; }
        absDeltaXY = Math.max(Math.abs(deltaY), Math.abs(deltaX));
        if ( !lowestDeltaXY || absDeltaXY < lowestDeltaXY ) { lowestDeltaXY = absDeltaXY; }

        // Get a whole value for the deltas
        fn = delta > 0 ? 'floor' : 'ceil';
        delta  = Math[fn](delta / lowestDelta);
        deltaX = Math[fn](deltaX / lowestDeltaXY);
        deltaY = Math[fn](deltaY / lowestDeltaXY);

        // Add event and delta to the front of the arguments
        args.unshift(event, delta, deltaX, deltaY);

        return ($.event.dispatch || $.event.handle).apply(this, args);
    }

}));

//SCRIPT: ../../vendor/js/jquery/jquery.touchwipe-1.1.1.min.js
/**
 * jQuery Plugin to obtain touch gestures from iPhone, iPod Touch and iPad, should also work with Android mobile phones (not tested yet!)
 * Common usage: wipe images (left and right to show the previous or next image)
 * 
 * @author Andreas Waltl, netCU Internetagentur (http://www.netcu.de)
 * @version 1.1.1 (9th December 2010) - fix bug (older IE's had problems)
 * @version 1.1 (1st September 2010) - support wipe up and wipe down
 * @version 1.0 (15th July 2010)
 */
(function($){$.fn.touchwipe=function(settings){var config={min_move_x:20,min_move_y:20,wipeLeft:function(){},wipeRight:function(){},wipeUp:function(){},wipeDown:function(){},preventDefaultEvents:true};if(settings)$.extend(config,settings);this.each(function(){var startX;var startY;var isMoving=false;function cancelTouch(){this.removeEventListener('touchmove',onTouchMove);startX=null;isMoving=false}function onTouchMove(e){if(config.preventDefaultEvents){e.preventDefault()}if(isMoving){var x=e.touches[0].pageX;var y=e.touches[0].pageY;var dx=startX-x;var dy=startY-y;if(Math.abs(dx)>=config.min_move_x){cancelTouch();if(dx>0){config.wipeLeft()}else{config.wipeRight()}}else if(Math.abs(dy)>=config.min_move_y){cancelTouch();if(dy>0){config.wipeDown()}else{config.wipeUp()}}}}function onTouchStart(e){if(e.touches.length==1){startX=e.touches[0].pageX;startY=e.touches[0].pageY;isMoving=true;this.addEventListener('touchmove',onTouchMove,false)}}if('ontouchstart'in document.documentElement){this.addEventListener('touchstart',onTouchStart,false)}});return this}})(jQuery);

//SCRIPT: ../../vendor/js/jquery/panasonic-jquery.avod.js
/**
 * jquery.avod.js v1.0.alpha - jQuery InFlight Media Player skin plugin
 *
 * This plugin skins InFlight media player by using VideoJS as the styling guide.
 *  
 * For HTML5 player:
 * - Updated video.js library is used to skin the html5 video element.
 * - Plugin can only be instantiated once the InFlight media player is ready. 
 *  
 * For Flash Player:
 * - Videojs styles are extracted as flash configuration and passed to ControlOverlayPlugin.swf.
 * - Plugin should be instantiated before loading the media into InFlight media player. 
 * 
 * For AUDIO player:
 * - Updated video.js library is used to handle the player controls while the actual player is hidden
 * - Plugin can only be instantiated once the InFlight media player is ready. 
 * 
 * Usage:
 * 
 * $('#aod_player').avod({avodPlayer: aodPlayer}); 
 */

/*************************************************************************
VELTI: START: Allow seeking forward and backward within HTML, FLASH and iOSSDK Players

ISSUES:
	This only selects the currently playing player because there isnt an easy way 
	of telling iOSSDK/Flash player which player it should be controlling
*************************************************************************/
var mediaManager = null;

var mediaPlayerSkip = function(seconds) {
	if(mediaManager) {
		var player = mediaManager.getCurrentlyPlayingPlayer();

		if(player) {
			var time = player.player.getCurrentTime() + seconds;

			if(time < 0) {
				time = 0;
			} else if (time > player.player.getDuration()) {
				time = player.player.getDuration();
			}

			player.player.seek(time);
		} else {
			console.log("AVOD Plugin: Cannot find playing player to FFWD or RWD");
		}
	} else {
		console.error("AVOD Plugin: Media Manager is not defined");
	}
};

window.mediaPlayerFFWD = function(seconds) {
	mediaPlayerSkip(seconds);
};

window.mediaPlayerRWD = function(seconds) {
	mediaPlayerSkip(-1 * seconds);
};

/*************************************************************************
VELTI: END: Allow seeking forward and backward within HTML, FLASH and iOSSDK Players
*************************************************************************/

(function($){
	
	var NS_AVOD_DATA = 'avod';
	
	var methods = {};
	var currentSelectedSkin = 'player_controls';
	
	var defaultOptions = {
		controlSwf:			null,
		avodPlayer: 		null,
		vjsPlayer: 			null,
		playerControls: 	null,
		skin: 				'vjs-default-skin',
		onReady:	 		null,
		onComplete: 		null,
		defaultFlashConfig: null,
		excludedDevices:	null  // An array of objects containing regex for user agent sniffing { regex: string, flags: string }
	};

	//VELTI: Added for FFWD/RWD seeking
	var skipSeekInSeconds = null;

	//VELTI: Changed for responsive configs
	var getTemplateByWindowSize = function(templateObj) {
		//this template is responsive
		if(templateObj["default"] && templateObj.responsiveWidths) {
			var windowWidth = $(window).width();
			var bestMatch = null;
			var currentBestMatchWidth = 10000000;

			$.each(templateObj.responsiveWidths, function(key, value) {
				var itemMaxWidth = parseInt(key);
				if (itemMaxWidth >= windowWidth && itemMaxWidth <= currentBestMatchWidth) {
					currentBestMatchWidth = itemMaxWidth;
					bestMatch = value;
				}	
			});

			return bestMatch || templateObj["default"];
		} else {
			return templateObj["default"] || templateObj;
		}
	};
	
	methods.init = function(options)
	{
		options = $.extend({}, defaultOptions, options);

		//VELTI: Set the media manager to the one passed through in the config.
		// This is inefficient but as only work around now until better FLASH and iOSSDK integration can be done
		// to handle in player events
		if(options.mediaManager) {
			mediaManager = options.mediaManager;
		}
		skipSeekInSeconds = options.skipSeekInSeconds;


		//VELTI: Changed for responsive configs
		options.defaultFlashConfig = options.defaultFlashConfig ? getTemplateByWindowSize(options.defaultFlashConfig) : undefined;
		
		if(options.excludedDevices !== null)
		{
			var exclude = false,
				regExProperties,
				regEx,
				i;
				
			for (i = 0; !exclude && i < options.excludedDevices.length; i++)
			{
				regExProperties = options.excludedDevices[i];
				if(typeof(regExProperties.regex) !== 'undefined')
				{
					regExProperties.flags = (typeof(regExProperties.flags) === 'string')? regExProperties.flags : '';
					regEx = new RegExp(regExProperties.regex, regExProperties.flags);
					exclude = regEx.test(navigator.userAgent);
				}
			}
		}

		// If the User Agent has been excluded, then exit
		if(exclude) {
				if(options.onReady)
					{
						options.onReady();
					};
					return;
		}
		
		var items = this.each(function() {
			var $this = $(this),
				data = null;
			
			if(options.avodPlayer !== null)
			{
				if(options.avodPlayer.isAOD())
				{
					// For VOD/TV set the data to the parent node (avod-wrapper element)
					data = $this.data(NS_AVOD_DATA);
					if (!data)
					{
						options.avodPlayer.addEventListener('jsbridgecreated', function(event) { onReadyHandler.call($this[0], event); });
						
						$this.data(NS_AVOD_DATA, {
							loading: 			true, 
							skin: 				options.skin, 
							onComplete: 		options.onComplete
						});

						options.avodPlayer.addPlugin(
							'controlOverlay', 
							options.controlSwf, 
							{
								namespace:       "http://api.airpana.com/avod/controls/settings", 
								configureGUI:    JSON.stringify(options.defaultFlashConfig)
							}
						);
					}
					
					if(options.onReady)
					{
						options.onReady();
					}
				}
				if(options.avodPlayer.isVOD() || options.avodPlayer.isTV())
				{
					// For VOD/TV set the data to the parent node (avod-wrapper element)
					data = $this.parent().data(NS_AVOD_DATA);
					
					var $wrapper = $this.parent();
					
					// If the plugin hasn't been initialized yet
					if (!data)
					{
						options.avodPlayer.addEventListener('jsbridgecreated', function(event) { onReadyHandler.call($wrapper[0], event); });
						
						$this.parent().data(NS_AVOD_DATA, {
							loading: 			true, 
							skin: 				options.skin, 
							onComplete: 		options.onComplete, 
							defaultFlashConfig: options.defaultFlashConfig
						});
		
						if(options.avodPlayer.isFlash() || options.avodPlayer.isiOSSDK()  || options.avodPlayer.isAndroidSDK())
						{
							if(options.controlSwf !== null)
							{
								// Suppress VideoJS logs while setting the flash configuration
								var videoJSLogger = _V_.log;
								_V_.log = function() {};
		
//								getFlashConfig(options.defaultFlashConfig, options.skin, function(flashConfig) {

									options.avodPlayer.addPlugin(
										'controlOverlay', 
										options.controlSwf, 
										{
											namespace:       "http://api.airpana.com/avod/controls/settings", 
										  configureGUI:    JSON.stringify(options.defaultFlashConfig)
										}
									);

									//VELTI: Changed for responsive configs
									// Listen to Window resize
									$(window).resize(function() {
										methods.showTemplate.call($wrapper.children().first(), currentSelectedSkin);
									});
									
									if(options.onReady)
									{
										options.onReady();
									}
									
									// Restore VideoJS Logging
									_V_.log = videoJSLogger;
//								});
							}
							else if(options.onReady)
							{
								options.onReady();
							}
						}
						else if(options.onReady)
						{
							options.onReady();
						}
					}
				}
			}
		});
		
		return items;
	};
	
	/**
	 * Sets the fullscreen mode on the player
	 * 
	 * @param vodPlayer
	 * @param fullscreenType
	 */
	methods.setFullScreenMode = function(fullScreenType)
	{
		var $this = this;
		var data = $this.parent().data(NS_AVOD_DATA);
		
		if(!data.avodPlayer || data.avodPlayer.isAOD()) {
			return;
		}
		
		if(data.avodPlayer.isHtml())
		{
	       $('.vjs-fullscreen-control div').live('click', function(event) {
	    	   methods.toggleFullScreen.call($this, fullScreenType);
	       });
		}
	};
	
	/**
	 * Handles the fullscreen state, enter/exit for HTML5 player
	 * 
	 * @param event
	 * @param vodPlayer
	 * @param fullscreenType
	 */
	methods.toggleFullScreen = function(fullScreenType) {
		
		var $this = this;
		var data = $this.parent().data(NS_AVOD_DATA);
		
		if(!data.avodPlayer || data.avodPlayer.isAOD()) {
			return;
		}
	
		if(data.avodPlayer.isPseudoFullScreen() || data.avodPlayer.isAbsoluteFullScreen())
		{
			data.avodPlayer.cancelFullScreen();
		}
		else if(data.avodPlayer.isNormalDisplay())
		{
			data.avodPlayer.requestFullScreen(fullScreenType);
		}
	};
	
	/**
	 * @param {string} skinType The skin type. Can be any of the following values 'player_controls', 'pa', 'end_of_media', 'end_of_playlist'
	 * @param {HTMLElement} htmlElement The htmlElement to display for this message
	 * @param {Object} skinJSON The json configuration to use for this message
	 */
	methods.setTemplate = function(skinType, htmlElement, skinJSON) {
		var $this = this;
		var data = $this.parent().data(NS_AVOD_DATA);
		var guiConfig, messageWidget, labelWidget, labelAsset;
		var i, html = "";
		
		if(!data || !data.avodPlayer){
			// Only show error if trying to show a message and console.error exists
			if(console && console.error)
			{
				console.error("jquery.avod:\tAVOD player is not ready to accept templates");
			}
			return;
		}
		
		data.skinCollection = data.skinCollection || {};
		data.skinCollection[skinType] = {
			'html': htmlElement,
			'json': skinJSON
		};

		// Save the skin config to the player
		$this.parent().data(NS_AVOD_DATA, data);
	};
	
	methods.showTemplate = function(skinType) {
		var $this = this;
		var data = $this.parent().data(NS_AVOD_DATA);
		var guiConfig, messageWidget, labelWidget, labelAsset;
		var i, html = "";
		
		if(!data || !data.avodPlayer) {
			// Only show error if trying to show a message and console.error exists
			if(console && console.warn)
			{
				console.warn("jquery.avod:\tAVOD player is not ready");
			}
			return;
		}

		if(!data.avodPlayer.skinningIsComplete) {
			if(console && console.log)
			{
				console.log("jquery.avod:\tPlayer is not yet skinned so ignoring showTemplate request");
			}
			return;
		}
		
		if(data.skinCollection !== undefined && data.skinCollection[skinType] === undefined)
		{
			if(console && console.log)
			{
				console.log("jquery.avod:\tThe requested template is not available");
			}
			return;
		}
		
		if(!data.avodPlayer.isAOD())
		{
			//VELTI: Changed for responsive configs
			currentSelectedSkin = skinType;

            if((data.avodPlayer.isiOSSDK() || data.avodPlayer.isFlash() || data.avodPlayer.isAndroidSDK() ) && data.skinCollection !== undefined && data.skinCollection[skinType].json)
			{
				//VELTI: Changed for responsive configs
                console.log("calling configureGUI with skin: ", getTemplateByWindowSize(data.skinCollection[skinType].json));
				data.avodPlayer.configureGUI(getTemplateByWindowSize(data.skinCollection[skinType].json));
			}
			else if(data.avodPlayer.isHtml())
			{
				if(console && console.log)
				{
					console.log('jquery.avod:\tDisplay html template:\t', data.skinCollection[skinType].html);
				}
			}
		}
	};
	
	methods.hideMessage = function()
	{
		var $this = this;
		$this.avod('showTemplate', 'player_controls');
	};

	$.fn.avod = function(method) {

		if (methods[method]) {
			return methods[method].apply(this, Array.prototype.slice.call(arguments, 1));
		} else if (typeof method === 'object' || !method) {
			return methods.init.apply(this, arguments);
		} else {
			$.error('Method ' + method + ' does not exist on jQuery.tooltip');
		}
	};
	
	/**
	 * @scope The HtmlElement that will contain the skin
	 */
	function onReadyHandler(event)
	{
		var $this = $('#' + event.player.target), 
			data = $(this).data(NS_AVOD_DATA);
		
		event.player.removeEventListener(event.player.target, onReadyHandler);
		
		if(event.player.isAOD())
		{
			data = {
				avodPlayer:			event.player,
				skin: 				data.skin,
				onComplete: 		data.onComplete,
				defaultFlashConfig: data.defaultFlashConfig
			};
			$this.parent().data(NS_AVOD_DATA, data);

			$this.css('visibility', 'hidden');
			
		   var $playerWrapper = $this.parent('div:first').css('height','0em').css('overflow', 'hidden');

		   var $skinWrapper;
		 
		   if(data.playerControls && data.playerControls.length){
			   $skinWrapper = data.playerControls;
		   }
		   else{
			   $skinWrapper = $('<div>');
			   $playerWrapper.parent().append($skinWrapper);
		   }

		   $skinWrapper.append('<div id="' + event.player.target + '_controls" class="video-js ' + data.skin + '" controls></div>').css('height', '4em');
		   
		   var skinId = event.player.target + '_controls';
		   var currentSkin = (_V_.players && _V_.players[skinId])? _V_.players[skinId] : undefined;
		   if(currentSkin)
		   {
			   currentSkin.destroy();
		   }

		   _V_(skinId, 
			   {
			   		PACPlayer: 		event.player,
			   		autoplay:		event.player.autoplay,
			   		controls: 		true,
			   		playerControls: $skinWrapper[0]
			   }, 
		       function(){
				   var data = $this.parent().data(NS_AVOD_DATA);
				   data.vjsPlayer = this;
				   $this.parent().data(NS_AVOD_DATA, data);
		           
				   // Set the wrapper height to the same as videoJS controls height
				   $skinWrapper.css('height', '4em');
		       }
		   ).ready(function(){
			   
			   // hide unnecessary controls
			   $skinWrapper.find('.vjs-big-play-button').css('visibility', 'hidden');
			   $skinWrapper.find('.vjs-fullscreen-control').css('visibility', 'hidden');
			   $skinWrapper.find('.vjs-subtitles-button').css('visibility', 'hidden');
			   $skinWrapper.find('.vjs-captions-button').css('visibility', 'hidden');
			   $skinWrapper.find('.vjs-chapters-button').css('visibility', 'hidden');
			   $skinWrapper.find('.vjs-time-divider').css('display', 'none !important');
			   $skinWrapper.find('.vjs-volume-level').css('width', '90%');
			   $skinWrapper.find('.vjs-volume-handle').css('left', '80%');
			   
			   $skinWrapper.find('.vjs-controls').show().addClass('vjs-fade-in');

			   //VELTI: Add skip functionality
				 addSkipButtons(event.player, $skinWrapper);
				 event.player.skinningIsComplete = true;
			   
			   if(data.onComplete)
			   {
				   data.onComplete.call(event.player, event.player);
			   }
		   });
		}
		else if(event.player.isHtml())
		{
			// add videojs css classes
			$this.addClass("video-js " + data.skin);
		   
			// initialize videojs
			_V_(event.player.target, 
			   {
			   		PACPlayer: 	event.player,
			   		autoplay:	event.player.autoplay,
			   		controls: 	true
			   }, 
		       function(){
				   var data = $this.parent().data(NS_AVOD_DATA);
				   data.vjsPlayer = this; 
				   data.avodPlayer = event.player;
				   $this.parent().data(NS_AVOD_DATA, data);
		       }
			).ready(function(){
				//VELTI: Add skip functionality
				addSkipButtons(event.player, $this.parent());

				if(data.onComplete)
				{
				   data.onComplete.call(event.player, event.player);
				}
			});
		}
		else
		{
			data.avodPlayer = event.player;
			event.player.skinningIsComplete = true;
			$this.data(NS_AVOD_DATA, data);
			if(data.onComplete)
			{
				data.onComplete.call(event.player, event.player);
			}
		}
	}

	//VELTI: HTML5: Add the FFW / RWD buttons
	function addSkipButtons(player, $this) {
		//this should only be called after VID JS has been initialised

		if(skipSeekInSeconds) {
			//START: REWIND
			var rewindEl = $("<div />").addClass("vjs-rewind-control vjs-control").attr('role','button');//This is required to set role=button so that iOS7 can click these items
			var rewindSpanEl = $("<span />").addClass("vjs-control-text").html("Skip back thirty seconds");
			rewindEl.append($("<div />").append(rewindSpanEl));
			rewindEl.insertAfter($this.find(".vjs-previous-control"));

			rewindEl.bind("click", function() {
				window.mediaPlayerRWD(skipSeekInSeconds);
			});
			//END: REWIND

			//START: FFWD
			var ffwdEl = $("<div />").addClass("vjs-ffwd-control vjs-control").attr('role','button');//This is required to set role=button so that iOS7 can click these items
			var ffwdSpanEl = $("<span />").addClass("vjs-control-text").html("Skip Forward  thirty seconds");
			ffwdEl.append($("<div />").append(ffwdSpanEl));
			ffwdEl.insertBefore($this.find(".vjs-next-control"));

			ffwdEl.bind("click", function() {
				window.mediaPlayerFFWD(skipSeekInSeconds);
			});
			//END: FFWD
		}
	}
	
	function getUniqueId()
	{
		var prefix = 'tempVid_';
		var suffix = parseInt(Math.Math.random() * 1000 + '');
		var element = null;
		
		while(!(element = document.getElementById(prefix + suffix)))
		{
			suffix += parseInt(Math.Math.random() * 1000 + '');
		}
		
		return prefix + suffix;
	}

	/*
	 * Reference: http://www.sitepoint.com/javascript-json-serialization/
	 */
	JSON.stringify = JSON.stringify || function (obj) {
		var t = typeof (obj);
		if (t != "object" || obj === null) {
			// simple data type
			if (t == "string") obj = '"'+obj+'"';
			return String(obj);
		}
		else {
			// recurse array or object
			var n, v, json = [], arr = (obj && obj.constructor == Array);
			for (n in obj) {
				v = obj[n]; t = typeof(v);
				if (t == "string") v = '"'+v+'"';
				else if (t == "object" && v !== null) v = JSON.stringify(v);
				json.push((arr ? "" : '"' + n + '":') + String(v));
			}
			return (arr ? "[" : "{") + String(json) + (arr ? "]" : "}");
		}
	};

})( jQuery );


//SCRIPT: ../../vendor/js/jquery/jquery.imgpreload.min.js
/* v1.4 */
/* https://github.com/farinspace/jquery.imgpreload */
if("undefined"!=typeof jQuery){(function(a){a.imgpreload=function(b,c){c=a.extend({},a.fn.imgpreload.defaults,c instanceof Function?{all:c}:c);if("string"==typeof b){b=new Array(b)}var d=new Array;a.each(b,function(e,f){var g=new Image;var h=f;var i=g;if("string"!=typeof f){h=a(f).attr("src");i=f}a(g).bind("load error",function(e){d.push(i);a.data(i,"loaded","error"==e.type?false:true);if(c.each instanceof Function){c.each.call(i)}if(d.length>=b.length&&c.all instanceof Function){c.all.call(d)}a(this).unbind("load error")});g.src=h})};a.fn.imgpreload=function(b){a.imgpreload(this,b);return this};a.fn.imgpreload.defaults={each:null,all:null}})(jQuery)}

//SCRIPT: ../../vendor/js/jquery/jquery.getpath.js
(function($) {
    $.fn.getPath = function () {
        if (this.length != 1) throw 'Requires one element.';

        var path, node = this;
        while (node.length) {
            var realNode = node[0];
            var name = (

                // IE9 and non-IE
                realNode.localName ||

                // IE <= 8
                realNode.tagName ||
                realNode.nodeName

            );

            // on IE8, nodeName is '#document' at the top level, but we don't need that
            if (!name || name == '#document') break;

            name = name.toLowerCase();
            if (realNode.id) {
                // As soon as an id is found, there's no need to specify more.
                return name + '#' + realNode.id + (path ? '>' + path : '');
            } else if (realNode.className) {
                name += '.' + realNode.className.split(/\s+/).join('.');
            }

            var parent = node.parent(), siblings = parent.children(name);
            if (siblings.length > 1) name += ':eq(' + siblings.index(node) + ')';
            path = name + (path ? '>' + path : '');

            node = parent;
        }

        return path;
    };
})(jQuery);

//SCRIPT: ../../vendor/js/jquery/jquery.cookie.js
/*!
 * jQuery Cookie Plugin v1.3.1
 * https://github.com/carhartl/jquery-cookie
 *
 * Copyright 2013 Klaus Hartl
 * Released under the MIT license
 */
(function (factory) {
	if (typeof define === 'function' && define.amd) {
		// AMD. Register as anonymous module.
		define(['jquery'], factory);
	} else {
		// Browser globals.
		factory(jQuery);
	}
}(function ($) {

	var pluses = /\+/g;

	function raw(s) {
		return s;
	}

	function decoded(s) {
		return decodeURIComponent(s.replace(pluses, ' '));
	}

	function converted(s) {
		if (s.indexOf('"') === 0) {
			// This is a quoted cookie as according to RFC2068, unescape
			s = s.slice(1, -1).replace(/\\"/g, '"').replace(/\\\\/g, '\\');
		}
		try {
			return config.json ? JSON.parse(s) : s;
		} catch(er) {}
	}

	var config = $.cookie = function (key, value, options) {

		// write
		if (value !== undefined) {
			options = $.extend({}, config.defaults, options);

			if (typeof options.expires === 'number') {
				var days = options.expires, t = options.expires = new Date();
				t.setDate(t.getDate() + days);
			}

			value = config.json ? JSON.stringify(value) : String(value);

			return (document.cookie = [
				config.raw ? key : encodeURIComponent(key),
				'=',
				config.raw ? value : encodeURIComponent(value),
				options.expires ? '; expires=' + options.expires.toUTCString() : '', // use expires attribute, max-age is not supported by IE
				options.path    ? '; path=' + options.path : '',
				options.domain  ? '; domain=' + options.domain : '',
				options.secure  ? '; secure' : ''
			].join(''));
		}

		// read
		var decode = config.raw ? raw : decoded;
		var cookies = document.cookie.split('; ');
		var result = key ? undefined : {};
		for (var i = 0, l = cookies.length; i < l; i++) {
			var parts = cookies[i].split('=');
			var name = decode(parts.shift());
			var cookie = decode(parts.join('='));

			if (key && key === name) {
				result = converted(cookie);
				break;
			}

			if (!key) {
				result[name] = converted(cookie);
			}
		}

		return result;
	};

	config.defaults = {};

	$.removeCookie = function (key, options) {
		if ($.cookie(key) !== undefined) {
			// Must not alter options, thus extending a fresh object...
			$.cookie(key, '', $.extend({}, options, { expires: -1 }));
			return true;
		}
		return false;
	};

}));

//SCRIPT: ../../vendor-mod/js/respond/respond.min.js
/* Respond.js v1.3.0: min/max-width media query polyfill. (c) Scott Jehl. MIT/GPLv2 Lic. j.mp/respondjs  */
(function(f){var w={};f.respond=w;var p={};var c=false;w.update=function(){};w.mediaQueriesSupported=f.matchMedia&&f.matchMedia("only all").matches;w.addEventListener=function(C,B){p[C]=p[C]||[];p[C].push(B)};w.hasInitialised=function(){return c};var n=function(B){if(p[B]){for(var C=0;C<p[B].length;C++){p[B][C]()}}};if(w.mediaQueriesSupported){setTimeout(function(){n("onInitStart");n("onInitEnd");c=true},0);return}var A=f.document,v=A.documentElement,j=[],l=[],t=[],r={},i=30,g=A.getElementsByTagName("head")[0]||v,h=A.getElementsByTagName("base")[0],b=g.getElementsByTagName("link"),e=[],a=function(){n("onInitStart");for(var E=0;E<b.length;E++){var D=b[E],C=D.href,F=D.media,B=D.rel&&D.rel.toLowerCase()==="stylesheet";if(!!C&&B&&!r[C]){if(D.styleSheet&&D.styleSheet.rawCssText){o(D.styleSheet.rawCssText,C,F);r[C]=true}else{if((!/^([a-zA-Z:]*\/\/)/.test(C)&&!h)||C.replace(RegExp.$1,"").split("/")[0]===f.location.host){e.push({href:C,media:F})}}}}y()},y=function(){if(e.length){var B=e.shift();q(B.href,function(C){o(C,B.href,B.media);r[B.href]=true;f.setTimeout(function(){y()},0)})}else{c=true;n("onInitEnd")}},o=function(M,B,D){var K=M.match(/@media[^\{]+\{([^\{\}]*\{[^\}\{]*\})+/gi),N=K&&K.length||0;B=B.substring(0,B.lastIndexOf("/"));var C=function(O){return O.replace(/(url\()['"]?([^\/\)'"][^:\)'"]+)['"]?(\))/g,"$1"+B+"$2$3")},E=!N&&D;if(B.length){B+="/"}if(E){N=1}for(var H=0;H<N;H++){var I,J,F,L;if(E){I=D;l.push(C(M))}else{I=K[H].match(/@media *([^\{]+)\{([\S\s]+?)$/)&&RegExp.$1;l.push(RegExp.$2&&C(RegExp.$2))}F=I.split(",");L=F.length;for(var G=0;G<L;G++){J=F[G];j.push({media:J.split("(")[0].match(/(only\s+)?([a-zA-Z]+)\s?/)&&RegExp.$2||"all",rules:l.length-1,hasquery:J.indexOf("(")>-1,minw:J.match(/\(\s*min\-width\s*:\s*(\s*[0-9\.]+)(px|em)\s*\)/)&&parseFloat(RegExp.$1)+(RegExp.$2||""),maxw:J.match(/\(\s*max\-width\s*:\s*(\s*[0-9\.]+)(px|em)\s*\)/)&&parseFloat(RegExp.$1)+(RegExp.$2||"")})}}k()},m,u,z=function(){var D,E=A.createElement("div"),B=A.body,C=false;E.style.cssText="position:absolute;font-size:1em;width:1em";if(!B){B=C=A.createElement("body");B.style.background="none"}B.appendChild(E);v.insertBefore(B,v.firstChild);D=E.offsetWidth;if(C){v.removeChild(B)}else{B.removeChild(E)}D=s=parseFloat(D);return D},s,k=function(N){var S="clientWidth",E=v[S],C=A.compatMode==="CSS1Compat"&&E||A.body[S]||E,Q={},R=b[b.length-1],D=(new Date()).getTime();if(N&&m&&D-m<i){f.clearTimeout(u);u=f.setTimeout(k,i);return}else{m=D}for(var L in j){if(j.hasOwnProperty(L)){var O=j[L],H=O.minw,K=O.maxw,M=H===null,P=K===null,B="em";if(!!H){H=parseFloat(H)*(H.indexOf(B)>-1?(s||z()):1)}if(!!K){K=parseFloat(K)*(K.indexOf(B)>-1?(s||z()):1)}if(!O.hasquery||(!M||!P)&&(M||C>=H)&&(P||C<=K)){if(!Q[O.media]){Q[O.media]=[]}Q[O.media].push(l[O.rules])}}}for(var J in t){if(t.hasOwnProperty(J)){if(t[J]&&t[J].parentNode===g){g.removeChild(t[J])}}}for(var I in Q){if(Q.hasOwnProperty(I)){var G=A.createElement("style"),F=Q[I].join("\n");G.type="text/css";G.media=I;g.insertBefore(G,R.nextSibling);if(G.styleSheet){G.styleSheet.cssText=F}else{G.appendChild(A.createTextNode(F))}t.push(G)}}},q=function(B,D){var C=d();if(!C){return}C.open("GET",B,true);C.onreadystatechange=function(){if(C.readyState!==4||C.status!==200&&C.status!==304){return}D(C.responseText)};if(C.readyState===4){return}C.send(null)},d=(function(){var B=false;try{B=new f.XMLHttpRequest()}catch(C){B=new f.ActiveXObject("Microsoft.XMLHTTP")}return function(){return B}})();setTimeout(a,0);w.update=a;function x(){k(true)}if(f.addEventListener){f.addEventListener("resize",x,false)}else{if(f.attachEvent){f.attachEvent("onresize",x)}}})(this);

//SCRIPT: ../../vendor/js/interface/mig-interface.min.js
"use strict";var $j=jQuery.noConflict();var interfaceToolkit={getNaturalLanguage:function(){$j.ajax({url:window.jsonPathy,dataType:"json",success:function(a){window.languageJSON=a;interfaceToolkit.init()},error:function(){throw"Error: Failed to window.languageJSON"}})},tabComponents:function(a){function b(e){this._COMPONENT=e;this._TAB_NAVIGATION=this._COMPONENT.find(".tab-navigation");this._TAB_LINKS=this._TAB_NAVIGATION.find("a");this._FIRST_TAB_LINK=this._TAB_LINKS.first();this._TAB_PANELS=this._COMPONENT.find("div.panel");this._FIRST_TAB_PANEL=this._TAB_PANELS.first();this._TAB_HEADERS=this._COMPONENT.find(".tab-header");this._TAB_HEADERS.wrapInner($j('<a href="#"></a>'));this._TAB_HEADER_LINKS=this._COMPONENT.find(".tab-header a");var f=this;this._TAB_HEADER_LINKS.bind("click",function(h){h.preventDefault();var g="#"+$j(this).parent().next().find("a.named-anchor").attr("id");f._TAB_LINKS.filter('a[href="'+g+'"]').trigger("click")});return this.init()}b.prototype={init:function(){this.prepare();this.attachTabEvent()},attachTabEvent:function(){var e=this;this._TAB_LINKS.each(function(){$j(this).bind("click",function(g){g.preventDefault();if($j(this).attr("class")!=="current"){var f="a"+$j(this).attr("href");e.clearLinks();e.hidePanels();$j(this).attr("class","current");e._COMPONENT.find(f).parent().show().attr("aria-hidden","false")}})})},prepare:function(){this._TAB_PANELS.attr("role","tabpanel");this._TAB_NAVIGATION.attr("role","tablist");this._TAB_LINKS.attr("role","tab");this._TAB_LINKS.each(function(){$j(this).attr("id",this.hash.substr(1).replace("anchor","link"))});this._TAB_PANELS.each(function(){var e=$j(this).find("a.named-anchor").attr("id").replace("anchor","link");$j(this).attr("aria-labelledby",e)});this.hidePanels();this._FIRST_TAB_LINK.addClass("current");this._FIRST_TAB_PANEL.show().attr("aria-hidden","false")},clearLinks:function(){this._TAB_LINKS.removeClass("current")},hidePanels:function(){this._TAB_PANELS.hide().attr("aria-hidden","true")}};var d,c;if(a===undefined){d=$j("body")}else{d=a}d.find("div.tabs").each(function(){c=new b($j(this));c=null})},ie6FocusPseudoClassReplication:function(){if($j("body").hasClass("ie6")){$j("a").focus(function(){$j(this).addClass("focus")}).blur(function(){$j(this).removeClass("focus")})}},internalLinks:function(a){function b(e){this._LINKS=e;this._SCROLL_DURATION=500;this._SCROLL_EASING="swing";var g,i,h,f=this;this._LINKS.bind("click",function(j){j.preventDefault();g=this.hash;i=$j(g).offset().top;h=this;$j("html:not(:animated),body:not(:animated)").animate({scrollTop:i},f._SCROLL_DURATION,f._SCROLL_EASING,function(){window.location.href=h})})}var d,c;if(a===undefined){d=$j("body")}else{d=a}c=new b(d.find('a[rel="internal"]').not(".tabs a"));c=null},externalLinks:function(a){function c(f){this._LINKS=f;var e;this._LINKS.bind("click",function(g){g.preventDefault();e=this;window.open(e)})}var d,b;if(a===undefined){d=$j("body")}else{d=a}b=new c(d.find('a[rel="ext"]'));b=null},setWaiAria:function(){$j("body").attr("role","application");$j(".logo").attr("role","banner");$j(".legal").attr("role","contentinfo");$j("form").attr("role","form");$j("#content").attr("role","main");$j(".navigation").attr("role","navigation");var a=$j("div.figure img");a.each(function(){$j(this).attr("aria-describedby",$j(this).next().attr("id"))})},googleMap:function(){if(window.google&&$j("div.google-map").length>0){var b=new google.maps.LatLng(-34.397,150.644),a={zoom:9,center:b,mapTypeId:google.maps.MapTypeId.ROADMAP},c=new google.maps.Map($j("div#google-map-id")[0],a)}},formValidations:function(){function a(b){this._FORM=b;this._ERRORS_LIST=$j('<ul class="list-unsigned errors"></ul>');this._INPUT_CONTAINERS=this._FORM.find("div.input:not(.submit)");this._SUBMIT=this._FORM.find("div.submit input:not(.inactive)");this.FORM_ERROR=false;return this.init()}a.prototype={init:function(){this.prepareForm();this.submitForm()},prepareForm:function(){this._FORM.prepend(this._ERRORS_LIST);this.setWaiAria()},setWaiAria:function(){this._ERRORS_LIST.attr({"aaa:atomic":"true","aaa:live":"polite"});this._INPUT_CONTAINERS.attr({"aaa:atomic":"true","aaa:live":"polite"})},getIsUserInput:function(b){return(b==="SELECT"||b==="INPUT"||b==="TEXTAREA")},getHasValidationTests:function(b){return !(b===undefined||b==="")},getHasValue:function(b){if($j(b).is("[type=radio]")){var d=$j(b).parent().parent().parent().find("input"),c=false;d.each(function(){if($j(this).is(":checked")){c=true;return}});return c}if($j(b).is("[type=checkbox]")){if($j(b).is(":checked")){return true}}if($j(b).val().length>0){return true}return false},setFormError:function(b){if(b===true){this.FORM_ERROR=true}},getHasError:function(i){var m,f,c,j="",d,k,l,b=false,n="",g="",h=this;m=i.target;if(!h.getIsUserInput(m.tagName.toUpperCase())){i.stopPropagation();return}f=$j(m).parents(".input-grouping");c=$j(f).find(".named-anchor").first().attr("id");j=$j(f).attr("data-validation");if(!(h.getHasValidationTests(j))){return}if(j.match(/mandatory/)){l=!(h.getHasValue(m));h.setFormError(l);if(l===true){b=true;n+=" "+window.languageJSON._ERROR_MESSAGES._MANDATORY.short_description;g+=" "+window.languageJSON._ERROR_MESSAGES._MANDATORY.long_description}}if(j.match(/maximumFourtyCharacters/)){l=h.getHasValue(m)&&(m.value.length>40);h.setFormError(l);if(l===true){b=true;n+=" "+window.languageJSON._ERROR_MESSAGES._MAXIMUM_FOURTY_CHARACTERS.short_description;g+=" "+window.languageJSON._ERROR_MESSAGES._MAXIMUM_FOURTY_CHARACTERS.long_description}}if(j.match(/email/)){d=/^([a-zA-Z0-9_.\-])+@([a-zA-Z0-9_.\-])+\.([a-zA-Z])+([a-zA-Z])+/;l=h.getHasValue(m)&&!d.test(m.value);h.setFormError(l);if(l===true){b=true;n+=" "+window.languageJSON._ERROR_MESSAGES._EMAIL.short_description;g+=" "+window.languageJSON._ERROR_MESSAGES._EMAIL.long_description}}if(j.match(/numeric/)){k=/^0|[1-9]\d*$/;l=h.getHasValue(m)&&!k.test(m.value);h.setFormError(l);if(l===true){b=true;n+=" "+window.languageJSON._ERROR_MESSAGES._NUMERIC.short_description;g+=" "+window.languageJSON._ERROR_MESSAGES._NUMERIC.long_description}}if(b===true){h._ERRORS_LIST.find("#warning-"+c).remove();$j(f).removeClass("valid").addClass("invalid");$j('<li id="warning-'+c+'"><strong><a href="#'+c+'" rel="internal">'+$j(f).find("label").first().attr("for",m.id).html()+"</a></strong> "+g+"</li>").appendTo("ul.errors");$j(f).find("p.notification").remove();$j('<p class="notification invalid"><span>'+n+"</span></p>").appendTo($j(f));interfaceToolkit.internalLinks(h._FORM)}else{$j(f).removeClass("invalid").addClass("valid");h._ERRORS_LIST.find("#warning-"+c).remove();$j(f).find("p.notification").remove();$j('<p class="notification valid"><span>Valid</span></p>').appendTo($j(f))}},submitForm:function(){var b=this;this._FORM.bind("focusout",function(c){b.getHasError(c)});this._SUBMIT.bind("click",function(c){b.FORM_ERROR=false;b._FORM.find("select, input, textarea").trigger("focusout");if(b.FORM_ERROR===true){c.preventDefault()}})}};$j(".validate").each(function(){var b=new a($j(this));b=null})},carousels:function(){function a(c,b){this._CAROUSEL=c;this._CAROUSEL_LIST=this._CAROUSEL.find(".carousel-items");this._CAROUSEL_LIST_ITEMS=this._CAROUSEL_LIST.find("li.carousel-item");this._CAROUSEL_CLIP=this._CAROUSEL.find(".carousel-clip");this._CAROUSEL_LENGTH=this._CAROUSEL_LIST_ITEMS.length;this._RELATIONAL_NAVIGATION=$j('<ul class="list-unsigned navigation relational-navigation"></ul>');this._DIRECT_NAVIGATION=$j('<ul class="list-unsigned list-hor navigation direct-navigation"></ul>');this._RELATIONAL_NAVIGATION_NEXT_LIST_ITEM=$j('<li class="next"></li>');this._RELATIONAL_NAVIGATION_PREV_LIST_ITEM=$j('<li class="prev"></li>');this._RELATIONAL_NAVIGATION_NEXT_LINK=$j('<a class="replaced" href="#" rel="next" title="'+window.languageJSON._LINK_TEXT._CAROUSEL_NEXT.title+'">'+window.languageJSON._LINK_TEXT._CAROUSEL_NEXT.text+"</a>");this._RELATIONAL_NAVIGATION_PREV_LINK=$j('<a class="replaced" href="#" rel="prev" title="'+window.languageJSON._LINK_TEXT._CAROUSEL_PREV.title+'">'+window.languageJSON._LINK_TEXT._CAROUSEL_PREV.text+"</a>");this._COUNT_NUMBER=0;this._FADE_DURATION=250;this._OPTION_SCROLLING=b.data_config_scroll;this._OPTION_DIRECT_NAVIGATION=b.data_config_direct_navigation;var d=this;this._CAROUSEL.touchwipe({wipeLeft:function(){d.navigateNext();d.showCurrent()},wipeRight:function(){d.navigatePrev();d.showCurrent()},min_move_x:20,min_move_y:1000,preventDefaultEvents:false});return this.init()}a.prototype={init:function(){this.prepareCarousel();if(this.getHasSufficientItems()){this.getRelationalNavigation();this.setRelationalNavigation();this.getDirectNavigation();this.setDirectNavigation()}},prepareCarousel:function(){this._CAROUSEL_LIST.addClass("list-unsigned");this._CAROUSEL_LIST_ITEMS.eq(this._COUNT_NUMBER).show();this._CAROUSEL_LIST_ITEMS.eq(this._COUNT_NUMBER).addClass("current-carousel-item");this.hideCarouselItems()},hideCarouselItems:function(){$j(this._CAROUSEL_LIST_ITEMS).not(".current-carousel-item").hide()},resetCarouselItems:function(){this._CAROUSEL_LIST_ITEMS.removeClass("current-carousel-item fade")},getHasSufficientItems:function(){return(this._CAROUSEL_LENGTH>1)},showCurrent:function(){var b=this;b.setDirectNavigation();this._CAROUSEL_LIST_ITEMS.eq(this._COUNT_NUMBER).addClass("fade").fadeIn(this._FADE_DURATION,function(){b.resetCarouselItems();b._CAROUSEL_LIST_ITEMS.eq(b._COUNT_NUMBER).addClass("current-carousel-item");b.hideCarouselItems();b.setRelationalNavigation();b.setDirectNavigation()})},getDirectNavigation:function(){var b=this;this._CAROUSEL_LIST_ITEMS.each(function(c,d){b._DIRECT_NAVIGATION.append($j('<li><a href="#" id="'+c+'" title="'+$j(d).find(".item-label").html()+'"><span>'+c+"</span></a></li>"))});this._DIRECT_NAVIGATION.prependTo(this._CAROUSEL_CLIP);this._DIRECT_NAVIGATION.find("a").bind("click",function(d){d.preventDefault();var c=Number($j(this).attr("id"));b._COUNT_NUMBER=c;b.showCurrent()});if(this._OPTION_DIRECT_NAVIGATION!=="show"){this._DIRECT_NAVIGATION.hide()}},setDirectNavigation:function(){this._DIRECT_NAVIGATION.find("a").removeClass("current");this._DIRECT_NAVIGATION.find("a").eq(this._COUNT_NUMBER).addClass("current")},getRelationalNavigation:function(){this._RELATIONAL_NAVIGATION_NEXT_LINK.prependTo(this._RELATIONAL_NAVIGATION_NEXT_LIST_ITEM);this._RELATIONAL_NAVIGATION_PREV_LINK.prependTo(this._RELATIONAL_NAVIGATION_PREV_LIST_ITEM);this._RELATIONAL_NAVIGATION_NEXT_LIST_ITEM.prependTo(this._RELATIONAL_NAVIGATION);this._RELATIONAL_NAVIGATION_PREV_LIST_ITEM.prependTo(this._RELATIONAL_NAVIGATION);this._RELATIONAL_NAVIGATION.prependTo(this._CAROUSEL_CLIP);var b=this;this._RELATIONAL_NAVIGATION_NEXT_LINK.add(this._RELATIONAL_NAVIGATION_PREV_LINK).bind("click",function(c){c.preventDefault();if(!(b._CAROUSEL_LIST_ITEMS.is(":animated"))){if($j(c.target).attr("rel")==="next"){b.navigateNext()}else{b.navigatePrev()}b.showCurrent()}})},navigatePrev:function(){if(this._OPTION_SCROLLING==="finite"){if(this._COUNT_NUMBER>0){this._COUNT_NUMBER--}}else{if(this._COUNT_NUMBER===0){this._COUNT_NUMBER=this._CAROUSEL_LENGTH-1}else{this._COUNT_NUMBER--}}},navigateNext:function(){if(this._OPTION_SCROLLING==="finite"){if(this._COUNT_NUMBER<this._CAROUSEL_LENGTH-1){this._COUNT_NUMBER++}}else{if(this._COUNT_NUMBER===this._CAROUSEL_LENGTH-1){this._COUNT_NUMBER=0}else{this._COUNT_NUMBER++}}},setRelationalNavigation:function(){if(this._OPTION_SCROLLING==="finite"){this._RELATIONAL_NAVIGATION_NEXT_LINK.css("display","block");this._RELATIONAL_NAVIGATION_PREV_LINK.css("display","block");if(this._COUNT_NUMBER===0){this._RELATIONAL_NAVIGATION_NEXT_LINK.css("display","block");this._RELATIONAL_NAVIGATION_PREV_LINK.css("display","none")}if(this._COUNT_NUMBER===this._CAROUSEL_LENGTH-1){this._RELATIONAL_NAVIGATION_NEXT_LINK.css("display","none");this._RELATIONAL_NAVIGATION_PREV_LINK.css("display","block")}}}};$j(".carousel").each(function(){var c,b,d;if($j(this).attr("data-config-scroll")==="infinite"){b="infinite"}else{b="finite"}if($j(this).attr("data-config-direct-navigation")==="show"){d="show"}else{d="hide"}c=new a($j(this),{data_config_scroll:b,data_config_direct_navigation:d});c=null})},fancyboxes:function(){$j("a.fancybox").fancybox({centerOnScroll:true,transitionIn:"fade",transitionOut:"fade",margin:0,padding:0,onStart:function(){return{href:"#home"}}});$j("a.fancybox.fancybox-title-inside").fancybox({centerOnScroll:true,titlePosition:"inside",transitionIn:"elastic",transitionOut:"elastic"});$j("a.fancybox.fancybox-title-outside").fancybox({centerOnScroll:true,titlePosition:"outside",transitionIn:"elastic",transitionOut:"elastic"});$j("a.fancybox.fancybox-title-over").fancybox({centerOnScroll:true,titlePosition:"over",transitionIn:"elastic",transitionOut:"elastic"});$j("a.fancybox.fancybox-iframe-content").fancybox({centerOnScroll:true,autoScale:false,height:"75%",titlePosition:"over",transitionIn:"elastic",transitionOut:"elastic",type:"iframe",width:"75%"});$j("a.fancybox[rel=fancybox-group]").fancybox({centerOnScroll:true,titlePosition:"over",transitionIn:"elastic",transitionOut:"elastic",titleFormat:function(c,b,a){return'<span id="fancybox-title-over">Image '+(a+1)+" / "+b.length+(c.length?" &nbsp; "+c:"")+"</span>"}})},toggleControllers:function(a){function b(e){this._TOGGLER_CONTROLLER=e;this._TOGGLE_ELEMENT=$j("#"+this._TOGGLER_CONTROLLER.attr("data-toggle-element"));this._TOGGLER_LINK=null;this._TOGGLE_DURATION=0;return this.init()}b.prototype={init:function(){this.getTogglerLink();this.setToggleEvent();this.setState();this.setInitState()},getTogglerLink:function(){this._TOGGLER_CONTROLLER.wrap('<a class="icon toggle-link" href="#"></a>');this._TOGGLER_LINK=this._TOGGLER_CONTROLLER.parent()},setToggleEvent:function(){var e=this;this._TOGGLER_LINK.bind("click",function(f){f.preventDefault();e._TOGGLE_ELEMENT.toggle(e._TOGGLE_DURATION,function(){e.setState()})})},setState:function(){if((this._TOGGLE_ELEMENT).css("display")==="block"){this._TOGGLE_ELEMENT.addClass("toggle-element-open").removeClass("toggle-element-closed");this._TOGGLER_LINK.addClass("toggler-open").removeClass("toggler-closed")}else{this._TOGGLE_ELEMENT.addClass("toggle-element-closed").removeClass("toggle-element-open");this._TOGGLER_LINK.addClass("toggler-closed").removeClass("toggler-open")}},setInitState:function(){if(this._TOGGLER_CONTROLLER.attr("data-toggle-element-open")==="open"){this._TOGGLER_LINK.trigger("click")}}};var d,c;if(a===undefined){d=$j("body")}else{d=a}d.find(".toggle-controller").each(function(){c=new b($j(this));c=null})},accordions:function(b){function a(e){this._ACCORDION=e;this._SUMMARY_ELEMENTS=this._ACCORDION.find(".summary");this._SUMMARY_LINKS=null;this._DISCLOSURE_ELEMENTS=this._ACCORDION.find("div.disclosure");this._SLIDE_DURATION=200;return this.init()}a.prototype={init:function(){this.getSummaryLinks();this.setAccordion();var e=this;this._SUMMARY_LINKS.bind("click",function(f){f.preventDefault();e.resetAccordion();if($j(this).parent().next(".disclosure").is(":hidden")){$j(this).removeClass("accordion-closed").addClass("accordion-open");$j(this).parent().next(".disclosure").stop(true,false).slideToggle(e._SLIDE_DURATION)}})},getSummaryLinks:function(){this._SUMMARY_ELEMENTS.wrapInner($j('<a class="icon" href="#"></a>'));this._SUMMARY_LINKS=this._SUMMARY_ELEMENTS.find("a")},resetAccordion:function(){this._DISCLOSURE_ELEMENTS.slideUp(this._SLIDE_DURATION);this._SUMMARY_LINKS.removeClass("accordion-open").addClass("accordion-closed")},setAccordion:function(){this._ACCORDION.attr({"aaa:atomic":"true","aaa:live":"polite"});this._DISCLOSURE_ELEMENTS.hide();this._SUMMARY_LINKS.addClass("accordion-closed")}};var d,c;if(b===undefined){d=$j("body")}else{d=b}d.find("div.accordion").each(function(){c=new a($j(this));c=null})},scrollPanes:function(c,a){if(!_.isUndefined(c)){var b=c.find(".scroll-pane")||$j([]);b.each(function(){if(_.isUndefined($j(this).attr("data-scroll-pane-set"))||a){if(!a){$j(this).attr("data-scroll-pane-set","true");setTimeout(function(){$j(this).jScrollPane({showArrows:false});var d=$j(this).data("jsp"),e;$j(this).find("a").bind("click",function(){d.scrollTo(0,Math.round($j($j(this)).position().top))});$j(window).bind("resize",function(){if($j.browser.msie){if(!e){e=setTimeout(function(){d.reinitialise.call(this);e=null},50)}}else{d.reinitialise.call(this)}}.createDelegate(this))}.createDelegate(this),500)}else{$j(window).trigger("resize",false)}}})}},updateResponse:function(a){function b(e){this._UPDATE_TRIGGER=e;this._UPDATE_TRIGGER_TAG=this._UPDATE_TRIGGER[0].tagName;this._UPDATE_LINK=null;this._QUERY_STRING=this._UPDATE_TRIGGER.attr("data-query-string");this._UPDATE_ELEMENT=$j("#"+this._UPDATE_TRIGGER.attr("data-update"));this._COUNT=0;return this.init()}b.prototype={init:function(){this.setLink();this.setWaiAria();this.setUpdateResponse()},setLink:function(){if(this._UPDATE_TRIGGER_TAG.toUpperCase()==="INPUT"){this._UPDATE_LINK=this._UPDATE_TRIGGER.parents("form").attr("action")}else{this._UPDATE_LINK=this._UPDATE_TRIGGER.attr("href")}},setWaiAria:function(){this._UPDATE_ELEMENT.attr({"aaa:atomic":"true","aaa:live":"polite"})},setUpdateResponse:function(){var e=this;this._UPDATE_TRIGGER.bind("click",function(f){f.preventDefault();$j.get(e._UPDATE_LINK+"?"+e._QUERY_STRING+"&count="+e._COUNT,function(g){e._UPDATE_ELEMENT.append(g)});e._COUNT++})}};var d,c;if(a===undefined){d=$j("body")}else{d=a}d.find(".update-response").each(function(){c=new b($j(this));c=null})},projekktorVideoSkin:function(){projekktor("video")},contextualLinkHighlighting:function(){var b=$j("a.contextual-indicator-primary, a.contextual-indicator");var c=window.location.hash,a=window.location.hash.split("-")[0];b.removeClass("current");$j("a.contextual-indicator-primary").each(function(){if(this.hash.split("-")[0]===a){$j(this).addClass("current")}});$j("a.contextual-indicator").each(function(){if(this.hash===c){$j(this).addClass("current")}})},locks:function(c){var b=c.find("div.lock");if(b&&(b.attr("data-locked")==="true"||b.attr("data-lock-persist")==="true")){(function a(l){var f=l.attr("data-lock-name");var j=$j('div[data-lock-name="'+f+'"]');var h=parseInt(l.attr("data-unlock-duration"))*1000;var k=l.find($j(".lock-link"));var m=l.find($j(".lock-modal"));var e=l.find($j(".lock-mask"));var i=null;l.attr("data-locked","true");l.removeClass("lock-status-unlocked").addClass("lock-status-locked");k.bind("mousedown touchstart",function(){$j(this).addClass("active");i=window.setTimeout(function(){g()},h);return false}).bind("mouseup touchend",function(){$j(this).removeClass("active");clearTimeout(i);return false}).bind("mouseleave",function(){$j(this).removeClass("active");clearTimeout(i)});e.bind(window.transitionEnd,function(n){if($j(n.target).is($j(this))){d()}});function g(){l.addClass("lock-status-unlocking")}function d(){l.removeClass("lock-status-locked lock-status-unlocking").addClass("lock-status-unlocked");j.attr("data-locked","false").removeClass("lock-status-locked").addClass("lock-status-unlocked")}})(b)}},autoRedirect:function(c){if(c.attr("data-auto-redirect")==="true"){var e=c.attr("data-auto-redirect-target");var b=c.attr("data-auto-redirect-iterations");var f=parseInt(c.attr("data-auto-redirect-count"));if(b==="infinite"||parseInt(b)>f){var a=parseInt(c.attr("data-auto-redirect-timer"))*1000;var d=window.setTimeout(function(){window.location.hash="#"+e;c.attr("data-auto-redirect-count",f+=1);clearTimeout(d)},a)}}},pagination:function(f,d){var e=f,c=d,a=null,b=null;function g(){return c.find("div.wrap.transition-in, div.wrap.transition-out").length>1}if($j("html").hasClass("touch")&&e.find("a.navigation-link").length>=1){a=e.find("a.next.navigation-link");b=e.find("a.prev.navigation-link")}},orientationNotification:function(){if($j("#orientation-warning")){a()}function a(){var f=$j("#orientation-warning");var h=Number(f.attr("data-fade-duration"));var k=f.attr("data-orientation-optimisation");var j=f.attr("data-persistent-notifications");var n=f.attr("data-auto-hide");var g=Number(f.attr("data-auto-hide-delay"));var d=f.find("a");function l(){d.bind("click",function(p){p.preventDefault();f.attr("data-notified","true");b()})}function o(){f.removeClass("hide").hide()}function m(){if(k!=="landscape-optimised"){i()}else{b()}}function c(){if(k!=="portrait-optimised"){i()}else{b()}}function i(){if(j==="true"||_.isUndefined(f.attr("data-notified"))){if(n==="true"){f.attr("data-notified","true");f.dequeue().fadeIn(h).delay(g).fadeOut(h)}else{f.dequeue().fadeIn(h)}}}function b(){f.dequeue().fadeOut(h)}function e(){switch(window.orientation){case 180:case 0:c();break;case -90:case 90:m();break}}$j(window).bind("orientationchange",function(){e()});o();l();e()}},init:function(){this.fancyboxes();this.orientationNotification()}};$j(document).ready(function(){interfaceToolkit.init()});window.onload=function(){var a=setTimeout(function(){$j("html").addClass("window-loaded")},1000)};function whichTransitionEvent(){var a;var b=document.createElement("fakeelement");var c={transition:"transitionEnd",OTransition:"oTransitionEnd",MSTransition:"msTransitionEnd",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd"};for(a in c){if(b.style[a]!==undefined){return c[a]}}}window.transitionEnd=whichTransitionEvent();

//SCRIPT: ../../vendor/js/moment-with-langs.min.js
//! moment.js
//! version : 2.5.0
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
(function(a){function b(a,b){return function(c){return i(a.call(this,c),b)}}function c(a,b){return function(c){return this.lang().ordinal(a.call(this,c),b)}}function d(){}function e(a){u(a),g(this,a)}function f(a){var b=o(a),c=b.year||0,d=b.month||0,e=b.week||0,f=b.day||0,g=b.hour||0,h=b.minute||0,i=b.second||0,j=b.millisecond||0;this._milliseconds=+j+1e3*i+6e4*h+36e5*g,this._days=+f+7*e,this._months=+d+12*c,this._data={},this._bubble()}function g(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);return b.hasOwnProperty("toString")&&(a.toString=b.toString),b.hasOwnProperty("valueOf")&&(a.valueOf=b.valueOf),a}function h(a){return 0>a?Math.ceil(a):Math.floor(a)}function i(a,b,c){for(var d=Math.abs(a)+"",e=a>=0;d.length<b;)d="0"+d;return(e?c?"+":"":"-")+d}function j(a,b,c,d){var e,f,g=b._milliseconds,h=b._days,i=b._months;g&&a._d.setTime(+a._d+g*c),(h||i)&&(e=a.minute(),f=a.hour()),h&&a.date(a.date()+h*c),i&&a.month(a.month()+i*c),g&&!d&&cb.updateOffset(a),(h||i)&&(a.minute(e),a.hour(f))}function k(a){return"[object Array]"===Object.prototype.toString.call(a)}function l(a){return"[object Date]"===Object.prototype.toString.call(a)||a instanceof Date}function m(a,b,c){var d,e=Math.min(a.length,b.length),f=Math.abs(a.length-b.length),g=0;for(d=0;e>d;d++)(c&&a[d]!==b[d]||!c&&q(a[d])!==q(b[d]))&&g++;return g+f}function n(a){if(a){var b=a.toLowerCase().replace(/(.)s$/,"$1");a=Qb[a]||Rb[b]||b}return a}function o(a){var b,c,d={};for(c in a)a.hasOwnProperty(c)&&(b=n(c),b&&(d[b]=a[c]));return d}function p(b){var c,d;if(0===b.indexOf("week"))c=7,d="day";else{if(0!==b.indexOf("month"))return;c=12,d="month"}cb[b]=function(e,f){var g,h,i=cb.fn._lang[b],j=[];if("number"==typeof e&&(f=e,e=a),h=function(a){var b=cb().utc().set(d,a);return i.call(cb.fn._lang,b,e||"")},null!=f)return h(f);for(g=0;c>g;g++)j.push(h(g));return j}}function q(a){var b=+a,c=0;return 0!==b&&isFinite(b)&&(c=b>=0?Math.floor(b):Math.ceil(b)),c}function r(a,b){return new Date(Date.UTC(a,b+1,0)).getUTCDate()}function s(a){return t(a)?366:365}function t(a){return a%4===0&&a%100!==0||a%400===0}function u(a){var b;a._a&&-2===a._pf.overflow&&(b=a._a[ib]<0||a._a[ib]>11?ib:a._a[jb]<1||a._a[jb]>r(a._a[hb],a._a[ib])?jb:a._a[kb]<0||a._a[kb]>23?kb:a._a[lb]<0||a._a[lb]>59?lb:a._a[mb]<0||a._a[mb]>59?mb:a._a[nb]<0||a._a[nb]>999?nb:-1,a._pf._overflowDayOfYear&&(hb>b||b>jb)&&(b=jb),a._pf.overflow=b)}function v(a){a._pf={empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1}}function w(a){return null==a._isValid&&(a._isValid=!isNaN(a._d.getTime())&&a._pf.overflow<0&&!a._pf.empty&&!a._pf.invalidMonth&&!a._pf.nullInput&&!a._pf.invalidFormat&&!a._pf.userInvalidated,a._strict&&(a._isValid=a._isValid&&0===a._pf.charsLeftOver&&0===a._pf.unusedTokens.length)),a._isValid}function x(a){return a?a.toLowerCase().replace("_","-"):a}function y(a,b){return b._isUTC?cb(a).zone(b._offset||0):cb(a).local()}function z(a,b){return b.abbr=a,ob[a]||(ob[a]=new d),ob[a].set(b),ob[a]}function A(a){delete ob[a]}function B(a){var b,c,d,e,f=0,g=function(a){if(!ob[a]&&pb)try{require("./lang/"+a)}catch(b){}return ob[a]};if(!a)return cb.fn._lang;if(!k(a)){if(c=g(a))return c;a=[a]}for(;f<a.length;){for(e=x(a[f]).split("-"),b=e.length,d=x(a[f+1]),d=d?d.split("-"):null;b>0;){if(c=g(e.slice(0,b).join("-")))return c;if(d&&d.length>=b&&m(e,d,!0)>=b-1)break;b--}f++}return cb.fn._lang}function C(a){return a.match(/\[[\s\S]/)?a.replace(/^\[|\]$/g,""):a.replace(/\\/g,"")}function D(a){var b,c,d=a.match(tb);for(b=0,c=d.length;c>b;b++)d[b]=Vb[d[b]]?Vb[d[b]]:C(d[b]);return function(e){var f="";for(b=0;c>b;b++)f+=d[b]instanceof Function?d[b].call(e,a):d[b];return f}}function E(a,b){return a.isValid()?(b=F(b,a.lang()),Sb[b]||(Sb[b]=D(b)),Sb[b](a)):a.lang().invalidDate()}function F(a,b){function c(a){return b.longDateFormat(a)||a}var d=5;for(ub.lastIndex=0;d>=0&&ub.test(a);)a=a.replace(ub,c),ub.lastIndex=0,d-=1;return a}function G(a,b){var c,d=b._strict;switch(a){case"DDDD":return Gb;case"YYYY":case"GGGG":case"gggg":return d?Hb:xb;case"YYYYYY":case"YYYYY":case"GGGGG":case"ggggg":return d?Ib:yb;case"S":if(d)return Eb;case"SS":if(d)return Fb;case"SSS":case"DDD":return d?Gb:wb;case"MMM":case"MMMM":case"dd":case"ddd":case"dddd":return Ab;case"a":case"A":return B(b._l)._meridiemParse;case"X":return Db;case"Z":case"ZZ":return Bb;case"T":return Cb;case"SSSS":return zb;case"MM":case"DD":case"YY":case"GG":case"gg":case"HH":case"hh":case"mm":case"ss":case"ww":case"WW":return d?Fb:vb;case"M":case"D":case"d":case"H":case"h":case"m":case"s":case"w":case"W":case"e":case"E":return d?Eb:vb;default:return c=new RegExp(O(N(a.replace("\\","")),"i"))}}function H(a){a=a||"";var b=a.match(Bb)||[],c=b[b.length-1]||[],d=(c+"").match(Nb)||["-",0,0],e=+(60*d[1])+q(d[2]);return"+"===d[0]?-e:e}function I(a,b,c){var d,e=c._a;switch(a){case"M":case"MM":null!=b&&(e[ib]=q(b)-1);break;case"MMM":case"MMMM":d=B(c._l).monthsParse(b),null!=d?e[ib]=d:c._pf.invalidMonth=b;break;case"D":case"DD":null!=b&&(e[jb]=q(b));break;case"DDD":case"DDDD":null!=b&&(c._dayOfYear=q(b));break;case"YY":e[hb]=q(b)+(q(b)>68?1900:2e3);break;case"YYYY":case"YYYYY":case"YYYYYY":e[hb]=q(b);break;case"a":case"A":c._isPm=B(c._l).isPM(b);break;case"H":case"HH":case"h":case"hh":e[kb]=q(b);break;case"m":case"mm":e[lb]=q(b);break;case"s":case"ss":e[mb]=q(b);break;case"S":case"SS":case"SSS":case"SSSS":e[nb]=q(1e3*("0."+b));break;case"X":c._d=new Date(1e3*parseFloat(b));break;case"Z":case"ZZ":c._useUTC=!0,c._tzm=H(b);break;case"w":case"ww":case"W":case"WW":case"d":case"dd":case"ddd":case"dddd":case"e":case"E":a=a.substr(0,1);case"gg":case"gggg":case"GG":case"GGGG":case"GGGGG":a=a.substr(0,2),b&&(c._w=c._w||{},c._w[a]=b)}}function J(a){var b,c,d,e,f,g,h,i,j,k,l=[];if(!a._d){for(d=L(a),a._w&&null==a._a[jb]&&null==a._a[ib]&&(f=function(b){var c=parseInt(b,10);return b?b.length<3?c>68?1900+c:2e3+c:c:null==a._a[hb]?cb().weekYear():a._a[hb]},g=a._w,null!=g.GG||null!=g.W||null!=g.E?h=Y(f(g.GG),g.W||1,g.E,4,1):(i=B(a._l),j=null!=g.d?U(g.d,i):null!=g.e?parseInt(g.e,10)+i._week.dow:0,k=parseInt(g.w,10)||1,null!=g.d&&j<i._week.dow&&k++,h=Y(f(g.gg),k,j,i._week.doy,i._week.dow)),a._a[hb]=h.year,a._dayOfYear=h.dayOfYear),a._dayOfYear&&(e=null==a._a[hb]?d[hb]:a._a[hb],a._dayOfYear>s(e)&&(a._pf._overflowDayOfYear=!0),c=T(e,0,a._dayOfYear),a._a[ib]=c.getUTCMonth(),a._a[jb]=c.getUTCDate()),b=0;3>b&&null==a._a[b];++b)a._a[b]=l[b]=d[b];for(;7>b;b++)a._a[b]=l[b]=null==a._a[b]?2===b?1:0:a._a[b];l[kb]+=q((a._tzm||0)/60),l[lb]+=q((a._tzm||0)%60),a._d=(a._useUTC?T:S).apply(null,l)}}function K(a){var b;a._d||(b=o(a._i),a._a=[b.year,b.month,b.day,b.hour,b.minute,b.second,b.millisecond],J(a))}function L(a){var b=new Date;return a._useUTC?[b.getUTCFullYear(),b.getUTCMonth(),b.getUTCDate()]:[b.getFullYear(),b.getMonth(),b.getDate()]}function M(a){a._a=[],a._pf.empty=!0;var b,c,d,e,f,g=B(a._l),h=""+a._i,i=h.length,j=0;for(d=F(a._f,g).match(tb)||[],b=0;b<d.length;b++)e=d[b],c=(h.match(G(e,a))||[])[0],c&&(f=h.substr(0,h.indexOf(c)),f.length>0&&a._pf.unusedInput.push(f),h=h.slice(h.indexOf(c)+c.length),j+=c.length),Vb[e]?(c?a._pf.empty=!1:a._pf.unusedTokens.push(e),I(e,c,a)):a._strict&&!c&&a._pf.unusedTokens.push(e);a._pf.charsLeftOver=i-j,h.length>0&&a._pf.unusedInput.push(h),a._isPm&&a._a[kb]<12&&(a._a[kb]+=12),a._isPm===!1&&12===a._a[kb]&&(a._a[kb]=0),J(a),u(a)}function N(a){return a.replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(a,b,c,d,e){return b||c||d||e})}function O(a){return a.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function P(a){var b,c,d,e,f;if(0===a._f.length)return a._pf.invalidFormat=!0,a._d=new Date(0/0),void 0;for(e=0;e<a._f.length;e++)f=0,b=g({},a),v(b),b._f=a._f[e],M(b),w(b)&&(f+=b._pf.charsLeftOver,f+=10*b._pf.unusedTokens.length,b._pf.score=f,(null==d||d>f)&&(d=f,c=b));g(a,c||b)}function Q(a){var b,c=a._i,d=Jb.exec(c);if(d){for(a._pf.iso=!0,b=4;b>0;b--)if(d[b]){a._f=Lb[b-1]+(d[6]||" ");break}for(b=0;4>b;b++)if(Mb[b][1].exec(c)){a._f+=Mb[b][0];break}c.match(Bb)&&(a._f+="Z"),M(a)}else a._d=new Date(c)}function R(b){var c=b._i,d=qb.exec(c);c===a?b._d=new Date:d?b._d=new Date(+d[1]):"string"==typeof c?Q(b):k(c)?(b._a=c.slice(0),J(b)):l(c)?b._d=new Date(+c):"object"==typeof c?K(b):b._d=new Date(c)}function S(a,b,c,d,e,f,g){var h=new Date(a,b,c,d,e,f,g);return 1970>a&&h.setFullYear(a),h}function T(a){var b=new Date(Date.UTC.apply(null,arguments));return 1970>a&&b.setUTCFullYear(a),b}function U(a,b){if("string"==typeof a)if(isNaN(a)){if(a=b.weekdaysParse(a),"number"!=typeof a)return null}else a=parseInt(a,10);return a}function V(a,b,c,d,e){return e.relativeTime(b||1,!!c,a,d)}function W(a,b,c){var d=gb(Math.abs(a)/1e3),e=gb(d/60),f=gb(e/60),g=gb(f/24),h=gb(g/365),i=45>d&&["s",d]||1===e&&["m"]||45>e&&["mm",e]||1===f&&["h"]||22>f&&["hh",f]||1===g&&["d"]||25>=g&&["dd",g]||45>=g&&["M"]||345>g&&["MM",gb(g/30)]||1===h&&["y"]||["yy",h];return i[2]=b,i[3]=a>0,i[4]=c,V.apply({},i)}function X(a,b,c){var d,e=c-b,f=c-a.day();return f>e&&(f-=7),e-7>f&&(f+=7),d=cb(a).add("d",f),{week:Math.ceil(d.dayOfYear()/7),year:d.year()}}function Y(a,b,c,d,e){var f,g,h=new Date(i(a,6,!0)+"-01-01").getUTCDay();return c=null!=c?c:e,f=e-h+(h>d?7:0),g=7*(b-1)+(c-e)+f+1,{year:g>0?a:a-1,dayOfYear:g>0?g:s(a-1)+g}}function Z(a){var b=a._i,c=a._f;return"undefined"==typeof a._pf&&v(a),null===b?cb.invalid({nullInput:!0}):("string"==typeof b&&(a._i=b=B().preparse(b)),cb.isMoment(b)?(a=g({},b),a._d=new Date(+b._d)):c?k(c)?P(a):M(a):R(a),new e(a))}function $(a,b){cb.fn[a]=cb.fn[a+"s"]=function(a){var c=this._isUTC?"UTC":"";return null!=a?(this._d["set"+c+b](a),cb.updateOffset(this),this):this._d["get"+c+b]()}}function _(a){cb.duration.fn[a]=function(){return this._data[a]}}function ab(a,b){cb.duration.fn["as"+a]=function(){return+this/b}}function bb(a){var b=!1,c=cb;"undefined"==typeof ender&&(a?(fb.moment=function(){return!b&&console&&console.warn&&(b=!0,console.warn("Accessing Moment through the global scope is deprecated, and will be removed in an upcoming release.")),c.apply(null,arguments)},g(fb.moment,c)):fb.moment=cb)}for(var cb,db,eb="2.5.0",fb=this,gb=Math.round,hb=0,ib=1,jb=2,kb=3,lb=4,mb=5,nb=6,ob={},pb="undefined"!=typeof module&&module.exports&&"undefined"!=typeof require,qb=/^\/?Date\((\-?\d+)/i,rb=/(\-)?(?:(\d*)\.)?(\d+)\:(\d+)(?:\:(\d+)\.?(\d{3})?)?/,sb=/^(-)?P(?:(?:([0-9,.]*)Y)?(?:([0-9,.]*)M)?(?:([0-9,.]*)D)?(?:T(?:([0-9,.]*)H)?(?:([0-9,.]*)M)?(?:([0-9,.]*)S)?)?|([0-9,.]*)W)$/,tb=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|mm?|ss?|S{1,4}|X|zz?|ZZ?|.)/g,ub=/(\[[^\[]*\])|(\\)?(LT|LL?L?L?|l{1,4})/g,vb=/\d\d?/,wb=/\d{1,3}/,xb=/\d{1,4}/,yb=/[+\-]?\d{1,6}/,zb=/\d+/,Ab=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,Bb=/Z|[\+\-]\d\d:?\d\d/gi,Cb=/T/i,Db=/[\+\-]?\d+(\.\d{1,3})?/,Eb=/\d/,Fb=/\d\d/,Gb=/\d{3}/,Hb=/\d{4}/,Ib=/[+\-]?\d{6}/,Jb=/^\s*\d{4}-(?:(\d\d-\d\d)|(W\d\d$)|(W\d\d-\d)|(\d\d\d))((T| )(\d\d(:\d\d(:\d\d(\.\d+)?)?)?)?([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Kb="YYYY-MM-DDTHH:mm:ssZ",Lb=["YYYY-MM-DD","GGGG-[W]WW","GGGG-[W]WW-E","YYYY-DDD"],Mb=[["HH:mm:ss.SSSS",/(T| )\d\d:\d\d:\d\d\.\d{1,3}/],["HH:mm:ss",/(T| )\d\d:\d\d:\d\d/],["HH:mm",/(T| )\d\d:\d\d/],["HH",/(T| )\d\d/]],Nb=/([\+\-]|\d\d)/gi,Ob="Date|Hours|Minutes|Seconds|Milliseconds".split("|"),Pb={Milliseconds:1,Seconds:1e3,Minutes:6e4,Hours:36e5,Days:864e5,Months:2592e6,Years:31536e6},Qb={ms:"millisecond",s:"second",m:"minute",h:"hour",d:"day",D:"date",w:"week",W:"isoWeek",M:"month",y:"year",DDD:"dayOfYear",e:"weekday",E:"isoWeekday",gg:"weekYear",GG:"isoWeekYear"},Rb={dayofyear:"dayOfYear",isoweekday:"isoWeekday",isoweek:"isoWeek",weekyear:"weekYear",isoweekyear:"isoWeekYear"},Sb={},Tb="DDD w W M D d".split(" "),Ub="M D H h m s w W".split(" "),Vb={M:function(){return this.month()+1},MMM:function(a){return this.lang().monthsShort(this,a)},MMMM:function(a){return this.lang().months(this,a)},D:function(){return this.date()},DDD:function(){return this.dayOfYear()},d:function(){return this.day()},dd:function(a){return this.lang().weekdaysMin(this,a)},ddd:function(a){return this.lang().weekdaysShort(this,a)},dddd:function(a){return this.lang().weekdays(this,a)},w:function(){return this.week()},W:function(){return this.isoWeek()},YY:function(){return i(this.year()%100,2)},YYYY:function(){return i(this.year(),4)},YYYYY:function(){return i(this.year(),5)},YYYYYY:function(){var a=this.year(),b=a>=0?"+":"-";return b+i(Math.abs(a),6)},gg:function(){return i(this.weekYear()%100,2)},gggg:function(){return this.weekYear()},ggggg:function(){return i(this.weekYear(),5)},GG:function(){return i(this.isoWeekYear()%100,2)},GGGG:function(){return this.isoWeekYear()},GGGGG:function(){return i(this.isoWeekYear(),5)},e:function(){return this.weekday()},E:function(){return this.isoWeekday()},a:function(){return this.lang().meridiem(this.hours(),this.minutes(),!0)},A:function(){return this.lang().meridiem(this.hours(),this.minutes(),!1)},H:function(){return this.hours()},h:function(){return this.hours()%12||12},m:function(){return this.minutes()},s:function(){return this.seconds()},S:function(){return q(this.milliseconds()/100)},SS:function(){return i(q(this.milliseconds()/10),2)},SSS:function(){return i(this.milliseconds(),3)},SSSS:function(){return i(this.milliseconds(),3)},Z:function(){var a=-this.zone(),b="+";return 0>a&&(a=-a,b="-"),b+i(q(a/60),2)+":"+i(q(a)%60,2)},ZZ:function(){var a=-this.zone(),b="+";return 0>a&&(a=-a,b="-"),b+i(q(a/60),2)+i(q(a)%60,2)},z:function(){return this.zoneAbbr()},zz:function(){return this.zoneName()},X:function(){return this.unix()},Q:function(){return this.quarter()}},Wb=["months","monthsShort","weekdays","weekdaysShort","weekdaysMin"];Tb.length;)db=Tb.pop(),Vb[db+"o"]=c(Vb[db],db);for(;Ub.length;)db=Ub.pop(),Vb[db+db]=b(Vb[db],2);for(Vb.DDDD=b(Vb.DDD,3),g(d.prototype,{set:function(a){var b,c;for(c in a)b=a[c],"function"==typeof b?this[c]=b:this["_"+c]=b},_months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),months:function(a){return this._months[a.month()]},_monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),monthsShort:function(a){return this._monthsShort[a.month()]},monthsParse:function(a){var b,c,d;for(this._monthsParse||(this._monthsParse=[]),b=0;12>b;b++)if(this._monthsParse[b]||(c=cb.utc([2e3,b]),d="^"+this.months(c,"")+"|^"+this.monthsShort(c,""),this._monthsParse[b]=new RegExp(d.replace(".",""),"i")),this._monthsParse[b].test(a))return b},_weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdays:function(a){return this._weekdays[a.day()]},_weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysShort:function(a){return this._weekdaysShort[a.day()]},_weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),weekdaysMin:function(a){return this._weekdaysMin[a.day()]},weekdaysParse:function(a){var b,c,d;for(this._weekdaysParse||(this._weekdaysParse=[]),b=0;7>b;b++)if(this._weekdaysParse[b]||(c=cb([2e3,1]).day(b),d="^"+this.weekdays(c,"")+"|^"+this.weekdaysShort(c,"")+"|^"+this.weekdaysMin(c,""),this._weekdaysParse[b]=new RegExp(d.replace(".",""),"i")),this._weekdaysParse[b].test(a))return b},_longDateFormat:{LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D YYYY",LLL:"MMMM D YYYY LT",LLLL:"dddd, MMMM D YYYY LT"},longDateFormat:function(a){var b=this._longDateFormat[a];return!b&&this._longDateFormat[a.toUpperCase()]&&(b=this._longDateFormat[a.toUpperCase()].replace(/MMMM|MM|DD|dddd/g,function(a){return a.slice(1)}),this._longDateFormat[a]=b),b},isPM:function(a){return"p"===(a+"").toLowerCase().charAt(0)},_meridiemParse:/[ap]\.?m?\.?/i,meridiem:function(a,b,c){return a>11?c?"pm":"PM":c?"am":"AM"},_calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},calendar:function(a,b){var c=this._calendar[a];return"function"==typeof c?c.apply(b):c},_relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},relativeTime:function(a,b,c,d){var e=this._relativeTime[c];return"function"==typeof e?e(a,b,c,d):e.replace(/%d/i,a)},pastFuture:function(a,b){var c=this._relativeTime[a>0?"future":"past"];return"function"==typeof c?c(b):c.replace(/%s/i,b)},ordinal:function(a){return this._ordinal.replace("%d",a)},_ordinal:"%d",preparse:function(a){return a},postformat:function(a){return a},week:function(a){return X(a,this._week.dow,this._week.doy).week},_week:{dow:0,doy:6},_invalidDate:"Invalid date",invalidDate:function(){return this._invalidDate}}),cb=function(b,c,d,e){return"boolean"==typeof d&&(e=d,d=a),Z({_i:b,_f:c,_l:d,_strict:e,_isUTC:!1})},cb.utc=function(b,c,d,e){var f;return"boolean"==typeof d&&(e=d,d=a),f=Z({_useUTC:!0,_isUTC:!0,_l:d,_i:b,_f:c,_strict:e}).utc()},cb.unix=function(a){return cb(1e3*a)},cb.duration=function(a,b){var c,d,e,g=a,h=null;return cb.isDuration(a)?g={ms:a._milliseconds,d:a._days,M:a._months}:"number"==typeof a?(g={},b?g[b]=a:g.milliseconds=a):(h=rb.exec(a))?(c="-"===h[1]?-1:1,g={y:0,d:q(h[jb])*c,h:q(h[kb])*c,m:q(h[lb])*c,s:q(h[mb])*c,ms:q(h[nb])*c}):(h=sb.exec(a))&&(c="-"===h[1]?-1:1,e=function(a){var b=a&&parseFloat(a.replace(",","."));return(isNaN(b)?0:b)*c},g={y:e(h[2]),M:e(h[3]),d:e(h[4]),h:e(h[5]),m:e(h[6]),s:e(h[7]),w:e(h[8])}),d=new f(g),cb.isDuration(a)&&a.hasOwnProperty("_lang")&&(d._lang=a._lang),d},cb.version=eb,cb.defaultFormat=Kb,cb.updateOffset=function(){},cb.lang=function(a,b){var c;return a?(b?z(x(a),b):null===b?(A(a),a="en"):ob[a]||B(a),c=cb.duration.fn._lang=cb.fn._lang=B(a),c._abbr):cb.fn._lang._abbr},cb.langData=function(a){return a&&a._lang&&a._lang._abbr&&(a=a._lang._abbr),B(a)},cb.isMoment=function(a){return a instanceof e},cb.isDuration=function(a){return a instanceof f},db=Wb.length-1;db>=0;--db)p(Wb[db]);for(cb.normalizeUnits=function(a){return n(a)},cb.invalid=function(a){var b=cb.utc(0/0);return null!=a?g(b._pf,a):b._pf.userInvalidated=!0,b},cb.parseZone=function(a){return cb(a).parseZone()},g(cb.fn=e.prototype,{clone:function(){return cb(this)},valueOf:function(){return+this._d+6e4*(this._offset||0)},unix:function(){return Math.floor(+this/1e3)},toString:function(){return this.clone().lang("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},toDate:function(){return this._offset?new Date(+this):this._d},toISOString:function(){var a=cb(this).utc();return 0<a.year()&&a.year()<=9999?E(a,"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]"):E(a,"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]")},toArray:function(){var a=this;return[a.year(),a.month(),a.date(),a.hours(),a.minutes(),a.seconds(),a.milliseconds()]},isValid:function(){return w(this)},isDSTShifted:function(){return this._a?this.isValid()&&m(this._a,(this._isUTC?cb.utc(this._a):cb(this._a)).toArray())>0:!1},parsingFlags:function(){return g({},this._pf)},invalidAt:function(){return this._pf.overflow},utc:function(){return this.zone(0)},local:function(){return this.zone(0),this._isUTC=!1,this},format:function(a){var b=E(this,a||cb.defaultFormat);return this.lang().postformat(b)},add:function(a,b){var c;return c="string"==typeof a?cb.duration(+b,a):cb.duration(a,b),j(this,c,1),this},subtract:function(a,b){var c;return c="string"==typeof a?cb.duration(+b,a):cb.duration(a,b),j(this,c,-1),this},diff:function(a,b,c){var d,e,f=y(a,this),g=6e4*(this.zone()-f.zone());return b=n(b),"year"===b||"month"===b?(d=432e5*(this.daysInMonth()+f.daysInMonth()),e=12*(this.year()-f.year())+(this.month()-f.month()),e+=(this-cb(this).startOf("month")-(f-cb(f).startOf("month")))/d,e-=6e4*(this.zone()-cb(this).startOf("month").zone()-(f.zone()-cb(f).startOf("month").zone()))/d,"year"===b&&(e/=12)):(d=this-f,e="second"===b?d/1e3:"minute"===b?d/6e4:"hour"===b?d/36e5:"day"===b?(d-g)/864e5:"week"===b?(d-g)/6048e5:d),c?e:h(e)},from:function(a,b){return cb.duration(this.diff(a)).lang(this.lang()._abbr).humanize(!b)},fromNow:function(a){return this.from(cb(),a)},calendar:function(){var a=y(cb(),this).startOf("day"),b=this.diff(a,"days",!0),c=-6>b?"sameElse":-1>b?"lastWeek":0>b?"lastDay":1>b?"sameDay":2>b?"nextDay":7>b?"nextWeek":"sameElse";return this.format(this.lang().calendar(c,this))},isLeapYear:function(){return t(this.year())},isDST:function(){return this.zone()<this.clone().month(0).zone()||this.zone()<this.clone().month(5).zone()},day:function(a){var b=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=a?(a=U(a,this.lang()),this.add({d:a-b})):b},month:function(a){var b,c=this._isUTC?"UTC":"";return null!=a?"string"==typeof a&&(a=this.lang().monthsParse(a),"number"!=typeof a)?this:(b=this.date(),this.date(1),this._d["set"+c+"Month"](a),this.date(Math.min(b,this.daysInMonth())),cb.updateOffset(this),this):this._d["get"+c+"Month"]()},startOf:function(a){switch(a=n(a)){case"year":this.month(0);case"month":this.date(1);case"week":case"isoWeek":case"day":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return"week"===a?this.weekday(0):"isoWeek"===a&&this.isoWeekday(1),this},endOf:function(a){return a=n(a),this.startOf(a).add("isoWeek"===a?"week":a,1).subtract("ms",1)},isAfter:function(a,b){return b="undefined"!=typeof b?b:"millisecond",+this.clone().startOf(b)>+cb(a).startOf(b)},isBefore:function(a,b){return b="undefined"!=typeof b?b:"millisecond",+this.clone().startOf(b)<+cb(a).startOf(b)},isSame:function(a,b){return b=b||"ms",+this.clone().startOf(b)===+y(a,this).startOf(b)},min:function(a){return a=cb.apply(null,arguments),this>a?this:a},max:function(a){return a=cb.apply(null,arguments),a>this?this:a},zone:function(a){var b=this._offset||0;return null==a?this._isUTC?b:this._d.getTimezoneOffset():("string"==typeof a&&(a=H(a)),Math.abs(a)<16&&(a=60*a),this._offset=a,this._isUTC=!0,b!==a&&j(this,cb.duration(b-a,"m"),1,!0),this)},zoneAbbr:function(){return this._isUTC?"UTC":""},zoneName:function(){return this._isUTC?"Coordinated Universal Time":""},parseZone:function(){return this._tzm?this.zone(this._tzm):"string"==typeof this._i&&this.zone(this._i),this},hasAlignedHourOffset:function(a){return a=a?cb(a).zone():0,(this.zone()-a)%60===0},daysInMonth:function(){return r(this.year(),this.month())},dayOfYear:function(a){var b=gb((cb(this).startOf("day")-cb(this).startOf("year"))/864e5)+1;return null==a?b:this.add("d",a-b)},quarter:function(){return Math.ceil((this.month()+1)/3)},weekYear:function(a){var b=X(this,this.lang()._week.dow,this.lang()._week.doy).year;return null==a?b:this.add("y",a-b)},isoWeekYear:function(a){var b=X(this,1,4).year;return null==a?b:this.add("y",a-b)},week:function(a){var b=this.lang().week(this);return null==a?b:this.add("d",7*(a-b))},isoWeek:function(a){var b=X(this,1,4).week;return null==a?b:this.add("d",7*(a-b))},weekday:function(a){var b=(this.day()+7-this.lang()._week.dow)%7;return null==a?b:this.add("d",a-b)},isoWeekday:function(a){return null==a?this.day()||7:this.day(this.day()%7?a:a-7)},get:function(a){return a=n(a),this[a]()},set:function(a,b){return a=n(a),"function"==typeof this[a]&&this[a](b),this},lang:function(b){return b===a?this._lang:(this._lang=B(b),this)}}),db=0;db<Ob.length;db++)$(Ob[db].toLowerCase().replace(/s$/,""),Ob[db]);$("year","FullYear"),cb.fn.days=cb.fn.day,cb.fn.months=cb.fn.month,cb.fn.weeks=cb.fn.week,cb.fn.isoWeeks=cb.fn.isoWeek,cb.fn.toJSON=cb.fn.toISOString,g(cb.duration.fn=f.prototype,{_bubble:function(){var a,b,c,d,e=this._milliseconds,f=this._days,g=this._months,i=this._data;i.milliseconds=e%1e3,a=h(e/1e3),i.seconds=a%60,b=h(a/60),i.minutes=b%60,c=h(b/60),i.hours=c%24,f+=h(c/24),i.days=f%30,g+=h(f/30),i.months=g%12,d=h(g/12),i.years=d},weeks:function(){return h(this.days()/7)},valueOf:function(){return this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*q(this._months/12)},humanize:function(a){var b=+this,c=W(b,!a,this.lang());return a&&(c=this.lang().pastFuture(b,c)),this.lang().postformat(c)},add:function(a,b){var c=cb.duration(a,b);return this._milliseconds+=c._milliseconds,this._days+=c._days,this._months+=c._months,this._bubble(),this},subtract:function(a,b){var c=cb.duration(a,b);return this._milliseconds-=c._milliseconds,this._days-=c._days,this._months-=c._months,this._bubble(),this},get:function(a){return a=n(a),this[a.toLowerCase()+"s"]()},as:function(a){return a=n(a),this["as"+a.charAt(0).toUpperCase()+a.slice(1)+"s"]()},lang:cb.fn.lang,toIsoString:function(){var a=Math.abs(this.years()),b=Math.abs(this.months()),c=Math.abs(this.days()),d=Math.abs(this.hours()),e=Math.abs(this.minutes()),f=Math.abs(this.seconds()+this.milliseconds()/1e3);return this.asSeconds()?(this.asSeconds()<0?"-":"")+"P"+(a?a+"Y":"")+(b?b+"M":"")+(c?c+"D":"")+(d||e||f?"T":"")+(d?d+"H":"")+(e?e+"M":"")+(f?f+"S":""):"P0D"}});for(db in Pb)Pb.hasOwnProperty(db)&&(ab(db,Pb[db]),_(db.toLowerCase()));ab("Weeks",6048e5),cb.duration.fn.asMonths=function(){return(+this-31536e6*this.years())/2592e6+12*this.years()},cb.lang("en",{ordinal:function(a){var b=a%10,c=1===q(a%100/10)?"th":1===b?"st":2===b?"nd":3===b?"rd":"th";return a+c}}),function(a){a(cb)}(function(a){return a.lang("ar-ma",{months:"يناير_فبراير_مارس_أبريل_ماي_يونيو_يوليوز_غشت_شتنبر_أكتوبر_نونبر_دجنبر".split("_"),monthsShort:"يناير_فبراير_مارس_أبريل_ماي_يونيو_يوليوز_غشت_شتنبر_أكتوبر_نونبر_دجنبر".split("_"),weekdays:"الأحد_الإتنين_الثلاثاء_الأربعاء_الخميس_الجمعة_السبت".split("_"),weekdaysShort:"احد_اتنين_ثلاثاء_اربعاء_خميس_جمعة_سبت".split("_"),weekdaysMin:"ح_ن_ث_ر_خ_ج_س".split("_"),longDateFormat:{LT:"HH:mm",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd D MMMM YYYY LT"},calendar:{sameDay:"[اليوم على الساعة] LT",nextDay:"[غدا على الساعة] LT",nextWeek:"dddd [على الساعة] LT",lastDay:"[أمس على الساعة] LT",lastWeek:"dddd [على الساعة] LT",sameElse:"L"},relativeTime:{future:"في %s",past:"منذ %s",s:"ثوان",m:"دقيقة",mm:"%d دقائق",h:"ساعة",hh:"%d ساعات",d:"يوم",dd:"%d أيام",M:"شهر",MM:"%d أشهر",y:"سنة",yy:"%d سنوات"},week:{dow:6,doy:12}})}),function(a){a(cb)}(function(a){return a.lang("ar",{months:"يناير/ كانون الثاني_فبراير/ شباط_مارس/ آذار_أبريل/ نيسان_مايو/ أيار_يونيو/ حزيران_يوليو/ تموز_أغسطس/ آب_سبتمبر/ أيلول_أكتوبر/ تشرين الأول_نوفمبر/ تشرين الثاني_ديسمبر/ كانون الأول".split("_"),monthsShort:"يناير/ كانون الثاني_فبراير/ شباط_مارس/ آذار_أبريل/ نيسان_مايو/ أيار_يونيو/ حزيران_يوليو/ تموز_أغسطس/ آب_سبتمبر/ أيلول_أكتوبر/ تشرين الأول_نوفمبر/ تشرين الثاني_ديسمبر/ كانون الأول".split("_"),weekdays:"الأحد_الإثنين_الثلاثاء_الأربعاء_الخميس_الجمعة_السبت".split("_"),weekdaysShort:"الأحد_الإثنين_الثلاثاء_الأربعاء_الخميس_الجمعة_السبت".split("_"),weekdaysMin:"ح_ن_ث_ر_خ_ج_س".split("_"),longDateFormat:{LT:"HH:mm",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd D MMMM YYYY LT"},calendar:{sameDay:"[اليوم على الساعة] LT",nextDay:"[غدا على الساعة] LT",nextWeek:"dddd [على الساعة] LT",lastDay:"[أمس على الساعة] LT",lastWeek:"dddd [على الساعة] LT",sameElse:"L"},relativeTime:{future:"في %s",past:"منذ %s",s:"ثوان",m:"دقيقة",mm:"%d دقائق",h:"ساعة",hh:"%d ساعات",d:"يوم",dd:"%d أيام",M:"شهر",MM:"%d أشهر",y:"سنة",yy:"%d سنوات"},week:{dow:6,doy:12}})}),function(a){a(cb)}(function(a){return a.lang("bg",{months:"януари_февруари_март_април_май_юни_юли_август_септември_октомври_ноември_декември".split("_"),monthsShort:"янр_фев_мар_апр_май_юни_юли_авг_сеп_окт_ное_дек".split("_"),weekdays:"неделя_понеделник_вторник_сряда_четвъртък_петък_събота".split("_"),weekdaysShort:"нед_пон_вто_сря_чет_пет_съб".split("_"),weekdaysMin:"нд_пн_вт_ср_чт_пт_сб".split("_"),longDateFormat:{LT:"H:mm",L:"D.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd, D MMMM YYYY LT"},calendar:{sameDay:"[Днес в] LT",nextDay:"[Утре в] LT",nextWeek:"dddd [в] LT",lastDay:"[Вчера в] LT",lastWeek:function(){switch(this.day()){case 0:case 3:case 6:return"[В изминалата] dddd [в] LT";case 1:case 2:case 4:case 5:return"[В изминалия] dddd [в] LT"}},sameElse:"L"},relativeTime:{future:"след %s",past:"преди %s",s:"няколко секунди",m:"минута",mm:"%d минути",h:"час",hh:"%d часа",d:"ден",dd:"%d дни",M:"месец",MM:"%d месеца",y:"година",yy:"%d години"},ordinal:function(a){var b=a%10,c=a%100;return 0===a?a+"-ев":0===c?a+"-ен":c>10&&20>c?a+"-ти":1===b?a+"-ви":2===b?a+"-ри":7===b||8===b?a+"-ми":a+"-ти"},week:{dow:1,doy:7}})}),function(a){a(cb)}(function(b){function c(a,b,c){var d={mm:"munutenn",MM:"miz",dd:"devezh"};return a+" "+f(d[c],a)}function d(a){switch(e(a)){case 1:case 3:case 4:case 5:case 9:return a+" bloaz";default:return a+" vloaz"}}function e(a){return a>9?e(a%10):a}function f(a,b){return 2===b?g(a):a}function g(b){var c={m:"v",b:"v",d:"z"};return c[b.charAt(0)]===a?b:c[b.charAt(0)]+b.substring(1)}return b.lang("br",{months:"Genver_C'hwevrer_Meurzh_Ebrel_Mae_Mezheven_Gouere_Eost_Gwengolo_Here_Du_Kerzu".split("_"),monthsShort:"Gen_C'hwe_Meu_Ebr_Mae_Eve_Gou_Eos_Gwe_Her_Du_Ker".split("_"),weekdays:"Sul_Lun_Meurzh_Merc'her_Yaou_Gwener_Sadorn".split("_"),weekdaysShort:"Sul_Lun_Meu_Mer_Yao_Gwe_Sad".split("_"),weekdaysMin:"Su_Lu_Me_Mer_Ya_Gw_Sa".split("_"),longDateFormat:{LT:"h[e]mm A",L:"DD/MM/YYYY",LL:"D [a viz] MMMM YYYY",LLL:"D [a viz] MMMM YYYY LT",LLLL:"dddd, D [a viz] MMMM YYYY LT"},calendar:{sameDay:"[Hiziv da] LT",nextDay:"[Warc'hoazh da] LT",nextWeek:"dddd [da] LT",lastDay:"[Dec'h da] LT",lastWeek:"dddd [paset da] LT",sameElse:"L"},relativeTime:{future:"a-benn %s",past:"%s 'zo",s:"un nebeud segondennoù",m:"ur vunutenn",mm:c,h:"un eur",hh:"%d eur",d:"un devezh",dd:c,M:"ur miz",MM:c,y:"ur bloaz",yy:d},ordinal:function(a){var b=1===a?"añ":"vet";return a+b},week:{dow:1,doy:4}})}),function(a){a(cb)}(function(a){function b(a,b,c){var d=a+" ";switch(c){case"m":return b?"jedna minuta":"jedne minute";case"mm":return d+=1===a?"minuta":2===a||3===a||4===a?"minute":"minuta";case"h":return b?"jedan sat":"jednog sata";case"hh":return d+=1===a?"sat":2===a||3===a||4===a?"sata":"sati";case"dd":return d+=1===a?"dan":"dana";case"MM":return d+=1===a?"mjesec":2===a||3===a||4===a?"mjeseca":"mjeseci";case"yy":return d+=1===a?"godina":2===a||3===a||4===a?"godine":"godina"}}return a.lang("bs",{months:"januar_februar_mart_april_maj_juni_juli_avgust_septembar_oktobar_novembar_decembar".split("_"),monthsShort:"jan._feb._mar._apr._maj._jun._jul._avg._sep._okt._nov._dec.".split("_"),weekdays:"nedjelja_ponedjeljak_utorak_srijeda_četvrtak_petak_subota".split("_"),weekdaysShort:"ned._pon._uto._sri._čet._pet._sub.".split("_"),weekdaysMin:"ne_po_ut_sr_če_pe_su".split("_"),longDateFormat:{LT:"H:mm",L:"DD. MM. YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY LT",LLLL:"dddd, D. MMMM YYYY LT"},calendar:{sameDay:"[danas u] LT",nextDay:"[sutra u] LT",nextWeek:function(){switch(this.day()){case 0:return"[u] [nedjelju] [u] LT";case 3:return"[u] [srijedu] [u] LT";case 6:return"[u] [subotu] [u] LT";case 1:case 2:case 4:case 5:return"[u] dddd [u] LT"}},lastDay:"[jučer u] LT",lastWeek:function(){switch(this.day()){case 0:case 3:return"[prošlu] dddd [u] LT";case 6:return"[prošle] [subote] [u] LT";case 1:case 2:case 4:case 5:return"[prošli] dddd [u] LT"}},sameElse:"L"},relativeTime:{future:"za %s",past:"prije %s",s:"par sekundi",m:b,mm:b,h:b,hh:b,d:"dan",dd:b,M:"mjesec",MM:b,y:"godinu",yy:b},ordinal:"%d.",week:{dow:1,doy:7}})}),function(a){a(cb)}(function(a){return a.lang("ca",{months:"Gener_Febrer_Març_Abril_Maig_Juny_Juliol_Agost_Setembre_Octubre_Novembre_Desembre".split("_"),monthsShort:"Gen._Febr._Mar._Abr._Mai._Jun._Jul._Ag._Set._Oct._Nov._Des.".split("_"),weekdays:"Diumenge_Dilluns_Dimarts_Dimecres_Dijous_Divendres_Dissabte".split("_"),weekdaysShort:"Dg._Dl._Dt._Dc._Dj._Dv._Ds.".split("_"),weekdaysMin:"Dg_Dl_Dt_Dc_Dj_Dv_Ds".split("_"),longDateFormat:{LT:"H:mm",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd D MMMM YYYY LT"},calendar:{sameDay:function(){return"[avui a "+(1!==this.hours()?"les":"la")+"] LT"},nextDay:function(){return"[demà a "+(1!==this.hours()?"les":"la")+"] LT"},nextWeek:function(){return"dddd [a "+(1!==this.hours()?"les":"la")+"] LT"},lastDay:function(){return"[ahir a "+(1!==this.hours()?"les":"la")+"] LT"
},lastWeek:function(){return"[el] dddd [passat a "+(1!==this.hours()?"les":"la")+"] LT"},sameElse:"L"},relativeTime:{future:"en %s",past:"fa %s",s:"uns segons",m:"un minut",mm:"%d minuts",h:"una hora",hh:"%d hores",d:"un dia",dd:"%d dies",M:"un mes",MM:"%d mesos",y:"un any",yy:"%d anys"},ordinal:"%dº",week:{dow:1,doy:4}})}),function(a){a(cb)}(function(a){function b(a){return a>1&&5>a&&1!==~~(a/10)}function c(a,c,d,e){var f=a+" ";switch(d){case"s":return c||e?"pár vteřin":"pár vteřinami";case"m":return c?"minuta":e?"minutu":"minutou";case"mm":return c||e?f+(b(a)?"minuty":"minut"):f+"minutami";break;case"h":return c?"hodina":e?"hodinu":"hodinou";case"hh":return c||e?f+(b(a)?"hodiny":"hodin"):f+"hodinami";break;case"d":return c||e?"den":"dnem";case"dd":return c||e?f+(b(a)?"dny":"dní"):f+"dny";break;case"M":return c||e?"měsíc":"měsícem";case"MM":return c||e?f+(b(a)?"měsíce":"měsíců"):f+"měsíci";break;case"y":return c||e?"rok":"rokem";case"yy":return c||e?f+(b(a)?"roky":"let"):f+"lety"}}var d="leden_únor_březen_duben_květen_červen_červenec_srpen_září_říjen_listopad_prosinec".split("_"),e="led_úno_bře_dub_kvě_čvn_čvc_srp_zář_říj_lis_pro".split("_");return a.lang("cs",{months:d,monthsShort:e,monthsParse:function(a,b){var c,d=[];for(c=0;12>c;c++)d[c]=new RegExp("^"+a[c]+"$|^"+b[c]+"$","i");return d}(d,e),weekdays:"neděle_pondělí_úterý_středa_čtvrtek_pátek_sobota".split("_"),weekdaysShort:"ne_po_út_st_čt_pá_so".split("_"),weekdaysMin:"ne_po_út_st_čt_pá_so".split("_"),longDateFormat:{LT:"H:mm",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY LT",LLLL:"dddd D. MMMM YYYY LT"},calendar:{sameDay:"[dnes v] LT",nextDay:"[zítra v] LT",nextWeek:function(){switch(this.day()){case 0:return"[v neděli v] LT";case 1:case 2:return"[v] dddd [v] LT";case 3:return"[ve středu v] LT";case 4:return"[ve čtvrtek v] LT";case 5:return"[v pátek v] LT";case 6:return"[v sobotu v] LT"}},lastDay:"[včera v] LT",lastWeek:function(){switch(this.day()){case 0:return"[minulou neděli v] LT";case 1:case 2:return"[minulé] dddd [v] LT";case 3:return"[minulou středu v] LT";case 4:case 5:return"[minulý] dddd [v] LT";case 6:return"[minulou sobotu v] LT"}},sameElse:"L"},relativeTime:{future:"za %s",past:"před %s",s:c,m:c,mm:c,h:c,hh:c,d:c,dd:c,M:c,MM:c,y:c,yy:c},ordinal:"%d.",week:{dow:1,doy:4}})}),function(a){a(cb)}(function(a){return a.lang("cv",{months:"кăрлач_нарăс_пуш_ака_май_çĕртме_утă_çурла_авăн_юпа_чӳк_раштав".split("_"),monthsShort:"кăр_нар_пуш_ака_май_çĕр_утă_çур_ав_юпа_чӳк_раш".split("_"),weekdays:"вырсарникун_тунтикун_ытларикун_юнкун_кĕçнерникун_эрнекун_шăматкун".split("_"),weekdaysShort:"выр_тун_ытл_юн_кĕç_эрн_шăм".split("_"),weekdaysMin:"вр_тн_ыт_юн_кç_эр_шм".split("_"),longDateFormat:{LT:"HH:mm",L:"DD-MM-YYYY",LL:"YYYY [çулхи] MMMM [уйăхĕн] D[-мĕшĕ]",LLL:"YYYY [çулхи] MMMM [уйăхĕн] D[-мĕшĕ], LT",LLLL:"dddd, YYYY [çулхи] MMMM [уйăхĕн] D[-мĕшĕ], LT"},calendar:{sameDay:"[Паян] LT [сехетре]",nextDay:"[Ыран] LT [сехетре]",lastDay:"[Ĕнер] LT [сехетре]",nextWeek:"[Çитес] dddd LT [сехетре]",lastWeek:"[Иртнĕ] dddd LT [сехетре]",sameElse:"L"},relativeTime:{future:function(a){var b=/сехет$/i.exec(a)?"рен":/çул$/i.exec(a)?"тан":"ран";return a+b},past:"%s каялла",s:"пĕр-ик çеккунт",m:"пĕр минут",mm:"%d минут",h:"пĕр сехет",hh:"%d сехет",d:"пĕр кун",dd:"%d кун",M:"пĕр уйăх",MM:"%d уйăх",y:"пĕр çул",yy:"%d çул"},ordinal:"%d-мĕш",week:{dow:1,doy:7}})}),function(a){a(cb)}(function(a){return a.lang("cy",{months:"Ionawr_Chwefror_Mawrth_Ebrill_Mai_Mehefin_Gorffennaf_Awst_Medi_Hydref_Tachwedd_Rhagfyr".split("_"),monthsShort:"Ion_Chwe_Maw_Ebr_Mai_Meh_Gor_Aws_Med_Hyd_Tach_Rhag".split("_"),weekdays:"Dydd Sul_Dydd Llun_Dydd Mawrth_Dydd Mercher_Dydd Iau_Dydd Gwener_Dydd Sadwrn".split("_"),weekdaysShort:"Sul_Llun_Maw_Mer_Iau_Gwe_Sad".split("_"),weekdaysMin:"Su_Ll_Ma_Me_Ia_Gw_Sa".split("_"),longDateFormat:{LT:"HH:mm",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd, D MMMM YYYY LT"},calendar:{sameDay:"[Heddiw am] LT",nextDay:"[Yfory am] LT",nextWeek:"dddd [am] LT",lastDay:"[Ddoe am] LT",lastWeek:"dddd [diwethaf am] LT",sameElse:"L"},relativeTime:{future:"mewn %s",past:"%s yn &#244;l",s:"ychydig eiliadau",m:"munud",mm:"%d munud",h:"awr",hh:"%d awr",d:"diwrnod",dd:"%d diwrnod",M:"mis",MM:"%d mis",y:"blwyddyn",yy:"%d flynedd"},ordinal:function(a){var b=a,c="",d=["","af","il","ydd","ydd","ed","ed","ed","fed","fed","fed","eg","fed","eg","eg","fed","eg","eg","fed","eg","fed"];return b>20?c=40===b||50===b||60===b||80===b||100===b?"fed":"ain":b>0&&(c=d[b]),a+c},week:{dow:1,doy:4}})}),function(a){a(cb)}(function(a){return a.lang("da",{months:"januar_februar_marts_april_maj_juni_juli_august_september_oktober_november_december".split("_"),monthsShort:"jan_feb_mar_apr_maj_jun_jul_aug_sep_okt_nov_dec".split("_"),weekdays:"søndag_mandag_tirsdag_onsdag_torsdag_fredag_lørdag".split("_"),weekdaysShort:"søn_man_tir_ons_tor_fre_lør".split("_"),weekdaysMin:"sø_ma_ti_on_to_fr_lø".split("_"),longDateFormat:{LT:"HH:mm",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd D. MMMM, YYYY LT"},calendar:{sameDay:"[I dag kl.] LT",nextDay:"[I morgen kl.] LT",nextWeek:"dddd [kl.] LT",lastDay:"[I går kl.] LT",lastWeek:"[sidste] dddd [kl] LT",sameElse:"L"},relativeTime:{future:"om %s",past:"%s siden",s:"få sekunder",m:"et minut",mm:"%d minutter",h:"en time",hh:"%d timer",d:"en dag",dd:"%d dage",M:"en måned",MM:"%d måneder",y:"et år",yy:"%d år"},ordinal:"%d.",week:{dow:1,doy:4}})}),function(a){a(cb)}(function(a){function b(a,b,c){var d={m:["eine Minute","einer Minute"],h:["eine Stunde","einer Stunde"],d:["ein Tag","einem Tag"],dd:[a+" Tage",a+" Tagen"],M:["ein Monat","einem Monat"],MM:[a+" Monate",a+" Monaten"],y:["ein Jahr","einem Jahr"],yy:[a+" Jahre",a+" Jahren"]};return b?d[c][0]:d[c][1]}return a.lang("de",{months:"Januar_Februar_März_April_Mai_Juni_Juli_August_September_Oktober_November_Dezember".split("_"),monthsShort:"Jan._Febr._Mrz._Apr._Mai_Jun._Jul._Aug._Sept._Okt._Nov._Dez.".split("_"),weekdays:"Sonntag_Montag_Dienstag_Mittwoch_Donnerstag_Freitag_Samstag".split("_"),weekdaysShort:"So._Mo._Di._Mi._Do._Fr._Sa.".split("_"),weekdaysMin:"So_Mo_Di_Mi_Do_Fr_Sa".split("_"),longDateFormat:{LT:"H:mm [Uhr]",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY LT",LLLL:"dddd, D. MMMM YYYY LT"},calendar:{sameDay:"[Heute um] LT",sameElse:"L",nextDay:"[Morgen um] LT",nextWeek:"dddd [um] LT",lastDay:"[Gestern um] LT",lastWeek:"[letzten] dddd [um] LT"},relativeTime:{future:"in %s",past:"vor %s",s:"ein paar Sekunden",m:b,mm:"%d Minuten",h:b,hh:"%d Stunden",d:b,dd:b,M:b,MM:b,y:b,yy:b},ordinal:"%d.",week:{dow:1,doy:4}})}),function(a){a(cb)}(function(a){return a.lang("el",{monthsNominativeEl:"Ιανουάριος_Φεβρουάριος_Μάρτιος_Απρίλιος_Μάιος_Ιούνιος_Ιούλιος_Αύγουστος_Σεπτέμβριος_Οκτώβριος_Νοέμβριος_Δεκέμβριος".split("_"),monthsGenitiveEl:"Ιανουαρίου_Φεβρουαρίου_Μαρτίου_Απριλίου_Μαΐου_Ιουνίου_Ιουλίου_Αυγούστου_Σεπτεμβρίου_Οκτωβρίου_Νοεμβρίου_Δεκεμβρίου".split("_"),months:function(a,b){return/D/.test(b.substring(0,b.indexOf("MMMM")))?this._monthsGenitiveEl[a.month()]:this._monthsNominativeEl[a.month()]},monthsShort:"Ιαν_Φεβ_Μαρ_Απρ_Μαϊ_Ιουν_Ιουλ_Αυγ_Σεπ_Οκτ_Νοε_Δεκ".split("_"),weekdays:"Κυριακή_Δευτέρα_Τρίτη_Τετάρτη_Πέμπτη_Παρασκευή_Σάββατο".split("_"),weekdaysShort:"Κυρ_Δευ_Τρι_Τετ_Πεμ_Παρ_Σαβ".split("_"),weekdaysMin:"Κυ_Δε_Τρ_Τε_Πε_Πα_Σα".split("_"),meridiem:function(a,b,c){return a>11?c?"μμ":"ΜΜ":c?"πμ":"ΠΜ"},longDateFormat:{LT:"h:mm A",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd, D MMMM YYYY LT"},calendarEl:{sameDay:"[Σήμερα {}] LT",nextDay:"[Αύριο {}] LT",nextWeek:"dddd [{}] LT",lastDay:"[Χθες {}] LT",lastWeek:"[την προηγούμενη] dddd [{}] LT",sameElse:"L"},calendar:function(a,b){var c=this._calendarEl[a],d=b&&b.hours();return c.replace("{}",d%12===1?"στη":"στις")},relativeTime:{future:"σε %s",past:"%s πριν",s:"δευτερόλεπτα",m:"ένα λεπτό",mm:"%d λεπτά",h:"μία ώρα",hh:"%d ώρες",d:"μία μέρα",dd:"%d μέρες",M:"ένας μήνας",MM:"%d μήνες",y:"ένας χρόνος",yy:"%d χρόνια"},ordinal:function(a){return a+"η"},week:{dow:1,doy:4}})}),function(a){a(cb)}(function(a){return a.lang("en-au",{months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),longDateFormat:{LT:"h:mm A",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd, D MMMM YYYY LT"},calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},ordinal:function(a){var b=a%10,c=1===~~(a%100/10)?"th":1===b?"st":2===b?"nd":3===b?"rd":"th";return a+c},week:{dow:1,doy:4}})}),function(a){a(cb)}(function(a){return a.lang("en-ca",{months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),longDateFormat:{LT:"h:mm A",L:"YYYY-MM-DD",LL:"D MMMM, YYYY",LLL:"D MMMM, YYYY LT",LLLL:"dddd, D MMMM, YYYY LT"},calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},ordinal:function(a){var b=a%10,c=1===~~(a%100/10)?"th":1===b?"st":2===b?"nd":3===b?"rd":"th";return a+c}})}),function(a){a(cb)}(function(a){return a.lang("en-gb",{months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),longDateFormat:{LT:"HH:mm",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd, D MMMM YYYY LT"},calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},ordinal:function(a){var b=a%10,c=1===~~(a%100/10)?"th":1===b?"st":2===b?"nd":3===b?"rd":"th";return a+c},week:{dow:1,doy:4}})}),function(a){a(cb)}(function(a){return a.lang("eo",{months:"januaro_februaro_marto_aprilo_majo_junio_julio_aŭgusto_septembro_oktobro_novembro_decembro".split("_"),monthsShort:"jan_feb_mar_apr_maj_jun_jul_aŭg_sep_okt_nov_dec".split("_"),weekdays:"Dimanĉo_Lundo_Mardo_Merkredo_Ĵaŭdo_Vendredo_Sabato".split("_"),weekdaysShort:"Dim_Lun_Mard_Merk_Ĵaŭ_Ven_Sab".split("_"),weekdaysMin:"Di_Lu_Ma_Me_Ĵa_Ve_Sa".split("_"),longDateFormat:{LT:"HH:mm",L:"YYYY-MM-DD",LL:"D[-an de] MMMM, YYYY",LLL:"D[-an de] MMMM, YYYY LT",LLLL:"dddd, [la] D[-an de] MMMM, YYYY LT"},meridiem:function(a,b,c){return a>11?c?"p.t.m.":"P.T.M.":c?"a.t.m.":"A.T.M."},calendar:{sameDay:"[Hodiaŭ je] LT",nextDay:"[Morgaŭ je] LT",nextWeek:"dddd [je] LT",lastDay:"[Hieraŭ je] LT",lastWeek:"[pasinta] dddd [je] LT",sameElse:"L"},relativeTime:{future:"je %s",past:"antaŭ %s",s:"sekundoj",m:"minuto",mm:"%d minutoj",h:"horo",hh:"%d horoj",d:"tago",dd:"%d tagoj",M:"monato",MM:"%d monatoj",y:"jaro",yy:"%d jaroj"},ordinal:"%da",week:{dow:1,doy:7}})}),function(a){a(cb)}(function(a){return a.lang("es",{months:"enero_febrero_marzo_abril_mayo_junio_julio_agosto_septiembre_octubre_noviembre_diciembre".split("_"),monthsShort:"ene._feb._mar._abr._may._jun._jul._ago._sep._oct._nov._dic.".split("_"),weekdays:"domingo_lunes_martes_miércoles_jueves_viernes_sábado".split("_"),weekdaysShort:"dom._lun._mar._mié._jue._vie._sáb.".split("_"),weekdaysMin:"Do_Lu_Ma_Mi_Ju_Vi_Sá".split("_"),longDateFormat:{LT:"H:mm",L:"DD/MM/YYYY",LL:"D [de] MMMM [de] YYYY",LLL:"D [de] MMMM [de] YYYY LT",LLLL:"dddd, D [de] MMMM [de] YYYY LT"},calendar:{sameDay:function(){return"[hoy a la"+(1!==this.hours()?"s":"")+"] LT"},nextDay:function(){return"[mañana a la"+(1!==this.hours()?"s":"")+"] LT"},nextWeek:function(){return"dddd [a la"+(1!==this.hours()?"s":"")+"] LT"},lastDay:function(){return"[ayer a la"+(1!==this.hours()?"s":"")+"] LT"},lastWeek:function(){return"[el] dddd [pasado a la"+(1!==this.hours()?"s":"")+"] LT"},sameElse:"L"},relativeTime:{future:"en %s",past:"hace %s",s:"unos segundos",m:"un minuto",mm:"%d minutos",h:"una hora",hh:"%d horas",d:"un día",dd:"%d días",M:"un mes",MM:"%d meses",y:"un año",yy:"%d años"},ordinal:"%dº",week:{dow:1,doy:4}})}),function(a){a(cb)}(function(a){function b(a,b,c,d){var e={s:["mõne sekundi","mõni sekund","paar sekundit"],m:["ühe minuti","üks minut"],mm:[a+" minuti",a+" minutit"],h:["ühe tunni","tund aega","üks tund"],hh:[a+" tunni",a+" tundi"],d:["ühe päeva","üks päev"],M:["kuu aja","kuu aega","üks kuu"],MM:[a+" kuu",a+" kuud"],y:["ühe aasta","aasta","üks aasta"],yy:[a+" aasta",a+" aastat"]};return b?e[c][2]?e[c][2]:e[c][1]:d?e[c][0]:e[c][1]}return a.lang("et",{months:"jaanuar_veebruar_märts_aprill_mai_juuni_juuli_august_september_oktoober_november_detsember".split("_"),monthsShort:"jaan_veebr_märts_apr_mai_juuni_juuli_aug_sept_okt_nov_dets".split("_"),weekdays:"pühapäev_esmaspäev_teisipäev_kolmapäev_neljapäev_reede_laupäev".split("_"),weekdaysShort:"P_E_T_K_N_R_L".split("_"),weekdaysMin:"P_E_T_K_N_R_L".split("_"),longDateFormat:{LT:"H:mm",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY LT",LLLL:"dddd, D. MMMM YYYY LT"},calendar:{sameDay:"[Täna,] LT",nextDay:"[Homme,] LT",nextWeek:"[Järgmine] dddd LT",lastDay:"[Eile,] LT",lastWeek:"[Eelmine] dddd LT",sameElse:"L"},relativeTime:{future:"%s pärast",past:"%s tagasi",s:b,m:b,mm:b,h:b,hh:b,d:b,dd:"%d päeva",M:b,MM:b,y:b,yy:b},ordinal:"%d.",week:{dow:1,doy:4}})}),function(a){a(cb)}(function(a){return a.lang("eu",{months:"urtarrila_otsaila_martxoa_apirila_maiatza_ekaina_uztaila_abuztua_iraila_urria_azaroa_abendua".split("_"),monthsShort:"urt._ots._mar._api._mai._eka._uzt._abu._ira._urr._aza._abe.".split("_"),weekdays:"igandea_astelehena_asteartea_asteazkena_osteguna_ostirala_larunbata".split("_"),weekdaysShort:"ig._al._ar._az._og._ol._lr.".split("_"),weekdaysMin:"ig_al_ar_az_og_ol_lr".split("_"),longDateFormat:{LT:"HH:mm",L:"YYYY-MM-DD",LL:"YYYY[ko] MMMM[ren] D[a]",LLL:"YYYY[ko] MMMM[ren] D[a] LT",LLLL:"dddd, YYYY[ko] MMMM[ren] D[a] LT",l:"YYYY-M-D",ll:"YYYY[ko] MMM D[a]",lll:"YYYY[ko] MMM D[a] LT",llll:"ddd, YYYY[ko] MMM D[a] LT"},calendar:{sameDay:"[gaur] LT[etan]",nextDay:"[bihar] LT[etan]",nextWeek:"dddd LT[etan]",lastDay:"[atzo] LT[etan]",lastWeek:"[aurreko] dddd LT[etan]",sameElse:"L"},relativeTime:{future:"%s barru",past:"duela %s",s:"segundo batzuk",m:"minutu bat",mm:"%d minutu",h:"ordu bat",hh:"%d ordu",d:"egun bat",dd:"%d egun",M:"hilabete bat",MM:"%d hilabete",y:"urte bat",yy:"%d urte"},ordinal:"%d.",week:{dow:1,doy:7}})}),function(a){a(cb)}(function(a){var b={1:"۱",2:"۲",3:"۳",4:"۴",5:"۵",6:"۶",7:"۷",8:"۸",9:"۹",0:"۰"},c={"۱":"1","۲":"2","۳":"3","۴":"4","۵":"5","۶":"6","۷":"7","۸":"8","۹":"9","۰":"0"};return a.lang("fa",{months:"ژانویه_فوریه_مارس_آوریل_مه_ژوئن_ژوئیه_اوت_سپتامبر_اکتبر_نوامبر_دسامبر".split("_"),monthsShort:"ژانویه_فوریه_مارس_آوریل_مه_ژوئن_ژوئیه_اوت_سپتامبر_اکتبر_نوامبر_دسامبر".split("_"),weekdays:"یک‌شنبه_دوشنبه_سه‌شنبه_چهارشنبه_پنج‌شنبه_جمعه_شنبه".split("_"),weekdaysShort:"یک‌شنبه_دوشنبه_سه‌شنبه_چهارشنبه_پنج‌شنبه_جمعه_شنبه".split("_"),weekdaysMin:"ی_د_س_چ_پ_ج_ش".split("_"),longDateFormat:{LT:"HH:mm",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd, D MMMM YYYY LT"},meridiem:function(a){return 12>a?"قبل از ظهر":"بعد از ظهر"},calendar:{sameDay:"[امروز ساعت] LT",nextDay:"[فردا ساعت] LT",nextWeek:"dddd [ساعت] LT",lastDay:"[دیروز ساعت] LT",lastWeek:"dddd [پیش] [ساعت] LT",sameElse:"L"},relativeTime:{future:"در %s",past:"%s پیش",s:"چندین ثانیه",m:"یک دقیقه",mm:"%d دقیقه",h:"یک ساعت",hh:"%d ساعت",d:"یک روز",dd:"%d روز",M:"یک ماه",MM:"%d ماه",y:"یک سال",yy:"%d سال"},preparse:function(a){return a.replace(/[۰-۹]/g,function(a){return c[a]}).replace(/،/g,",")},postformat:function(a){return a.replace(/\d/g,function(a){return b[a]}).replace(/,/g,"،")},ordinal:"%dم",week:{dow:6,doy:12}})}),function(a){a(cb)}(function(a){function b(a,b,d,e){var f="";switch(d){case"s":return e?"muutaman sekunnin":"muutama sekunti";case"m":return e?"minuutin":"minuutti";case"mm":f=e?"minuutin":"minuuttia";break;case"h":return e?"tunnin":"tunti";case"hh":f=e?"tunnin":"tuntia";break;case"d":return e?"päivän":"päivä";case"dd":f=e?"päivän":"päivää";break;case"M":return e?"kuukauden":"kuukausi";case"MM":f=e?"kuukauden":"kuukautta";break;case"y":return e?"vuoden":"vuosi";case"yy":f=e?"vuoden":"vuotta"}return f=c(a,e)+" "+f}function c(a,b){return 10>a?b?e[a]:d[a]:a}var d="nolla yksi kaksi kolme neljä viisi kuusi seitsemän kahdeksan yhdeksän".split(" "),e=["nolla","yhden","kahden","kolmen","neljän","viiden","kuuden",d[7],d[8],d[9]];return a.lang("fi",{months:"tammikuu_helmikuu_maaliskuu_huhtikuu_toukokuu_kesäkuu_heinäkuu_elokuu_syyskuu_lokakuu_marraskuu_joulukuu".split("_"),monthsShort:"tammi_helmi_maalis_huhti_touko_kesä_heinä_elo_syys_loka_marras_joulu".split("_"),weekdays:"sunnuntai_maanantai_tiistai_keskiviikko_torstai_perjantai_lauantai".split("_"),weekdaysShort:"su_ma_ti_ke_to_pe_la".split("_"),weekdaysMin:"su_ma_ti_ke_to_pe_la".split("_"),longDateFormat:{LT:"HH.mm",L:"DD.MM.YYYY",LL:"Do MMMM[ta] YYYY",LLL:"Do MMMM[ta] YYYY, [klo] LT",LLLL:"dddd, Do MMMM[ta] YYYY, [klo] LT",l:"D.M.YYYY",ll:"Do MMM YYYY",lll:"Do MMM YYYY, [klo] LT",llll:"ddd, Do MMM YYYY, [klo] LT"},calendar:{sameDay:"[tänään] [klo] LT",nextDay:"[huomenna] [klo] LT",nextWeek:"dddd [klo] LT",lastDay:"[eilen] [klo] LT",lastWeek:"[viime] dddd[na] [klo] LT",sameElse:"L"},relativeTime:{future:"%s päästä",past:"%s sitten",s:b,m:b,mm:b,h:b,hh:b,d:b,dd:b,M:b,MM:b,y:b,yy:b},ordinal:"%d.",week:{dow:1,doy:4}})}),function(a){a(cb)}(function(a){return a.lang("fo",{months:"januar_februar_mars_apríl_mai_juni_juli_august_september_oktober_november_desember".split("_"),monthsShort:"jan_feb_mar_apr_mai_jun_jul_aug_sep_okt_nov_des".split("_"),weekdays:"sunnudagur_mánadagur_týsdagur_mikudagur_hósdagur_fríggjadagur_leygardagur".split("_"),weekdaysShort:"sun_mán_týs_mik_hós_frí_ley".split("_"),weekdaysMin:"su_má_tý_mi_hó_fr_le".split("_"),longDateFormat:{LT:"HH:mm",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd D. MMMM, YYYY LT"},calendar:{sameDay:"[Í dag kl.] LT",nextDay:"[Í morgin kl.] LT",nextWeek:"dddd [kl.] LT",lastDay:"[Í gjár kl.] LT",lastWeek:"[síðstu] dddd [kl] LT",sameElse:"L"},relativeTime:{future:"um %s",past:"%s síðani",s:"fá sekund",m:"ein minutt",mm:"%d minuttir",h:"ein tími",hh:"%d tímar",d:"ein dagur",dd:"%d dagar",M:"ein mánaði",MM:"%d mánaðir",y:"eitt ár",yy:"%d ár"},ordinal:"%d.",week:{dow:1,doy:4}})}),function(a){a(cb)}(function(a){return a.lang("fr-ca",{months:"janvier_février_mars_avril_mai_juin_juillet_août_septembre_octobre_novembre_décembre".split("_"),monthsShort:"janv._févr._mars_avr._mai_juin_juil._août_sept._oct._nov._déc.".split("_"),weekdays:"dimanche_lundi_mardi_mercredi_jeudi_vendredi_samedi".split("_"),weekdaysShort:"dim._lun._mar._mer._jeu._ven._sam.".split("_"),weekdaysMin:"Di_Lu_Ma_Me_Je_Ve_Sa".split("_"),longDateFormat:{LT:"HH:mm",L:"YYYY-MM-DD",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd D MMMM YYYY LT"},calendar:{sameDay:"[Aujourd'hui à] LT",nextDay:"[Demain à] LT",nextWeek:"dddd [à] LT",lastDay:"[Hier à] LT",lastWeek:"dddd [dernier à] LT",sameElse:"L"},relativeTime:{future:"dans %s",past:"il y a %s",s:"quelques secondes",m:"une minute",mm:"%d minutes",h:"une heure",hh:"%d heures",d:"un jour",dd:"%d jours",M:"un mois",MM:"%d mois",y:"un an",yy:"%d ans"},ordinal:function(a){return a+(1===a?"er":"")}})}),function(a){a(cb)}(function(a){return a.lang("fr",{months:"janvier_février_mars_avril_mai_juin_juillet_août_septembre_octobre_novembre_décembre".split("_"),monthsShort:"janv._févr._mars_avr._mai_juin_juil._août_sept._oct._nov._déc.".split("_"),weekdays:"dimanche_lundi_mardi_mercredi_jeudi_vendredi_samedi".split("_"),weekdaysShort:"dim._lun._mar._mer._jeu._ven._sam.".split("_"),weekdaysMin:"Di_Lu_Ma_Me_Je_Ve_Sa".split("_"),longDateFormat:{LT:"HH:mm",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd D MMMM YYYY LT"},calendar:{sameDay:"[Aujourd'hui à] LT",nextDay:"[Demain à] LT",nextWeek:"dddd [à] LT",lastDay:"[Hier à] LT",lastWeek:"dddd [dernier à] LT",sameElse:"L"},relativeTime:{future:"dans %s",past:"il y a %s",s:"quelques secondes",m:"une minute",mm:"%d minutes",h:"une heure",hh:"%d heures",d:"un jour",dd:"%d jours",M:"un mois",MM:"%d mois",y:"un an",yy:"%d ans"},ordinal:function(a){return a+(1===a?"er":"")},week:{dow:1,doy:4}})}),function(a){a(cb)}(function(a){return a.lang("gl",{months:"Xaneiro_Febreiro_Marzo_Abril_Maio_Xuño_Xullo_Agosto_Setembro_Outubro_Novembro_Decembro".split("_"),monthsShort:"Xan._Feb._Mar._Abr._Mai._Xuñ._Xul._Ago._Set._Out._Nov._Dec.".split("_"),weekdays:"Domingo_Luns_Martes_Mércores_Xoves_Venres_Sábado".split("_"),weekdaysShort:"Dom._Lun._Mar._Mér._Xov._Ven._Sáb.".split("_"),weekdaysMin:"Do_Lu_Ma_Mé_Xo_Ve_Sá".split("_"),longDateFormat:{LT:"H:mm",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd D MMMM YYYY LT"},calendar:{sameDay:function(){return"[hoxe "+(1!==this.hours()?"ás":"á")+"] LT"},nextDay:function(){return"[mañá "+(1!==this.hours()?"ás":"á")+"] LT"},nextWeek:function(){return"dddd ["+(1!==this.hours()?"ás":"a")+"] LT"},lastDay:function(){return"[onte "+(1!==this.hours()?"á":"a")+"] LT"},lastWeek:function(){return"[o] dddd [pasado "+(1!==this.hours()?"ás":"a")+"] LT"},sameElse:"L"},relativeTime:{future:function(a){return"uns segundos"===a?"nuns segundos":"en "+a},past:"hai %s",s:"uns segundos",m:"un minuto",mm:"%d minutos",h:"unha hora",hh:"%d horas",d:"un día",dd:"%d días",M:"un mes",MM:"%d meses",y:"un ano",yy:"%d anos"},ordinal:"%dº",week:{dow:1,doy:7}})}),function(a){a(cb)}(function(a){return a.lang("he",{months:"ינואר_פברואר_מרץ_אפריל_מאי_יוני_יולי_אוגוסט_ספטמבר_אוקטובר_נובמבר_דצמבר".split("_"),monthsShort:"ינו׳_פבר׳_מרץ_אפר׳_מאי_יוני_יולי_אוג׳_ספט׳_אוק׳_נוב׳_דצמ׳".split("_"),weekdays:"ראשון_שני_שלישי_רביעי_חמישי_שישי_שבת".split("_"),weekdaysShort:"א׳_ב׳_ג׳_ד׳_ה׳_ו׳_ש׳".split("_"),weekdaysMin:"א_ב_ג_ד_ה_ו_ש".split("_"),longDateFormat:{LT:"HH:mm",L:"DD/MM/YYYY",LL:"D [ב]MMMM YYYY",LLL:"D [ב]MMMM YYYY LT",LLLL:"dddd, D [ב]MMMM YYYY LT",l:"D/M/YYYY",ll:"D MMM YYYY",lll:"D MMM YYYY LT",llll:"ddd, D MMM YYYY LT"},calendar:{sameDay:"[היום ב־]LT",nextDay:"[מחר ב־]LT",nextWeek:"dddd [בשעה] LT",lastDay:"[אתמול ב־]LT",lastWeek:"[ביום] dddd [האחרון בשעה] LT",sameElse:"L"},relativeTime:{future:"בעוד %s",past:"לפני %s",s:"מספר שניות",m:"דקה",mm:"%d דקות",h:"שעה",hh:function(a){return 2===a?"שעתיים":a+" שעות"},d:"יום",dd:function(a){return 2===a?"יומיים":a+" ימים"},M:"חודש",MM:function(a){return 2===a?"חודשיים":a+" חודשים"},y:"שנה",yy:function(a){return 2===a?"שנתיים":a+" שנים"}}})}),function(a){a(cb)}(function(a){var b={1:"१",2:"२",3:"३",4:"४",5:"५",6:"६",7:"७",8:"८",9:"९",0:"०"},c={"१":"1","२":"2","३":"3","४":"4","५":"5","६":"6","७":"7","८":"8","९":"9","०":"0"};return a.lang("hi",{months:"जनवरी_फ़रवरी_मार्च_अप्रैल_मई_जून_जुलाई_अगस्त_सितम्बर_अक्टूबर_नवम्बर_दिसम्बर".split("_"),monthsShort:"जन._फ़र._मार्च_अप्रै._मई_जून_जुल._अग._सित._अक्टू._नव._दिस.".split("_"),weekdays:"रविवार_सोमवार_मंगलवार_बुधवार_गुरूवार_शुक्रवार_शनिवार".split("_"),weekdaysShort:"रवि_सोम_मंगल_बुध_गुरू_शुक्र_शनि".split("_"),weekdaysMin:"र_सो_मं_बु_गु_शु_श".split("_"),longDateFormat:{LT:"A h:mm बजे",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, LT",LLLL:"dddd, D MMMM YYYY, LT"},calendar:{sameDay:"[आज] LT",nextDay:"[कल] LT",nextWeek:"dddd, LT",lastDay:"[कल] LT",lastWeek:"[पिछले] dddd, LT",sameElse:"L"},relativeTime:{future:"%s में",past:"%s पहले",s:"कुछ ही क्षण",m:"एक मिनट",mm:"%d मिनट",h:"एक घंटा",hh:"%d घंटे",d:"एक दिन",dd:"%d दिन",M:"एक महीने",MM:"%d महीने",y:"एक वर्ष",yy:"%d वर्ष"},preparse:function(a){return a.replace(/[१२३४५६७८९०]/g,function(a){return c[a]})},postformat:function(a){return a.replace(/\d/g,function(a){return b[a]})},meridiem:function(a){return 4>a?"रात":10>a?"सुबह":17>a?"दोपहर":20>a?"शाम":"रात"},week:{dow:0,doy:6}})}),function(a){a(cb)}(function(a){function b(a,b,c){var d=a+" ";switch(c){case"m":return b?"jedna minuta":"jedne minute";case"mm":return d+=1===a?"minuta":2===a||3===a||4===a?"minute":"minuta";case"h":return b?"jedan sat":"jednog sata";case"hh":return d+=1===a?"sat":2===a||3===a||4===a?"sata":"sati";case"dd":return d+=1===a?"dan":"dana";case"MM":return d+=1===a?"mjesec":2===a||3===a||4===a?"mjeseca":"mjeseci";case"yy":return d+=1===a?"godina":2===a||3===a||4===a?"godine":"godina"}}return a.lang("hr",{months:"sječanj_veljača_ožujak_travanj_svibanj_lipanj_srpanj_kolovoz_rujan_listopad_studeni_prosinac".split("_"),monthsShort:"sje._vel._ožu._tra._svi._lip._srp._kol._ruj._lis._stu._pro.".split("_"),weekdays:"nedjelja_ponedjeljak_utorak_srijeda_četvrtak_petak_subota".split("_"),weekdaysShort:"ned._pon._uto._sri._čet._pet._sub.".split("_"),weekdaysMin:"ne_po_ut_sr_če_pe_su".split("_"),longDateFormat:{LT:"H:mm",L:"DD. MM. YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY LT",LLLL:"dddd, D. MMMM YYYY LT"},calendar:{sameDay:"[danas u] LT",nextDay:"[sutra u] LT",nextWeek:function(){switch(this.day()){case 0:return"[u] [nedjelju] [u] LT";case 3:return"[u] [srijedu] [u] LT";case 6:return"[u] [subotu] [u] LT";case 1:case 2:case 4:case 5:return"[u] dddd [u] LT"}},lastDay:"[jučer u] LT",lastWeek:function(){switch(this.day()){case 0:case 3:return"[prošlu] dddd [u] LT";case 6:return"[prošle] [subote] [u] LT";case 1:case 2:case 4:case 5:return"[prošli] dddd [u] LT"}},sameElse:"L"},relativeTime:{future:"za %s",past:"prije %s",s:"par sekundi",m:b,mm:b,h:b,hh:b,d:"dan",dd:b,M:"mjesec",MM:b,y:"godinu",yy:b},ordinal:"%d.",week:{dow:1,doy:7}})}),function(a){a(cb)}(function(a){function b(a,b,c,d){var e=a;switch(c){case"s":return d||b?"néhány másodperc":"néhány másodperce";case"m":return"egy"+(d||b?" perc":" perce");case"mm":return e+(d||b?" perc":" perce");case"h":return"egy"+(d||b?" óra":" órája");case"hh":return e+(d||b?" óra":" órája");case"d":return"egy"+(d||b?" nap":" napja");case"dd":return e+(d||b?" nap":" napja");case"M":return"egy"+(d||b?" hónap":" hónapja");case"MM":return e+(d||b?" hónap":" hónapja");case"y":return"egy"+(d||b?" év":" éve");case"yy":return e+(d||b?" év":" éve")}return""}function c(a){return(a?"":"[múlt] ")+"["+d[this.day()]+"] LT[-kor]"}var d="vasárnap hétfőn kedden szerdán csütörtökön pénteken szombaton".split(" ");return a.lang("hu",{months:"január_február_március_április_május_június_július_augusztus_szeptember_október_november_december".split("_"),monthsShort:"jan_feb_márc_ápr_máj_jún_júl_aug_szept_okt_nov_dec".split("_"),weekdays:"vasárnap_hétfő_kedd_szerda_csütörtök_péntek_szombat".split("_"),weekdaysShort:"vas_hét_kedd_sze_csüt_pén_szo".split("_"),weekdaysMin:"v_h_k_sze_cs_p_szo".split("_"),longDateFormat:{LT:"H:mm",L:"YYYY.MM.DD.",LL:"YYYY. MMMM D.",LLL:"YYYY. MMMM D., LT",LLLL:"YYYY. MMMM D., dddd LT"},calendar:{sameDay:"[ma] LT[-kor]",nextDay:"[holnap] LT[-kor]",nextWeek:function(){return c.call(this,!0)},lastDay:"[tegnap] LT[-kor]",lastWeek:function(){return c.call(this,!1)},sameElse:"L"},relativeTime:{future:"%s múlva",past:"%s",s:b,m:b,mm:b,h:b,hh:b,d:b,dd:b,M:b,MM:b,y:b,yy:b},ordinal:"%d.",week:{dow:1,doy:7}})}),function(a){a(cb)}(function(a){return a.lang("id",{months:"Januari_Februari_Maret_April_Mei_Juni_Juli_Agustus_September_Oktober_November_Desember".split("_"),monthsShort:"Jan_Feb_Mar_Apr_Mei_Jun_Jul_Ags_Sep_Okt_Nov_Des".split("_"),weekdays:"Minggu_Senin_Selasa_Rabu_Kamis_Jumat_Sabtu".split("_"),weekdaysShort:"Min_Sen_Sel_Rab_Kam_Jum_Sab".split("_"),weekdaysMin:"Mg_Sn_Sl_Rb_Km_Jm_Sb".split("_"),longDateFormat:{LT:"HH.mm",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY [pukul] LT",LLLL:"dddd, D MMMM YYYY [pukul] LT"},meridiem:function(a){return 11>a?"pagi":15>a?"siang":19>a?"sore":"malam"},calendar:{sameDay:"[Hari ini pukul] LT",nextDay:"[Besok pukul] LT",nextWeek:"dddd [pukul] LT",lastDay:"[Kemarin pukul] LT",lastWeek:"dddd [lalu pukul] LT",sameElse:"L"},relativeTime:{future:"dalam %s",past:"%s yang lalu",s:"beberapa detik",m:"semenit",mm:"%d menit",h:"sejam",hh:"%d jam",d:"sehari",dd:"%d hari",M:"sebulan",MM:"%d bulan",y:"setahun",yy:"%d tahun"},week:{dow:1,doy:7}})}),function(a){a(cb)}(function(a){function b(a){return a%100===11?!0:a%10===1?!1:!0}function c(a,c,d,e){var f=a+" ";switch(d){case"s":return c||e?"nokkrar sekúndur":"nokkrum sekúndum";case"m":return c?"mínúta":"mínútu";case"mm":return b(a)?f+(c||e?"mínútur":"mínútum"):c?f+"mínúta":f+"mínútu";case"hh":return b(a)?f+(c||e?"klukkustundir":"klukkustundum"):f+"klukkustund";case"d":return c?"dagur":e?"dag":"degi";case"dd":return b(a)?c?f+"dagar":f+(e?"daga":"dögum"):c?f+"dagur":f+(e?"dag":"degi");case"M":return c?"mánuður":e?"mánuð":"mánuði";case"MM":return b(a)?c?f+"mánuðir":f+(e?"mánuði":"mánuðum"):c?f+"mánuður":f+(e?"mánuð":"mánuði");case"y":return c||e?"ár":"ári";case"yy":return b(a)?f+(c||e?"ár":"árum"):f+(c||e?"ár":"ári")}}return a.lang("is",{months:"janúar_febrúar_mars_apríl_maí_júní_júlí_ágúst_september_október_nóvember_desember".split("_"),monthsShort:"jan_feb_mar_apr_maí_jún_júl_ágú_sep_okt_nóv_des".split("_"),weekdays:"sunnudagur_mánudagur_þriðjudagur_miðvikudagur_fimmtudagur_föstudagur_laugardagur".split("_"),weekdaysShort:"sun_mán_þri_mið_fim_fös_lau".split("_"),weekdaysMin:"Su_Má_Þr_Mi_Fi_Fö_La".split("_"),longDateFormat:{LT:"H:mm",L:"DD/MM/YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY [kl.] LT",LLLL:"dddd, D. MMMM YYYY [kl.] LT"},calendar:{sameDay:"[í dag kl.] LT",nextDay:"[á morgun kl.] LT",nextWeek:"dddd [kl.] LT",lastDay:"[í gær kl.] LT",lastWeek:"[síðasta] dddd [kl.] LT",sameElse:"L"},relativeTime:{future:"eftir %s",past:"fyrir %s síðan",s:c,m:c,mm:c,h:"klukkustund",hh:c,d:c,dd:c,M:c,MM:c,y:c,yy:c},ordinal:"%d.",week:{dow:1,doy:4}})}),function(a){a(cb)}(function(a){return a.lang("it",{months:"Gennaio_Febbraio_Marzo_Aprile_Maggio_Giugno_Luglio_Agosto_Settembre_Ottobre_Novembre_Dicembre".split("_"),monthsShort:"Gen_Feb_Mar_Apr_Mag_Giu_Lug_Ago_Set_Ott_Nov_Dic".split("_"),weekdays:"Domenica_Lunedì_Martedì_Mercoledì_Giovedì_Venerdì_Sabato".split("_"),weekdaysShort:"Dom_Lun_Mar_Mer_Gio_Ven_Sab".split("_"),weekdaysMin:"D_L_Ma_Me_G_V_S".split("_"),longDateFormat:{LT:"HH:mm",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd, D MMMM YYYY LT"},calendar:{sameDay:"[Oggi alle] LT",nextDay:"[Domani alle] LT",nextWeek:"dddd [alle] LT",lastDay:"[Ieri alle] LT",lastWeek:"[lo scorso] dddd [alle] LT",sameElse:"L"},relativeTime:{future:function(a){return(/^[0-9].+$/.test(a)?"tra":"in")+" "+a},past:"%s fa",s:"alcuni secondi",m:"un minuto",mm:"%d minuti",h:"un'ora",hh:"%d ore",d:"un giorno",dd:"%d giorni",M:"un mese",MM:"%d mesi",y:"un anno",yy:"%d anni"},ordinal:"%dº",week:{dow:1,doy:4}})}),function(a){a(cb)}(function(a){return a.lang("ja",{months:"1月_2月_3月_4月_5月_6月_7月_8月_9月_10月_11月_12月".split("_"),monthsShort:"1月_2月_3月_4月_5月_6月_7月_8月_9月_10月_11月_12月".split("_"),weekdays:"日曜日_月曜日_火曜日_水曜日_木曜日_金曜日_土曜日".split("_"),weekdaysShort:"日_月_火_水_木_金_土".split("_"),weekdaysMin:"日_月_火_水_木_金_土".split("_"),longDateFormat:{LT:"Ah時m分",L:"YYYY/MM/DD",LL:"YYYY年M月D日",LLL:"YYYY年M月D日LT",LLLL:"YYYY年M月D日LT dddd"},meridiem:function(a){return 12>a?"午前":"午後"},calendar:{sameDay:"[今日] LT",nextDay:"[明日] LT",nextWeek:"[来週]dddd LT",lastDay:"[昨日] LT",lastWeek:"[前週]dddd LT",sameElse:"L"},relativeTime:{future:"%s後",past:"%s前",s:"数秒",m:"1分",mm:"%d分",h:"1時間",hh:"%d時間",d:"1日",dd:"%d日",M:"1ヶ月",MM:"%dヶ月",y:"1年",yy:"%d年"}})
}),function(a){a(cb)}(function(a){function b(a,b){var c={nominative:"იანვარი_თებერვალი_მარტი_აპრილი_მაისი_ივნისი_ივლისი_აგვისტო_სექტემბერი_ოქტომბერი_ნოემბერი_დეკემბერი".split("_"),accusative:"იანვარს_თებერვალს_მარტს_აპრილის_მაისს_ივნისს_ივლისს_აგვისტს_სექტემბერს_ოქტომბერს_ნოემბერს_დეკემბერს".split("_")},d=/D[oD] *MMMM?/.test(b)?"accusative":"nominative";return c[d][a.month()]}function c(a,b){var c={nominative:"კვირა_ორშაბათი_სამშაბათი_ოთხშაბათი_ხუთშაბათი_პარასკევი_შაბათი".split("_"),accusative:"კვირას_ორშაბათს_სამშაბათს_ოთხშაბათს_ხუთშაბათს_პარასკევს_შაბათს".split("_")},d=/(წინა|შემდეგ)/.test(b)?"accusative":"nominative";return c[d][a.day()]}return a.lang("ka",{months:b,monthsShort:"იან_თებ_მარ_აპრ_მაი_ივნ_ივლ_აგვ_სექ_ოქტ_ნოე_დეკ".split("_"),weekdays:c,weekdaysShort:"კვი_ორშ_სამ_ოთხ_ხუთ_პარ_შაბ".split("_"),weekdaysMin:"კვ_ორ_სა_ოთ_ხუ_პა_შა".split("_"),longDateFormat:{LT:"h:mm A",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd, D MMMM YYYY LT"},calendar:{sameDay:"[დღეს] LT[-ზე]",nextDay:"[ხვალ] LT[-ზე]",lastDay:"[გუშინ] LT[-ზე]",nextWeek:"[შემდეგ] dddd LT[-ზე]",lastWeek:"[წინა] dddd LT-ზე",sameElse:"L"},relativeTime:{future:function(a){return/(წამი|წუთი|საათი|წელი)/.test(a)?a.replace(/ი$/,"ში"):a+"ში"},past:function(a){return/(წამი|წუთი|საათი|დღე|თვე)/.test(a)?a.replace(/(ი|ე)$/,"ის წინ"):/წელი/.test(a)?a.replace(/წელი$/,"წლის წინ"):void 0},s:"რამდენიმე წამი",m:"წუთი",mm:"%d წუთი",h:"საათი",hh:"%d საათი",d:"დღე",dd:"%d დღე",M:"თვე",MM:"%d თვე",y:"წელი",yy:"%d წელი"},ordinal:function(a){return 0===a?a:1===a?a+"-ლი":20>a||100>=a&&a%20===0||a%100===0?"მე-"+a:a+"-ე"},week:{dow:1,doy:7}})}),function(a){a(cb)}(function(a){return a.lang("ko",{months:"1월_2월_3월_4월_5월_6월_7월_8월_9월_10월_11월_12월".split("_"),monthsShort:"1월_2월_3월_4월_5월_6월_7월_8월_9월_10월_11월_12월".split("_"),weekdays:"일요일_월요일_화요일_수요일_목요일_금요일_토요일".split("_"),weekdaysShort:"일_월_화_수_목_금_토".split("_"),weekdaysMin:"일_월_화_수_목_금_토".split("_"),longDateFormat:{LT:"A h시 mm분",L:"YYYY.MM.DD",LL:"YYYY년 MMMM D일",LLL:"YYYY년 MMMM D일 LT",LLLL:"YYYY년 MMMM D일 dddd LT"},meridiem:function(a){return 12>a?"오전":"오후"},calendar:{sameDay:"오늘 LT",nextDay:"내일 LT",nextWeek:"dddd LT",lastDay:"어제 LT",lastWeek:"지난주 dddd LT",sameElse:"L"},relativeTime:{future:"%s 후",past:"%s 전",s:"몇초",ss:"%d초",m:"일분",mm:"%d분",h:"한시간",hh:"%d시간",d:"하루",dd:"%d일",M:"한달",MM:"%d달",y:"일년",yy:"%d년"},ordinal:"%d일",meridiemParse:/(오전|오후)/,isPM:function(a){return"오후"===a}})}),function(a){a(cb)}(function(a){function b(a,b,c){var d={m:["eng Minutt","enger Minutt"],h:["eng Stonn","enger Stonn"],d:["een Dag","engem Dag"],dd:[a+" Deeg",a+" Deeg"],M:["ee Mount","engem Mount"],MM:[a+" Méint",a+" Méint"],y:["ee Joer","engem Joer"],yy:[a+" Joer",a+" Joer"]};return b?d[c][0]:d[c][1]}function c(a){var b=a.substr(0,a.indexOf(" "));return g(b)?"a "+a:"an "+a}function d(a){var b=a.substr(0,a.indexOf(" "));return g(b)?"viru "+a:"virun "+a}function e(){var a=this.format("d");return f(a)?"[Leschte] dddd [um] LT":"[Leschten] dddd [um] LT"}function f(a){switch(a=parseInt(a,10)){case 0:case 1:case 3:case 5:case 6:return!0;default:return!1}}function g(a){if(a=parseInt(a,10),isNaN(a))return!1;if(0>a)return!0;if(10>a)return a>=4&&7>=a?!0:!1;if(100>a){var b=a%10,c=a/10;return 0===b?g(c):g(b)}if(1e4>a){for(;a>=10;)a/=10;return g(a)}return a/=1e3,g(a)}return a.lang("lb",{months:"Januar_Februar_Mäerz_Abrëll_Mee_Juni_Juli_August_September_Oktober_November_Dezember".split("_"),monthsShort:"Jan._Febr._Mrz._Abr._Mee_Jun._Jul._Aug._Sept._Okt._Nov._Dez.".split("_"),weekdays:"Sonndeg_Méindeg_Dënschdeg_Mëttwoch_Donneschdeg_Freideg_Samschdeg".split("_"),weekdaysShort:"So._Mé._Dë._Më._Do._Fr._Sa.".split("_"),weekdaysMin:"So_Mé_Dë_Më_Do_Fr_Sa".split("_"),longDateFormat:{LT:"H:mm [Auer]",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY LT",LLLL:"dddd, D. MMMM YYYY LT"},calendar:{sameDay:"[Haut um] LT",sameElse:"L",nextDay:"[Muer um] LT",nextWeek:"dddd [um] LT",lastDay:"[Gëschter um] LT",lastWeek:e},relativeTime:{future:c,past:d,s:"e puer Sekonnen",m:b,mm:"%d Minutten",h:b,hh:"%d Stonnen",d:b,dd:b,M:b,MM:b,y:b,yy:b},ordinal:"%d.",week:{dow:1,doy:4}})}),function(a){a(cb)}(function(a){function b(a,b,c,d){return b?"kelios sekundės":d?"kelių sekundžių":"kelias sekundes"}function c(a,b,c,d){return b?e(c)[0]:d?e(c)[1]:e(c)[2]}function d(a){return a%10===0||a>10&&20>a}function e(a){return h[a].split("_")}function f(a,b,f,g){var h=a+" ";return 1===a?h+c(a,b,f[0],g):b?h+(d(a)?e(f)[1]:e(f)[0]):g?h+e(f)[1]:h+(d(a)?e(f)[1]:e(f)[2])}function g(a,b){var c=-1===b.indexOf("dddd LT"),d=i[a.weekday()];return c?d:d.substring(0,d.length-2)+"į"}var h={m:"minutė_minutės_minutę",mm:"minutės_minučių_minutes",h:"valanda_valandos_valandą",hh:"valandos_valandų_valandas",d:"diena_dienos_dieną",dd:"dienos_dienų_dienas",M:"mėnuo_mėnesio_mėnesį",MM:"mėnesiai_mėnesių_mėnesius",y:"metai_metų_metus",yy:"metai_metų_metus"},i="pirmadienis_antradienis_trečiadienis_ketvirtadienis_penktadienis_šeštadienis_sekmadienis".split("_");return a.lang("lt",{months:"sausio_vasario_kovo_balandžio_gegužės_biržėlio_liepos_rugpjūčio_rugsėjo_spalio_lapkričio_gruodžio".split("_"),monthsShort:"sau_vas_kov_bal_geg_bir_lie_rgp_rgs_spa_lap_grd".split("_"),weekdays:g,weekdaysShort:"Sek_Pir_Ant_Tre_Ket_Pen_Šeš".split("_"),weekdaysMin:"S_P_A_T_K_Pn_Š".split("_"),longDateFormat:{LT:"HH:mm",L:"YYYY-MM-DD",LL:"YYYY [m.] MMMM D [d.]",LLL:"YYYY [m.] MMMM D [d.], LT [val.]",LLLL:"YYYY [m.] MMMM D [d.], dddd, LT [val.]",l:"YYYY-MM-DD",ll:"YYYY [m.] MMMM D [d.]",lll:"YYYY [m.] MMMM D [d.], LT [val.]",llll:"YYYY [m.] MMMM D [d.], ddd, LT [val.]"},calendar:{sameDay:"[Šiandien] LT",nextDay:"[Rytoj] LT",nextWeek:"dddd LT",lastDay:"[Vakar] LT",lastWeek:"[Praėjusį] dddd LT",sameElse:"L"},relativeTime:{future:"po %s",past:"prieš %s",s:b,m:c,mm:f,h:c,hh:f,d:c,dd:f,M:c,MM:f,y:c,yy:f},ordinal:function(a){return a+"-oji"},week:{dow:1,doy:4}})}),function(a){a(cb)}(function(a){function b(a,b,c){var d=a.split("_");return c?b%10===1&&11!==b?d[2]:d[3]:b%10===1&&11!==b?d[0]:d[1]}function c(a,c,e){return a+" "+b(d[e],a,c)}var d={mm:"minūti_minūtes_minūte_minūtes",hh:"stundu_stundas_stunda_stundas",dd:"dienu_dienas_diena_dienas",MM:"mēnesi_mēnešus_mēnesis_mēneši",yy:"gadu_gadus_gads_gadi"};return a.lang("lv",{months:"janvāris_februāris_marts_aprīlis_maijs_jūnijs_jūlijs_augusts_septembris_oktobris_novembris_decembris".split("_"),monthsShort:"jan_feb_mar_apr_mai_jūn_jūl_aug_sep_okt_nov_dec".split("_"),weekdays:"svētdiena_pirmdiena_otrdiena_trešdiena_ceturtdiena_piektdiena_sestdiena".split("_"),weekdaysShort:"Sv_P_O_T_C_Pk_S".split("_"),weekdaysMin:"Sv_P_O_T_C_Pk_S".split("_"),longDateFormat:{LT:"HH:mm",L:"DD.MM.YYYY",LL:"YYYY. [gada] D. MMMM",LLL:"YYYY. [gada] D. MMMM, LT",LLLL:"YYYY. [gada] D. MMMM, dddd, LT"},calendar:{sameDay:"[Šodien pulksten] LT",nextDay:"[Rīt pulksten] LT",nextWeek:"dddd [pulksten] LT",lastDay:"[Vakar pulksten] LT",lastWeek:"[Pagājušā] dddd [pulksten] LT",sameElse:"L"},relativeTime:{future:"%s vēlāk",past:"%s agrāk",s:"dažas sekundes",m:"minūti",mm:c,h:"stundu",hh:c,d:"dienu",dd:c,M:"mēnesi",MM:c,y:"gadu",yy:c},ordinal:"%d.",week:{dow:1,doy:4}})}),function(a){a(cb)}(function(a){return a.lang("mk",{months:"јануари_февруари_март_април_мај_јуни_јули_август_септември_октомври_ноември_декември".split("_"),monthsShort:"јан_фев_мар_апр_мај_јун_јул_авг_сеп_окт_ное_дек".split("_"),weekdays:"недела_понеделник_вторник_среда_четврток_петок_сабота".split("_"),weekdaysShort:"нед_пон_вто_сре_чет_пет_саб".split("_"),weekdaysMin:"нe_пo_вт_ср_че_пе_сa".split("_"),longDateFormat:{LT:"H:mm",L:"D.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd, D MMMM YYYY LT"},calendar:{sameDay:"[Денес во] LT",nextDay:"[Утре во] LT",nextWeek:"dddd [во] LT",lastDay:"[Вчера во] LT",lastWeek:function(){switch(this.day()){case 0:case 3:case 6:return"[Во изминатата] dddd [во] LT";case 1:case 2:case 4:case 5:return"[Во изминатиот] dddd [во] LT"}},sameElse:"L"},relativeTime:{future:"после %s",past:"пред %s",s:"неколку секунди",m:"минута",mm:"%d минути",h:"час",hh:"%d часа",d:"ден",dd:"%d дена",M:"месец",MM:"%d месеци",y:"година",yy:"%d години"},ordinal:function(a){var b=a%10,c=a%100;return 0===a?a+"-ев":0===c?a+"-ен":c>10&&20>c?a+"-ти":1===b?a+"-ви":2===b?a+"-ри":7===b||8===b?a+"-ми":a+"-ти"},week:{dow:1,doy:7}})}),function(a){a(cb)}(function(a){return a.lang("ml",{months:"ജനുവരി_ഫെബ്രുവരി_മാർച്ച്_ഏപ്രിൽ_മേയ്_ജൂൺ_ജൂലൈ_ഓഗസ്റ്റ്_സെപ്റ്റംബർ_ഒക്ടോബർ_നവംബർ_ഡിസംബർ".split("_"),monthsShort:"ജനു._ഫെബ്രു._മാർ._ഏപ്രി._മേയ്_ജൂൺ_ജൂലൈ._ഓഗ._സെപ്റ്റ._ഒക്ടോ._നവം._ഡിസം.".split("_"),weekdays:"ഞായറാഴ്ച_തിങ്കളാഴ്ച_ചൊവ്വാഴ്ച_ബുധനാഴ്ച_വ്യാഴാഴ്ച_വെള്ളിയാഴ്ച_ശനിയാഴ്ച".split("_"),weekdaysShort:"ഞായർ_തിങ്കൾ_ചൊവ്വ_ബുധൻ_വ്യാഴം_വെള്ളി_ശനി".split("_"),weekdaysMin:"ഞാ_തി_ചൊ_ബു_വ്യാ_വെ_ശ".split("_"),longDateFormat:{LT:"A h:mm -നു",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, LT",LLLL:"dddd, D MMMM YYYY, LT"},calendar:{sameDay:"[ഇന്ന്] LT",nextDay:"[നാളെ] LT",nextWeek:"dddd, LT",lastDay:"[ഇന്നലെ] LT",lastWeek:"[കഴിഞ്ഞ] dddd, LT",sameElse:"L"},relativeTime:{future:"%s കഴിഞ്ഞ്",past:"%s മുൻപ്",s:"അൽപ നിമിഷങ്ങൾ",m:"ഒരു മിനിറ്റ്",mm:"%d മിനിറ്റ്",h:"ഒരു മണിക്കൂർ",hh:"%d മണിക്കൂർ",d:"ഒരു ദിവസം",dd:"%d ദിവസം",M:"ഒരു മാസം",MM:"%d മാസം",y:"ഒരു വർഷം",yy:"%d വർഷം"},meridiem:function(a){return 4>a?"രാത്രി":12>a?"രാവിലെ":17>a?"ഉച്ച കഴിഞ്ഞ്":20>a?"വൈകുന്നേരം":"രാത്രി"}})}),function(a){a(cb)}(function(a){var b={1:"१",2:"२",3:"३",4:"४",5:"५",6:"६",7:"७",8:"८",9:"९",0:"०"},c={"१":"1","२":"2","३":"3","४":"4","५":"5","६":"6","७":"7","८":"8","९":"9","०":"0"};return a.lang("mr",{months:"जानेवारी_फेब्रुवारी_मार्च_एप्रिल_मे_जून_जुलै_ऑगस्ट_सप्टेंबर_ऑक्टोबर_नोव्हेंबर_डिसेंबर".split("_"),monthsShort:"जाने._फेब्रु._मार्च._एप्रि._मे._जून._जुलै._ऑग._सप्टें._ऑक्टो._नोव्हें._डिसें.".split("_"),weekdays:"रविवार_सोमवार_मंगळवार_बुधवार_गुरूवार_शुक्रवार_शनिवार".split("_"),weekdaysShort:"रवि_सोम_मंगळ_बुध_गुरू_शुक्र_शनि".split("_"),weekdaysMin:"र_सो_मं_बु_गु_शु_श".split("_"),longDateFormat:{LT:"A h:mm वाजता",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, LT",LLLL:"dddd, D MMMM YYYY, LT"},calendar:{sameDay:"[आज] LT",nextDay:"[उद्या] LT",nextWeek:"dddd, LT",lastDay:"[काल] LT",lastWeek:"[मागील] dddd, LT",sameElse:"L"},relativeTime:{future:"%s नंतर",past:"%s पूर्वी",s:"सेकंद",m:"एक मिनिट",mm:"%d मिनिटे",h:"एक तास",hh:"%d तास",d:"एक दिवस",dd:"%d दिवस",M:"एक महिना",MM:"%d महिने",y:"एक वर्ष",yy:"%d वर्षे"},preparse:function(a){return a.replace(/[१२३४५६७८९०]/g,function(a){return c[a]})},postformat:function(a){return a.replace(/\d/g,function(a){return b[a]})},meridiem:function(a){return 4>a?"रात्री":10>a?"सकाळी":17>a?"दुपारी":20>a?"सायंकाळी":"रात्री"},week:{dow:0,doy:6}})}),function(a){a(cb)}(function(a){return a.lang("ms-my",{months:"Januari_Februari_Mac_April_Mei_Jun_Julai_Ogos_September_Oktober_November_Disember".split("_"),monthsShort:"Jan_Feb_Mac_Apr_Mei_Jun_Jul_Ogs_Sep_Okt_Nov_Dis".split("_"),weekdays:"Ahad_Isnin_Selasa_Rabu_Khamis_Jumaat_Sabtu".split("_"),weekdaysShort:"Ahd_Isn_Sel_Rab_Kha_Jum_Sab".split("_"),weekdaysMin:"Ah_Is_Sl_Rb_Km_Jm_Sb".split("_"),longDateFormat:{LT:"HH.mm",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY [pukul] LT",LLLL:"dddd, D MMMM YYYY [pukul] LT"},meridiem:function(a){return 11>a?"pagi":15>a?"tengahari":19>a?"petang":"malam"},calendar:{sameDay:"[Hari ini pukul] LT",nextDay:"[Esok pukul] LT",nextWeek:"dddd [pukul] LT",lastDay:"[Kelmarin pukul] LT",lastWeek:"dddd [lepas pukul] LT",sameElse:"L"},relativeTime:{future:"dalam %s",past:"%s yang lepas",s:"beberapa saat",m:"seminit",mm:"%d minit",h:"sejam",hh:"%d jam",d:"sehari",dd:"%d hari",M:"sebulan",MM:"%d bulan",y:"setahun",yy:"%d tahun"},week:{dow:1,doy:7}})}),function(a){a(cb)}(function(a){return a.lang("nb",{months:"januar_februar_mars_april_mai_juni_juli_august_september_oktober_november_desember".split("_"),monthsShort:"jan._feb._mars_april_mai_juni_juli_aug._sep._okt._nov._des.".split("_"),weekdays:"søndag_mandag_tirsdag_onsdag_torsdag_fredag_lørdag".split("_"),weekdaysShort:"sø._ma._ti._on._to._fr._lø.".split("_"),weekdaysMin:"sø_ma_ti_on_to_fr_lø".split("_"),longDateFormat:{LT:"H.mm",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY [kl.] LT",LLLL:"dddd D. MMMM YYYY [kl.] LT"},calendar:{sameDay:"[i dag kl.] LT",nextDay:"[i morgen kl.] LT",nextWeek:"dddd [kl.] LT",lastDay:"[i går kl.] LT",lastWeek:"[forrige] dddd [kl.] LT",sameElse:"L"},relativeTime:{future:"om %s",past:"for %s siden",s:"noen sekunder",m:"ett minutt",mm:"%d minutter",h:"en time",hh:"%d timer",d:"en dag",dd:"%d dager",M:"en måned",MM:"%d måneder",y:"ett år",yy:"%d år"},ordinal:"%d.",week:{dow:1,doy:4}})}),function(a){a(cb)}(function(a){var b={1:"१",2:"२",3:"३",4:"४",5:"५",6:"६",7:"७",8:"८",9:"९",0:"०"},c={"१":"1","२":"2","३":"3","४":"4","५":"5","६":"6","७":"7","८":"8","९":"9","०":"0"};return a.lang("ne",{months:"जनवरी_फेब्रुवरी_मार्च_अप्रिल_मई_जुन_जुलाई_अगष्ट_सेप्टेम्बर_अक्टोबर_नोभेम्बर_डिसेम्बर".split("_"),monthsShort:"जन._फेब्रु._मार्च_अप्रि._मई_जुन_जुलाई._अग._सेप्ट._अक्टो._नोभे._डिसे.".split("_"),weekdays:"आइतबार_सोमबार_मङ्गलबार_बुधबार_बिहिबार_शुक्रबार_शनिबार".split("_"),weekdaysShort:"आइत._सोम._मङ्गल._बुध._बिहि._शुक्र._शनि.".split("_"),weekdaysMin:"आइ._सो._मङ्_बु._बि._शु._श.".split("_"),longDateFormat:{LT:"Aको h:mm बजे",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, LT",LLLL:"dddd, D MMMM YYYY, LT"},preparse:function(a){return a.replace(/[१२३४५६७८९०]/g,function(a){return c[a]})},postformat:function(a){return a.replace(/\d/g,function(a){return b[a]})},meridiem:function(a){return 3>a?"राती":10>a?"बिहान":15>a?"दिउँसो":18>a?"बेलुका":20>a?"साँझ":"राती"},calendar:{sameDay:"[आज] LT",nextDay:"[भोली] LT",nextWeek:"[आउँदो] dddd[,] LT",lastDay:"[हिजो] LT",lastWeek:"[गएको] dddd[,] LT",sameElse:"L"},relativeTime:{future:"%sमा",past:"%s अगाडी",s:"केही समय",m:"एक मिनेट",mm:"%d मिनेट",h:"एक घण्टा",hh:"%d घण्टा",d:"एक दिन",dd:"%d दिन",M:"एक महिना",MM:"%d महिना",y:"एक बर्ष",yy:"%d बर्ष"},week:{dow:1,doy:7}})}),function(a){a(cb)}(function(a){var b="jan._feb._mrt._apr._mei_jun._jul._aug._sep._okt._nov._dec.".split("_"),c="jan_feb_mrt_apr_mei_jun_jul_aug_sep_okt_nov_dec".split("_");return a.lang("nl",{months:"januari_februari_maart_april_mei_juni_juli_augustus_september_oktober_november_december".split("_"),monthsShort:function(a,d){return/-MMM-/.test(d)?c[a.month()]:b[a.month()]},weekdays:"zondag_maandag_dinsdag_woensdag_donderdag_vrijdag_zaterdag".split("_"),weekdaysShort:"zo._ma._di._wo._do._vr._za.".split("_"),weekdaysMin:"Zo_Ma_Di_Wo_Do_Vr_Za".split("_"),longDateFormat:{LT:"HH:mm",L:"DD-MM-YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd D MMMM YYYY LT"},calendar:{sameDay:"[vandaag om] LT",nextDay:"[morgen om] LT",nextWeek:"dddd [om] LT",lastDay:"[gisteren om] LT",lastWeek:"[afgelopen] dddd [om] LT",sameElse:"L"},relativeTime:{future:"over %s",past:"%s geleden",s:"een paar seconden",m:"één minuut",mm:"%d minuten",h:"één uur",hh:"%d uur",d:"één dag",dd:"%d dagen",M:"één maand",MM:"%d maanden",y:"één jaar",yy:"%d jaar"},ordinal:function(a){return a+(1===a||8===a||a>=20?"ste":"de")},week:{dow:1,doy:4}})}),function(a){a(cb)}(function(a){return a.lang("nn",{months:"januar_februar_mars_april_mai_juni_juli_august_september_oktober_november_desember".split("_"),monthsShort:"jan_feb_mar_apr_mai_jun_jul_aug_sep_okt_nov_des".split("_"),weekdays:"sundag_måndag_tysdag_onsdag_torsdag_fredag_laurdag".split("_"),weekdaysShort:"sun_mån_tys_ons_tor_fre_lau".split("_"),weekdaysMin:"su_må_ty_on_to_fr_lø".split("_"),longDateFormat:{LT:"HH:mm",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd D MMMM YYYY LT"},calendar:{sameDay:"[I dag klokka] LT",nextDay:"[I morgon klokka] LT",nextWeek:"dddd [klokka] LT",lastDay:"[I går klokka] LT",lastWeek:"[Føregående] dddd [klokka] LT",sameElse:"L"},relativeTime:{future:"om %s",past:"for %s siden",s:"noen sekund",m:"ett minutt",mm:"%d minutt",h:"en time",hh:"%d timar",d:"en dag",dd:"%d dagar",M:"en månad",MM:"%d månader",y:"ett år",yy:"%d år"},ordinal:"%d.",week:{dow:1,doy:4}})}),function(a){a(cb)}(function(a){function b(a){return 5>a%10&&a%10>1&&~~(a/10)%10!==1}function c(a,c,d){var e=a+" ";switch(d){case"m":return c?"minuta":"minutę";case"mm":return e+(b(a)?"minuty":"minut");case"h":return c?"godzina":"godzinę";case"hh":return e+(b(a)?"godziny":"godzin");case"MM":return e+(b(a)?"miesiące":"miesięcy");case"yy":return e+(b(a)?"lata":"lat")}}var d="styczeń_luty_marzec_kwiecień_maj_czerwiec_lipiec_sierpień_wrzesień_październik_listopad_grudzień".split("_"),e="stycznia_lutego_marca_kwietnia_maja_czerwca_lipca_sierpnia_września_października_listopada_grudnia".split("_");return a.lang("pl",{months:function(a,b){return/D MMMM/.test(b)?e[a.month()]:d[a.month()]},monthsShort:"sty_lut_mar_kwi_maj_cze_lip_sie_wrz_paź_lis_gru".split("_"),weekdays:"niedziela_poniedziałek_wtorek_środa_czwartek_piątek_sobota".split("_"),weekdaysShort:"nie_pon_wt_śr_czw_pt_sb".split("_"),weekdaysMin:"N_Pn_Wt_Śr_Cz_Pt_So".split("_"),longDateFormat:{LT:"HH:mm",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd, D MMMM YYYY LT"},calendar:{sameDay:"[Dziś o] LT",nextDay:"[Jutro o] LT",nextWeek:"[W] dddd [o] LT",lastDay:"[Wczoraj o] LT",lastWeek:function(){switch(this.day()){case 0:return"[W zeszłą niedzielę o] LT";case 3:return"[W zeszłą środę o] LT";case 6:return"[W zeszłą sobotę o] LT";default:return"[W zeszły] dddd [o] LT"}},sameElse:"L"},relativeTime:{future:"za %s",past:"%s temu",s:"kilka sekund",m:c,mm:c,h:c,hh:c,d:"1 dzień",dd:"%d dni",M:"miesiąc",MM:c,y:"rok",yy:c},ordinal:"%d.",week:{dow:1,doy:4}})}),function(a){a(cb)}(function(a){return a.lang("pt-br",{months:"Janeiro_Fevereiro_Março_Abril_Maio_Junho_Julho_Agosto_Setembro_Outubro_Novembro_Dezembro".split("_"),monthsShort:"Jan_Fev_Mar_Abr_Mai_Jun_Jul_Ago_Set_Out_Nov_Dez".split("_"),weekdays:"Domingo_Segunda-feira_Terça-feira_Quarta-feira_Quinta-feira_Sexta-feira_Sábado".split("_"),weekdaysShort:"Dom_Seg_Ter_Qua_Qui_Sex_Sáb".split("_"),weekdaysMin:"Dom_2ª_3ª_4ª_5ª_6ª_Sáb".split("_"),longDateFormat:{LT:"HH:mm",L:"DD/MM/YYYY",LL:"D [de] MMMM [de] YYYY",LLL:"D [de] MMMM [de] YYYY LT",LLLL:"dddd, D [de] MMMM [de] YYYY LT"},calendar:{sameDay:"[Hoje às] LT",nextDay:"[Amanhã às] LT",nextWeek:"dddd [às] LT",lastDay:"[Ontem às] LT",lastWeek:function(){return 0===this.day()||6===this.day()?"[Último] dddd [às] LT":"[Última] dddd [às] LT"},sameElse:"L"},relativeTime:{future:"em %s",past:"%s atrás",s:"segundos",m:"um minuto",mm:"%d minutos",h:"uma hora",hh:"%d horas",d:"um dia",dd:"%d dias",M:"um mês",MM:"%d meses",y:"um ano",yy:"%d anos"},ordinal:"%dº"})}),function(a){a(cb)}(function(a){return a.lang("pt",{months:"Janeiro_Fevereiro_Março_Abril_Maio_Junho_Julho_Agosto_Setembro_Outubro_Novembro_Dezembro".split("_"),monthsShort:"Jan_Fev_Mar_Abr_Mai_Jun_Jul_Ago_Set_Out_Nov_Dez".split("_"),weekdays:"Domingo_Segunda-feira_Terça-feira_Quarta-feira_Quinta-feira_Sexta-feira_Sábado".split("_"),weekdaysShort:"Dom_Seg_Ter_Qua_Qui_Sex_Sáb".split("_"),weekdaysMin:"Dom_2ª_3ª_4ª_5ª_6ª_Sáb".split("_"),longDateFormat:{LT:"HH:mm",L:"DD/MM/YYYY",LL:"D [de] MMMM [de] YYYY",LLL:"D [de] MMMM [de] YYYY LT",LLLL:"dddd, D [de] MMMM [de] YYYY LT"},calendar:{sameDay:"[Hoje às] LT",nextDay:"[Amanhã às] LT",nextWeek:"dddd [às] LT",lastDay:"[Ontem às] LT",lastWeek:function(){return 0===this.day()||6===this.day()?"[Último] dddd [às] LT":"[Última] dddd [às] LT"},sameElse:"L"},relativeTime:{future:"em %s",past:"%s atrás",s:"segundos",m:"um minuto",mm:"%d minutos",h:"uma hora",hh:"%d horas",d:"um dia",dd:"%d dias",M:"um mês",MM:"%d meses",y:"um ano",yy:"%d anos"},ordinal:"%dº",week:{dow:1,doy:4}})}),function(a){a(cb)}(function(a){function b(a,b,c){var d={mm:"minute",hh:"ore",dd:"zile",MM:"luni",yy:"ani"},e=" ";return(a%100>=20||a>=100&&a%100===0)&&(e=" de "),a+e+d[c]}return a.lang("ro",{months:"ianuarie_februarie_martie_aprilie_mai_iunie_iulie_august_septembrie_octombrie_noiembrie_decembrie".split("_"),monthsShort:"ian_feb_mar_apr_mai_iun_iul_aug_sep_oct_noi_dec".split("_"),weekdays:"duminică_luni_marți_miercuri_joi_vineri_sâmbătă".split("_"),weekdaysShort:"Dum_Lun_Mar_Mie_Joi_Vin_Sâm".split("_"),weekdaysMin:"Du_Lu_Ma_Mi_Jo_Vi_Sâ".split("_"),longDateFormat:{LT:"H:mm",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY H:mm",LLLL:"dddd, D MMMM YYYY H:mm"},calendar:{sameDay:"[azi la] LT",nextDay:"[mâine la] LT",nextWeek:"dddd [la] LT",lastDay:"[ieri la] LT",lastWeek:"[fosta] dddd [la] LT",sameElse:"L"},relativeTime:{future:"peste %s",past:"%s în urmă",s:"câteva secunde",m:"un minut",mm:b,h:"o oră",hh:b,d:"o zi",dd:b,M:"o lună",MM:b,y:"un an",yy:b},week:{dow:1,doy:7}})}),function(a){a(cb)}(function(a){function b(a,b,c){var d=a+" ";switch(c){case"m":return b?"jedna minuta":"jedne minute";case"mm":return d+=1===a?"minuta":2===a||3===a||4===a?"minute":"minuta";case"h":return b?"jedan sat":"jednog sata";case"hh":return d+=1===a?"sat":2===a||3===a||4===a?"sata":"sati";case"dd":return d+=1===a?"dan":"dana";case"MM":return d+=1===a?"mesec":2===a||3===a||4===a?"meseca":"meseci";case"yy":return d+=1===a?"godina":2===a||3===a||4===a?"godine":"godina"}}return a.lang("rs",{months:"januar_februar_mart_april_maj_jun_jul_avgust_septembar_oktobar_novembar_decembar".split("_"),monthsShort:"jan._feb._mar._apr._maj._jun._jul._avg._sep._okt._nov._dec.".split("_"),weekdays:"nedelja_ponedeljak_utorak_sreda_četvrtak_petak_subota".split("_"),weekdaysShort:"ned._pon._uto._sre._čet._pet._sub.".split("_"),weekdaysMin:"ne_po_ut_sr_če_pe_su".split("_"),longDateFormat:{LT:"H:mm",L:"DD. MM. YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY LT",LLLL:"dddd, D. MMMM YYYY LT"},calendar:{sameDay:"[danas u] LT",nextDay:"[sutra u] LT",nextWeek:function(){switch(this.day()){case 0:return"[u] [nedelju] [u] LT";case 3:return"[u] [sredu] [u] LT";case 6:return"[u] [subotu] [u] LT";case 1:case 2:case 4:case 5:return"[u] dddd [u] LT"}},lastDay:"[juče u] LT",lastWeek:function(){switch(this.day()){case 0:case 3:return"[prošlu] dddd [u] LT";case 6:return"[prošle] [subote] [u] LT";case 1:case 2:case 4:case 5:return"[prošli] dddd [u] LT"}},sameElse:"L"},relativeTime:{future:"za %s",past:"pre %s",s:"par sekundi",m:b,mm:b,h:b,hh:b,d:"dan",dd:b,M:"mesec",MM:b,y:"godinu",yy:b},ordinal:"%d.",week:{dow:1,doy:7}})}),function(a){a(cb)}(function(a){function b(a,b){var c=a.split("_");return b%10===1&&b%100!==11?c[0]:b%10>=2&&4>=b%10&&(10>b%100||b%100>=20)?c[1]:c[2]}function c(a,c,d){var e={mm:"минута_минуты_минут",hh:"час_часа_часов",dd:"день_дня_дней",MM:"месяц_месяца_месяцев",yy:"год_года_лет"};return"m"===d?c?"минута":"минуту":a+" "+b(e[d],+a)}function d(a,b){var c={nominative:"январь_февраль_март_апрель_май_июнь_июль_август_сентябрь_октябрь_ноябрь_декабрь".split("_"),accusative:"января_февраля_марта_апреля_мая_июня_июля_августа_сентября_октября_ноября_декабря".split("_")},d=/D[oD]?(\[[^\[\]]*\]|\s+)+MMMM?/.test(b)?"accusative":"nominative";return c[d][a.month()]}function e(a,b){var c={nominative:"янв_фев_мар_апр_май_июнь_июль_авг_сен_окт_ноя_дек".split("_"),accusative:"янв_фев_мар_апр_мая_июня_июля_авг_сен_окт_ноя_дек".split("_")},d=/D[oD]?(\[[^\[\]]*\]|\s+)+MMMM?/.test(b)?"accusative":"nominative";return c[d][a.month()]}function f(a,b){var c={nominative:"воскресенье_понедельник_вторник_среда_четверг_пятница_суббота".split("_"),accusative:"воскресенье_понедельник_вторник_среду_четверг_пятницу_субботу".split("_")},d=/\[ ?[Вв] ?(?:прошлую|следующую)? ?\] ?dddd/.test(b)?"accusative":"nominative";return c[d][a.day()]}return a.lang("ru",{months:d,monthsShort:e,weekdays:f,weekdaysShort:"вс_пн_вт_ср_чт_пт_сб".split("_"),weekdaysMin:"вс_пн_вт_ср_чт_пт_сб".split("_"),monthsParse:[/^янв/i,/^фев/i,/^мар/i,/^апр/i,/^ма[й|я]/i,/^июн/i,/^июл/i,/^авг/i,/^сен/i,/^окт/i,/^ноя/i,/^дек/i],longDateFormat:{LT:"HH:mm",L:"DD.MM.YYYY",LL:"D MMMM YYYY г.",LLL:"D MMMM YYYY г., LT",LLLL:"dddd, D MMMM YYYY г., LT"},calendar:{sameDay:"[Сегодня в] LT",nextDay:"[Завтра в] LT",lastDay:"[Вчера в] LT",nextWeek:function(){return 2===this.day()?"[Во] dddd [в] LT":"[В] dddd [в] LT"},lastWeek:function(){switch(this.day()){case 0:return"[В прошлое] dddd [в] LT";case 1:case 2:case 4:return"[В прошлый] dddd [в] LT";case 3:case 5:case 6:return"[В прошлую] dddd [в] LT"}},sameElse:"L"},relativeTime:{future:"через %s",past:"%s назад",s:"несколько секунд",m:c,mm:c,h:"час",hh:c,d:"день",dd:c,M:"месяц",MM:c,y:"год",yy:c},meridiem:function(a){return 4>a?"ночи":12>a?"утра":17>a?"дня":"вечера"},ordinal:function(a,b){switch(b){case"M":case"d":case"DDD":return a+"-й";case"D":return a+"-го";case"w":case"W":return a+"-я";default:return a}},week:{dow:1,doy:7}})}),function(a){a(cb)}(function(a){function b(a){return a>1&&5>a}function c(a,c,d,e){var f=a+" ";switch(d){case"s":return c||e?"pár sekúnd":"pár sekundami";case"m":return c?"minúta":e?"minútu":"minútou";case"mm":return c||e?f+(b(a)?"minúty":"minút"):f+"minútami";break;case"h":return c?"hodina":e?"hodinu":"hodinou";case"hh":return c||e?f+(b(a)?"hodiny":"hodín"):f+"hodinami";break;case"d":return c||e?"deň":"dňom";case"dd":return c||e?f+(b(a)?"dni":"dní"):f+"dňami";break;case"M":return c||e?"mesiac":"mesiacom";case"MM":return c||e?f+(b(a)?"mesiace":"mesiacov"):f+"mesiacmi";break;case"y":return c||e?"rok":"rokom";case"yy":return c||e?f+(b(a)?"roky":"rokov"):f+"rokmi"}}var d="január_február_marec_apríl_máj_jún_júl_august_september_október_november_december".split("_"),e="jan_feb_mar_apr_máj_jún_júl_aug_sep_okt_nov_dec".split("_");return a.lang("sk",{months:d,monthsShort:e,monthsParse:function(a,b){var c,d=[];for(c=0;12>c;c++)d[c]=new RegExp("^"+a[c]+"$|^"+b[c]+"$","i");return d}(d,e),weekdays:"nedeľa_pondelok_utorok_streda_štvrtok_piatok_sobota".split("_"),weekdaysShort:"ne_po_ut_st_št_pi_so".split("_"),weekdaysMin:"ne_po_ut_st_št_pi_so".split("_"),longDateFormat:{LT:"H:mm",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY LT",LLLL:"dddd D. MMMM YYYY LT"},calendar:{sameDay:"[dnes o] LT",nextDay:"[zajtra o] LT",nextWeek:function(){switch(this.day()){case 0:return"[v nedeľu o] LT";case 1:case 2:return"[v] dddd [o] LT";case 3:return"[v stredu o] LT";case 4:return"[vo štvrtok o] LT";case 5:return"[v piatok o] LT";case 6:return"[v sobotu o] LT"}},lastDay:"[včera o] LT",lastWeek:function(){switch(this.day()){case 0:return"[minulú nedeľu o] LT";case 1:case 2:return"[minulý] dddd [o] LT";case 3:return"[minulú stredu o] LT";case 4:case 5:return"[minulý] dddd [o] LT";case 6:return"[minulú sobotu o] LT"}},sameElse:"L"},relativeTime:{future:"za %s",past:"pred %s",s:c,m:c,mm:c,h:c,hh:c,d:c,dd:c,M:c,MM:c,y:c,yy:c},ordinal:"%d.",week:{dow:1,doy:4}})}),function(a){a(cb)}(function(a){function b(a,b,c){var d=a+" ";switch(c){case"m":return b?"ena minuta":"eno minuto";case"mm":return d+=1===a?"minuta":2===a?"minuti":3===a||4===a?"minute":"minut";case"h":return b?"ena ura":"eno uro";case"hh":return d+=1===a?"ura":2===a?"uri":3===a||4===a?"ure":"ur";case"dd":return d+=1===a?"dan":"dni";case"MM":return d+=1===a?"mesec":2===a?"meseca":3===a||4===a?"mesece":"mesecev";case"yy":return d+=1===a?"leto":2===a?"leti":3===a||4===a?"leta":"let"}}return a.lang("sl",{months:"januar_februar_marec_april_maj_junij_julij_avgust_september_oktober_november_december".split("_"),monthsShort:"jan._feb._mar._apr._maj._jun._jul._avg._sep._okt._nov._dec.".split("_"),weekdays:"nedelja_ponedeljek_torek_sreda_četrtek_petek_sobota".split("_"),weekdaysShort:"ned._pon._tor._sre._čet._pet._sob.".split("_"),weekdaysMin:"ne_po_to_sr_če_pe_so".split("_"),longDateFormat:{LT:"H:mm",L:"DD. MM. YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY LT",LLLL:"dddd, D. MMMM YYYY LT"},calendar:{sameDay:"[danes ob] LT",nextDay:"[jutri ob] LT",nextWeek:function(){switch(this.day()){case 0:return"[v] [nedeljo] [ob] LT";case 3:return"[v] [sredo] [ob] LT";case 6:return"[v] [soboto] [ob] LT";case 1:case 2:case 4:case 5:return"[v] dddd [ob] LT"}},lastDay:"[včeraj ob] LT",lastWeek:function(){switch(this.day()){case 0:case 3:case 6:return"[prejšnja] dddd [ob] LT";case 1:case 2:case 4:case 5:return"[prejšnji] dddd [ob] LT"}},sameElse:"L"},relativeTime:{future:"čez %s",past:"%s nazaj",s:"nekaj sekund",m:b,mm:b,h:b,hh:b,d:"en dan",dd:b,M:"en mesec",MM:b,y:"eno leto",yy:b},ordinal:"%d.",week:{dow:1,doy:7}})}),function(a){a(cb)}(function(a){return a.lang("sq",{months:"Janar_Shkurt_Mars_Prill_Maj_Qershor_Korrik_Gusht_Shtator_Tetor_Nëntor_Dhjetor".split("_"),monthsShort:"Jan_Shk_Mar_Pri_Maj_Qer_Kor_Gus_Sht_Tet_Nën_Dhj".split("_"),weekdays:"E Diel_E Hënë_E Marte_E Mërkure_E Enjte_E Premte_E Shtunë".split("_"),weekdaysShort:"Die_Hën_Mar_Mër_Enj_Pre_Sht".split("_"),weekdaysMin:"D_H_Ma_Më_E_P_Sh".split("_"),longDateFormat:{LT:"HH:mm",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd, D MMMM YYYY LT"},calendar:{sameDay:"[Sot në] LT",nextDay:"[Neser në] LT",nextWeek:"dddd [në] LT",lastDay:"[Dje në] LT",lastWeek:"dddd [e kaluar në] LT",sameElse:"L"},relativeTime:{future:"në %s",past:"%s me parë",s:"disa sekonda",m:"një minut",mm:"%d minuta",h:"një orë",hh:"%d orë",d:"një ditë",dd:"%d ditë",M:"një muaj",MM:"%d muaj",y:"një vit",yy:"%d vite"},ordinal:"%d.",week:{dow:1,doy:4}})}),function(a){a(cb)}(function(a){return a.lang("sv",{months:"januari_februari_mars_april_maj_juni_juli_augusti_september_oktober_november_december".split("_"),monthsShort:"jan_feb_mar_apr_maj_jun_jul_aug_sep_okt_nov_dec".split("_"),weekdays:"söndag_måndag_tisdag_onsdag_torsdag_fredag_lördag".split("_"),weekdaysShort:"sön_mån_tis_ons_tor_fre_lör".split("_"),weekdaysMin:"sö_må_ti_on_to_fr_lö".split("_"),longDateFormat:{LT:"HH:mm",L:"YYYY-MM-DD",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd D MMMM YYYY LT"},calendar:{sameDay:"[Idag] LT",nextDay:"[Imorgon] LT",lastDay:"[Igår] LT",nextWeek:"dddd LT",lastWeek:"[Förra] dddd[en] LT",sameElse:"L"},relativeTime:{future:"om %s",past:"för %s sedan",s:"några sekunder",m:"en minut",mm:"%d minuter",h:"en timme",hh:"%d timmar",d:"en dag",dd:"%d dagar",M:"en månad",MM:"%d månader",y:"ett år",yy:"%d år"},ordinal:function(a){var b=a%10,c=1===~~(a%100/10)?"e":1===b?"a":2===b?"a":3===b?"e":"e";return a+c},week:{dow:1,doy:4}})}),function(a){a(cb)}(function(a){return a.lang("ta",{months:"ஜனவரி_பிப்ரவரி_மார்ச்_ஏப்ரல்_மே_ஜூன்_ஜூலை_ஆகஸ்ட்_செப்டெம்பர்_அக்டோபர்_நவம்பர்_டிசம்பர்".split("_"),monthsShort:"ஜனவரி_பிப்ரவரி_மார்ச்_ஏப்ரல்_மே_ஜூன்_ஜூலை_ஆகஸ்ட்_செப்டெம்பர்_அக்டோபர்_நவம்பர்_டிசம்பர்".split("_"),weekdays:"ஞாயிற்றுக்கிழமை_திங்கட்கிழமை_செவ்வாய்கிழமை_புதன்கிழமை_வியாழக்கிழமை_வெள்ளிக்கிழமை_சனிக்கிழமை".split("_"),weekdaysShort:"ஞாயிறு_திங்கள்_செவ்வாய்_புதன்_வியாழன்_வெள்ளி_சனி".split("_"),weekdaysMin:"ஞா_தி_செ_பு_வி_வெ_ச".split("_"),longDateFormat:{LT:"HH:mm",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, LT",LLLL:"dddd, D MMMM YYYY, LT"},calendar:{sameDay:"[இன்று] LT",nextDay:"[நாளை] LT",nextWeek:"dddd, LT",lastDay:"[நேற்று] LT",lastWeek:"[கடந்த வாரம்] dddd, LT",sameElse:"L"},relativeTime:{future:"%s இல்",past:"%s முன்",s:"ஒரு சில விநாடிகள்",m:"ஒரு நிமிடம்",mm:"%d நிமிடங்கள்",h:"ஒரு மணி நேரம்",hh:"%d மணி நேரம்",d:"ஒரு நாள்",dd:"%d நாட்கள்",M:"ஒரு மாதம்",MM:"%d மாதங்கள்",y:"ஒரு வருடம்",yy:"%d ஆண்டுகள்"},ordinal:function(a){return a+"வது"},meridiem:function(a){return a>=6&&10>=a?" காலை":a>=10&&14>=a?" நண்பகல்":a>=14&&18>=a?" எற்பாடு":a>=18&&20>=a?" மாலை":a>=20&&24>=a?" இரவு":a>=0&&6>=a?" வைகறை":void 0},week:{dow:0,doy:6}})}),function(a){a(cb)}(function(a){return a.lang("th",{months:"มกราคม_กุมภาพันธ์_มีนาคม_เมษายน_พฤษภาคม_มิถุนายน_กรกฎาคม_สิงหาคม_กันยายน_ตุลาคม_พฤศจิกายน_ธันวาคม".split("_"),monthsShort:"มกรา_กุมภา_มีนา_เมษา_พฤษภา_มิถุนา_กรกฎา_สิงหา_กันยา_ตุลา_พฤศจิกา_ธันวา".split("_"),weekdays:"อาทิตย์_จันทร์_อังคาร_พุธ_พฤหัสบดี_ศุกร์_เสาร์".split("_"),weekdaysShort:"อาทิตย์_จันทร์_อังคาร_พุธ_พฤหัส_ศุกร์_เสาร์".split("_"),weekdaysMin:"อา._จ._อ._พ._พฤ._ศ._ส.".split("_"),longDateFormat:{LT:"H นาฬิกา m นาที",L:"YYYY/MM/DD",LL:"D MMMM YYYY",LLL:"D MMMM YYYY เวลา LT",LLLL:"วันddddที่ D MMMM YYYY เวลา LT"},meridiem:function(a){return 12>a?"ก่อนเที่ยง":"หลังเที่ยง"},calendar:{sameDay:"[วันนี้ เวลา] LT",nextDay:"[พรุ่งนี้ เวลา] LT",nextWeek:"dddd[หน้า เวลา] LT",lastDay:"[เมื่อวานนี้ เวลา] LT",lastWeek:"[วัน]dddd[ที่แล้ว เวลา] LT",sameElse:"L"},relativeTime:{future:"อีก %s",past:"%sที่แล้ว",s:"ไม่กี่วินาที",m:"1 นาที",mm:"%d นาที",h:"1 ชั่วโมง",hh:"%d ชั่วโมง",d:"1 วัน",dd:"%d วัน",M:"1 เดือน",MM:"%d เดือน",y:"1 ปี",yy:"%d ปี"}})
}),function(a){a(cb)}(function(a){return a.lang("tl-ph",{months:"Enero_Pebrero_Marso_Abril_Mayo_Hunyo_Hulyo_Agosto_Setyembre_Oktubre_Nobyembre_Disyembre".split("_"),monthsShort:"Ene_Peb_Mar_Abr_May_Hun_Hul_Ago_Set_Okt_Nob_Dis".split("_"),weekdays:"Linggo_Lunes_Martes_Miyerkules_Huwebes_Biyernes_Sabado".split("_"),weekdaysShort:"Lin_Lun_Mar_Miy_Huw_Biy_Sab".split("_"),weekdaysMin:"Li_Lu_Ma_Mi_Hu_Bi_Sab".split("_"),longDateFormat:{LT:"HH:mm",L:"MM/D/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY LT",LLLL:"dddd, MMMM DD, YYYY LT"},calendar:{sameDay:"[Ngayon sa] LT",nextDay:"[Bukas sa] LT",nextWeek:"dddd [sa] LT",lastDay:"[Kahapon sa] LT",lastWeek:"dddd [huling linggo] LT",sameElse:"L"},relativeTime:{future:"sa loob ng %s",past:"%s ang nakalipas",s:"ilang segundo",m:"isang minuto",mm:"%d minuto",h:"isang oras",hh:"%d oras",d:"isang araw",dd:"%d araw",M:"isang buwan",MM:"%d buwan",y:"isang taon",yy:"%d taon"},ordinal:function(a){return a},week:{dow:1,doy:4}})}),function(a){a(cb)}(function(a){var b={1:"'inci",5:"'inci",8:"'inci",70:"'inci",80:"'inci",2:"'nci",7:"'nci",20:"'nci",50:"'nci",3:"'üncü",4:"'üncü",100:"'üncü",6:"'ncı",9:"'uncu",10:"'uncu",30:"'uncu",60:"'ıncı",90:"'ıncı"};return a.lang("tr",{months:"Ocak_Şubat_Mart_Nisan_Mayıs_Haziran_Temmuz_Ağustos_Eylül_Ekim_Kasım_Aralık".split("_"),monthsShort:"Oca_Şub_Mar_Nis_May_Haz_Tem_Ağu_Eyl_Eki_Kas_Ara".split("_"),weekdays:"Pazar_Pazartesi_Salı_Çarşamba_Perşembe_Cuma_Cumartesi".split("_"),weekdaysShort:"Paz_Pts_Sal_Çar_Per_Cum_Cts".split("_"),weekdaysMin:"Pz_Pt_Sa_Ça_Pe_Cu_Ct".split("_"),longDateFormat:{LT:"HH:mm",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd, D MMMM YYYY LT"},calendar:{sameDay:"[bugün saat] LT",nextDay:"[yarın saat] LT",nextWeek:"[haftaya] dddd [saat] LT",lastDay:"[dün] LT",lastWeek:"[geçen hafta] dddd [saat] LT",sameElse:"L"},relativeTime:{future:"%s sonra",past:"%s önce",s:"birkaç saniye",m:"bir dakika",mm:"%d dakika",h:"bir saat",hh:"%d saat",d:"bir gün",dd:"%d gün",M:"bir ay",MM:"%d ay",y:"bir yıl",yy:"%d yıl"},ordinal:function(a){if(0===a)return a+"'ıncı";var c=a%10,d=a%100-c,e=a>=100?100:null;return a+(b[c]||b[d]||b[e])},week:{dow:1,doy:7}})}),function(a){a(cb)}(function(a){return a.lang("tzm-la",{months:"innayr_brˤayrˤ_marˤsˤ_ibrir_mayyw_ywnyw_ywlywz_ɣwšt_šwtanbir_ktˤwbrˤ_nwwanbir_dwjnbir".split("_"),monthsShort:"innayr_brˤayrˤ_marˤsˤ_ibrir_mayyw_ywnyw_ywlywz_ɣwšt_šwtanbir_ktˤwbrˤ_nwwanbir_dwjnbir".split("_"),weekdays:"asamas_aynas_asinas_akras_akwas_asimwas_asiḍyas".split("_"),weekdaysShort:"asamas_aynas_asinas_akras_akwas_asimwas_asiḍyas".split("_"),weekdaysMin:"asamas_aynas_asinas_akras_akwas_asimwas_asiḍyas".split("_"),longDateFormat:{LT:"HH:mm",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd D MMMM YYYY LT"},calendar:{sameDay:"[asdkh g] LT",nextDay:"[aska g] LT",nextWeek:"dddd [g] LT",lastDay:"[assant g] LT",lastWeek:"dddd [g] LT",sameElse:"L"},relativeTime:{future:"dadkh s yan %s",past:"yan %s",s:"imik",m:"minuḍ",mm:"%d minuḍ",h:"saɛa",hh:"%d tassaɛin",d:"ass",dd:"%d ossan",M:"ayowr",MM:"%d iyyirn",y:"asgas",yy:"%d isgasn"},week:{dow:6,doy:12}})}),function(a){a(cb)}(function(a){return a.lang("tzm",{months:"ⵉⵏⵏⴰⵢⵔ_ⴱⵕⴰⵢⵕ_ⵎⴰⵕⵚ_ⵉⴱⵔⵉⵔ_ⵎⴰⵢⵢⵓ_ⵢⵓⵏⵢⵓ_ⵢⵓⵍⵢⵓⵣ_ⵖⵓⵛⵜ_ⵛⵓⵜⴰⵏⴱⵉⵔ_ⴽⵟⵓⴱⵕ_ⵏⵓⵡⴰⵏⴱⵉⵔ_ⴷⵓⵊⵏⴱⵉⵔ".split("_"),monthsShort:"ⵉⵏⵏⴰⵢⵔ_ⴱⵕⴰⵢⵕ_ⵎⴰⵕⵚ_ⵉⴱⵔⵉⵔ_ⵎⴰⵢⵢⵓ_ⵢⵓⵏⵢⵓ_ⵢⵓⵍⵢⵓⵣ_ⵖⵓⵛⵜ_ⵛⵓⵜⴰⵏⴱⵉⵔ_ⴽⵟⵓⴱⵕ_ⵏⵓⵡⴰⵏⴱⵉⵔ_ⴷⵓⵊⵏⴱⵉⵔ".split("_"),weekdays:"ⴰⵙⴰⵎⴰⵙ_ⴰⵢⵏⴰⵙ_ⴰⵙⵉⵏⴰⵙ_ⴰⴽⵔⴰⵙ_ⴰⴽⵡⴰⵙ_ⴰⵙⵉⵎⵡⴰⵙ_ⴰⵙⵉⴹⵢⴰⵙ".split("_"),weekdaysShort:"ⴰⵙⴰⵎⴰⵙ_ⴰⵢⵏⴰⵙ_ⴰⵙⵉⵏⴰⵙ_ⴰⴽⵔⴰⵙ_ⴰⴽⵡⴰⵙ_ⴰⵙⵉⵎⵡⴰⵙ_ⴰⵙⵉⴹⵢⴰⵙ".split("_"),weekdaysMin:"ⴰⵙⴰⵎⴰⵙ_ⴰⵢⵏⴰⵙ_ⴰⵙⵉⵏⴰⵙ_ⴰⴽⵔⴰⵙ_ⴰⴽⵡⴰⵙ_ⴰⵙⵉⵎⵡⴰⵙ_ⴰⵙⵉⴹⵢⴰⵙ".split("_"),longDateFormat:{LT:"HH:mm",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd D MMMM YYYY LT"},calendar:{sameDay:"[ⴰⵙⴷⵅ ⴴ] LT",nextDay:"[ⴰⵙⴽⴰ ⴴ] LT",nextWeek:"dddd [ⴴ] LT",lastDay:"[ⴰⵚⴰⵏⵜ ⴴ] LT",lastWeek:"dddd [ⴴ] LT",sameElse:"L"},relativeTime:{future:"ⴷⴰⴷⵅ ⵙ ⵢⴰⵏ %s",past:"ⵢⴰⵏ %s",s:"ⵉⵎⵉⴽ",m:"ⵎⵉⵏⵓⴺ",mm:"%d ⵎⵉⵏⵓⴺ",h:"ⵙⴰⵄⴰ",hh:"%d ⵜⴰⵙⵙⴰⵄⵉⵏ",d:"ⴰⵙⵙ",dd:"%d oⵙⵙⴰⵏ",M:"ⴰⵢoⵓⵔ",MM:"%d ⵉⵢⵢⵉⵔⵏ",y:"ⴰⵙⴳⴰⵙ",yy:"%d ⵉⵙⴳⴰⵙⵏ"},week:{dow:6,doy:12}})}),function(a){a(cb)}(function(a){function b(a,b){var c=a.split("_");return b%10===1&&b%100!==11?c[0]:b%10>=2&&4>=b%10&&(10>b%100||b%100>=20)?c[1]:c[2]}function c(a,c,d){var e={mm:"хвилина_хвилини_хвилин",hh:"година_години_годин",dd:"день_дні_днів",MM:"місяць_місяці_місяців",yy:"рік_роки_років"};return"m"===d?c?"хвилина":"хвилину":"h"===d?c?"година":"годину":a+" "+b(e[d],+a)}function d(a,b){var c={nominative:"січень_лютий_березень_квітень_травень_червень_липень_серпень_вересень_жовтень_листопад_грудень".split("_"),accusative:"січня_лютого_березня_квітня_травня_червня_липня_серпня_вересня_жовтня_листопада_грудня".split("_")},d=/D[oD]? *MMMM?/.test(b)?"accusative":"nominative";return c[d][a.month()]}function e(a,b){var c={nominative:"неділя_понеділок_вівторок_середа_четвер_п’ятниця_субота".split("_"),accusative:"неділю_понеділок_вівторок_середу_четвер_п’ятницю_суботу".split("_"),genitive:"неділі_понеділка_вівторка_середи_четверга_п’ятниці_суботи".split("_")},d=/(\[[ВвУу]\]) ?dddd/.test(b)?"accusative":/\[?(?:минулої|наступної)? ?\] ?dddd/.test(b)?"genitive":"nominative";return c[d][a.day()]}function f(a){return function(){return a+"о"+(11===this.hours()?"б":"")+"] LT"}}return a.lang("uk",{months:d,monthsShort:"січ_лют_бер_квіт_трав_черв_лип_серп_вер_жовт_лист_груд".split("_"),weekdays:e,weekdaysShort:"нд_пн_вт_ср_чт_пт_сб".split("_"),weekdaysMin:"нд_пн_вт_ср_чт_пт_сб".split("_"),longDateFormat:{LT:"HH:mm",L:"DD.MM.YYYY",LL:"D MMMM YYYY р.",LLL:"D MMMM YYYY р., LT",LLLL:"dddd, D MMMM YYYY р., LT"},calendar:{sameDay:f("[Сьогодні "),nextDay:f("[Завтра "),lastDay:f("[Вчора "),nextWeek:f("[У] dddd ["),lastWeek:function(){switch(this.day()){case 0:case 3:case 5:case 6:return f("[Минулої] dddd [").call(this);case 1:case 2:case 4:return f("[Минулого] dddd [").call(this)}},sameElse:"L"},relativeTime:{future:"за %s",past:"%s тому",s:"декілька секунд",m:c,mm:c,h:"годину",hh:c,d:"день",dd:c,M:"місяць",MM:c,y:"рік",yy:c},meridiem:function(a){return 4>a?"ночі":12>a?"ранку":17>a?"дня":"вечора"},ordinal:function(a,b){switch(b){case"M":case"d":case"DDD":case"w":case"W":return a+"-й";case"D":return a+"-го";default:return a}},week:{dow:1,doy:7}})}),function(a){a(cb)}(function(a){return a.lang("uz",{months:"январь_февраль_март_апрель_май_июнь_июль_август_сентябрь_октябрь_ноябрь_декабрь".split("_"),monthsShort:"янв_фев_мар_апр_май_июн_июл_авг_сен_окт_ноя_дек".split("_"),weekdays:"Якшанба_Душанба_Сешанба_Чоршанба_Пайшанба_Жума_Шанба".split("_"),weekdaysShort:"Якш_Душ_Сеш_Чор_Пай_Жум_Шан".split("_"),weekdaysMin:"Як_Ду_Се_Чо_Па_Жу_Ша".split("_"),longDateFormat:{LT:"HH:mm",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"D MMMM YYYY, dddd LT"},calendar:{sameDay:"[Бугун соат] LT [да]",nextDay:"[Эртага] LT [да]",nextWeek:"dddd [куни соат] LT [да]",lastDay:"[Кеча соат] LT [да]",lastWeek:"[Утган] dddd [куни соат] LT [да]",sameElse:"L"},relativeTime:{future:"Якин %s ичида",past:"Бир неча %s олдин",s:"фурсат",m:"бир дакика",mm:"%d дакика",h:"бир соат",hh:"%d соат",d:"бир кун",dd:"%d кун",M:"бир ой",MM:"%d ой",y:"бир йил",yy:"%d йил"},week:{dow:1,doy:7}})}),function(a){a(cb)}(function(a){return a.lang("vn",{months:"tháng 1_tháng 2_tháng 3_tháng 4_tháng 5_tháng 6_tháng 7_tháng 8_tháng 9_tháng 10_tháng 11_tháng 12".split("_"),monthsShort:"Th01_Th02_Th03_Th04_Th05_Th06_Th07_Th08_Th09_Th10_Th11_Th12".split("_"),weekdays:"chủ nhật_thứ hai_thứ ba_thứ tư_thứ năm_thứ sáu_thứ bảy".split("_"),weekdaysShort:"CN_T2_T3_T4_T5_T6_T7".split("_"),weekdaysMin:"CN_T2_T3_T4_T5_T6_T7".split("_"),longDateFormat:{LT:"HH:mm",L:"DD/MM/YYYY",LL:"D MMMM [năm] YYYY",LLL:"D MMMM [năm] YYYY LT",LLLL:"dddd, D MMMM [năm] YYYY LT",l:"DD/M/YYYY",ll:"D MMM YYYY",lll:"D MMM YYYY LT",llll:"ddd, D MMM YYYY LT"},calendar:{sameDay:"[Hôm nay lúc] LT",nextDay:"[Ngày mai lúc] LT",nextWeek:"dddd [tuần tới lúc] LT",lastDay:"[Hôm qua lúc] LT",lastWeek:"dddd [tuần rồi lúc] LT",sameElse:"L"},relativeTime:{future:"%s tới",past:"%s trước",s:"vài giây",m:"một phút",mm:"%d phút",h:"một giờ",hh:"%d giờ",d:"một ngày",dd:"%d ngày",M:"một tháng",MM:"%d tháng",y:"một năm",yy:"%d năm"},ordinal:function(a){return a},week:{dow:1,doy:4}})}),function(a){a(cb)}(function(a){return a.lang("zh-cn",{months:"一月_二月_三月_四月_五月_六月_七月_八月_九月_十月_十一月_十二月".split("_"),monthsShort:"1月_2月_3月_4月_5月_6月_7月_8月_9月_10月_11月_12月".split("_"),weekdays:"星期日_星期一_星期二_星期三_星期四_星期五_星期六".split("_"),weekdaysShort:"周日_周一_周二_周三_周四_周五_周六".split("_"),weekdaysMin:"日_一_二_三_四_五_六".split("_"),longDateFormat:{LT:"Ah点mm",L:"YYYY-MM-DD",LL:"YYYY年MMMD日",LLL:"YYYY年MMMD日LT",LLLL:"YYYY年MMMD日ddddLT",l:"YYYY-MM-DD",ll:"YYYY年MMMD日",lll:"YYYY年MMMD日LT",llll:"YYYY年MMMD日ddddLT"},meridiem:function(a,b){var c=100*a+b;return 600>c?"凌晨":900>c?"早上":1130>c?"上午":1230>c?"中午":1800>c?"下午":"晚上"},calendar:{sameDay:function(){return 0===this.minutes()?"[今天]Ah[点整]":"[今天]LT"},nextDay:function(){return 0===this.minutes()?"[明天]Ah[点整]":"[明天]LT"},lastDay:function(){return 0===this.minutes()?"[昨天]Ah[点整]":"[昨天]LT"},nextWeek:function(){var b,c;return b=a().startOf("week"),c=this.unix()-b.unix()>=604800?"[下]":"[本]",0===this.minutes()?c+"dddAh点整":c+"dddAh点mm"},lastWeek:function(){var b,c;return b=a().startOf("week"),c=this.unix()<b.unix()?"[上]":"[本]",0===this.minutes()?c+"dddAh点整":c+"dddAh点mm"},sameElse:"LL"},ordinal:function(a,b){switch(b){case"d":case"D":case"DDD":return a+"日";case"M":return a+"月";case"w":case"W":return a+"周";default:return a}},relativeTime:{future:"%s内",past:"%s前",s:"几秒",m:"1分钟",mm:"%d分钟",h:"1小时",hh:"%d小时",d:"1天",dd:"%d天",M:"1个月",MM:"%d个月",y:"1年",yy:"%d年"},week:{dow:1,doy:4}})}),function(a){a(cb)}(function(a){return a.lang("zh-tw",{months:"一月_二月_三月_四月_五月_六月_七月_八月_九月_十月_十一月_十二月".split("_"),monthsShort:"1月_2月_3月_4月_5月_6月_7月_8月_9月_10月_11月_12月".split("_"),weekdays:"星期日_星期一_星期二_星期三_星期四_星期五_星期六".split("_"),weekdaysShort:"週日_週一_週二_週三_週四_週五_週六".split("_"),weekdaysMin:"日_一_二_三_四_五_六".split("_"),longDateFormat:{LT:"Ah點mm",L:"YYYY年MMMD日",LL:"YYYY年MMMD日",LLL:"YYYY年MMMD日LT",LLLL:"YYYY年MMMD日ddddLT",l:"YYYY年MMMD日",ll:"YYYY年MMMD日",lll:"YYYY年MMMD日LT",llll:"YYYY年MMMD日ddddLT"},meridiem:function(a,b){var c=100*a+b;return 900>c?"早上":1130>c?"上午":1230>c?"中午":1800>c?"下午":"晚上"},calendar:{sameDay:"[今天]LT",nextDay:"[明天]LT",nextWeek:"[下]ddddLT",lastDay:"[昨天]LT",lastWeek:"[上]ddddLT",sameElse:"L"},ordinal:function(a,b){switch(b){case"d":case"D":case"DDD":return a+"日";case"M":return a+"月";case"w":case"W":return a+"週";default:return a}},relativeTime:{future:"%s內",past:"%s前",s:"幾秒",m:"一分鐘",mm:"%d分鐘",h:"一小時",hh:"%d小時",d:"一天",dd:"%d天",M:"一個月",MM:"%d個月",y:"一年",yy:"%d年"}})}),cb.lang("en"),bb()}).call(this);

//SCRIPT: ../../vendor-mod/js/swiper-1.9.3.js
/*
 * Swiper 1.9.3 - Mobile Touch Slider
 * http://www.idangero.us/sliders/swiper/
 *
 * Copyright 2012-2013, Vladimir Kharlampidi
 * The iDangero.us
 * http://www.idangero.us/
 *
 * Licensed under GPL & MIT
 *
 * Updated on: April 30, 2013
 *
 * Modified by Velti:
 * Chris Bishop -- Fixed slidesPerSlide issue
 * Gabriel Aszalos -- Fixed issue in Firefox where HTML inside templates was URI encoded (with this comes jQuery dependency)
 * Keve Kutner -- Fixed null or not an object issue when trying to use getPropertyValue() in line 1499
 *
*/
var Swiper = function (selector, params, callback) {
    /*=========================
      A little bit dirty but required part for IE8 and old FF support
      ===========================*/
    if (!window.addEventListener) {
        if (!window.Element)
            Element = function () { };
    
        Element.prototype.addEventListener = HTMLDocument.prototype.addEventListener = addEventListener = function (type, listener, useCapture) { this.attachEvent('on' + type, listener); }
        Element.prototype.removeEventListener = HTMLDocument.prototype.removeEventListener = removeEventListener = function (type, listener, useCapture) { this.detachEvent('on' + type, listener); }
    }
    
    if (document.body.__defineGetter__) {
        if (HTMLElement) {
            var element = HTMLElement.prototype;
            if (element.__defineGetter__)
                element.__defineGetter__("outerHTML", function () { return new XMLSerializer().serializeToString(this); } );
        }
    }
    
    if (!window.getComputedStyle) {
        window.getComputedStyle = function (el, pseudo) {
            this.el = el;
            this.getPropertyValue = function (prop) {
                var re = /(\-([a-z]){1})/g;
                if (prop == 'float') prop = 'styleFloat';
                if (re.test(prop)) {
                    prop = prop.replace(re, function () {
                        return arguments[2].toUpperCase();
                    });
                }
                return el.currentStyle[prop] ? el.currentStyle[prop] : null;
            }
            return this;
        }
    }

    // #master-music-playlist-swiper.widget.swiper-container.ds-wapplet.ds-element #master-music-playlist-swiper

        
    /* End Of Polyfills*/
    if(!(selector.nodeType))
        if (!document.querySelectorAll||document.querySelectorAll(selector).length==0) return;
    
    function dQ(s) {
        return document.querySelectorAll(s)
    }
    var _this = this

    _this.touches = {};
    _this.positions = {
        current : 0 
    };
    _this.id = (new Date()).getTime();
    _this.container = (selector.nodeType) ? selector : dQ(selector)[0];
    _this.times = {};
    _this.isTouched = false;
    _this.realIndex = 0;
    _this.activeSlide = 0;
    _this.activeIndex = 0;
    _this.previousSlide = null;
    _this.previousIndex = null;
    _this.langDirection = window.getComputedStyle(_this.container, null).getPropertyValue('direction')
    /*=========================
      New Support Object
      ===========================*/
    _this.support = {
        touch : _this.isSupportTouch(),
        threeD : _this.isSupport3D(),
        transitions : _this.isSupportTransitions()    
    }
    //For fallback with older versions
    _this.use3D = _this.support.threeD;
    
    
    /*=========================
      Default Parameters
      ===========================*/
    var defaults = {
        mode : 'horizontal',
        ratio : 1,
        speed : 300,
        freeMode : false,
        freeModeFluid : false,
        slidesPerSlide : 1,
        slidesPerGroup : 1,
        simulateTouch : true,
        followFinger : true,
        shortSwipes : true,
        moveStartThreshold:false,
        autoPlay:false,
        onlyExternal : false,
        createPagination : true,
        pagination : false,
        resistance : true,
        nopeek : false,
        scrollContainer : false,
        preventLinks : true,
        preventClassNoSwiping : true,
        initialSlide: 0,
        keyboardControl: false, 
        mousewheelControl : false,
        resizeEvent : 'auto', //or 'resize' or 'orientationchange'
        useCSS3Transforms : true,
        //Namespace
        slideElement : 'div',
        slideClass : 'swiper-slide',
        wrapperClass : 'swiper-wrapper',
        paginationClass: 'swiper-pagination-switch' ,
        paginationActiveClass : 'swiper-active-switch',
        plugins: {}, 
        resumeAutoPlay: false
    }
    params = params || {};  
    for (var prop in defaults) {
        if (! (prop in params)) {
            params[prop] = defaults[prop]   
        }
    }
    _this.params = params;
    if (params.scrollContainer) {
        params.freeMode = true;
        params.freeModeFluid = true;    
    }
    var _widthFromCSS = false
    if (params.slidesPerSlide=='auto') {
        _widthFromCSS = true;
        params.slidesPerSlide = 1;
    }
    
    //Default Vars
    var wrapper, isHorizontal,
        slideSize, numOfSlides, wrapperSize, direction, isScrolling, containerSize;

    //Define wrapper
    for (var i = _this.container.childNodes.length - 1; i >= 0; i--) {
        
        if (_this.container.childNodes[i].className) {

            var _wrapperClasses = _this.container.childNodes[i].className.split(' ')

            for (var j = 0; j < _wrapperClasses.length; j++) {

                if (_wrapperClasses[j]===params.wrapperClass) {
                    wrapper = _this.container.childNodes[i]
                }
            };
        }
    };

    _this.wrapper = wrapper;
    //Mode
    isHorizontal = params.mode == 'horizontal';
        
    //Define Touch Events
    _this.touchEvents = {
        touchStart : _this.support.touch || !params.simulateTouch  ? 'touchstart' : (_this.ie10 ? 'MSPointerDown' : 'mousedown'),
        touchMove : _this.support.touch || !params.simulateTouch ? 'touchmove' : (_this.ie10 ? 'MSPointerMove' : 'mousemove'),
        touchEnd : _this.support.touch || !params.simulateTouch ? 'touchend' : (_this.ie10 ? 'MSPointerUp' : 'mouseup')
    };

    /*=========================
      Slide API
      ===========================*/
    _this._extendSwiperSlide = function  (el) {
        el.append = function () {
            _this.wrapper.appendChild(el);
            _this.reInit();
            return el;
        }
        el.prepend = function () {
            _this.wrapper.insertBefore(el, _this.wrapper.firstChild)
            _this.reInit();
            return el;
        }
        el.insertAfter = function (index) {
            if(typeof index === 'undefined') return false;
            var beforeSlide = _this.slides[index+1]
            _this.wrapper.insertBefore(el, beforeSlide)
            _this.reInit();
            return el;
        }
        el.clone = function () {
            return _this._extendSwiperSlide(el.cloneNode(true))
        }
        el.remove = function () {
            _this.wrapper.removeChild(el);
            _this.reInit()
        }
        el.html = function (html) {
            if (typeof html === 'undefined') {
                return el.innerHTML
            }
            else {
                el.innerHTML = html;
                return el;
            }
        }
        el.index = function () {
            var index
            for (var i = _this.slides.length - 1; i >= 0; i--) {
                if(el==_this.slides[i]) index = i
            };
            return index;
        }
        el.isActive = function () {
            if (el.index() == _this.activeIndex) return true;
            else return false;
        }
        if (!el.swiperSlideDataStorage) el.swiperSlideDataStorage={};
        el.getData = function (name) {
            return el.swiperSlideDataStorage[name]
        }
        el.setData = function (name, value) {
            el.swiperSlideDataStorage[name] = value;
            return el;
        }
        el.data = function (name, value) {
            if (!value) {
                return el.getAttribute('data-'+name);
            }
            else {
                el.setAttribute('data-'+name,value);
                return el;
            }
        }
        return el;
    }

    //Calculate information about slides
    _this._calcSlides = function () {

        var oldNumber = _this.slides ? _this.slides.length : false;
        _this.slides = []

        for (var i = 0; i < _this.wrapper.childNodes.length; i++) {
            if (_this.wrapper.childNodes[i].className) {
                var _slideClasses = _this.wrapper.childNodes[i].className.split(' ')
                for (var j = 0; j < _slideClasses.length; j++) {
                    //this is looking for the immediate child nodes of the swiper as the slides disappear in mobile widths
                    if(_slideClasses[j]===params.slideClass || _slideClasses[j]==='qfa-grid') _this.slides.push(_this.wrapper.childNodes[i])
                };
            } 
        };
        for (var i = _this.slides.length - 1; i >= 0; i--) {
            _this._extendSwiperSlide(_this.slides[i]);
        };
        if (!oldNumber) return;
        if(oldNumber!=_this.slides.length && _this.createPagination) {
            // Number of slides has been changed
            _this.createPagination();
            _this.callPlugins('numberOfSlidesChanged')
        }
        /*
        if (_this.langDirection=='rtl') {
            for (var i = 0; i < _this.slides.length; i++) {
                _this.slides[i].style.float="right"
            };
        }
        */
    }
    _this._calcSlides();

    //Create Slide
    _this.createSlide = function (html, slideClassList, el) {
        var slideClassList = slideClassList || _this.params.slideClass;
        var el = el||params.slideElement;
        var newSlide = document.createElement(el)
        newSlide.innerHTML = html||'';
        newSlide.className = slideClassList;
        return _this._extendSwiperSlide(newSlide);
    }

    //Append Slide  
    _this.appendSlide = function (html, slideClassList, el) {
        if (!html) return;
        if (html.nodeType) {
            return _this._extendSwiperSlide(html).append()
        }
        else {
            return _this.createSlide(html, slideClassList, el).append()
        }
    }
    _this.prependSlide = function (html, slideClassList, el) {
        if (!html) return;
        if (html.nodeType) {
            return _this._extendSwiperSlide(html).prepend()
        }
        else {
            return _this.createSlide(html, slideClassList, el).prepend()
        }
    }
    _this.insertSlideAfter = function (index, html, slideClassList, el) {
        if (!index) return false;
        if (html.nodeType) {
            return _this._extendSwiperSlide(html).insertAfter(index)
        }
        else {
            return _this.createSlide(html, slideClassList, el).insertAfter(index)
        }
    }
    _this.removeSlide = function (index) {
        if (_this.slides[index]) {
            _this.slides[index].remove()
            return true;
        }
        else return false;
    }
    _this.removeLastSlide = function () {
        if (_this.slides.length>0) {
            _this.slides[ (_this.slides.length-1) ].remove();
            return true
        }
        else {
            return false
        }
    }
    _this.removeAllSlides = function () {
        for (var i = _this.slides.length - 1; i >= 0; i--) {
            _this.slides[i].remove()
        };
    }
    _this.getSlide = function (index) {
        return _this.slides[index]
    }
    _this.getLastSlide = function () {
        return _this.slides[ _this.slides.length-1 ]
    }
    _this.getFirstSlide = function () {
        return _this.slides[0]
    }

    //Currently Active Slide
    _this.currentSlide = function () {
        return _this.slides[_this.activeIndex]
    }
    
    /*=========================
      Find All Plugins
      !!! Plugins API is in beta !!!
      ===========================*/
    var _plugins = [];
    for (var plugin in params.plugins) {
        if (params[plugin]) {
            var p = params.plugins[plugin](_this, params[plugin])
            if (p)
                _plugins.push( p )  
        }
    }
    
    _this.callPlugins = function(method, args) {
        if (!args) args = {}
        for (var i=0; i<_plugins.length; i++) {
            if (method in _plugins[i]) {
                _plugins[i][method](args);
            }

        }
        
    }

    /*=========================
      WP8 Fix
      ===========================*/
    if (_this.ie10 && !params.onlyExternal) {
        if (isHorizontal) _this.wrapper.classList.add('swiper-wp8-horizontal')  
        else _this.wrapper.classList.add('swiper-wp8-vertical') 
    }
    
    //Init Function
    var firstInit = false;
    //ReInitizize function. Good to use after dynamically changes of Swiper, like after add/remove slides
	_this.reInit = function () {
        _this.init(true)
    }

    _this.triggerAccesibility = function() {
        var currentSlide = $j(_this.currentSlide());
        
        //if slider is in vertical mode all slides need to be visible, so don't do this bit if vertical
        if(!_this.params.ignoreAria && this.params.mode != "vertical"){

            //Set all slides hidden from screenreaders
            $j(_this.wrapper.childNodes).attr('aria-hidden', 'true');
            //Set current slide to be visible to screenreaders      
            currentSlide.attr('aria-hidden','false').attr('tabindex','-1');
        }

        //if slides per page is set, also make visible the slides that are also on the current page.
        if(_this.params.slidesPerPage){
            var loop;
            for (loop = 1; loop < _this.params.slidesPerPage; loop++){
                _this.slides[_this.activeIndex+loop].setAttribute('aria-hidden','false');          
            }
        }
        
        if (!_this.params.ignoreAria) {
          //Focus screenreader on first .aria-focus element, or first visible header within active slide
          var focusElement = currentSlide.find('.aria-focus').length > 0 ? currentSlide.find('.aria-focus').first().attr('tabindex','-1') : currentSlide.find(':header').find(':visible').first().attr('tabindex','-1');

          focusElement.focus();
        }
    }

    _this.init = function(reInit) {
        var _width = window.getComputedStyle(_this.container, null).getPropertyValue('width')
        var _height = window.getComputedStyle(_this.container, null).getPropertyValue('height')
        var newWidth = parseInt(_width,10);
        var newHeight  = parseInt(_height,10);
        
        if(!_this.params.ignoreAria && this.params.mode != "vertical"){ //if slider is in vertical mode all slides need to be visible, so don't do this bit if vertical
            //Set all slides hidden from screenreaders
            $j(_this.wrapper.childNodes).attr('aria-hidden', 'true');
        }
        //IE8 Fixes
        if(isNaN(newWidth) || _width.indexOf('%')>0) {
            newWidth = _this.container.offsetWidth - parseInt(window.getComputedStyle(_this.container, null).getPropertyValue('padding-left'),10) - parseInt(window.getComputedStyle(_this.container, null).getPropertyValue('padding-right'),10) 
        }
        if(isNaN(newHeight) || _height.indexOf('%')>0) {
            newHeight = _this.container.offsetHeight - parseInt(window.getComputedStyle(_this.container, null).getPropertyValue('padding-top'),10) - parseInt(window.getComputedStyle(_this.container, null).getPropertyValue('padding-bottom'),10)         
        }
        if (!reInit) {
            if (_this.width==newWidth && _this.height==newHeight) return            
        }
        if (reInit || firstInit) {
            _this._calcSlides();
            if (params.pagination) {
                _this.updatePagination()
            }
        }
		
		/*=========================
		  Loop
		  ===========================*/
		if (params.loop && !firstInit) {
			//(function(){
				numOfSlides = _this.slides.length;
				if (_this.slides.length==0) return;
				var slideFirstHTML = '';
				var slideLastHTML = '';
				//Grab First Slides
				for (var i=0; i<params.slidesPerSlide; i++) {
					slideFirstHTML+=jQuery(_this.slides[i]).clone().wrap('<p>').parent().html()
				}
				//Grab Last Slides
				for (var i=numOfSlides-params.slidesPerSlide; i<numOfSlides; i++) {
					slideLastHTML+=jQuery(_this.slides[i]).clone().wrap('<p>').parent().html()
				}
                jQuery(slideLastHTML).prependTo(wrapper);
                jQuery(wrapper).append(slideFirstHTML);
				//wrapper.innerHTML = slideLastHTML + wrapper.innerHTML + slideFirstHTML;
				_this._calcSlides()
				_this.callPlugins('onCreateLoop');
			//})();
		}
        _this.width  = newWidth;
        _this.height  = newHeight;
        
        var dividerVertical = isHorizontal ? 1 : params.slidesPerSlide,
            dividerHorizontal = isHorizontal ? params.slidesPerSlide : 1,
            slideWidth, slideHeight, wrapperWidth, wrapperHeight;

        numOfSlides = _this.slides.length
        if (!params.scrollContainer) {
            if (!_widthFromCSS) {
                slideWidth = _this.width/dividerHorizontal;
                slideHeight = _this.height/dividerVertical; 
            }
            else { 
                slideWidth = _this.slides[0].offsetWidth;
                slideHeight = _this.slides[0].offsetHeight;
            }
            containerSize = isHorizontal ? _this.width : _this.height;
            slideSize = isHorizontal ? slideWidth : slideHeight;
            wrapperWidth = isHorizontal ? numOfSlides * slideWidth : _this.width;
            wrapperHeight = isHorizontal ? _this.height : numOfSlides*slideHeight;
            if (_widthFromCSS) {
                //Re-Calc sps for pagination
                params.slidesPerSlide = Math.round(containerSize/slideSize)
            }
        }
        else {
            //Unset dimensions in vertical scroll container mode to recalculate slides
            if (!isHorizontal) {
                wrapper.style.width='';
                wrapper.style.height='';
                _this.slides[0].style.width='';
                _this.slides[0].style.height='';
            }
            
            slideWidth = _this.slides[0].offsetWidth;
            slideHeight = _this.slides[0].offsetHeight;
            containerSize = isHorizontal ? _this.width : _this.height;
            
            slideSize = isHorizontal ? slideWidth : slideHeight;
            wrapperWidth = slideWidth;
            wrapperHeight = slideHeight;
        }

        wrapperSize = isHorizontal ? wrapperWidth : wrapperHeight;
    
        for (var i=0; i<_this.slides.length; i++ ) {
            var el = _this.slides[i];
            if (!_widthFromCSS) {
                el.style.width=slideWidth+"px"
                el.style.height=slideHeight+"px"
            }
            if (params.onSlideInitialize) {
                params.onSlideInitialize(_this, el);
            }
        }
        if(!params.cssWrapper){
            wrapper.style.width = wrapperWidth+"px";
            wrapper.style.height = wrapperHeight+"px";
        }
        
        // Set Initial Slide Position
        if(params.initialSlide > 0 && params.initialSlide < numOfSlides && firstInit) {
            _this.realIndex = _this.activeIndex = params.initialSlide;
            
            if (params.loop) {
                _this.activeIndex = _this.realIndex-params.slidesPerSlide;
            }
            //Legacy
            _this.activeSlide = _this.activeIndex;
            //--          
            if (isHorizontal) {
                _this.positions.current = -params.initialSlide * slideWidth;
                _this.setTransform( _this.positions.current, 0, 0);
            }
            else {  
                _this.positions.current = -params.initialSlide * slideHeight;
                _this.setTransform( 0, _this.positions.current, 0);
            }
        }

        //Trigger accessibility
        _this.triggerAccesibility();

        
        if (!firstInit) _this.callPlugins('onFirstInit');
        else _this.callPlugins('onInit');
        firstInit = true;
    };

    _this.fixLinks = function(){

        if (params.preventLinks) {

            var links = _this.container.querySelectorAll('a')
            for (var i=0; i<links.length; i++) {
                links[i].addEventListener('click', preventClick, false) 
            }
        }
    }

    _this.init()

    
    
    //Get Max And Min Positions
    function maxPos() {
        var a = (wrapperSize - containerSize);
        if (params.loop) a = a - containerSize; 
        if (params.scrollContainer) {
            a = slideSize - containerSize;
            if (a<0) a = 0;
        }
        if (params.slidesPerSlide > _this.slides.length) a = 0;
        return a;
    }
    function minPos() {
        var a = 0;
        if (params.loop) a = containerSize;
        return a;   
    }
    
    /*=========================
      Pagination
      ===========================*/
    _this.updatePagination = function() {
        if (_this.slides.length<1) return;
        var activeSwitch = dQ(params.pagination+' .'+params.paginationActiveClass)
        if(!activeSwitch) return
        for (var i=0; i < activeSwitch.length; i++) {
            activeSwitch.item(i).className = params.paginationClass
        }
        var pagers = dQ(params.pagination+' .'+params.paginationClass).length;
        var minPagerIndex = (params.loop ? _this.realIndex-params.slidesPerSlide : _this.realIndex) || 0;

        var maxPagerIndex = minPagerIndex + (params.slidesPerSlide-1);
        //temporary fix to stop infinite loop when paramsSlidesPerSlide is inifinty. Caused by slideSize being 0 at line 497.
        if(maxPagerIndex>99999) maxPagerIndex = 6;
        for (var i = minPagerIndex; i <= maxPagerIndex; i++ ) {
            var j = i;
            if (j>=pagers) j=j-pagers;
            if (j<0) j = pagers + j;
            if (j<0) j = 0; //sometime pagers is 0 and j is -1 so need to double check
            if (j<numOfSlides) {
              var item = dQ(params.pagination+' .'+params.paginationClass).item( j );
              
              if (item) {
                item.className = params.paginationClass+' '+params.paginationActiveClass;
              }
            }
            if (i===minPagerIndex) {
              var item = dQ(params.pagination+' .'+params.paginationClass).item( j );
              
              if (item) {
                dQ(params.pagination+' .'+params.paginationClass).item( j ).className+=' swiper-activeslide-switch';
              } else {
                console.warn("Swiper was trying to use nav idicator #" + j + " but we only have " + dQ(params.pagination+' .'+params.paginationClass).length + " indicators.");
              }
            }
        }
    }
    _this.createPagination = function () {
        if (params.pagination && params.createPagination) {
            var paginationHTML = "";
            var numOfSlides = _this.slides.length;
            var numOfButtons = params.loop ? numOfSlides - params.slidesPerSlide*2 : numOfSlides;
            for (var i = 0; i < numOfButtons; i++) {
                paginationHTML += '<span class="'+params.paginationClass+'"></span>'
            }
            dQ(params.pagination)[0].innerHTML = paginationHTML
            _this.updatePagination()
            
            _this.callPlugins('onCreatePagination');
        }   
    }
    _this.createPagination();
    
    
    //Window Resize Re-init
    /*
     * 
     * http://stackoverflow.com/questions/1649086/detect-rotation-of-android-phone-in-the-browser-with-javascript
     * 
     * As described on the table on droid phones "orientationchange" event gets fired earlier than "resize" event 
     * thus blocking the next resize call
     * 
     */
    _this.resizeEvent = params.resizeEvent==='auto' 
        ? ('onorientationchange' in window && !navigator.userAgent.match(/android/i)) ? 'orientationchange' : 'resize'
        : params.resizeEvent

    _this.resizeFix = function(){
        _this.callPlugins('beforeResizeFix');
        _this.init()
        //To fix translate value
        if (!params.scrollContainer) 
            _this.swipeTo(_this.activeIndex, 0, false)
        else {
            var pos = isHorizontal ? _this.getTranslate('x') : _this.getTranslate('y')
            if (pos < -maxPos()) {
                var x = isHorizontal ? -maxPos() : 0;
                var y = isHorizontal ? 0 : -maxPos();
                _this.setTransition(0)
                _this.setTransform(x,y,0)   
            }
        }
        _this.callPlugins('afterResizeFix');
    }
    if (!params.disableAutoResize) {
        //Check for resize event
        window.addEventListener(_this.resizeEvent, _this.resizeFix, false)
    }

    /*========================================== 
        Autoplay 
    ============================================*/

    var autoPlay;
    _this.startAutoPlay = function() {
        if (autoPlay)
            clearInterval(autoPlay);

        if (params.autoPlay && !params.loop) {
            autoPlay = setInterval(function(){
                var newSlide = _this.realIndex + 1
                if ( newSlide == numOfSlides) newSlide = 0 
                _this.swipeTo(newSlide) 
            }, params.autoPlay)
        }
        else if (params.autoPlay && params.loop) {
            autoPlay = setInterval(function(){
                _this.fixLoop();
                _this.swipeNext(true)
            }, params.autoPlay)
        }
        _this.callPlugins('onAutoPlayStart');
    }
    _this.stopAutoPlay = function() {
        if (autoPlay)
            clearInterval(autoPlay)
        _this.callPlugins('onAutoPlayStop');
    }
    if (params.autoPlay) {
        _this.startAutoPlay()
    }
    
    /*========================================== 
        Event Listeners 
    ============================================*/
    
    if (!_this.ie10) {
        if (_this.support.touch) {
            wrapper.addEventListener('touchstart', onTouchStart, false);
            wrapper.addEventListener('touchmove', onTouchMove, false);
            wrapper.addEventListener('touchend', onTouchEnd, false);    
        }
        if (params.simulateTouch) {
            wrapper.addEventListener('mousedown', onTouchStart, false);
            document.addEventListener('mousemove', onTouchMove, false);
            document.addEventListener('mouseup', onTouchEnd, false);
        }
    }
    else {
        wrapper.addEventListener(_this.touchEvents.touchStart, onTouchStart, false);
        document.addEventListener(_this.touchEvents.touchMove, onTouchMove, false);
        document.addEventListener(_this.touchEvents.touchEnd, onTouchEnd, false);
    }
    
    //Remove Events
    _this.destroy = function(removeResizeFix){
        removeResizeFix = removeResizeFix===false ? removeResizeFix : removeResizeFix || true
        if (removeResizeFix) {
            window.removeEventListener(_this.resizeEvent, _this.resizeFix, false);
        }

        if (_this.ie10) {
            wrapper.removeEventListener(_this.touchEvents.touchStart, onTouchStart, false);
            document.removeEventListener(_this.touchEvents.touchMove, onTouchMove, false);
            document.removeEventListener(_this.touchEvents.touchEnd, onTouchEnd, false);
        }
        else {
            if (_this.support.touch) {
                wrapper.removeEventListener('touchstart', onTouchStart, false);
                wrapper.removeEventListener('touchmove', onTouchMove, false);
                wrapper.removeEventListener('touchend', onTouchEnd, false); 
            }
            wrapper.removeEventListener('mousedown', onTouchStart, false);
            document.removeEventListener('mousemove', onTouchMove, false);
            document.removeEventListener('mouseup', onTouchEnd, false);
        }

        if (params.keyboardControl) {
            document.removeEventListener('keydown', handleKeyboardKeys, false);
        }
        if (params.mousewheelControl && _this._wheelEvent) {
            _this.container.removeEventListener(_this._wheelEvent, handleMousewheel, false);
        }
        if (params.autoPlay) {
            _this.stopAutoPlay()
        }
        _this.callPlugins('onDestroy');
    }
    /*=========================
      Prevent Links
      ===========================*/

    _this.allowLinks = true;
    if (params.preventLinks) {
        var links = _this.container.querySelectorAll('a')
        for (var i=0; i<links.length; i++) {
            links[i].addEventListener('click', preventClick, false) 
        }
    }
    function preventClick(e) {

        if (!_this.allowLinks) e.preventDefault();  
    }

    /*========================================== 
        Keyboard Control 
    ============================================*/
    if (params.keyboardControl) {
        function handleKeyboardKeys (e) {
            var kc = e.keyCode || e.charCode;
            if (isHorizontal) {
                if (kc==37 || kc==39) e.preventDefault();
                if (kc == 39) _this.swipeNext()
                if (kc == 37) _this.swipePrev()
            }
            else {
                if (kc==38 || kc==40) e.preventDefault();
                if (kc == 40) _this.swipeNext()
                if (kc == 38) _this.swipePrev()
            }
        }
        document.addEventListener('keydown',handleKeyboardKeys, false);
    }

    /*========================================== 
        Mousewheel Control. Beta! 
    ============================================*/
    // detect available wheel event
    _this._wheelEvent = false;
    
    if (params.mousewheelControl) {
        if ( document.onmousewheel !== undefined ) {
            _this._wheelEvent = "mousewheel"
        }
            try {
                WheelEvent("wheel");
                _this._wheelEvent = "wheel";
            } catch (e) {}
            if ( !_this._wheelEvent ) {
                _this._wheelEvent = "DOMMouseScroll";
            }
        function handleMousewheel (e) {
            if(e.preventDefault) e.preventDefault();
            var we = _this._wheelEvent;
            var delta;
            //Opera & IE
            if (e.detail) delta = -e.detail;
            //WebKits   
            else if (we == 'mousewheel') delta = e.wheelDelta; 
            //Old FireFox
            else if (we == 'DOMMouseScroll') delta = -e.detail;
            //New FireFox
            else if (we == 'wheel') {
                delta = Math.abs(e.deltaX)>Math.abs(e.deltaY) ? - e.deltaX : - e.deltaY;
            }
            if (!params.freeMode) {
                if(delta<0) _this.swipeNext()
                else _this.swipePrev()
            }
            else {
                //Freemode or scrollContainer:
                var currentTransform =isHorizontal ? _this.getTranslate('x') : _this.getTranslate('y')
                var x,y;
                if (isHorizontal) {
                    x = _this.getTranslate('x') + delta;
                    y = _this.getTranslate('y');
                    if (x>0) x = 0;
                    if (x<-maxPos()) x = -maxPos();
                }
                else {
                    x = _this.getTranslate('x');
                    y = _this.getTranslate('y')+delta;
                    if (y>0) y = 0;
                    if (y<-maxPos()) y = -maxPos();
                }
                _this.setTransition(0)
                _this.setTransform(x,y,0)
            }

            if(event.preventDefault) event.preventDefault();
            else event.returnValue = false;
            return false;
        }
        if (_this._wheelEvent) {
            _this.container.addEventListener(_this._wheelEvent, handleMousewheel, false);
        }
    }
    /*=========================
      Grab Cursor
      ===========================*/
    if (params.grabCursor) {
        _this.container.style.cursor = 'move';
        _this.container.style.cursor = 'grab';
        _this.container.style.cursor = '-moz-grab';
        _this.container.style.cursor = '-webkit-grab';
    }  
    /*=========================
      Handle Touches
      ===========================*/
    //Detect event type for devices with both touch and mouse support
    var isTouchEvent = false; 
    var allowThresholdMove; 
    function onTouchStart(event) {

        //Exit if slider is already was touched
        if (_this.isTouched || params.onlyExternal) {
            return false
        }
        if (params.preventClassNoSwiping && event.target && event.target.className.indexOf('NoSwiping') > -1) return false;
        
        //Check For Nested Swipers
        _this.isTouched = true;
        isTouchEvent = event.type=='touchstart';
        if (!isTouchEvent || event.targetTouches.length == 1 ) {
            _this.callPlugins('onTouchStartBegin');
            
            if (params.loop) _this.fixLoop();
            if(!isTouchEvent) {
                if(event.preventDefault) event.preventDefault();
                else event.returnValue = false;
            }
            var pageX = isTouchEvent ? event.targetTouches[0].pageX : (event.pageX || event.clientX)
            var pageY = isTouchEvent ? event.targetTouches[0].pageY : (event.pageY || event.clientY)
            
            //Start Touches to check the scrolling
            _this.touches.startX = _this.touches.currentX = pageX;
            _this.touches.startY = _this.touches.currentY = pageY;
            
            _this.touches.start = _this.touches.current = isHorizontal ? _this.touches.startX : _this.touches.startY ;
            
            //Set Transition Time to 0
            _this.setTransition(0)
            
            //Get Start Translate Position
            _this.positions.start = _this.positions.current = isHorizontal ? _this.getTranslate('x') : _this.getTranslate('y');

            //Set Transform
            if (isHorizontal) {
                _this.setTransform( _this.positions.start, 0, 0)
            }
            else {
                _this.setTransform( 0, _this.positions.start, 0)
            }
            
            //TouchStartTime
            var tst = new Date()
            _this.times.start = tst.getTime()
            
            //Unset Scrolling
            isScrolling = undefined;
            
            //Define Clicked Slide without additional event listeners
            if (params.onSlideClick || params.onSlideTouch) {
                ;(function () {
                    var el = _this.container;
                    var box = el.getBoundingClientRect();
                    var body = document.body;
                    var clientTop  = el.clientTop  || body.clientTop  || 0;
                    var clientLeft = el.clientLeft || body.clientLeft || 0;
                    var scrollTop  = window.pageYOffset || el.scrollTop;
                    var scrollLeft = window.pageXOffset || el.scrollLeft;
                    var x = pageX - box.left + clientLeft - scrollLeft;
                    var y = pageY - box.top - clientTop - scrollTop;
                    var touchOffset = isHorizontal ? x : y; 
                    var beforeSlides = -Math.round(_this.positions.current/slideSize)
                    var realClickedIndex = Math.floor(touchOffset/slideSize) + beforeSlides
                    var clickedIndex = realClickedIndex;
                    if (params.loop) {
                        var clickedIndex = realClickedIndex - params.slidesPerSlide;
                        if (clickedIndex<0) {
                            clickedIndex = _this.slides.length+clickedIndex-(params.slidesPerSlide*2);
                        }

                    }
                    _this.clickedSlideIndex = clickedIndex
                    _this.clickedSlide = _this.getSlide(realClickedIndex);
                    if (params.onSlideTouch) {
                        params.onSlideTouch(_this);
                        _this.callPlugins('onSlideTouch');
                    }
                })();
            }
            //Set Treshold
            if (params.moveStartThreshold>0) allowThresholdMove = false;
            //CallBack
            if (params.onTouchStart) params.onTouchStart(_this)
            _this.callPlugins('onTouchStartEnd');
            
        }
    }
    function onTouchMove(event) {

        // If slider is not touched - exit
        if (!_this.isTouched || params.onlyExternal) return;
        if (isTouchEvent && event.type=='mousemove') return;
        var pageX = isTouchEvent ? event.targetTouches[0].pageX : (event.pageX || event.clientX)
        var pageY = isTouchEvent ? event.targetTouches[0].pageY : (event.pageY || event.clientY)
        //check for scrolling
        if ( typeof isScrolling === 'undefined' && isHorizontal) {
          isScrolling = !!( isScrolling || Math.abs(pageY - _this.touches.startY) > Math.abs( pageX - _this.touches.startX ) )
        }
        if ( typeof isScrolling === 'undefined' && !isHorizontal) {
          isScrolling = !!( isScrolling || Math.abs(pageY - _this.touches.startY) < Math.abs( pageX - _this.touches.startX ) )
        }

        if (isScrolling ) {
            _this.isTouched = false;
            return
        }
        
        //Check For Nested Swipers
        if (event.assignedToSwiper) {
            _this.isTouched = false;
            return
        }
        event.assignedToSwiper = true;  
        
        //Block inner links
        if (params.preventLinks) {
            _this.allowLinks = false;   
        }
        
        //Stop AutoPlay if exist
        if (params.autoPlay) {
            _this.stopAutoPlay()
        }
        if (!isTouchEvent || event.touches.length == 1) {
            
            _this.callPlugins('onTouchMoveStart');

            if(event.preventDefault) event.preventDefault();
            else event.returnValue = false;
            
            _this.touches.current = isHorizontal ? pageX : pageY ;
            
            _this.positions.current = (_this.touches.current - _this.touches.start)*params.ratio + _this.positions.start            
            
            if (params.resistance) {
                //Resistance for Negative-Back sliding
                if(_this.positions.current > 0 && !(params.freeMode&&!params.freeModeFluid)) {
                    
                    if (params.loop) {
                        var resistance = 1;
                        if (_this.positions.current>0) _this.positions.current = 0;
                    }
                    else {
                        var resistance = (containerSize*2-_this.positions.current)/containerSize/2;
                    }
                    if (resistance < 0.5) 
                        _this.positions.current = (containerSize/2)
                    else 
                        _this.positions.current = _this.positions.current * resistance
                        
                    if (params.nopeek)
                        _this.positions.current = 0;
                    
                }
                //Resistance for After-End Sliding
                if ( (_this.positions.current) < -maxPos() && !(params.freeMode&&!params.freeModeFluid)) {
                    
                    if (params.loop) {
                        var resistance = 1;
                        var newPos = _this.positions.current
                        var stopPos = -maxPos() - containerSize
                    }
                    else {
                        
                        var diff = (_this.touches.current - _this.touches.start)*params.ratio + (maxPos()+_this.positions.start)
                        var resistance = (containerSize+diff)/(containerSize);
                        var newPos = _this.positions.current-diff*(1-resistance)/2
                        var stopPos = -maxPos() - containerSize/2;
                    }
                    
                    if (params.nopeek) {
                        newPos = _this.positions.current-diff;
						stopPos = -maxPos();
					}
                    
                    if (newPos < stopPos || resistance<=0)
                        _this.positions.current = stopPos;
                    else 
                        _this.positions.current = newPos
                }
            }
            
            //Move Slides
            if (!params.followFinger) return

            if (!params.moveStartThreshold) {
                if (isHorizontal) _this.setTransform( _this.positions.current, 0, 0)
                else _this.setTransform( 0, _this.positions.current, 0)    
            }
            else {
                if ( Math.abs(_this.touches.current - _this.touches.start)>params.moveStartThreshold || allowThresholdMove) {
                    allowThresholdMove = true;
                    if (isHorizontal) _this.setTransform( _this.positions.current, 0, 0)
                    else _this.setTransform( 0, _this.positions.current, 0)  
                }
                else {
                    _this.positions.current = _this.positions.start
                }
            }    
            
            
            if (params.freeMode) {
                _this.updateActiveSlide(_this.positions.current)
            }

            //Prevent onSlideClick Fallback if slide is moved
            if (params.onSlideClick && _this.clickedSlide) {
                _this.clickedSlide = false
            }

            //Grab Cursor
            if (params.grabCursor) {
                _this.container.style.cursor = 'move';
                _this.container.style.cursor = 'grabbing';
                _this.container.style.cursor = '-moz-grabbin';
                _this.container.style.cursor = '-webkit-grabbing';
            }  

            //Callbacks
            _this.callPlugins('onTouchMoveEnd');
            if (params.onTouchMove) params.onTouchMove(_this)

            return false
        }
    }
    function onTouchEnd(event) {

        //Check For scrolling
        if (isScrolling) _this.swipeReset();
        // If slider is not touched exit
        if ( params.onlyExternal || !_this.isTouched ) return
        _this.isTouched = false

        //Return Grab Cursor
        if (params.grabCursor) {
            _this.container.style.cursor = 'move';
            _this.container.style.cursor = 'grab';
            _this.container.style.cursor = '-moz-grab';
            _this.container.style.cursor = '-webkit-grab';
        } 

        //onSlideClick
        if (params.onSlideClick && _this.clickedSlide) {
            params.onSlideClick(_this);
            _this.callPlugins('onSlideClick')
        }

        //Check for Current Position
        if (!_this.positions.current && _this.positions.current!==0) {
            _this.positions.current = _this.positions.start 
        }
        
        //For case if slider touched but not moved
        if (params.followFinger) {
            if (isHorizontal) _this.setTransform( _this.positions.current, 0, 0)
            else _this.setTransform( 0, _this.positions.current, 0)
        }
        //--
        
        // TouchEndTime
        var tet = new Date()
        _this.times.end = tet.getTime();
        
        //Difference
        _this.touches.diff = _this.touches.current - _this.touches.start        
        _this.touches.abs = Math.abs(_this.touches.diff)
        
        _this.positions.diff = _this.positions.current - _this.positions.start
        _this.positions.abs = Math.abs(_this.positions.diff)
        
        var diff = _this.positions.diff ;
        var diffAbs =_this.positions.abs ;

        if(diffAbs < 5 && (_this.times.end - _this.times.start) < 300 && _this.allowLinks == false) {
            _this.swipeReset()
            //Release inner links
            if (params.preventLinks) {
                _this.allowLinks = true;
            }
        }
        
        var maxPosition = wrapperSize - containerSize;
        if (params.scrollContainer) {
            maxPosition = slideSize - containerSize
        }
        
        //Prevent Negative Back Sliding
        if (_this.positions.current > 0) {
            _this.swipeReset()
            if (params.onTouchEnd) params.onTouchEnd(_this)
            _this.callPlugins('onTouchEnd');
            return
        }
        //Prevent After-End Sliding
        if (_this.positions.current < -maxPosition) {
            _this.swipeReset()
            if (params.onTouchEnd) params.onTouchEnd(_this)
            _this.callPlugins('onTouchEnd');
            return
        }
        
        //Free Mode
        if (params.freeMode) {
            if ( (_this.times.end - _this.times.start) < 300 && params.freeModeFluid ) {
                var newPosition = _this.positions.current + _this.touches.diff * 2 ;
                if (newPosition < maxPosition*(-1)) newPosition = -maxPosition;
                if (newPosition > 0) newPosition = 0;
                if (isHorizontal)
                    _this.setTransform( newPosition, 0, 0)
                else 
                    _this.setTransform( 0, newPosition, 0)
                    
                _this.setTransition( (_this.times.end - _this.times.start)*2 )
                _this.updateActiveSlide(newPosition)
            }
            if (!params.freeModeFluid || (_this.times.end - _this.times.start) >= 300) _this.updateActiveSlide(_this.positions.current)
            if (params.onTouchEnd) params.onTouchEnd(_this)
            _this.callPlugins('onTouchEnd');
            return
        }
        
        //Direction
        direction = diff < 0 ? "toNext" : "toPrev"
        
        //Short Touches
        if (direction=="toNext" && ( _this.times.end - _this.times.start <= 300 ) ) {
            if (diffAbs < 30 || !params.shortSwipes) _this.swipeReset()
            else _this.swipeNext(true);
        }
        
        if (direction=="toPrev" && ( _this.times.end - _this.times.start <= 300 ) ) {
        
            if (diffAbs < 30 || !params.shortSwipes) _this.swipeReset()
            else _this.swipePrev(true);
        }
        //Long Touches
        var groupSize = slideSize * params.slidesPerGroup
        if (direction=="toNext" && ( _this.times.end - _this.times.start > 300 ) ) {
            if (diffAbs >= groupSize*0.5) {
                _this.swipeNext(true)
            }
            else {
                _this.swipeReset()
            }
        }
        if (direction=="toPrev" && ( _this.times.end - _this.times.start > 300 ) ) {
            if (diffAbs >= groupSize*0.5) {
                _this.swipePrev(true);
            }
            else {
                _this.swipeReset()
            }
        }

        if( params.resumeAutoPlay ){

            _this.startAutoPlay();
        }

        if (params.onTouchEnd) params.onTouchEnd(_this)
        _this.callPlugins('onTouchEnd');
    }
    
    /*=========================
      Swipe Functions
    ===========================*/
    _this.swipeNext = function(internal) {
        if (!internal && params.loop) _this.fixLoop();
        if (!internal && params.autoPlay) _this.stopAutoPlay();

        _this.callPlugins('onSwipeNext');

        var getTranslate = isHorizontal ? _this.getTranslate('x') : _this.getTranslate('y');
        var groupSize = slideSize * params.slidesPerGroup;

        var newPosition = Math.floor(Math.abs(Math.round(getTranslate))/Math.floor(groupSize))*groupSize + groupSize;
        var curPos = Math.abs(getTranslate)
        if (newPosition==wrapperSize) return;
        if (curPos >= maxPos() && !params.loop) return;
        if (newPosition > maxPos() && !params.loop) {
            newPosition = maxPos()
        };
        if (params.loop) {
            if (newPosition >= (maxPos()+containerSize)) newPosition = maxPos()+containerSize
        }

        _this.setTransition( params.speed )

        if (isHorizontal) {
            _this.setTransform(-newPosition,0,0)
        }
        else {
            _this.setTransform(0,-newPosition,0)
        }
        
        
        //Update Active Slide
        _this.updateActiveSlide(-newPosition)
        
        //Run Callbacks
        slideChangeCallbacks()
        
        return true
    }
    
    _this.swipePrev = function(internal) {
        if (!internal&&params.loop) _this.fixLoop();
        if (!internal && params.autoPlay) _this.stopAutoPlay();

        _this.callPlugins('onSwipePrev');

        var getTranslate = Math.ceil( isHorizontal ? _this.getTranslate('x') : _this.getTranslate('y') );
        
        var groupSize = slideSize * params.slidesPerGroup;
        var newPosition = (Math.ceil(-Math.round(getTranslate)/groupSize)-1)*groupSize;
        
        if (newPosition < 0) newPosition = 0;
        
        _this.setTransition(params.speed)

        if (isHorizontal) {
            _this.setTransform(-newPosition,0,0)
        }
        else  {
            _this.setTransform(0,-newPosition,0)
        }
        
        //Update Active Slide
        _this.updateActiveSlide(-newPosition)
        
        //Run Callbacks
        slideChangeCallbacks()
        
        return true
    }
    
    _this.swipeReset = function(prevention) {
        _this.callPlugins('onSwipeReset');
        var getTranslate = isHorizontal ? _this.getTranslate('x') : _this.getTranslate('y');
        var groupSize = slideSize * params.slidesPerGroup
        var newPosition = getTranslate<0 ? Math.round(getTranslate/groupSize)*groupSize : 0
        var maxPosition = -maxPos()
        if (params.scrollContainer)  {
            newPosition = getTranslate<0 ? getTranslate : 0;
            maxPosition = containerSize - slideSize;
        }
        
        if (newPosition <= maxPosition) {
            newPosition = maxPosition
        }
        if (params.scrollContainer && (containerSize>slideSize)) {
            newPosition = 0;
        }
        
        if (params.mode=='horizontal') {
            _this.setTransform(newPosition,0,0)
        }
        else {
            _this.setTransform(0,newPosition,0)
        }
        
        _this.setTransition( params.speed)
        
        //Update Active Slide
        _this.updateActiveSlide(newPosition)
        
        //Reset Callback
        if (params.onSlideReset) {
            params.onSlideReset(_this)
        }
        
        return true
    }
    
    var firstTimeLoopPositioning = true;
    
    _this.swipeTo = function (index, speed, runCallbacks) { 

        index = parseInt(index || 0, 10); //type cast to int
        _this.callPlugins('onSwipeTo', {index:index, speed:speed});
            
        if (index > (numOfSlides-1)) return;
        if (index<0 && !params.loop) return;
        runCallbacks = runCallbacks===false ? false : runCallbacks || true
        var speed = speed===0 ? speed : speed || params.speed;
        
    
        if (params.loop) index = index + params.slidesPerSlide;
        
        if (index > numOfSlides - params.slidesPerSlide){

            index = numOfSlides - params.slidesPerSlide;
        } 

        if( numOfSlides < params.slidesPerSlide ){
            
            index = 0;
        }

        var newPosition = -index*slideSize;

        if(firstTimeLoopPositioning && params.loop && params.initialSlide > 0 && params.initialSlide < numOfSlides){
            newPosition = newPosition - params.initialSlide * slideSize;
            firstTimeLoopPositioning = false;
        }
        
        if (isHorizontal) {
            _this.setTransform(newPosition,0,0)
        }
        else {
            _this.setTransform(0,newPosition,0)
        }
        _this.setTransition( speed )    
        _this.updateActiveSlide(newPosition)

        //Run Callbacks
        if (runCallbacks) 
            slideChangeCallbacks()
            
        return true
    }
    
    //Prevent Multiple Callbacks 
    _this._queueStartCallbacks = false;
    _this._queueEndCallbacks = false;
    function slideChangeCallbacks() {
        //Transition Start Callback
        _this.callPlugins('onSlideChangeStart');
        if (params.onSlideChangeStart && !_this._queueStartCallbacks) {
            _this._queueStartCallbacks = true;
            params.onSlideChangeStart(_this)
            _this.transitionEnd(function(){
                _this._queueStartCallbacks = false;
            })
        }
        
        //Transition End Callback
        if (params.onSlideChangeEnd && !_this._queueEndCallbacks) {
            if(_this.support.transitions) {
                _this._queueEndCallbacks = true;
                _this.transitionEnd(params.onSlideChangeEnd)
            }
            else {
                setTimeout(function(){
                    params.onSlideChangeEnd(_this)
                },10)
            }
        }
    }
    
    _this.updateActiveSlide = function(position) {
        _this.previousIndex = _this.previousSlide = _this.realIndex
        _this.realIndex = Math.round(-position/slideSize)

        if (!params.loop) _this.activeIndex = _this.realIndex;
        else {
            _this.activeIndex = _this.realIndex-params.slidesPerSlide
            if (_this.activeIndex>=numOfSlides-params.slidesPerSlide*2) {
                _this.activeIndex = numOfSlides - params.slidesPerSlide*2 - _this.activeIndex
            }
            if (_this.activeIndex<0) {
                _this.activeIndex = numOfSlides - params.slidesPerSlide*2 + _this.activeIndex   
            }
        }
        if (_this.realIndex==numOfSlides) _this.realIndex = numOfSlides-1
        if (_this.realIndex<0) _this.realIndex = 0
        //Legacy
        _this.activeSlide = _this.activeIndex;
        //Update Pagination
        if (params.pagination) {
            _this.updatePagination()
        }

        //Trigger accessibility
        _this.triggerAccesibility();

       
    }
    
    
    /*=========================
      Loop Fixes
      ===========================*/
    _this.fixLoop = function(){     
        //Fix For Negative Oversliding
        if (_this.realIndex < params.slidesPerSlide) {
            var newIndex = numOfSlides - params.slidesPerSlide*3 + _this.realIndex;
            _this.swipeTo(newIndex,0, false)
        }
        //Fix For Positive Oversliding
        if (_this.realIndex > numOfSlides - params.slidesPerSlide*2) {
            var newIndex = -numOfSlides + _this.realIndex + params.slidesPerSlide
            _this.swipeTo(newIndex,0, false)
        }
    }
    if (params.loop) {
        _this.swipeTo(0,0, false)
    }

    

}

Swiper.prototype = {
    plugins : {},
    //Transition End
    transitionEnd : function(callback, permanent) {
        var a = this
        var el = a.wrapper
        var events = ['webkitTransitionEnd','transitionend', 'oTransitionEnd', 'MSTransitionEnd', 'msTransitionEnd'];
        if (callback) {
            function fireCallBack() {
                callback(a)
                a._queueEndCallbacks = false
                if (!permanent) {
                    for (var i=0; i<events.length; i++) {
                        el.removeEventListener(events[i], fireCallBack, false)
                    }
                }
            }
            for (var i=0; i<events.length; i++) {
                el.addEventListener(events[i], fireCallBack, false)
            }
        }
    },
    
    //Touch Support
    isSupportTouch : function() {
        return ("ontouchstart" in window) || window.DocumentTouch && document instanceof DocumentTouch;
    },
    //Transition Support
    isSupportTransitions : function(){
        var div = document.createElement('div').style
        return ('transition' in div) || ('WebkitTransition' in div) || ('MozTransition' in div) || ('msTransition' in div) || ('MsTransition' in div) || ('OTransition' in div);
    },
    // 3D Transforms Test 
    isSupport3D : function() {
        var div = document.createElement('div');
        div.id = 'test3d';
            
        var s3d=false;  
        if("webkitPerspective" in div.style) s3d=true;
        if("MozPerspective" in div.style) s3d=true;
        if("OPerspective" in div.style) s3d=true;
        if("MsPerspective" in div.style) s3d=true;
        if("perspective" in div.style) s3d=true;

        /* Test with Media query for Webkit to prevent FALSE positive*/ 
        if(s3d && ("webkitPerspective" in div.style) ) {
            var st = document.createElement('style');
            st.textContent = '@media (-webkit-transform-3d), (transform-3d), (-moz-transform-3d), (-o-transform-3d), (-ms-transform-3d) {#test3d{height:5px}}'
            document.getElementsByTagName('head')[0].appendChild(st);
            document.body.appendChild(div);
            s3d = div.offsetHeight === 5;
            st.parentNode.removeChild(st);
            div.parentNode.removeChild(div);
        }
        
        return s3d;
    },
        
    //GetTranslate
    getTranslate : function(axis){
        var el = this.wrapper
        var matrix;
        var curTransform;
        if (window.WebKitCSSMatrix) {
            var transformMatrix = new WebKitCSSMatrix(window.getComputedStyle(el, null).webkitTransform)
            matrix = transformMatrix.toString().split(',');
        }
        else {
            var transformMatrix =   window.getComputedStyle(el, null).MozTransform || window.getComputedStyle(el, null).OTransform || window.getComputedStyle(el, null).MsTransform || window.getComputedStyle(el, null).msTransform  || window.getComputedStyle(el, null).transform|| (window.getComputedStyle(el, null).getPropertyValue("transform") != null ? window.getComputedStyle(el, null).getPropertyValue("transform").replace("translate(", "matrix(1, 0, 0, 1,") : "");
            matrix = transformMatrix.toString().split(',');
            
        }
        if (this.params.useCSS3Transforms) { 
            if (axis=='x') {
                //Crazy IE10 Matrix
                if (matrix.length==16) 
                    curTransform = parseFloat( matrix[12] )
                //Latest Chrome and webkits Fix
                else if (window.WebKitCSSMatrix)
                    curTransform = transformMatrix.m41
                //Normal Browsers
                else 
                    curTransform = parseFloat( matrix[4] )
            }
            if (axis=='y') {
                //Crazy IE10 Matrix
                if (matrix.length==16) 
                    curTransform = parseFloat( matrix[13] )
                //Latest Chrome and webkits Fix
                else if (window.WebKitCSSMatrix)
                    curTransform = transformMatrix.m42
                //Normal Browsers
                else 
                    curTransform = parseFloat( matrix[5] )
            }
        }
        else {
            if (axis=='x') curTransform = parseFloat(el.style.left,10) || 0
            if (axis=='y') curTransform = parseFloat(el.style.top,10) || 0
        }
        return curTransform;
    },
    
    //Set Transform
    setTransform : function(x,y,z) {
        
        var es = this.wrapper.style
        x=x||0;
        y=y||0;
        z=z||0;
        if (this.params.useCSS3Transforms) {
            if (this.support.threeD) {
                es.webkitTransform = es.MsTransform = es.msTransform = es.MozTransform = es.OTransform = es.transform = 'translate3d('+x+'px, '+y+'px, '+z+'px)'
            }
            else {
                
                es.webkitTransform = es.MsTransform = es.msTransform = es.MozTransform = es.OTransform = es.transform = 'translate('+x+'px, '+y+'px)'
                if (this.ie8) {
                    es.left = x+'px'
                    es.top = y+'px'
                }
            }
        }
        else {
            es.left = x+'px';
            es.top = y+'px';
        }
        this.callPlugins('onSetTransform', {x:x, y:y, z:z})
    },
    
    //Set Transition
    setTransition : function(duration) {
        var es = this.wrapper.style
        es.webkitTransitionDuration = es.MsTransitionDuration = es.msTransitionDuration = es.MozTransitionDuration = es.OTransitionDuration = es.transitionDuration = duration/1000+'s';
        this.callPlugins('onSetTransition', {duration: duration})
    },
    
    //Check for IE8
    ie8: (function(){
        var rv = -1; // Return value assumes failure.
        if (navigator.appName == 'Microsoft Internet Explorer') {
            var ua = navigator.userAgent;
            var re = new RegExp("MSIE ([0-9]{1,}[\.0-9]{0,})");
            if (re.exec(ua) != null)
                rv = parseFloat(RegExp.$1);
        }
        return rv != -1 && rv < 9;
    })(),
    
    ie10 : window.navigator.msPointerEnabled
}

/*=========================
  jQuery & Zepto Plugins
  ===========================*/   
if (window.jQuery||window.Zepto) {
    (function($){
        $.fn.swiper = function(params) {
            var s = new Swiper($(this)[0], params)
            $(this).data('swiper',s);
            return s
        }
    })(window.jQuery||window.Zepto)
}   

//SCRIPT: ../../vendor/js/jquery.uberAccordion.js
/*
 * UberAccordion
 *
 * Gabriel Aszalos / Velti (c) 2013
 *
*/

(function($) {

    var UberAccordion = function(parent, options) {

        // Default settings

        var defaults = {
            verticalClass    : 'accordion-vertical',    // Class to apply when orientation is vertical
            horizontalClass  : 'accordion-horizontal',  // Class to apply when orientation is horizontal
            activeSlideClass : 'active',                // Class to apply on active accordion slide
            orientation      : 'horizontal',            // Accordion orientation
            orientationQuery : null,                    // Media query which causes orientation change
            startSlide       : 1,                       // Starter slide
            openMultiple     : false,                   // Set to true for multiple open slides at a time
            autoPlay         : false,                   // Auto-play
            autoPlaySpeed    : 5000,                    // Auto-play interval
            slideEvent       : 'click',                 // Open slide event
            animationSpeed   : 200,                     // Animation Speed
            headerItem       : typeof options.headerClass === 'undefined' ? 'h1' : '.' + options.headerClass,     // Header class
            contentItem      : typeof options.contentClass === 'undefined' ? 'div' : '.' + options.contentClass   // Content class
        };

        var settings  = $.extend(true, {}, defaults, options);                  // Add user settings with overwrite
        var el        = parent.children('ul');                                  // Accordion container
        var slides    = el.children().children(settings.contentItem);           // Accordion slides
        var headers   = el.children('li').children(settings.headerItem);        // Accordion headers
        var state     = {};                                                     // Keeps current accordion state (ie. currentSlide, orientation, etc)

        var showSlideCallback = function() {
            el.trigger('ua-slide-changed');
        }

        this.toggleSlide = function(slideNumber, override) {

            if(!settings.openMultiple) {

                // If multiple is disabled, open current slide and close other

                if(slideNumber !== state.currentSlide || override) {
                    this.hideSlide($(slides[el.children('li.' + settings.activeSlideClass).index()]));
                    this.showSlide($(slides[slideNumber]));
                }

            } else {

                // If multiple is enabled, toggle clicked slide

                if($(slides[slideNumber]).parent().hasClass(settings.activeSlideClass)) {
                    this.hideSlide($(slides[slideNumber]));
                } else {
                    this.showSlide($(slides[slideNumber]));
                }
            }

            state.currentSlide = slideNumber;
        }

        this.showSlide = function(slide) {

            if(state.orientation === "horizontal") {
                slide.slideDown(settings.animationSpeed, showSlideCallback);
            } else {
                slide.parent().animate({
                    width: slide.parent().attr('data-width')
                }, settings.animationSpeed, showSlideCallback);
            }

            slide.parent().addClass(settings.activeSlideClass);
        }

        this.hideSlide = function(slide) {
            if(state.orientation === "horizontal") {
                slide.slideUp(settings.animationSpeed);
            } else {
                slide.parent().animate({
                    width: slide.parent().children(settings.headerItem).attr('data-width')
                }, settings.animationSpeed);
            }

            slide.parent().removeClass(settings.activeSlideClass);
        }

        this.setOrientation = function(orientation) {

            el.removeClass(settings.horizontalClass + ' ' + settings.verticalClass);

            switch(orientation) {
                case 'vertical':
                    el.addClass(settings.verticalClass);
                    installVertical();
                    break;

                case 'horizontal':
                    el.addClass(settings.horizontalClass);

                    // Don't wipe styles on first load

                    if(typeof state.orientation !== 'undefined') {
                        uninstallVertical();
                    }

                    applyHorizontalBase();

                    break;
            }

            $(slides[state.currentSlide])
                .show()
                .parent().addClass(settings.activeSlideClass);

            state.orientation = orientation;
        }

        this.setAutoplay = function(enabled) {

            var _this = this;

            if(enabled) {
                state.autoPlayInterval = setInterval(function() {
                    var totalSlides = el.children('li').children(settings.headerItem).length;
                    state.currentSlide = state.currentSlide < (totalSlides - 1) ? state.currentSlide + 1 : 0;
                    _this.toggleSlide(state.currentSlide, true);
                }, settings.autoPlaySpeed);
            } else {
                if(typeof state.autoPlayInterval !== "undefined") {
                    clearInterval(state.autoPlayInterval);
                }
            }
        }

        // Installs styling and events for vertical slider

        var installVertical = function() {

            uninstallVertical();

            $(window).bind('resize', resizeContainer);

            applyVerticalBase();
            calculateSizes();
        }

        var applyVerticalBase = function() {

            slides.parent().css(CSSObject.SlideContainers);

            CSSObject.Headers.functions.setTransforms(-$(headers[0]).outerHeight(), 0);
            CSSObject.Slides.functions.setHeight(el.outerHeight(true));
            CSSObject.Slides.functions.setLeft($(headers[0]).outerHeight(true));

            headers.css(CSSObject.Headers.defaults);
            headers.setOuterWidth(el.innerHeight());
            slides.css(CSSObject.Slides.defaults);
        }

        var applyHorizontalBase = function() {
            slides.css({ 'display': 'none' });
        }

        // Calculate sizes and save widths in data attributes
        // for safe animating

        var calculateSizes = function() {

            var totalHeaderWidth = 0;
            var currentContainer = el.children('li.' + settings.activeSlideClass);
            var currentHeader    = currentContainer.children(settings.headerItem);
            var parentWidth      = parent.innerWidth();

            var slideWidth, headerWidth;

            headers.each(function() {
                headerWidth = $(this).outerHeight(true);
                totalHeaderWidth += headerWidth;

                $(this).parent().width(headerWidth);
                $(this).attr('data-width', headerWidth);
            });

            slides.each(function() {
                slideWidth  = parentWidth - totalHeaderWidth;
                headerWidth = $(this).parent().children(settings.headerItem).outerHeight(true);

                $(this).setOuterWidth(slideWidth);
                $(this).attr('data-width', slideWidth);

                $(this).parent().attr('data-width', slideWidth + headerWidth - 1);
            });

            currentContainer.width(parentWidth - totalHeaderWidth + currentHeader.outerHeight(true) - 1);

        }

        // Called on resize event - adjusts accordion width according
        // to parent to allow fluid design

        var resizeContainer = function() {

            if(state.orientation === "vertical") {

                // If we don't hide the accordion before reading the parent's width value
                // the parent will not auto-adjust in width

                el.css('display', 'none');
                el.width(parent.innerWidth());
                el.css('display', 'block');

                calculateSizes();
            }
        }

        // Uninstalls vertical events and styles

        var uninstallVertical = function() {

            $(window).unbind('resize', resizeContainer);

            el.removeAttr('style');
            el.children('li').removeAttr('style');
            slides.removeAttr('style');

            headers.removeAttr('style');
        }

        // Constructor

        var initialize = function(scope) {

            if(typeof options.headerClass !== 'undefined' && typeof options.contentClass === 'undefined') {
                throw("Content class must be defined along with header class.");
            }

            el.addClass('uberAccordion');

            headers.on(settings.slideEvent, function(e) {
                scope.toggleSlide(el.children('li').children(settings.headerItem).index(this));
                scope.setAutoplay(false);

                e.stopImmediatePropagation();
            });

            // If set to responsive, handle orientation changes

            if(settings.orientationQuery) {
                state.matchesQuery = window.matchMedia(settings.orientationQuery).matches;

                // If media query match state changes, switch orientation
                $(window).resize(function() {
                    if(window.matchMedia(settings.orientationQuery).matches !== state.matchesQuery) {
                        state.matchesQuery = window.matchMedia(settings.orientationQuery).matches;
                        scope.setOrientation(state.orientation === 'vertical' ? 'horizontal' : 'vertical');
                    }
                });

                if(state.matchesQuery) {
                    settings.orientation = settings.orientation === 'vertical' ? 'horizontal' : 'vertical';
                }
            }

            state.currentSlide = settings.startSlide - 1;
            $(slides[state.currentSlide]).parent().addClass(settings.activeSlideClass);

            scope.setOrientation(settings.orientation);

            // Set-up auto-play if enabled

            if(settings.autoPlay && !settings.openMultiple) {
                scope.setAutoplay(true);
            }

            el.attr('data-accordion-active', "true");
        }

        initialize(this);
    }

    $.fn.uberAccordion = function(options) {

        // Avoid double instantiating

        return $(this).children("ul").attr('data-accordion-active') === "true" ? false : new UberAccordion(this, options);
    }

    // Set total width with padding and borders (outerWidth)

    $.fn.setOuterWidth = function(value) {
        $(this).each(function() {
            var paddingLeft = isNaN(parseInt($(this).css('padding-left'), 10)) || $(this).css('padding-left') === '100%' ? 0 : parseInt($(this).css('padding-left'), 10);
            var paddingRight = isNaN(parseInt($(this).css('padding-right'), 10)) || $(this).css('padding-right') === '100%' ? 0 : parseInt($(this).css('padding-right'), 10);
            var borderLeft = isNaN(parseInt($(this).css('border-left-width'), 10)) ? 0 : parseInt($(this).css('border-left-width'), 10);
            var borderRight = isNaN(parseInt($(this).css('border-right-width'), 10)) ? 0 : parseInt($(this).css('border-right-width'), 10);
            
            $(this).width(value - paddingLeft - paddingRight - borderLeft - borderRight);
        });
    }

    // CSS Object for vertical accordion
    // These base styles are necessary for all vertical accordions

    var CSSObject = {

        SlideContainers: {
            'display': 'inline',
            'overflow': 'hidden',
            'float': 'left',
            'height': '100%',
            'position': 'relative'
        },

        Headers: {

            defaults: {
                'display': 'block',
                'float': 'left',
                'white-space': 'nowrap',
                'position': 'absolute',
                'top': '0',
                'left': '0',
                'transform-origin': '0 100% 0',
                '-webkit-transform-origin': '0 100%',
                '-moz-transform-origin': '0 100%',
                '-ms-transform-origin': '0 100%'
            },

            functions: {
                setTransforms: function(x, y) {
                    CSSObject.Headers.defaults['-webkit-transform'] = "rotate(90deg) translate(" + x + "px, " + y + "px)";
                    CSSObject.Headers.defaults['-moz-transform'] = "rotate(90deg) translate(" + x + "px, " + y + "px)";
                    CSSObject.Headers.defaults['-ms-transform'] = "rotate(90deg) translate(" + x + "px, " + y + "px)";
                    CSSObject.Headers.defaults['-sand-transform'] = "rotate(90deg) translate(" + x + "px, " + y + "px)";
                    CSSObject.Headers.defaults['transform'] = "rotate(90deg) translate(" + x + "px, " + y + "px)";
                    //CSSObject.Headers.defaults['filter'] = "progid:DXImageTransform.Microsoft.BasicImage(rotation=1)";
                }
            }
        },

        Slides: {

            defaults: {
                'float': 'left',
                'height': 0,
                'display': 'block',
                'position': 'absolute',
                'top': '0'
            },

            functions: {
                setHeight: function(height) { CSSObject.Slides.defaults.height = height; },
                setLeft: function(left) { CSSObject.Slides.defaults.left = left; }
            }
        }
    }

}(jQuery));

//SCRIPT: ../../vendor/js/jquery.magnific-popup.min.js
/*! Magnific Popup - v0.8.7 - 2013-05-19
* http://dimsemenov.com/plugins/magnific-popup/
* Copyright (c) 2013 Dmitry Semenov; */
(function(e){var t,i,n,a,r,o,s,l="Close",c="BeforeAppend",d="MarkupParse",u="Open",p="Change",f="mfp",m="."+f,g="mfp-ready",v="mfp-removing",h="mfp-prevent-close",C=function(){},y=!!window.jQuery,w=e(window),b=function(e,i){t.ev.on(f+e+m,i)},I=function(t,i,n,a){var r=document.createElement("div");return r.className="mfp-"+t,n&&(r.innerHTML=n),a?i&&i.appendChild(r):(r=e(r),i&&r.appendTo(i)),r},x=function(i,n){t.ev.triggerHandler(f+i,n),t.st.callbacks&&(i=i.charAt(0).toLowerCase()+i.slice(1),t.st.callbacks[i]&&t.st.callbacks[i].apply(t,e.isArray(n)?n:[n]))},k=function(){(t.st.focus?t.content.find(t.st.focus).eq(0):t.wrap).focus()},S=function(i){return i===s&&t.currTemplate.closeBtn||(t.currTemplate.closeBtn=e(t.st.closeMarkup.replace("%title%",t.st.tClose)),s=i),t.currTemplate.closeBtn},P=function(){e.magnificPopup.instance||(t=new C,t.init(),e.magnificPopup.instance=t)},E=function(i){if(!e(i).hasClass(h)){var n=t.st.closeOnContentClick,a=t.st.closeOnBgClick;if(n&&a)return!0;if(!t.content||e(i).hasClass("mfp-close")||t.preloader&&i===t.preloader[0])return!0;if(i===t.content[0]||e.contains(t.content[0],i)){if(n)return!0}else if(a)return!0;return!1}};C.prototype={constructor:C,init:function(){var i=navigator.appVersion;t.isIE7=-1!==i.indexOf("MSIE 7."),t.isIE8=-1!==i.indexOf("MSIE 8."),t.isLowIE=t.isIE7||t.isIE8,t.isAndroid=/android/gi.test(i),t.isIOS=/iphone|ipad|ipod/gi.test(i),t.probablyMobile=t.isAndroid||t.isIOS||/(Opera Mini)|Kindle|webOS|BlackBerry|(Opera Mobi)|(Windows Phone)|IEMobile/i.test(navigator.userAgent),n=e(document.body),a=e(document),t.popupsCache={}},open:function(i){var r;if(t.items=i.isObj===!1?i.items.toArray():e.isArray(i.items)?i.items:[i.items],t.isOpen)return t.updateItemHTML(),void 0;if(t.types=[],o="",t.ev=i.mainEl||a,i.isObj)t.index=i.index||0;else{t.index=0;var s,l=i.items;for(r=0;l.length>r;r++)if(s=l[r],s.parsed&&(s=s.el[0]),s===i.el[0]){t.index=r;break}}i.key?(t.popupsCache[i.key]||(t.popupsCache[i.key]={}),t.currTemplate=t.popupsCache[i.key]):t.currTemplate={},t.st=e.extend(!0,{},e.magnificPopup.defaults,i),t.fixedContentPos="auto"===t.st.fixedContentPos?!t.probablyMobile:t.st.fixedContentPos,t.bgOverlay||(t.bgOverlay=I("bg").on("click"+m,function(){t.close()}),t.wrap=I("wrap").attr("tabindex",-1).on("click"+m,function(e){E(e.target)&&t.close()}),t.container=I("container",t.wrap)),t.contentContainer=I("content"),t.st.preloader&&(t.preloader=I("preloader",t.container,t.st.tLoading));var c=e.magnificPopup.modules;for(r=0;c.length>r;r++){var p=c[r];p=p.charAt(0).toUpperCase()+p.slice(1),t["init"+p].call(t)}x("BeforeOpen"),t.st.closeBtnInside?(b(d,function(e,t,i,n){i.close_replaceWith=S(n.type)}),o+=" mfp-close-btn-in"):t.wrap.append(S()),t.st.alignTop&&(o+=" mfp-align-top"),t.fixedContentPos?t.wrap.css({overflow:t.st.overflowY,overflowX:"hidden",overflowY:t.st.overflowY}):t.wrap.css({top:w.scrollTop(),position:"absolute"}),(t.st.fixedBgPos===!1||"auto"===t.st.fixedBgPos&&!t.fixedContentPos)&&t.bgOverlay.css({height:a.height(),position:"absolute"}),a.on("keyup"+m,function(e){27===e.keyCode&&t.close()}),w.on("resize"+m,function(){t.updateSize()}),t.st.closeOnContentClick||(o+=" mfp-auto-cursor"),o&&t.wrap.addClass(o);var f=t.wH=w.height(),v={};if(t.fixedContentPos){var h=t._getScrollbarSize();h&&(v.paddingRight=h)}t.fixedContentPos&&(t.isIE7?e("body, html").css("overflow","hidden"):v.overflow="hidden");var C=t.st.mainClass;t.isIE7&&(C+=" mfp-ie7"),C&&t._addClassToMFP(C),t.updateItemHTML(),x("BuildControls"),n.css(v),t.bgOverlay.add(t.wrap).prependTo(document.body),t._lastFocusedEl=document.activeElement,setTimeout(function(){t.content?(t._addClassToMFP(g),k()):t.bgOverlay.addClass(g),a.on("focusin"+m,function(i){return i.target===t.wrap[0]||e.contains(t.wrap[0],i.target)?void 0:(k(),!1)})},16),t.isOpen=!0,t.updateSize(f),x(u)},close:function(){t.isOpen&&(t.isOpen=!1,t.st.removalDelay&&!t.isLowIE?(t._addClassToMFP(v),setTimeout(function(){t._close()},t.st.removalDelay)):t._close())},_close:function(){x(l);var i=v+" "+g+" ";if(t.bgOverlay.detach(),t.wrap.detach(),t.container.empty(),t.st.mainClass&&(i+=t.st.mainClass+" "),t._removeClassFromMFP(i),t.fixedContentPos){var r={paddingRight:0};t.isIE7?e("body, html").css("overflow","auto"):r.overflow="visible",n.css(r)}a.off("keyup"+m+" focusin"+m),t.ev.off(m),t.wrap.attr("class","mfp-wrap").removeAttr("style"),t.bgOverlay.attr("class","mfp-bg"),t.container.attr("class","mfp-container"),t.st.closeBtnInside&&t.currTemplate[t.currItem.type]!==!0||t.currTemplate.closeBtn&&t.currTemplate.closeBtn.detach(),t._lastFocusedEl&&e(t._lastFocusedEl).focus(),t.currItem=null,t.content=null,t.currTemplate=null,t.prevHeight=0},updateSize:function(e){if(t.isIOS){var i=document.documentElement.clientWidth/window.innerWidth,n=window.innerHeight*i;t.wrap.css("height",n),t.wH=n}else t.wH=e||w.height();x("Resize")},updateItemHTML:function(){var i=t.items[t.index];t.contentContainer.detach(),t.content&&t.content.detach(),i.parsed||(i=t.parseEl(t.index));var n=i.type;if(x("BeforeChange",[t.currItem?t.currItem.type:"",n]),t.currItem=i,!t.currTemplate[n]){var a=t.st[n]?t.st[n].markup:!1;x("FirstMarkupParse",a),t.currTemplate[n]=a?e(a):!0}r&&r!==i.type&&t.container.removeClass("mfp-"+r+"-holder");var o=t["get"+n.charAt(0).toUpperCase()+n.slice(1)](i,t.currTemplate[n]);t.appendContent(o,n),i.preloaded=!0,x(p,i),r=i.type,t.container.prepend(t.contentContainer),x("AfterChange")},appendContent:function(e,i){t.content=e,e?t.st.closeBtnInside&&t.currTemplate[i]===!0?t.content.find(".mfp-close").length||t.content.append(S()):t.content=e:t.content="",x(c),t.container.addClass("mfp-"+i+"-holder"),t.contentContainer.append(t.content)},parseEl:function(i){var n=t.items[i],a=n.type;if(n=n.tagName?{el:e(n)}:{data:n,src:n.src},n.el){for(var r=t.types,o=0;r.length>o;o++)if(n.el.hasClass("mfp-"+r[o])){a=r[o];break}n.src=n.el.attr("data-mfp-src"),n.src||(n.src=n.el.attr("href"))}return n.type=a||t.st.type||"inline",n.index=i,n.parsed=!0,t.items[i]=n,x("ElementParse",n),t.items[i]},addGroup:function(e,i){var n=function(n){n.mfpEl=this,t._openClick(n,e,i)};i||(i={});var a="click.magnificPopup";i.mainEl=e,i.items?(i.isObj=!0,e.off(a).on(a,n)):(i.isObj=!1,i.delegate?e.off(a).on(a,i.delegate,n):(i.items=e,e.off(a).on(a,n)))},_openClick:function(i,n,a){var r=void 0!==a.midClick?a.midClick:e.magnificPopup.defaults.midClick;if(r||2!==i.which){var o=void 0!==a.disableOn?a.disableOn:e.magnificPopup.defaults.disableOn;if(o)if(e.isFunction(o)){if(!o.call(t))return!0}else if(o>w.width())return!0;i.type&&i.preventDefault(),a.el=e(i.mfpEl),a.delegate&&(a.items=n.find(a.delegate)),t.open(a)}},updateStatus:function(e,n){if(t.preloader){i!==e&&t.container.removeClass("mfp-s-"+i),n||"loading"!==e||(n=t.st.tLoading);var a={status:e,text:n};x("UpdateStatus",a),e=a.status,n=a.text,t.preloader.html(n),t.preloader.find("a").click(function(e){e.stopImmediatePropagation()}),t.container.addClass("mfp-s-"+e),i=e}},_addClassToMFP:function(e){t.bgOverlay.addClass(e),t.wrap.addClass(e)},_removeClassFromMFP:function(e){this.bgOverlay.removeClass(e),t.wrap.removeClass(e)},_hasScrollBar:function(e){return document.body.clientHeight>(e||w.height())?!0:!1},_parseMarkup:function(t,i,n){var a;n.data&&(i=e.extend(n.data,i)),x(d,[t,i,n]),e.each(i,function(e,i){if(void 0===i||i===!1)return!0;if(a=e.split("_"),a.length>1){var n=t.find(m+"-"+a[0]);if(n.length>0){var r=a[1];"replaceWith"===r?n[0]!==i[0]&&n.replaceWith(i):"img"===r?n.is("img")?n.attr("src",i):n.replaceWith('<img src="'+i+'" class="'+n.attr("class")+'" />'):n.attr(a[1],i)}}else t.find(m+"-"+e).html(i)})},_getScrollbarSize:function(){if(void 0===t.scrollbarSize){var e=document.createElement("div");e.id="mfp-sbm",e.style.cssText="width: 99px; height: 99px; overflow: scroll; position: absolute; top: -9999px;",document.body.appendChild(e),t.scrollbarSize=e.offsetWidth-e.clientWidth,document.body.removeChild(e)}return t.scrollbarSize}},e.magnificPopup={instance:null,proto:C.prototype,modules:[],open:function(e,t){return P(),e||(e={}),e.isObj=!0,e.index=t||0,this.instance.open(e)},close:function(){return e.magnificPopup.instance.close()},registerModule:function(t,i){i.options&&(e.magnificPopup.defaults[t]=i.options),e.extend(this.proto,i.proto),this.modules.push(t)},defaults:{disableOn:0,key:null,midClick:!1,mainClass:"",preloader:!0,focus:"",closeOnContentClick:!1,closeOnBgClick:!0,closeBtnInside:!0,alignTop:!1,removalDelay:0,fixedContentPos:"auto",fixedBgPos:"auto",overflowY:"auto",closeMarkup:'<button title="%title%" type="button" class="mfp-close">&times;</button>',tClose:"Close (Esc)",tLoading:"Loading..."}},e.fn.magnificPopup=function(i){P();var n=e(this);if("string"==typeof i)if("open"===i){var a,r=y?n.data("magnificPopup"):n[0].magnificPopup,o=parseInt(arguments[1],10)||0;r.items?a=r.items[o]:(a=n,r.delegate&&(a=a.find(r.delegate)),a=a.eq(o)),t._openClick({mfpEl:a},n,r)}else t.isOpen&&t[i].apply(t,Array.prototype.slice.call(arguments,1));else y?n.data("magnificPopup",i):n[0].magnificPopup=i,t.addGroup(n,i);return n};var T,M,O,_="inline",z=function(){O&&(M.after(O.addClass(T)).detach(),O=null)};e.magnificPopup.registerModule(_,{options:{hiddenClass:"hide",markup:"",tNotFound:"Content not found"},proto:{initInline:function(){t.types.push(_),b(l+"."+_,function(){z()})},getInline:function(i,n){if(z(),i.src){var a=t.st.inline,r=e(i.src);return r.length?(null!==r[0].parentNode&&(M||(T=a.hiddenClass,M=I(T),T="mfp-"+T),O=r.after(M).detach().removeClass(T)),t.updateStatus("ready")):(t.updateStatus("error",a.tNotFound),r=e("<div>")),i.inlineElement=r,r}return t.updateStatus("ready"),t._parseMarkup(n,{},i),n}}});var B,F="ajax",H=function(){B&&n.removeClass(B)};e.magnificPopup.registerModule(F,{options:{settings:null,cursor:"mfp-ajax-cur",tError:'<a href="%url%">The content</a> could not be loaded.'},proto:{initAjax:function(){t.types.push(F),B=t.st.ajax.cursor,b(l+"."+F,function(){H(),t.req&&t.req.abort()})},getAjax:function(i){B&&n.addClass(B),t.updateStatus("loading");var a=e.extend({url:i.src,success:function(n,a,r){x("ParseAjax",r),t.appendContent(e(r.responseText),F),i.finished=!0,H(),k(),setTimeout(function(){t.wrap.addClass(g)},16),t.updateStatus("ready")},error:function(){H(),i.finished=i.loadError=!0,t.updateStatus("error",t.st.ajax.tError.replace("%url%",i.src))}},t.st.ajax.settings);return t.req=e.ajax(a),""}}});var L,A=function(i){if(i.data&&void 0!==i.data.title)return i.data.title;var n=t.st.image.titleSrc;if(n){if(e.isFunction(n))return n.call(t,i);if(i.el)return i.el.attr(n)||""}return""};e.magnificPopup.registerModule("image",{options:{markup:'<div class="mfp-figure"><div class="mfp-close"></div><div class="mfp-img"></div><div class="mfp-bottom-bar"><div class="mfp-title"></div><div class="mfp-counter"></div></div></div>',cursor:"mfp-zoom-out-cur",titleSrc:"title",verticalFit:!0,tError:'<a href="%url%">The image</a> could not be loaded.'},proto:{initImage:function(){var e=t.st.image,i=".image";t.types.push("image"),b(u+i,function(){"image"===t.currItem.type&&e.cursor&&n.addClass(e.cursor)}),b(l+i,function(){e.cursor&&n.removeClass(e.cursor),w.off("resize"+m)}),b("Resize"+i,t.resizeImage),t.isLowIE&&b("AfterChange",t.resizeImage)},resizeImage:function(){var e=t.currItem;if(e.img&&t.st.image.verticalFit){var i=0;t.isLowIE&&(i=parseInt(e.img.css("padding-top"),10)+parseInt(e.img.css("padding-bottom"),10)),e.img.css("max-height",t.wH-i)}},_onImageHasSize:function(e){e.img&&(e.hasSize=!0,L&&clearInterval(L),e.isCheckingImgSize=!1,x("ImageHasSize",e),e.imgHidden&&(t.content&&t.content.removeClass("mfp-loading"),e.imgHidden=!1))},findImageSize:function(e){var i=0,n=e.img[0],a=function(r){L&&clearInterval(L),L=setInterval(function(){return n.naturalWidth>0?(t._onImageHasSize(e),void 0):(i>200&&clearInterval(L),i++,3===i?a(10):40===i?a(50):100===i&&a(500),void 0)},r)};a(1)},getImage:function(i,n){var a=0,r=function(){i&&(i.img[0].complete?(i.img.off(".mfploader"),i===t.currItem&&(t._onImageHasSize(i),t.updateStatus("ready")),i.hasSize=!0,i.loaded=!0):(a++,200>a?setTimeout(r,100):o()))},o=function(){i&&(i.img.off(".mfploader"),i===t.currItem&&(t._onImageHasSize(i),t.updateStatus("error",s.tError.replace("%url%",i.src))),i.hasSize=!0,i.loaded=!0,i.loadError=!0)},s=t.st.image,l=n.find(".mfp-img");if(l.length){var c=new Image;c.className="mfp-img",i.img=e(c).on("load.mfploader",r).on("error.mfploader",o),c.src=i.src,l.is("img")&&(i.img=i.img.clone())}return t._parseMarkup(n,{title:A(i),img_replaceWith:i.img},i),t.resizeImage(),i.hasSize?(L&&clearInterval(L),i.loadError?(n.addClass("mfp-loading"),t.updateStatus("error",s.tError.replace("%url%",i.src))):(n.removeClass("mfp-loading"),t.updateStatus("ready")),n):(t.updateStatus("loading"),i.loading=!0,i.hasSize||(i.imgHidden=!0,n.addClass("mfp-loading"),t.findImageSize(i)),n)}}});var j="iframe",N="//about:blank",W=function(e){if(t.currTemplate[j]){var i=t.currTemplate[j].find("iframe");i.length&&(e||(i[0].src=N),t.isIE8&&i.css("display",e?"block":"none"))}};e.magnificPopup.registerModule(j,{options:{markup:'<div class="mfp-iframe-scaler"><div class="mfp-close"></div><iframe class="mfp-iframe" src="//about:blank" frameborder="0" allowfullscreen></iframe></div>',srcAction:"iframe_src",patterns:{youtube:{index:"youtube.com",id:"v=",src:"//www.youtube.com/embed/%id%?autoplay=1"},vimeo:{index:"vimeo.com/",id:"/",src:"//player.vimeo.com/video/%id%?autoplay=1"},gmaps:{index:"//maps.google.",src:"%id%&output=embed"}}},proto:{initIframe:function(){t.types.push(j),b("BeforeChange",function(e,t,i){t!==i&&(t===j?W():i===j&&W(!0))}),b(l+"."+j,function(){W()})},getIframe:function(i,n){var a=i.src,r=t.st.iframe;e.each(r.patterns,function(){return a.indexOf(this.index)>-1?(this.id&&(a="string"==typeof this.id?a.substr(a.lastIndexOf(this.id)+this.id.length,a.length):this.id.call(this,a)),a=this.src.replace("%id%",a),!1):void 0});var o={};return r.srcAction&&(o[r.srcAction]=a),t._parseMarkup(n,o,i),t.updateStatus("ready"),n}}});var R=function(e){var i=t.items.length;return e>i-1?e-i:0>e?i+e:e},Y=function(e,t,i){return e.replace("%curr%",t+1).replace("%total%",i)};e.magnificPopup.registerModule("gallery",{options:{enabled:!1,arrowMarkup:'<button title="%title%" type="button" class="mfp-arrow mfp-arrow-%dir%"></button>',preload:[0,2],navigateByImgClick:!0,arrows:!0,tPrev:"Previous (Left arrow key)",tNext:"Next (Right arrow key)",tCounter:"%curr% of %total%"},proto:{initGallery:function(){var i=t.st.gallery,n=".mfp-gallery",r=Boolean(e.fn.mfpFastClick);return t.direction=!0,i&&i.enabled?(o+=" mfp-gallery",b(u+n,function(){i.navigateByImgClick&&t.wrap.on("click"+n,".mfp-img",function(){return t.items.length>1?(t.next(),!1):void 0}),a.on("keydown"+n,function(e){37===e.keyCode?t.prev():39===e.keyCode&&t.next()})}),b("UpdateStatus"+n,function(e,i){i.text&&(i.text=Y(i.text,t.currItem.index,t.items.length))}),b(d+n,function(e,n,a,r){var o=t.items.length;a.counter=o>1?Y(i.tCounter,r.index,o):""}),b("BuildControls"+n,function(){if(t.items.length>1&&i.arrows&&!t.arrowLeft){var n=i.arrowMarkup,a=t.arrowLeft=e(n.replace("%title%",i.tPrev).replace("%dir%","left")).addClass(h),o=t.arrowRight=e(n.replace("%title%",i.tNext).replace("%dir%","right")).addClass(h),s=r?"mfpFastClick":"click";a[s](function(){t.prev()}),o[s](function(){t.next()}),t.isIE7&&(I("b",a[0],!1,!0),I("a",a[0],!1,!0),I("b",o[0],!1,!0),I("a",o[0],!1,!0)),t.container.append(a.add(o))}}),b(p+n,function(){t._preloadTimeout&&clearTimeout(t._preloadTimeout),t._preloadTimeout=setTimeout(function(){t.preloadNearbyImages(),t._preloadTimeout=null},16)}),b(l+n,function(){a.off(n),t.wrap.off("click"+n),t.arrowLeft&&r&&t.arrowLeft.add(t.arrowRight).destroyMfpFastClick(),t.arrowRight=t.arrowLeft=null}),void 0):!1},next:function(){t.direction=!0,t.index=R(t.index+1),t.updateItemHTML()},prev:function(){t.direction=!1,t.index=R(t.index-1),t.updateItemHTML()},goTo:function(e){t.direction=e>=t.index,t.index=e,t.updateItemHTML()},preloadNearbyImages:function(){var e,i=t.st.gallery.preload,n=Math.min(i[0],t.items.length),a=Math.min(i[1],t.items.length);for(e=1;(t.direction?a:n)>=e;e++)t._preloadItem(t.index+e);for(e=1;(t.direction?n:a)>=e;e++)t._preloadItem(t.index-e)},_preloadItem:function(i){if(i=R(i),!t.items[i].preloaded){var n=t.items[i];n.parsed||(n=t.parseEl(i)),x("LazyLoad",n),"image"===n.type&&(n.img=e('<img class="mfp-img" />').on("load.mfploader",function(){n.hasSize=!0}).on("error.mfploader",function(){n.hasSize=!0,n.loadError=!0}).attr("src",n.src)),n.preloaded=!0}}}});var q="retina";e.magnificPopup.registerModule(q,{options:{replaceSrc:function(e){return e.src.replace(/\.\w+$/,function(e){return"@2x"+e})},ratio:1},proto:{initRetina:function(){if(window.devicePixelRatio>1){var e=t.st.retina,i=e.ratio;i=isNaN(i)?i():i,i>1&&(b("ImageHasSize."+q,function(e,t){t.img.css({"max-width":t.img[0].naturalWidth/i,width:"100%"})}),b("ElementParse."+q,function(t,n){n.src=e.replaceSrc(n,i)}))}}}}),function(){var t=1e3,i="ontouchstart"in window,n=function(){w.off("touchmove"+r+" touchend"+r)},a="mfpFastClick",r="."+a;e.fn.mfpFastClick=function(a){return e(this).each(function(){var o,s=e(this);if(i){var l,c,d,u,p,f;s.on("touchstart"+r,function(e){u=!1,f=1,p=e.originalEvent?e.originalEvent.touches[0]:e.touches[0],c=p.clientX,d=p.clientY,w.on("touchmove"+r,function(e){p=e.originalEvent?e.originalEvent.touches:e.touches,f=p.length,p=p[0],(Math.abs(p.clientX-c)>10||Math.abs(p.clientY-d)>10)&&(u=!0,n())}).on("touchend"+r,function(e){n(),u||f>1||(o=!0,e.preventDefault(),clearTimeout(l),l=setTimeout(function(){o=!1},t),a())})})}s.on("click"+r,function(){o||a()})})},e.fn.destroyMfpFastClick=function(){e(this).off("touchstart"+r+" click"+r),i&&w.off("touchmove"+r+" touchend"+r)}}()})(window.jQuery||window.Zepto);

//SCRIPT: ../../vendor/js/jquery.marquee.js
/**
 * author Remy Sharp
 * url http://remysharp.com/tag/marquee
 *
 * Ralph Jennings. 4/5/2013.
 * Added support for "resize" event. If triggered, marquee is resized according to
 * its parent's width and scroll position is updated accordingly.
 *
 * Sam Newman. 26/5/2013
 * Added options to be passed in through .marquee()

  options = {
    behavior : 'scroll',
    loop : 0-9,
    scrollamount : 1,
    direction : left,
    marqueeContainerClass : 'marquee-inner'
  }
  
 * Hacked resize event so that it is opt in, the returning marquee jQuery object is returned with a
 * 'resizeMarquee' method. Example:
 *
 * var $marquee = $('#marquee').marquee(*options*);
 * $(window).on('resize', function () {
 *   $marquee.resizeMarquee();
 * });
 */

(function ($) {
  $.fn.marquee = function (options) {
    var newMarquee = [], last = this.length, $newMarquee;

    function resizeMarquee (marquee) {
      var $marquee = $(marquee);
      return function () {
        $marquee.each(function () {
          var marqueeRedux = this,
              $marqueeRedux = $(marqueeRedux),
              state = $marqueeRedux.data('marqueeState'),
              $parent = $(marqueeRedux.parentElement),
              horizontal = /scrollWidth/.test(state.widthAxis),
              origStateWidth = state.width,
              newStateWidth = horizontal ? $parent.width() : $parent.height();

          // resize the widget
          if (horizontal) {
            $marqueeRedux.width(newStateWidth);
            $marqueeRedux.find('.' + (options.marqueeContainerClass || 'marquee-inner')).css('padding', '0 ' + newStateWidth + 'px');
            state.width = newStateWidth;
          } else {
            $marqueeRedux.height(newStateWidth);
            $marqueeRedux.find('.' + (options.marqueeContainerClass || 'marquee-inner')).css('padding', newStateWidth + 'px 0');
            state.width = newStateWidth;
          }
          // update the scroll amount so the text doesn't jump all over the place (stays in the same relative position top-left)
          state.last += (newStateWidth - origStateWidth);
          marqueeRedux[state.axis] = state.last;
        });
        return $marquee;
      };
    }

    // works out the left or right hand reset position, based on scroll
    // behavior, current direction and new direction
    function getReset(newDir, marqueeRedux, marqueeState) {
      var behavior = marqueeState.behavior, width = marqueeState.width, dir = marqueeState.dir;
      var r = 0;
      if (behavior == 'alternate') {
        r = newDir == 1 ? marqueeRedux[marqueeState.widthAxis] - (width*2) : width;
      } else if (behavior == 'slide') {
        if (newDir == -1) {
          r = dir == -1 ? marqueeRedux[marqueeState.widthAxis] : width;
        } else {
          r = dir == -1 ? marqueeRedux[marqueeState.widthAxis] - (width*2) : 0;
        }
      } else {
        r = newDir == -1 ? marqueeRedux[marqueeState.widthAxis] : 0;
      }
      return r;
    }

    // single "thread" animation
    function animateMarquee() {
      var i = newMarquee.length,
        marqueeRedux = null,
        $marqueeRedux = null,
        marqueeState = {},
        newMarqueeList = [],
        hitedge = false;
        
      while (i--) {
        marqueeRedux = newMarquee[i];
        $marqueeRedux = $(marqueeRedux);

        marqueeState = $marqueeRedux.data('marqueeState');

        //  item no longer in DOM so bail
        if (!marqueeState) {
          return;
        }
        
        if ($marqueeRedux.data('paused') !== true) {
          // TODO read scrollamount, dir, behavior, loops and last from data
          marqueeRedux[marqueeState.axis] += (marqueeState.scrollamount * marqueeState.dir);

          // only true if it's hit the end
          hitedge = marqueeState.dir == -1 ? marqueeRedux[marqueeState.axis] <= getReset(marqueeState.dir * -1, marqueeRedux, marqueeState) : marqueeRedux[marqueeState.axis] >= getReset(marqueeState.dir * -1, marqueeRedux, marqueeState);
          
          if ((marqueeState.behavior == 'scroll' && marqueeState.last == marqueeRedux[marqueeState.axis]) || (marqueeState.behavior == 'alternate' && hitedge && marqueeState.last != -1) || (marqueeState.behavior == 'slide' && hitedge && marqueeState.last != -1)) {                        
            if (marqueeState.behavior == 'alternate') {
              marqueeState.dir *= -1; // flip
            }
            marqueeState.last = -1;

            $marqueeRedux.trigger('stop');

            marqueeState.loops--;
            if (marqueeState.loops === 0) {
              if (marqueeState.behavior != 'slide') {
                marqueeRedux[marqueeState.axis] = getReset(marqueeState.dir, marqueeRedux, marqueeState);
              } else {
                // corrects the position
                marqueeRedux[marqueeState.axis] = getReset(marqueeState.dir * -1, marqueeRedux, marqueeState);
              }

              $marqueeRedux.trigger('end');
            } else {
              // keep this marquee going
              newMarqueeList.push(marqueeRedux);
              $marqueeRedux.trigger('start');
              marqueeRedux[marqueeState.axis] = getReset(marqueeState.dir, marqueeRedux, marqueeState);
            }
          } else {
            newMarqueeList.push(marqueeRedux);
          }
          marqueeState.last = marqueeRedux[marqueeState.axis];

          // store updated state only if we ran an animation
          $marqueeRedux.data('marqueeState', marqueeState);
        } else {
          // even though it's paused, keep it in the list
          newMarqueeList.push(marqueeRedux);                    
        }
      }

      newMarquee = newMarqueeList;

      if (newMarquee.length) {
        setTimeout(animateMarquee, 50);
      }
    }

    //  Set up options
    
    if (typeof options === 'string') {
      options = {
        className : options
      };
    } else if (typeof options !== 'object') {
      options = {};
    }

    if (options.loop === true) {
      options.loop = -1;
    } else if (options.loop === false) {
      options.loop = 0;
    }

    //  Adding speed options



    // TODO consider whether using .html() in the wrapping process could lead to loosing predefined events...
    this.each(function (i) {
      var marqueeRedux, $marqueeRedux, hitedge, direction, marqueeState, loop, horizontal,
        $marquee = $(this),
        width = $marquee.width() || $marquee.attr('width'),
        height = $marquee.height() || $marquee.attr('height');

      if (this.tagName === 'MARQUEE') {
        $marqueeRedux = $marquee.after('<div ' + (options.className ? 'class="' + options.className + '" ' : '') + 'style="display: block-inline; width: ' + width + 'px; height: ' + height + 'px; overflow: hidden;"><div class="' + (options.marqueeContainerClass || 'marquee-inner') + '" style="float: left; white-space: nowrap;">' + $marquee.html() + '</div></div>').next();
      } else {
        if (options.className) {
          $marquee.addClass(options.className);
        }
        $marqueeRedux = $marquee.css({
          width : width,
          height : height,
          display: 'inline-block',
          overflow: 'hidden'
        }).html('<div class="' + (options.marqueeContainerClass || 'marquee-inner') + '" style="float: left; white-space: nowrap;">' + $marquee.html() + '</div>');
      }
      
      marqueeRedux = $marqueeRedux.get(0);
      hitedge = 0;
      direction = options.direction || ($marquee.attr('direction') || 'left').toLowerCase();
      loop = options.loop || $marquee.attr('loop') || -1;
      horizontal = /left|right/.test(direction);
      marqueeState = {
        dir : /down|right/.test(direction) ? -1 : 1,
        axis : horizontal ? 'scrollLeft' : 'scrollTop',
        widthAxis : horizontal ? 'scrollWidth' : 'scrollHeight',
        last : -1,
        loops : loop,
        scrollamount : options.scrollAmount || $marquee.attr('scrollamount') || 2,
        behavior : (options.behavior || $marquee.attr('behavior') || 'scroll').toLowerCase(),
        width : horizontal ? width : height
      };
      
      // corrects a bug in Firefox - the default loops for slide is -1
      if (loop == -1 && marqueeState.behavior == 'slide') {
        marqueeState.loops = 1;
      }

      if (this.tagName === 'MARQUEE') {
        $marquee.remove();
      }
      
      // add padding
      if (horizontal) {
        $marqueeRedux.find('.' + (options.marqueeContainerClass || 'marquee-inner')).css('padding', '0 ' + width + 'px');
      } else {
        $marqueeRedux.find('.' + (options.marqueeContainerClass || 'marquee-inner')).css('padding', height + 'px 0');
      }
      
      $marqueeRedux.data('marqueeState', marqueeState)
      // events
      .bind('stop', function () {
        $marqueeRedux.data('paused', true);
      }).bind('pause', function () {
        $marqueeRedux.data('paused', true);
      }).bind('start', function () {
        $marqueeRedux.data('paused', false);
      }).bind('unpause', function () {
        $marqueeRedux.data('paused', false);
      });//.data('marqueeState', marqueeState); // finally: store the state

      // todo - rerender event allowing us to do an ajax hit and redraw the marquee

      newMarquee.push(marqueeRedux);

      marqueeRedux[marqueeState.axis] = getReset(marqueeState.dir, marqueeRedux, marqueeState);
      $marqueeRedux.trigger('start');
      
      // on the very last marquee, trigger the animation
      if (i+1 == last) {
        animateMarquee();
      }
    });

    $newMarquee = $(newMarquee);

    $newMarquee.resizeMarquee = resizeMarquee(newMarquee);

    return $newMarquee;
  };
}(jQuery));

//SCRIPT: ../../vendor/js/jquery.event.move.js
	// jquery.event.move
//
// 1.3.1
//
// Stephen Band
//
// Triggers 'movestart', 'move' and 'moveend' events after
// mousemoves following a mousedown cross a distance threshold,
// similar to the native 'dragstart', 'drag' and 'dragend' events.
// Move events are throttled to animation frames. Move event objects
// have the properties:
//
// pageX:
// pageY:   Page coordinates of pointer.
// startX:
// startY:  Page coordinates of pointer at movestart.
// distX:
// distY:  Distance the pointer has moved since movestart.
// deltaX:
// deltaY:  Distance the finger has moved since last event.
// velocityX:
// velocityY:  Average velocity over last few events.


(function (module) {
	if (typeof define === 'function' && define.amd) {
		// AMD. Register as an anonymous module.
		define(['jquery'], module);
	} else {
		// Browser globals
		module(jQuery);
	}
})(function(jQuery, undefined){

	var // Number of pixels a pressed pointer travels before movestart
	    // event is fired.
	    threshold = 6,
	
	    add = jQuery.event.add,
	
	    remove = jQuery.event.remove,

	    // Just sugar, so we can have arguments in the same order as
	    // add and remove.
	    trigger = function(node, type, data) {
	    	jQuery.event.trigger(type, data, node);
	    },

	    // Shim for requestAnimationFrame, falling back to timer. See:
	    // see http://paulirish.com/2011/requestanimationframe-for-smart-animating/
	    requestFrame = (function(){
	    	return (
	    		window.requestAnimationFrame ||
	    		window.webkitRequestAnimationFrame ||
	    		window.mozRequestAnimationFrame ||
	    		window.oRequestAnimationFrame ||
	    		window.msRequestAnimationFrame ||
	    		function(fn, element){
	    			return window.setTimeout(function(){
	    				fn();
	    			}, 25);
	    		}
	    	);
	    })(),
	    
	    ignoreTags = {
	    	textarea: true,
	    	input: true,
	    	select: true,
	    	button: true
	    },
	    
	    mouseevents = {
	    	move: 'mousemove',
	    	cancel: 'mouseup dragstart',
	    	end: 'mouseup'
	    },
	    
	    touchevents = {
	    	move: 'touchmove',
	    	cancel: 'touchend',
	    	end: 'touchend'
	    };


	// Constructors
	
	function Timer(fn){
		var callback = fn,
				active = false,
				running = false;
		
		function trigger(time) {
			if (active){
				callback();
				requestFrame(trigger);
				running = true;
				active = false;
			}
			else {
				running = false;
			}
		}
		
		this.kick = function(fn) {
			active = true;
			if (!running) { trigger(); }
		};
		
		this.end = function(fn) {
			var cb = callback;
			
			if (!fn) { return; }
			
			// If the timer is not running, simply call the end callback.
			if (!running) {
				fn();
			}
			// If the timer is running, and has been kicked lately, then
			// queue up the current callback and the end callback, otherwise
			// just the end callback.
			else {
				callback = active ?
					function(){ cb(); fn(); } : 
					fn ;
				
				active = true;
			}
		};
	}


	// Functions
	
	function returnTrue() {
		return true;
	}
	
	function returnFalse() {
		return false;
	}
	
	function preventDefault(e) {
		e.preventDefault();
	}
	
	function preventIgnoreTags(e) {
		// Don't prevent interaction with form elements.
		if (ignoreTags[ e.target.tagName.toLowerCase() ]) { return; }
		
		e.preventDefault();
	}

	function isLeftButton(e) {
		// Ignore mousedowns on any button other than the left (or primary)
		// mouse button, or when a modifier key is pressed.
		return (e.which === 1 && !e.ctrlKey && !e.altKey);
	}

	function identifiedTouch(touchList, id) {
		var i, l;

		if (touchList.identifiedTouch) {
			return touchList.identifiedTouch(id);
		}
		
		// touchList.identifiedTouch() does not exist in
		// webkit yet… we must do the search ourselves...
		
		i = -1;
		l = touchList.length;
		
		while (++i < l) {
			if (touchList[i].identifier === id) {
				return touchList[i];
			}
		}
	}

	function changedTouch(e, event) {
		var touch = identifiedTouch(e.changedTouches, event.identifier);

		// This isn't the touch you're looking for.
		if (!touch) { return; }

		// Chrome Android (at least) includes touches that have not
		// changed in e.changedTouches. That's a bit annoying. Check
		// that this touch has changed.
		if (touch.pageX === event.pageX && touch.pageY === event.pageY) { return; }

		return touch;
	}


	// Handlers that decide when the first movestart is triggered
	
	function mousedown(e){
		var data;

		if (!isLeftButton(e)) { return; }

		data = {
			target: e.target,
			startX: e.pageX,
			startY: e.pageY,
			timeStamp: e.timeStamp
		};

		add(document, mouseevents.move, mousemove, data);
		add(document, mouseevents.cancel, mouseend, data);
	}

	function mousemove(e){
		var data = e.data;

		checkThreshold(e, data, e, removeMouse);
	}

	function mouseend(e) {
		removeMouse();
	}

	function removeMouse() {
		remove(document, mouseevents.move, mousemove);
		remove(document, mouseevents.cancel, mouseend);
	}

	function touchstart(e) {
		var touch, template;

		// Don't get in the way of interaction with form elements.
		if (ignoreTags[ e.target.tagName.toLowerCase() ]) { return; }

		touch = e.changedTouches[0];
		
		// iOS live updates the touch objects whereas Android gives us copies.
		// That means we can't trust the touchstart object to stay the same,
		// so we must copy the data. This object acts as a template for
		// movestart, move and moveend event objects.
		template = {
			target: touch.target,
			startX: touch.pageX,
			startY: touch.pageY,
			timeStamp: e.timeStamp,
			identifier: touch.identifier
		};

		// Use the touch identifier as a namespace, so that we can later
		// remove handlers pertaining only to this touch.
		add(document, touchevents.move + '.' + touch.identifier, touchmove, template);
		add(document, touchevents.cancel + '.' + touch.identifier, touchend, template);
	}

	function touchmove(e){
		var data = e.data,
		    touch = changedTouch(e, data);

		if (!touch) { return; }

		checkThreshold(e, data, touch, removeTouch);
	}

	function touchend(e) {
		var template = e.data,
		    touch = identifiedTouch(e.changedTouches, template.identifier);

		if (!touch) { return; }

		removeTouch(template.identifier);
	}

	function removeTouch(identifier) {
		remove(document, '.' + identifier, touchmove);
		remove(document, '.' + identifier, touchend);
	}


	// Logic for deciding when to trigger a movestart.

	function checkThreshold(e, template, touch, fn) {
		var distX = touch.pageX - template.startX,
		    distY = touch.pageY - template.startY;

		// Do nothing if the threshold has not been crossed.
		if ((distX * distX) + (distY * distY) < (threshold * threshold)) { return; }

		triggerStart(e, template, touch, distX, distY, fn);
	}

	function handled() {
		// this._handled should return false once, and after return true.
		this._handled = returnTrue;
		return false;
	}

	function flagAsHandled(e) {
		e._handled();
	}

	function triggerStart(e, template, touch, distX, distY, fn) {
		var node = template.target,
		    touches, time;

		touches = e.targetTouches;
		time = e.timeStamp - template.timeStamp;

		// Create a movestart object with some special properties that
		// are passed only to the movestart handlers.
		template.type = 'movestart';
		template.distX = distX;
		template.distY = distY;
		template.deltaX = distX;
		template.deltaY = distY;
		template.pageX = touch.pageX;
		template.pageY = touch.pageY;
		template.velocityX = distX / time;
		template.velocityY = distY / time;
		template.targetTouches = touches;
		template.finger = touches ?
			touches.length :
			1 ;

		// The _handled method is fired to tell the default movestart
		// handler that one of the move events is bound.
		template._handled = handled;
			
		// Pass the touchmove event so it can be prevented if or when
		// movestart is handled.
		template._preventTouchmoveDefault = function() {
			e.preventDefault();
		};

		// Trigger the movestart event.
		trigger(template.target, template);

		// Unbind handlers that tracked the touch or mouse up till now.
		fn(template.identifier);
	}


	// Handlers that control what happens following a movestart

	function activeMousemove(e) {
		var event = e.data.event,
		    timer = e.data.timer;

		updateEvent(event, e, e.timeStamp, timer);
	}

	function activeMouseend(e) {
		var event = e.data.event,
		    timer = e.data.timer;
		
		removeActiveMouse();

		endEvent(event, timer, function() {
			// Unbind the click suppressor, waiting until after mouseup
			// has been handled.
			setTimeout(function(){
				remove(event.target, 'click', returnFalse);
			}, 0);
		});
	}

	function removeActiveMouse(event) {
		remove(document, mouseevents.move, activeMousemove);
		remove(document, mouseevents.end, activeMouseend);
	}

	function activeTouchmove(e) {
		var event = e.data.event,
		    timer = e.data.timer,
		    touch = changedTouch(e, event);

		if (!touch) { return; }

		// Stop the interface from gesturing
		e.preventDefault();

		event.targetTouches = e.targetTouches;
		updateEvent(event, touch, e.timeStamp, timer);
	}

	function activeTouchend(e) {
		var event = e.data.event,
		    timer = e.data.timer,
		    touch = identifiedTouch(e.changedTouches, event.identifier);

		// This isn't the touch you're looking for.
		if (!touch) { return; }

		removeActiveTouch(event);
		endEvent(event, timer);
	}

	function removeActiveTouch(event) {
		remove(document, '.' + event.identifier, activeTouchmove);
		remove(document, '.' + event.identifier, activeTouchend);
	}


	// Logic for triggering move and moveend events

	function updateEvent(event, touch, timeStamp, timer) {
		var time = timeStamp - event.timeStamp;

		event.type = 'move';
		event.distX =  touch.pageX - event.startX;
		event.distY =  touch.pageY - event.startY;
		event.deltaX = touch.pageX - event.pageX;
		event.deltaY = touch.pageY - event.pageY;
		
		// Average the velocity of the last few events using a decay
		// curve to even out spurious jumps in values.
		event.velocityX = 0.3 * event.velocityX + 0.7 * event.deltaX / time;
		event.velocityY = 0.3 * event.velocityY + 0.7 * event.deltaY / time;
		event.pageX =  touch.pageX;
		event.pageY =  touch.pageY;

		timer.kick();
	}

	function endEvent(event, timer, fn) {
		timer.end(function(){
			event.type = 'moveend';

			trigger(event.target, event);
			
			return fn && fn();
		});
	}


	// jQuery special event definition

	function setup(data, namespaces, eventHandle) {
		// Stop the node from being dragged
		//add(this, 'dragstart.move drag.move', preventDefault);
		
		// Prevent text selection and touch interface scrolling
		//add(this, 'mousedown.move', preventIgnoreTags);
		
		// Tell movestart default handler that we've handled this
		add(this, 'movestart.move', flagAsHandled);

		// Don't bind to the DOM. For speed.
		return true;
	}
	
	function teardown(namespaces) {
		remove(this, 'dragstart drag', preventDefault);
		remove(this, 'mousedown touchstart', preventIgnoreTags);
		remove(this, 'movestart', flagAsHandled);
		
		// Don't bind to the DOM. For speed.
		return true;
	}
	
	function addMethod(handleObj) {
		// We're not interested in preventing defaults for handlers that
		// come from internal move or moveend bindings
		if (handleObj.namespace === "move" || handleObj.namespace === "moveend") {
			return;
		}
		
		// Stop the node from being dragged
		add(this, 'dragstart.' + handleObj.guid + ' drag.' + handleObj.guid, preventDefault, undefined, handleObj.selector);
		
		// Prevent text selection and touch interface scrolling
		add(this, 'mousedown.' + handleObj.guid, preventIgnoreTags, undefined, handleObj.selector);
	}
	
	function removeMethod(handleObj) {
		if (handleObj.namespace === "move" || handleObj.namespace === "moveend") {
			return;
		}
		
		remove(this, 'dragstart.' + handleObj.guid + ' drag.' + handleObj.guid);
		remove(this, 'mousedown.' + handleObj.guid);
	}
	
	jQuery.event.special.movestart = {
		setup: setup,
		teardown: teardown,
		add: addMethod,
		remove: removeMethod,

		_default: function(e) {
			var template, data;
			
			// If no move events were bound to any ancestors of this
			// target, high tail it out of here.
			if (!e._handled()) { return; }

			template = {
				target: e.target,
				startX: e.startX,
				startY: e.startY,
				pageX: e.pageX,
				pageY: e.pageY,
				distX: e.distX,
				distY: e.distY,
				deltaX: e.deltaX,
				deltaY: e.deltaY,
				velocityX: e.velocityX,
				velocityY: e.velocityY,
				timeStamp: e.timeStamp,
				identifier: e.identifier,
				targetTouches: e.targetTouches,
				finger: e.finger
			};

			data = {
				event: template,
				timer: new Timer(function(time){
					trigger(e.target, template);
				})
			};
			
			if (e.identifier === undefined) {
				// We're dealing with a mouse
				// Stop clicks from propagating during a move
				add(e.target, 'click', returnFalse);
				add(document, mouseevents.move, activeMousemove, data);
				add(document, mouseevents.end, activeMouseend, data);
			}
			else {
				// We're dealing with a touch. Stop touchmove doing
				// anything defaulty.
				e._preventTouchmoveDefault();
				add(document, touchevents.move + '.' + e.identifier, activeTouchmove, data);
				add(document, touchevents.end + '.' + e.identifier, activeTouchend, data);
			}
		}
	};

	jQuery.event.special.move = {
		setup: function() {
			// Bind a noop to movestart. Why? It's the movestart
			// setup that decides whether other move events are fired.
			add(this, 'movestart.move', jQuery.noop);
		},
		
		teardown: function() {
			remove(this, 'movestart.move', jQuery.noop);
		}
	};
	
	jQuery.event.special.moveend = {
		setup: function() {
			// Bind a noop to movestart. Why? It's the movestart
			// setup that decides whether other move events are fired.
			add(this, 'movestart.moveend', jQuery.noop);
		},
		
		teardown: function() {
			remove(this, 'movestart.moveend', jQuery.noop);
		}
	};

	add(document, 'mousedown.move', mousedown);
	add(document, 'touchstart.move', touchstart);

	// Make jQuery copy touch event properties over to the jQuery event
	// object, if they are not already listed. But only do the ones we
	// really need. IE7/8 do not have Array#indexOf(), but nor do they
	// have touch events, so let's assume we can ignore them.
	if (typeof Array.prototype.indexOf === 'function') {
		(function(jQuery, undefined){
			var props = ["changedTouches", "targetTouches"],
			    l = props.length;
			
			while (l--) {
				if (jQuery.event.props.indexOf(props[l]) === -1) {
					jQuery.event.props.push(props[l]);
				}
			}
		})(jQuery);
	};
});

//SCRIPT: ../../vendor/js/odometer.js
(function() {
  var COUNT_FRAMERATE, COUNT_MS_PER_FRAME, DIGIT_FORMAT, DIGIT_HTML, DIGIT_SPEEDBOOST, DURATION, FORMAT_MARK_HTML, FORMAT_PARSER, FRAMERATE, FRAMES_PER_VALUE, MS_PER_FRAME, MutationObserver, Odometer, RIBBON_HTML, TRANSITION_END_EVENTS, TRANSITION_SUPPORT, VALUE_HTML, addClass, createFromHTML, fractionalPart, now, removeClass, requestAnimationFrame, round, transitionCheckStyles, trigger, truncate, wrapJQuery, _jQueryWrapped, _old, _ref, _ref1,
    __slice = [].slice;

  VALUE_HTML = '<span class="odometer-value"></span>';

  RIBBON_HTML = '<span class="odometer-ribbon"><span class="odometer-ribbon-inner">' + VALUE_HTML + '</span></span>';

  DIGIT_HTML = '<span class="odometer-digit"><span class="odometer-digit-spacer">8</span><span class="odometer-digit-inner">' + RIBBON_HTML + '</span></span>';

  FORMAT_MARK_HTML = '<span class="odometer-formatting-mark"></span>';

  DIGIT_FORMAT = '(,ddd).dd';

  FORMAT_PARSER = /^\(?([^)]*)\)?(?:(.)(d+))?$/;

  FRAMERATE = 30;

  DURATION = 2000;

  COUNT_FRAMERATE = 20;

  FRAMES_PER_VALUE = 2;

  DIGIT_SPEEDBOOST = .5;

  MS_PER_FRAME = 1000 / FRAMERATE;

  COUNT_MS_PER_FRAME = 1000 / COUNT_FRAMERATE;

  TRANSITION_END_EVENTS = 'transitionend webkitTransitionEnd oTransitionEnd otransitionend MSTransitionEnd';

  transitionCheckStyles = document.createElement('div').style;

  TRANSITION_SUPPORT = (transitionCheckStyles.transition != null) || (transitionCheckStyles.webkitTransition != null) || (transitionCheckStyles.mozTransition != null) || (transitionCheckStyles.oTransition != null);

  requestAnimationFrame = window.requestAnimationFrame || window.mozRequestAnimationFrame || window.webkitRequestAnimationFrame || window.msRequestAnimationFrame;

  MutationObserver = window.MutationObserver || window.WebKitMutationObserver || window.MozMutationObserver;

  createFromHTML = function(html) {
    var el;
    el = document.createElement('div');
    el.innerHTML = html;
    return el.children[0];
  };

  removeClass = function(el, name) {
    return el.className = el.className.replace(new RegExp("(^| )" + (name.split(' ').join('|')) + "( |$)", 'gi'), ' ');
  };

  addClass = function(el, name) {
    removeClass(el, name);
    return el.className += " " + name;
  };

  trigger = function(el, name) {
    var evt;
    if (document.createEvent != null) {
      evt = document.createEvent('HTMLEvents');
      evt.initEvent(name, true, true);
      return el.dispatchEvent(evt);
    }
  };

  now = function() {
    var _ref, _ref1;
    return (_ref = (_ref1 = window.performance) != null ? typeof _ref1.now === "function" ? _ref1.now() : void 0 : void 0) != null ? _ref : +(new Date);
  };

  round = function(val, precision) {
    if (precision == null) {
      precision = 0;
    }
    if (!precision) {
      return Math.round(val);
    }
    val *= Math.pow(10, precision);
    val += 0.5;
    val = Math.floor(val);
    return val /= Math.pow(10, precision);
  };

  truncate = function(val) {
    if (val < 0) {
      return Math.ceil(val);
    } else {
      return Math.floor(val);
    }
  };

  fractionalPart = function(val) {
    return val - round(val);
  };

  _jQueryWrapped = false;

  (wrapJQuery = function() {
    var property, _i, _len, _ref, _results;
    if (_jQueryWrapped) {
      return;
    }
    if (window.jQuery != null) {
      _jQueryWrapped = true;
      _ref = ['html', 'text'];
      _results = [];
      for (_i = 0, _len = _ref.length; _i < _len; _i++) {
        property = _ref[_i];
        _results.push((function(property) {
          var old;
          old = window.jQuery.fn[property];
          return window.jQuery.fn[property] = function(val) {
            var _ref1;
            if ((val == null) || (((_ref1 = this[0]) != null ? _ref1.odometer : void 0) == null)) {
              return old.apply(this, arguments);
            }
            return this[0].odometer.update(val);
          };
        })(property));
      }
      return _results;
    }
  })();

  setTimeout(wrapJQuery, 0);

  Odometer = (function() {
    function Odometer(options) {
      var e, k, property, v, _base, _i, _len, _ref, _ref1, _ref2,
        _this = this;
      this.options = options;
      this.el = this.options.el;
      if (this.el.odometer != null) {
        return this.el.odometer;
      }
      this.el.odometer = this;
      _ref = Odometer.options;
      for (k in _ref) {
        v = _ref[k];
        if (this.options[k] == null) {
          this.options[k] = v;
        }
      }
      if ((_base = this.options).duration == null) {
        _base.duration = DURATION;
      }
      this.MAX_VALUES = ((this.options.duration / MS_PER_FRAME) / FRAMES_PER_VALUE) | 0;
      this.resetFormat();
      this.value = this.cleanValue((_ref1 = this.options.value) != null ? _ref1 : '');
      this.renderInside();
      this.render();
      try {
        _ref2 = ['innerHTML', 'innerText', 'textContent'];
        for (_i = 0, _len = _ref2.length; _i < _len; _i++) {
          property = _ref2[_i];
          if (this.el[property] != null) {
            (function(property) {
              return Object.defineProperty(_this.el, property, {
                get: function() {
                  var _ref3;
                  if (property === 'innerHTML') {
                    return _this.inside.outerHTML;
                  } else {
                    return (_ref3 = _this.inside.innerText) != null ? _ref3 : _this.inside.textContent;
                  }
                },
                set: function(val) {
                  return _this.update(val);
                }
              });
            })(property);
          }
        }
      } catch (_error) {
        e = _error;
        this.watchForMutations();
      }
      this;
    }

    Odometer.prototype.renderInside = function() {
      this.inside = document.createElement('div');
      this.inside.className = 'odometer-inside';
      this.el.innerHTML = '';
      return this.el.appendChild(this.inside);
    };

    Odometer.prototype.watchForMutations = function() {
      var e,
        _this = this;
      if (MutationObserver == null) {
        return;
      }
      try {
        if (this.observer == null) {
          this.observer = new MutationObserver(function(mutations) {
            var newVal;
            newVal = _this.el.innerText;
            _this.renderInside();
            _this.render(_this.value);
            return _this.update(newVal);
          });
        }
        this.watchMutations = true;
        return this.startWatchingMutations();
      } catch (_error) {
        e = _error;
      }
    };

    Odometer.prototype.startWatchingMutations = function() {
      if (this.watchMutations) {
        return this.observer.observe(this.el, {
          childList: true
        });
      }
    };

    Odometer.prototype.stopWatchingMutations = function() {
      var _ref;
      return (_ref = this.observer) != null ? _ref.disconnect() : void 0;
    };

    Odometer.prototype.cleanValue = function(val) {
      var _ref;
      if (typeof val === 'string') {
        val = val.replace((_ref = this.format.radix) != null ? _ref : '.', '<radix>');
        val = val.replace(/[.,]/g, '');
        val = val.replace('<radix>', '.');
        val = parseFloat(val, 10) || 0;
      }
      return round(val, this.format.precision);
    };

    Odometer.prototype.bindTransitionEnd = function() {
      var event, renderEnqueued, _i, _len, _ref, _results,
        _this = this;
      if (this.transitionEndBound) {
        return;
      }
      this.transitionEndBound = true;
      renderEnqueued = false;
      _ref = TRANSITION_END_EVENTS.split(' ');
      _results = [];
      for (_i = 0, _len = _ref.length; _i < _len; _i++) {
        event = _ref[_i];
        _results.push(this.el.addEventListener(event, function() {
          if (renderEnqueued) {
            return true;
          }
          renderEnqueued = true;
          setTimeout(function() {
            _this.render();
            renderEnqueued = false;
            return trigger(_this.el, 'odometerdone');
          }, 0);
          return true;
        }, false));
      }
      return _results;
    };

    Odometer.prototype.resetFormat = function() {
      var format, fractional, parsed, precision, radix, repeating, _ref, _ref1;
      format = (_ref = this.options.format) != null ? _ref : DIGIT_FORMAT;
      format || (format = 'd');
      parsed = FORMAT_PARSER.exec(format);
      if (!parsed) {
        throw new Error("Odometer: Unparsable digit format");
      }
      _ref1 = parsed.slice(1, 4), repeating = _ref1[0], radix = _ref1[1], fractional = _ref1[2];
      precision = (fractional != null ? fractional.length : void 0) || 0;
      return this.format = {
        repeating: repeating,
        radix: radix,
        precision: precision
      };
    };

    Odometer.prototype.render = function(value) {
      var classes, cls, digit, match, newClasses, theme, wholePart, _i, _j, _len, _len1, _ref;
      if (value == null) {
        value = this.value;
      }
      this.stopWatchingMutations();
      this.resetFormat();
      this.inside.innerHTML = '';
      theme = this.options.theme;
      classes = this.el.className.split(' ');
      newClasses = [];
      for (_i = 0, _len = classes.length; _i < _len; _i++) {
        cls = classes[_i];
        if (!cls.length) {
          continue;
        }
        if (match = /^odometer-theme-(.+)$/.exec(cls)) {
          theme = match[1];
          continue;
        }
        if (/^odometer(-|$)/.test(cls)) {
          continue;
        }
        newClasses.push(cls);
      }
      newClasses.push('odometer');
      if (!TRANSITION_SUPPORT) {
        newClasses.push('odometer-no-transitions');
      }
      if (theme) {
        newClasses.push("odometer-theme-" + theme);
      } else {
        newClasses.push("odometer-auto-theme");
      }
      this.el.className = newClasses.join(' ');
      this.ribbons = {};
      this.digits = [];
      wholePart = !this.format.precision || !fractionalPart(value) || false;
      _ref = value.toString().split('').reverse();
      for (_j = 0, _len1 = _ref.length; _j < _len1; _j++) {
        digit = _ref[_j];
        if (digit === '.') {
          wholePart = true;
        }
        this.addDigit(digit, wholePart);
      }
      return this.startWatchingMutations();
    };

    Odometer.prototype.update = function(newValue) {
      var diff,
        _this = this;
      newValue = this.cleanValue(newValue);
      if (!(diff = newValue - this.value)) {
        return;
      }
      removeClass(this.el, 'odometer-animating-up odometer-animating-down odometer-animating');
      if (diff > 0) {
        addClass(this.el, 'odometer-animating-up');
      } else {
        addClass(this.el, 'odometer-animating-down');
      }
      this.stopWatchingMutations();
      this.animate(newValue);
      this.startWatchingMutations();
      setTimeout(function() {
        _this.el.offsetHeight;
        return addClass(_this.el, 'odometer-animating');
      }, 0);
      return this.value = newValue;
    };

    Odometer.prototype.renderDigit = function() {
      return createFromHTML(DIGIT_HTML);
    };

    Odometer.prototype.insertDigit = function(digit, before) {
      if (before != null) {
        return this.inside.insertBefore(digit, before);
      } else if (!this.inside.children.length) {
        return this.inside.appendChild(digit);
      } else {
        return this.inside.insertBefore(digit, this.inside.children[0]);
      }
    };

    Odometer.prototype.addSpacer = function(chr, before, extraClasses) {
      var spacer;
      spacer = createFromHTML(FORMAT_MARK_HTML);
      spacer.innerHTML = chr;
      if (extraClasses) {
        addClass(spacer, extraClasses);
      }
      return this.insertDigit(spacer, before);
    };

    Odometer.prototype.addDigit = function(value, repeating) {
      var chr, digit, resetted, _ref;
      if (repeating == null) {
        repeating = true;
      }
      if (value === '-') {
        return this.addSpacer(value, null, 'odometer-negation-mark');
      }
      if (value === '.') {
        return this.addSpacer((_ref = this.format.radix) != null ? _ref : '.', null, 'odometer-radix-mark');
      }
      if (repeating) {
        resetted = false;
        while (true) {
          if (!this.format.repeating.length) {
            if (resetted) {
              throw new Error("Bad odometer format without digits");
            }
            this.resetFormat();
            resetted = true;
          }
          chr = this.format.repeating[this.format.repeating.length - 1];
          this.format.repeating = this.format.repeating.substring(0, this.format.repeating.length - 1);
          if (chr === 'd') {
            break;
          }
          this.addSpacer(chr);
        }
      }
      digit = this.renderDigit();
      digit.querySelector('.odometer-value').innerHTML = value;
      this.digits.push(digit);
      return this.insertDigit(digit);
    };

    Odometer.prototype.animate = function(newValue) {
      if (!TRANSITION_SUPPORT || this.options.animation === 'count') {
        return this.animateCount(newValue);
      } else {
        return this.animateSlide(newValue);
      }
    };

    Odometer.prototype.animateCount = function(newValue) {
      var cur, diff, last, start, tick,
        _this = this;
      if (!(diff = +newValue - this.value)) {
        return;
      }
      start = last = now();
      cur = this.value;
      return (tick = function() {
        var delta, dist, fraction;
        if ((now() - start) > _this.options.duration) {
          _this.value = newValue;
          _this.render();
          trigger(_this.el, 'odometerdone');
          return;
        }
        delta = now() - last;
        if (delta > COUNT_MS_PER_FRAME) {
          last = now();
          fraction = delta / _this.options.duration;
          dist = diff * fraction;
          cur += dist;
          _this.render(Math.round(cur));
        }
        if (requestAnimationFrame != null) {
          return requestAnimationFrame(tick);
        } else {
          return setTimeout(tick, COUNT_MS_PER_FRAME);
        }
      })();
    };

    Odometer.prototype.getDigitCount = function() {
      var i, max, value, values, _i, _len;
      values = 1 <= arguments.length ? __slice.call(arguments, 0) : [];
      for (i = _i = 0, _len = values.length; _i < _len; i = ++_i) {
        value = values[i];
        values[i] = Math.abs(value);
      }
      max = Math.max.apply(Math, values);
      return Math.ceil(Math.log(max + 1) / Math.log(10));
    };

    Odometer.prototype.getFractionalDigitCount = function() {
      var i, parser, parts, value, values, _i, _len;
      values = 1 <= arguments.length ? __slice.call(arguments, 0) : [];
      parser = /^\-?\d*\.(\d*?)0*$/;
      for (i = _i = 0, _len = values.length; _i < _len; i = ++_i) {
        value = values[i];
        values[i] = value.toString();
        parts = parser.exec(values[i]);
        if (parts == null) {
          values[i] = 0;
        } else {
          values[i] = parts[1].length;
        }
      }
      return Math.max.apply(Math, values);
    };

    Odometer.prototype.resetDigits = function() {
      this.digits = [];
      this.ribbons = [];
      this.inside.innerHTML = '';
      return this.resetFormat();
    };

    Odometer.prototype.animateSlide = function(newValue) {
      var boosted, cur, diff, digitCount, digits, dist, end, fractionalCount, frame, frames, i, incr, j, mark, numEl, oldValue, start, _base, _i, _j, _k, _l, _len, _len1, _len2, _m, _ref, _results;
      oldValue = this.value;
      fractionalCount = this.getFractionalDigitCount(oldValue, newValue);
      if (fractionalCount) {
        newValue = newValue * Math.pow(10, fractionalCount);
        oldValue = oldValue * Math.pow(10, fractionalCount);
      }
      if (!(diff = newValue - oldValue)) {
        return;
      }
      this.bindTransitionEnd();
      digitCount = this.getDigitCount(oldValue, newValue);
      digits = [];
      boosted = 0;
      for (i = _i = 0; 0 <= digitCount ? _i < digitCount : _i > digitCount; i = 0 <= digitCount ? ++_i : --_i) {
        start = truncate(oldValue / Math.pow(10, digitCount - i - 1));
        end = truncate(newValue / Math.pow(10, digitCount - i - 1));
        dist = end - start;
        if (Math.abs(dist) > this.MAX_VALUES) {
          frames = [];
          incr = dist / (this.MAX_VALUES + this.MAX_VALUES * boosted * DIGIT_SPEEDBOOST);
          cur = start;
          while ((dist > 0 && cur < end) || (dist < 0 && cur > end)) {
            frames.push(Math.round(cur));
            cur += incr;
          }
          if (frames[frames.length - 1] !== end) {
            frames.push(end);
          }
          boosted++;
        } else {
          frames = (function() {
            _results = [];
            for (var _j = start; start <= end ? _j <= end : _j >= end; start <= end ? _j++ : _j--){ _results.push(_j); }
            return _results;
          }).apply(this);
        }
        for (i = _k = 0, _len = frames.length; _k < _len; i = ++_k) {
          frame = frames[i];
          frames[i] = Math.abs(frame % 10);
        }
        digits.push(frames);
      }
      this.resetDigits();
      _ref = digits.reverse();
      for (i = _l = 0, _len1 = _ref.length; _l < _len1; i = ++_l) {
        frames = _ref[i];
        if (!this.digits[i]) {
          this.addDigit(' ', i >= fractionalCount);
        }
        if ((_base = this.ribbons)[i] == null) {
          _base[i] = this.digits[i].querySelector('.odometer-ribbon-inner');
        }
        this.ribbons[i].innerHTML = '';
        if (diff < 0) {
          frames = frames.reverse();
        }
        for (j = _m = 0, _len2 = frames.length; _m < _len2; j = ++_m) {
          frame = frames[j];
          numEl = document.createElement('div');
          numEl.className = 'odometer-value';
          numEl.innerHTML = frame;
          this.ribbons[i].appendChild(numEl);
          if (j === frames.length - 1) {
            addClass(numEl, 'odometer-last-value');
          }
          if (j === 0) {
            addClass(numEl, 'odometer-first-value');
          }
        }
      }
      if (start < 0) {
        this.addDigit('-');
      }
      mark = this.inside.querySelector('.odometer-radix-mark');
      if (mark != null) {
        mark.parent.removeChild(mark);
      }
      if (fractionalCount) {
        return this.addSpacer(this.format.radix, this.digits[fractionalCount - 1], 'odometer-radix-mark');
      }
    };

    return Odometer;

  })();

  Odometer.options = (_ref = window.odometerOptions) != null ? _ref : {};

  setTimeout(function() {
    var k, v, _base, _ref1, _results;
    if (window.odometerOptions) {
      _ref1 = window.odometerOptions;
      _results = [];
      for (k in _ref1) {
        v = _ref1[k];
        _results.push((_base = Odometer.options)[k] != null ? (_base = Odometer.options)[k] : _base[k] = v);
      }
      return _results;
    }
  }, 0);

  Odometer.init = function() {
    var el, elements, _i, _len, _ref1, _results;
    if (document.querySelectorAll == null) {
      return;
    }
    elements = document.querySelectorAll(Odometer.options.selector || '.odometer');
    _results = [];
    for (_i = 0, _len = elements.length; _i < _len; _i++) {
      el = elements[_i];
      _results.push(el.odometer = new Odometer({
        el: el,
        value: (_ref1 = el.innerText) != null ? _ref1 : el.textContent
      }));
    }
    return _results;
  };

  if ((((_ref1 = document.documentElement) != null ? _ref1.doScroll : void 0) != null) && (document.createEventObject != null)) {
    _old = document.onreadystatechange;
    document.onreadystatechange = function() {
      if (document.readyState === 'complete' && Odometer.options.auto !== false) {
        Odometer.init();
      }
      return _old != null ? _old.apply(this, arguments) : void 0;
    };
  } else {
    document.addEventListener('DOMContentLoaded', function() {
      if (Odometer.options.auto !== false) {
        return Odometer.init();
      }
    }, false);
  }

  window.Odometer = Odometer;

}).call(this);


//SCRIPT: ../../vendor-mod/js/pointer_events_polyfill.js
/*
 * Pointer Events Polyfill: Adds support for the style attribute "pointer-events: none" to browsers without this feature (namely, IE).
 * (c) 2013, Kent Mewhort, licensed under BSD. See LICENSE.txt for details.
 * https://github.com/kmewhort/pointer_events_polyfill
 */

(function($) {
    function PointerEventsPolyfill(options) {
        // set defaults
        this.options = {
            selector: '*',
            mouseEvents: ['click', 'dblclick', 'mousedown', 'mouseup'],
            usePolyfillIf: function() {
                var dummyStyle = document.createElement('div').style;
                return 'pointerEvents' in dummyStyle;
            }
        };
        if (options) {
            var obj = this;
            $.each(options, function(k, v) {
                obj.options[k] = v;
            });
        }

        if (this.options.usePolyfillIf()) {
            this.register_mouse_events();
        }
    }

    // singleton initializer
    PointerEventsPolyfill.initialize = function(options) {
        if (PointerEventsPolyfill.singleton == null)
            PointerEventsPolyfill.singleton = new PointerEventsPolyfill(options);
        return PointerEventsPolyfill.singleton;
    };

    // handle mouse events w/ support for pointer-events: none
    PointerEventsPolyfill.prototype.register_mouse_events = function() {
        // register on all elements (and all future elements) matching the selector
        $(document).on(this.options.mouseEvents.join(" "), this.options.selector, function(e) {

            if ($(this).css('pointer-events') == 'none') {
                return false;
            }

        });
    };

    $(document).ready(function() {
        PointerEventsPolyfill.initialize({
            selector: 'a'
        });
    });

}(jQuery));


//SCRIPT: target/panasonic-js-engine_min_125.js
"use strict";var $j=jQuery.noConflict();Function.prototype.createDelegate=function(h,e,f){var g=this;return function(){var a=e||arguments;if(f===true){a=Array.prototype.slice.call(arguments,0);a=a.concat(e)}else{if(typeof f=="number"){a=Array.prototype.slice.call(arguments,0);var b=[f,0].concat(e);Array.prototype.splice.apply(a,b)}}return g.apply(h||this,a)}};var helpers={};helpers.getType=function(b){var a=jsonPath(window,b);if(a&&a.length>0){return a[0]}else{console.error("helpers.getType: Unable to find type '"+b+"'");return null}};helpers.assertExists=function(b,a){if(_.isUndefined(b)){throw new Error(a)}};helpers.assertParametersExistAndAddToObject=function(b,c,a){_.each(c,function(d){helpers.assertExists(b[d],"The constructor expects the parameter '"+d+"' to be passed in as a config parameter");if(!_.isUndefined(a)){a[d]=b[d]}})};helpers.checkAndAdd=function(d,c,b){var a;for(a in c){helpers.assertExists(d[a],"The constructor expects the parameter '"+a+"' to be passed in as a config parameter")}if(b){for(a in d){b[a]=d[a]}}};helpers.createComponentElementParameters=function(c,d,f,a,b,e){var g={el:c,page:d,feedManager:f,mediaManager:a,messageManager:b,applicationVariables:e,collectionContainers:{}};_.each(c.data(),function(i,h){if(_.isUndefined(g[h])){g[h]=i}});return g};helpers.addParametersToObjectIfExist=function(b,c,a){_.each(c,function(d){if(!_.isUndefined(a)&&!_.isUndefined(b[d])){a[d]=b[d]}})};helpers.assertParametersExist=function(a,b){helpers.assertParametersExistAndAddToObject(a,b)};helpers.assertTrue=function(a){if(a==="true"||a===true){return true}return false};helpers.changeDocumentLocation=function(a,b){b=b||window;b.location=a};helpers.openInBrowserApp=function(b,a){a=(a&&typeof a==="function")?a:function(){};JSEngine.IFAPIInitHelper.initialize("app_bridge/v1",function(c){var d=c[0];if(d.getBridgeType()!==d.BridgeType.NONE&&typeof d.sendMessage==="function"){d.sendMessage("app.open_browser",b)}else{a()}},a)};helpers.setWindowTitle=function(a){document.title=a};helpers.createNewWindow=function(d,a,c){a=a||"";var b=window.open(a,d);if(c){$j(b).load(function(){$j(b).unload(c)})}return b};helpers.navigateToPage=function(c,d,a){var b="#"+(c.name||c);if(d){b+="/"+encodeURIComponent(JSON.stringify(d))}helpers.changeDocumentLocation(b,a)};helpers.navigateToPageNewTab=function(b,c,a){helpers.changeDocumentLocation(helpers.buildPageUrl(b,c),a)};helpers.buildPageUrl=function(b,d,c){var a="#"+(b.name||b);if(d){a+="/"+encodeURIComponent(JSON.stringify(d))}a=document.location.pathname+a;return c?window.location.protocol+"//"+window.location.host+a:a};helpers.internalUrlToFullPath=function(b){if(b.indexOf("/")!==0){var f,c="",a=location.pathname.replace(/[^\/]*$/,b.replace(/(\/|^)(?:\.?\/+)+/g,"$1"));for(var e,d=0;e=a.indexOf("/../",d),e>-1;d=e+f){f=/^\/(?:\.\.\/)*/.exec(a.slice(e))[0].length;c=(c+a.substring(d,e)).replace(new RegExp("(?:\\/+[^\\/]*){0,"+((f-1)/3)+"}$"),"/")}b=c+a.substr(d)}return window.location.protocol+"//"+window.location.host+b};helpers.getDocumentLocation=function(){return document.location};helpers.getHtmlEl=function(){return $j("html")};helpers.getStUrl=function(a){var b=/\b-[A-z]+\b-[a-zA-Z0-9_-]*.html/;return b.exec(a)};helpers.getHashUrl=function(a){var b=/\#[a-zA-Z0-9_-]*/;return b.exec(a)};helpers.goBackRequest=false;helpers.windowHistoryGoBack=function(a){if(!helpers.goBackRequest){helpers.goBackRequest=true;window.setTimeout(function b(){helpers.goBackRequest=false},1000);window.history.go(a*-1)}};helpers.objInheritsFrom=function(b,a){return helpers.typeInheritsFrom(b.__proto__,a)};helpers.typeInheritsFrom=function(b,a){if(b.__super__==a.prototype){return true}else{if(b.__super__){return helpers.typeInheritsFrom(b.__super__.constructor,a)}else{return false}}};helpers.getTemplateMarkup=function(b){if(!_.isUndefined(b)){var a=$j("#"+b);if(!_.isUndefined(a)){return a.html()}}return null};helpers.getConfigFromFromElement=function(b){if(_.isString(b)){b=$j(b)}if(b&&b.length>=1&&b.text){var c=helpers.getHtmlFromElement(b);var a=jQuery.parseJSON(c);if(a){return a}else{console.error("Error parsing config",b.attr("id"))}}return null};helpers.getHtmlFromElement=function(a){if(a&&a.length>=1&&a.text){var b=a.text();if(_.isEmpty(b)){b=a[0].innerHTML}return b}return null};helpers.getApplicationConfig=function(){var b=helpers.getTemplateMarkup("app-config");if(b){var a=jQuery.parseJSON(b);if(a){if(document.location.hash){var d=document.location.hash.split("/");if(d.length>=2){try{a.urlParams=jQuery.parseJSON(d[1])}catch(c){}}}return a}else{console.log("Error parsing application config",b)}}return{}};helpers.attributeValueToArray=function(d,b){var c=-1,a,e=[];b=b||" ";if(d&&typeof d==="string"){d=d.split(b);a=d.length;while(++c<a){if(d[c]){e.push(d[c])}}}return e};helpers.endsWith=function(a,b){return a.indexOf(b,a.length-b.length)!==-1};helpers.setTimeout=function(a,b){return window.setTimeout(a,b)};helpers.clearTimeout=function(a){return window.clearTimeout(a)};helpers.setInterval=function(a,b){return window.setInterval(a,b)};helpers.clearInterval=function(a){return window.clearInterval(a)};helpers.matchMedia=function(a){return window.matchMedia(a)};helpers.getWindowEl=function(){return $j(window)};helpers.removeClassByPrefix=function(a,b){var c=a.attr("class")?a.attr("class").split(/\s+/):[];_.each(c,function(d){if(d.indexOf(b)>=0){a.removeClass(d)}})};helpers.loadExternalTemplates=function(c,a){var b=c.find("script[type='text/template']");var e=0;var d=function(){e++;if(e>=b.length){a()}};if(b.length>0){_.each(b,function(g){var f=$j(g);if(f.text().length==0&&f.attr("src")){$j.ajax({url:f.attr("src"),dataType:"html",success:function(i,h,j){f[0].textContent=i;d()}.createDelegate(this),error:function(h,j,i){f.text("//UNABLE TO LOAD: "+f.attr("src")+"\nError:\n"+i);d()}.createDelegate(this)})}else{d()}}.createDelegate(this))}else{d()}};helpers.parseTemplateMarkup=function(b,a){var d,c;b=(b instanceof $j)?b:$j(b);d=b.find(a);if(d.length===0){return null}return helpers.getHtmlFromElement(d)};helpers.parseNestedTemplates=function(a){var b=a.replace(/scr\+/g,"scr");b=b.replace(/<\+/g,"<");b=b.replace(/\+>/g,">");return b};helpers.firstLetterToLowerCase=function(a){return a.substring(0,1).toLowerCase()+a.substring(1)};var namespace=function(){var a=arguments,o=null,i,j,d,rt;for(i=0;i<a.length;++i){d=a[i].split(".");rt=d[0];eval("if (typeof window."+rt+' == "undefined"){window.'+rt+" = {};} o = window."+rt+";");for(j=1;j<d.length;++j){o[d[j]]=o[d[j]]||{};o=o[d[j]]}}};helpers.extractPrefixedOptions=function(b,c){var a={};_.each(b,function(e,d){if(d.indexOf(c)!==0){return}d=helpers.firstLetterToLowerCase(d.substring(c.length));a[d]=e});return a};helpers.localStorage=function(a,b){if(_.isUndefined(b)){return $j.cookie(a)}else{if(_.isNull(b)){$j.cookie(a,undefined)}else{$j.cookie(a,b)}}};helpers.getFlashInstallForDevice=function(a){a=a||{};if(browserHelpers.isWindows()){return a.flashWindows||"/software_installs/install_flash_player_11_plugin.exe"}else{if(browserHelpers.isOSX()){return a.flashMac||"/software_installs/install_flash_player_11_osx.dmg"}}};helpers.elementFromPoint=function(a,b){return document.elementFromPoint(a,b)};helpers.jsonPath=function(b,c){var a=helpers.jsonPath;if(helpers.getApplicationConfig().jsonPathResultToScalar){helpers.jsonPath=function(e,f){var d=jsonPath(e,f);return d.length==1?d[0]:d}}else{helpers.jsonPath=function(d,e){return jsonPath(d,e)}}helpers.jsonPath.reset=function(){helpers.jsonPath=a};return helpers.jsonPath(b,c)};if(!Object.prototype.hasOwnProperty){Object.prototype.hasOwnProperty=function(a){return _.has(this,a)}}if(!window.hasOwnProperty){window.hasOwnProperty=function(a){return _.has(this,a)}}if(!window.HTMLDocument){window.HTMLDocument=function(){}}var browserHelpers={};browserHelpers.isWindows=function(){return(navigator.appVersion.toLowerCase().indexOf("win")>-1)};browserHelpers.isiOSSDK=function(){return(browserHelpers.isiOS()&&navigator.userAgent.indexOf("InFlight")>-1)};browserHelpers.isLinux=function(){return(navigator.appVersion.toLowerCase().indexOf("linux")>-1||navigator.appVersion.toLowerCase().indexOf("unix")>-1||navigator.platform.toLowerCase().indexOf("linux")>-1||navigator.platform.toLowerCase().indexOf("unix")>-1)};browserHelpers.isOSX=function(){return(!browserHelpers.isiOS()&&navigator.appVersion.toLowerCase().indexOf("mac")>-1)};browserHelpers.isiPhone=function(){return(navigator.userAgent.toLowerCase().indexOf("iphone")>-1)};browserHelpers.isiPod=function(){return(navigator.userAgent.toLowerCase().indexOf("ipod")>-1)};browserHelpers.isiPad=function(){return(navigator.userAgent.toLowerCase().indexOf("ipad")>-1)};browserHelpers.isiOS=function(){return browserHelpers.isiPhone()||browserHelpers.isiPod()||browserHelpers.isiPad()};_.mixin({slice:function(b){var c=Array.prototype.slice,a=c.call(arguments,1);return c.apply(b,a)}});if(typeof Event!=="undefined"&&!Event.prototype.preventDefault){Event.prototype.preventDefault=function(){this.returnValue=false}}(function(){Backbone.Collection.prototype._set=function(b,j){j=j||{};var h=j.isEqual||false;if(!_.isFunction(h)){return Backbone.Collection.prototype.set.call(this,b,j)}var f,e;var d;var c=[];var g;for(f=0,e=b.length;f<e;f++){if(!(g=this._prepareModel(b[f],j))){continue}d=undefined;var a=_.filter(this.models,function(i){return h(i,g)});a=_.difference(a,c);if(a.length>0){d=a[0]}if(d){c.push(d);b[f]=d}}return Backbone.Collection.prototype.set.call(this,b,j)}}).call(this);namespace("JSEngine");JSEngine.DataAttributeHelper={paramSeparator:"|",valueSeparator:":",get:function(g,a,b,e,f){var d=$j(g),c,h;e=e||this.paramSeparator;if(d.length&&a){a=a.indexOf("data")===0?a:"data-"+a;c=d.attr(a);if(c.indexOf(e)!==-1){h=c.split(e);if(_.isUndefined(b)||b){c={val:h.shift(),params:{}};_.each(h,function(k){var i,j;if(k){k=k.split(f||this.valueSeparator);i=k.shift();j=k.shift()}c.params[i]=j},this)}else{c=h.shift()}}}return c},getVal:function(c,a,b){return this.get(c,a,false,b)},getParams:function(e,a,c,d){var b=this.get(e,a,true,c,d);return(b&&_.isObject(b)&&b.params)||{}}};ComponentSpy=function(b,a){this.newObjectCreations=[];this.wrapObjectFunctions(b,a)};ComponentSpy.prototype.wrapObjectFunctions=function(c,b){var a=this.newObjectCreations;_.each(c,function(e,d,f){if(_.isFunction(e)){f[d]=function(){a.push({typeFullName:(b+"."+d),args:arguments});return e.apply(this,arguments)};f[d].prototype=e.prototype;f[d].__super__=e.__super__}else{if(_.isObject(e)){this.wrapObjectFunctions(e,b+"."+d)}}},this)};ComponentSpy.prototype.flushObjectCreationsToLog=function(){_.each(this.newObjectCreations,function(a){console.log(a.typeFullName,a.args)});this.newObjectCreations=[]};ComponentSpy.prototype.generateReport=function(){var a={};var b=function(c){params=_.flatten(c);names=[];_.each(params,function(e,d){if(_.isObject(e)){if(e instanceof $j){names.push("jQuery")}else{names=_.union(names,_.keys(e))}}else{names.push(typeof e)}});return _.uniq(names)};_.each(this.newObjectCreations,function(d){a[d.typeFullName]=a[d.typeFullName]||[];var c=b(d.args);a[d.typeFullName]=_.union(c,a[d.typeFullName])});console.group("Components Used");_.each(_.sortBy(_.keys(a),function(c){return c}),function(c){console.log(c,a[c])});console.groupEnd()};namespace("JSEngine");var oldBind=$j.bind;$j.bind=function(b,a){if(b==="click"){var c=this;c.bind("doubletap",function(d){d.preventDefault();console.log(d.target.outerHTML);console.log($j(d.target).html());c.trigger("click")});oldBind.call(this,[b,a])}};JSEngine.EngineContoller=Backbone.Model.extend({initialize:function(b){b=b||{};this.applicationVariables=helpers.getApplicationConfig();this.applicationVariables.useServiceControl=(this.applicationVariables.hasOwnProperty("useServiceControl"))?this.applicationVariables.useServiceControl:true;JSEngine.EventHandler=new JSEngine.EventHandlerWrapper(this.applicationVariables);this.transitionController=new JSEngine.TransitionController();this.feedManager=new JSEngine.FeedManager();this.locks={};this.tabHandler=new JSEngine.TabHandler();this.messageManager=new JSEngine.MessageManager({applicationVariables:this.applicationVariables});this.mediaManager=new JSEngine.MediaManager({applicationVariables:this.applicationVariables});this.reportManager=new JSEngine.ReportManager({applicationVariables:this.applicationVariables});if(this.applicationVariables.screenConfig&&this.applicationVariables.screenConfig.preventTouchMove){JSEngine.TouchHandler.startTouchMoveHandler(this.applicationVariables.screenConfig.preventTouchMove)}if(this.applicationVariables.screenConfig&&this.applicationVariables.screenConfig.handleTouchStartEnd){var c=[{minWidth:1,direction:"horizontal"}];var d=this.applicationVariables.screenConfig.touchMoveDirections||c;JSEngine.TouchHandler.startTouchStartAndEndHandler(this.applicationVariables.screenConfig.touchMoveThreshold,d)}var a=function(){this.init(b.afterInitialise)}.createDelegate(this);if(this.applicationVariables.drm){if(this.applicationVariables.drm.softwareInstallMessages){this.setSoftwareInstallMessages()}this.setupDRM(a)}else{a()}Backbone.Model.prototype.initialize.call(this)},init:function(b){this.runModernizrStyleChecks();if(this.applicationVariables.useServiceControl){JSEngine.EventHandler.subscribe("serviceControlStatusChange","serviceControlStatusChange_"+(_.uniqueId()),this.checkServiceStatus.createDelegate(this))}var a=function(){this.initLocks();this.initLocksRedirect();this.initApplyLocks();this.initPaEvents();this.notifyAppAboutPortalVersion();if(this.applicationVariables.preload&&this.applicationVariables.preload.afterLoadImages&&_.isArray(this.applicationVariables.preload.afterLoadImages)&&this.applicationVariables.preload.afterLoadImages.length>0){this.preloadImages(this.applicationVariables.preload.afterLoadImages)}var c=function(){this.initPageManager();if(b){b(this)}}.createDelegate(this);if(this.applicationVariables.flightEvents){JSEngine.EventHandler.subscribe("flightEvents:initialise","flightEventsInitialise_"+_.uniqueId(),function(d){this.applyFlightKlassOnInit(d);this.loadExternalTemplates(c)}.createDelegate(this));JSEngine.EventHandler.subscribe("flightEvents:flightChange","flightChange_"+_.uniqueId(),this.onFlightChange.createDelegate(this))}else{this.loadExternalTemplates(c)}}.createDelegate(this);if(this.applicationVariables.background&&this.applicationVariables.background.isDynamic){JSEngine.BGHandler.initialise(this.applicationVariables.background,this.getHtmlEl())}if(this.applicationVariables.preload&&this.applicationVariables.preload.beforeLoadImages&&_.isArray(this.applicationVariables.preload.beforeLoadImages)&&this.applicationVariables.preload.beforeLoadImages.length>0){this.preloadImages(this.applicationVariables.preload.beforeLoadImages,a)}else{a()}this.setUserAgentClass()},initPaEvents:function(){JSEngine.EventHandler.subscribe("paoff","paoff_"+(_.uniqueId()),this.paOffEvent.createDelegate(this));JSEngine.EventHandler.subscribe("paaudio","paaudio_"+(_.uniqueId()),this.paOnAudioEvent.createDelegate(this));JSEngine.EventHandler.subscribe("pavideo","pavideo_"+(_.uniqueId()),this.paOnVideoEvent.createDelegate(this));JSEngine.EventHandler.subscribe("pavideoa","pavideoa_"+(_.uniqueId()),this.paOnVideoAEvent.createDelegate(this));JSEngine.EventHandler.subscribe("paother","paother_"+(_.uniqueId()),this.paOnOtherEvent.createDelegate(this))},paScrollStop:function(a){a.preventDefault();a.stopPropagation();return false},paOnAudioEvent:function(){$j(document).on("scroll touchmove mousewheel keydown",this.paScrollStop);this.getHtmlEl().addClass("ae-pa-audio")},paOnVideoEvent:function(){$j(document).on("scroll touchmove mousewheel keydown",this.paScrollStop);this.getHtmlEl().addClass("ae-pa-video")},paOnVideoAEvent:function(){$j(document).on("scroll touchmove mousewheel keydown",this.paScrollStop);this.getHtmlEl().addClass("ae-pa-video-a")},paOnOtherEvent:function(){$j(document).on("scroll touchmove mousewheel keydown",this.paScrollStop);this.getHtmlEl().addClass("ae-pa-other")},paOffEvent:function(){$j(document).off("scroll touchmove mousewheel keydown",this.paScrollStop);this.getHtmlEl().removeClass("ae-pa-audio");this.getHtmlEl().removeClass("ae-pa-video");this.getHtmlEl().removeClass("ae-pa-video-a");this.getHtmlEl().removeClass("ae-pa-other")},runModernizrStyleChecks:function(a){JSEngine.IFAPIInitHelper.initialize("avod/v1",function(c){var b=c[0];var d=function(e,f){switch(f){case 0:this.addModernizerCheckFeature(["no-"+e]);break;case 1:this.addModernizerCheckFeature([e,"html5-"+e,"no-html5-partial-"+e]);break;case 2:this.addModernizerCheckFeature([e,"flash-"+e,"no-flash-partial-"+e]);break;case 3:this.addModernizerCheckFeature([e,"html5-"+e,"html5-partial-"+e]);break;case 4:this.addModernizerCheckFeature([e,"flash-"+e,"flash-partial-"+e]);break;case 5:this.addModernizerCheckFeature([e,"ios-sdk-"+e,"no-ios-sdk-partial-"+e]);break}}.createDelegate(this);d("video",b.support.platform.vod);d("audio",b.support.platform.aod);d("tv",b.support.platform.tv);d("radio",b.support.platform.radio);if(a){a()}}.createDelegate(this))},checkServiceStatus:function(a){var c=this.getHtmlEl();var d=[];try{d=$j(".ae-ifapi-services-"+a.serviceName+"-state-dependent")}catch(b){}if(a.blocked||!a.enabled){c.removeClass("ae-ifapi-services-"+a.serviceName+"-enabled");c.addClass("ae-ifapi-services-"+a.serviceName+"-disabled");if(d.length>0){d.attr("aria-hidden","true")}}else{c.removeClass("ae-ifapi-services-"+a.serviceName+"-disabled");c.addClass("ae-ifapi-services-"+a.serviceName+"-enabled");if(d.length>0){d.attr("aria-hidden","false")}}},addModernizerCheckFeature:function(b){var a=this.getHtmlEl();_.each(b,function(c){a.addClass("ae-"+c)})},initPageManager:function(){this.pageManager=new JSEngine.PageManager({parentEl:$j("html"),locks:this.locks,transitionController:this.transitionController,feedManager:this.feedManager,applicationVariables:this.applicationVariables,mediaManager:this.mediaManager,messageManager:this.messageManager,reportManager:this.reportManager})},preloadImages:function(b,a){$j.imgpreload(b,{each:function(){},all:a})},initLocks:function(){_.each($j(".page-lock"),function(a){var d=$j(a);var b=d.attr("id");var c=(parseInt(d.attr("data-display-lock-timeout"))||5)*1000;if(!_.isUndefined(b)&&_.isUndefined(this.locks[b])){this.locks[b]=new JSEngine.PageLock({el:d,name:b,isLocked:false,displayLockTimeoutSeconds:c})}},this)},initLocksRedirect:function(){_.each($j(".page-lock-redirect"),function(a){var c=$j(a);var b=c.attr("data-lock-name")||c.attr("id");if(!_.isUndefined(b)&&_.isUndefined(this.locks[b])){this.locks[b]=new JSEngine.PageLockRedirect({$page:c,name:b,isLocked:false})}},this)},initApplyLocks:function(){_.each($j(".page-lock-apply-lock"),function(b){var c=$j(b);var a=c.attr("data-lock");if(this.locks[a]){c.bind("click",function(){this.locks[a].lock()}.createDelegate(this))}},this)},setSoftwareInstallMessages:function(){JSEngine.IFAPIInitHelper.initialize("avod/v1",function(b){var a=b[0];if(this.applicationVariables.drm.softwareInstallMessages.drmPlugin){a.setSoftwareInstallMessage(a.SoftwareRequired.DRM_PLUGIN,this.applicationVariables.drm.softwareInstallMessages.drmPlugin)}if(this.applicationVariables.drm.softwareInstallMessages.flashPlugin){a.setSoftwareInstallMessage(a.SoftwareRequired.FLASH_PLUGIN,this.applicationVariables.drm.softwareInstallMessages.flashPlugin)}if(this.applicationVariables.drm.softwareInstallMessages.iosApplication){a.setSoftwareInstallMessage(a.SoftwareRequired.IOS_APPLICATION,this.applicationVariables.drm.softwareInstallMessages.iosApplication)}if(this.applicationVariables.drm.softwareInstallMessages.androidApplication){a.setSoftwareInstallMessage(a.SoftwareRequired.ANDROID_APPLICATION,this.applicationVariables.drm.softwareInstallMessages.androidApplication)}}.createDelegate(this))},setupDRM:function(a){JSEngine.IFAPIInitHelper.initialize("avod/v1",function(c){var b=c[0];JSEngine.IFAPIInitHelper.initialize("metadata/v1",function(f){var d=f[0];var e={seat_class:"all"};this.applicationVariables.drm.softwareRequired="";this.applicationVariables.drm.requiredSoftwareTypes="";this.applicationVariables.drm.requiredSoftwareLink="";this.applicationVariables.drm.softwareInstallMessage="";d.getRequiredSoftwareForMedia(e,function(h,g){if(!h){this.applicationVariables.drm.softwareRequired=g;this.applicationVariables.drm.requiredSoftwareTypes=b.SoftwareRequired;switch(g){case b.SoftwareRequired.FLASH_PLUGIN:var i=(b.getSoftwareUrl(b.SoftwareRequired.FLASH_PLUGIN)!==null)?b.getSoftwareUrl(b.SoftwareRequired.FLASH_PLUGIN):helpers.getFlashInstallForDevice(this.applicationVariables.drm.pluginURLs);this.applicationVariables.drm.requiredSoftwareLink=i;this.applicationVariables.drm.softwareInstallMessage=this.applicationVariables.drm.softwareInstallMessages.flashPlugin;this.addModernizerCheckFeature(["drm-required"]);break;case b.SoftwareRequired.DRM_PLUGIN:this.applicationVariables.drm.requiredSoftwareLink=b.getSoftwareUrl(b.SoftwareRequired.DRM_PLUGIN);this.applicationVariables.drm.softwareInstallMessage=this.applicationVariables.drm.softwareInstallMessages.drmPlugin;this.addModernizerCheckFeature(["drm-required"]);break;case b.SoftwareRequired.IOS_APPLICATION:var i=(b.getSoftwareUrl(b.SoftwareRequired.IOS_APPLICATION)!==null)?b.getSoftwareUrl(b.SoftwareRequired.IOS_APPLICATION):this.applicationVariables.drm.pluginURLs.iosApp;this.applicationVariables.drm.requiredSoftwareLink=i;this.applicationVariables.drm.softwareInstallMessage=this.applicationVariables.drm.softwareInstallMessages.iosApplication;this.addModernizerCheckFeature(["drm-required"]);break;case b.SoftwareRequired.ANDROID_APPLICATION:var i=(b.getSoftwareUrl(b.SoftwareRequired.ANDROID_APPLICATION)!==null)?b.getSoftwareUrl(b.SoftwareRequired.ANDROID_APPLICATION):this.applicationVariables.drm.pluginURLs.androidApp;this.applicationVariables.drm.requiredSoftwareLink=i;this.applicationVariables.drm.softwareInstallMessage=this.applicationVariables.drm.softwareInstallMessages.androidApplication;this.addModernizerCheckFeature(["drm-required"]);break;default:this.applicationVariables.drm.softwareRequired=null;if(!_.isEmpty(this.applicationVariables.drm.requiredSoftwareLink)){delete this.applicationVariables.drm.requiredSoftwareLink}$j("html").removeClass("drm-required");break}a();this.trigger("drmInitComplete")}}.createDelegate(this))}.createDelegate(this))}.createDelegate(this))},viewPage:function(b,a){this.pageManager.viewPage(b,a)},getApplicationVariables:function(){return this.applicationVariables},getHtmlEl:function(){return $j("html")},loadExternalTemplates:function(a){helpers.loadExternalTemplates(this.getHtmlEl(),a)},onFlightChange:function(c,f){if(_.isArray(this.applicationVariables.flightEvents.flightHtmlClasses)){var b=this.applicationVariables.flightEvents.flightHtmlClasses.length;var e=helpers.localStorage("lastFlightKlass");var d=this.applicationVariables.flightEvents.flightHtmlClasses.indexOf(e);var a=this.getFlightKlassIndexByFlightId(c);if(a==d){if(d<(b-1)){a++}else{a=0}}this.applyFlightClassByIndex(a)}},applyFlightKlassOnInit:function(a){var b=this.getFlightKlassIndexByFlightId(a);this.applyFlightClassByIndex(b)},applyFlightClassByIndex:function(b){var c=this.getHtmlEl();_.each(this.applicationVariables.flightEvents.flightHtmlClasses,function(d){c.removeClass(d)});var a=this.applicationVariables.flightEvents.flightHtmlClasses[b];c.addClass(a);helpers.localStorage("lastFlightKlass",a)},getFlightKlassIndexByFlightId:function(b){var a=this.applicationVariables.flightEvents.flightHtmlClasses.length;return Math.abs(Math.ceil(b%a))},notifyAppAboutPortalVersion:function(){JSEngine.IFAPIInitHelper.initialize("sdk/v1/iosbridge",function(a){var c=a[0];var b={message:"ifapi.portal.version",payload:this.applicationVariables.version||1};c.call("ifapi.portal.notification",b,null)}.createDelegate(this))},setUserAgentClass:function(){document.getElementsByTagName("html")[0].className+=(function(){var f=navigator.userAgent,g=(/OS 7_0_/gi).test(f),a=(/iPad/gi).test(f),e=(/iPhone/gi).test(f),c=(/Safari/gi).test(f),b=(/InFlight/gi).test(f),d=(/Android/gi).test(f);return(g?" ios7":"")+(a?" ipad":"")+(e?" iphone":"")+(c?" safari":"")+(b?" iossdk":"")+(d?" android":"")})()}});namespace("JSEngine");JSEngine.TransitionController=Backbone.Model.extend({initialize:function(){this.pageHandlers={};this.defaultPageHandler=new JSEngine.PageTransitionHandler();_.each(JSEngine,function(b,a){if(_.isFunction(b)){if(helpers.typeInheritsFrom(b,JSEngine.PageTransitionHandler)){this.pageHandlers[a]=new b()}}},this);Backbone.Model.prototype.initialize.call(this)},getPageHandler:function(a){if(!_.isUndefined(this.pageHandlers[a])){return this.pageHandlers[a]}else{return this.defaultPageHandler}}});namespace("JSEngine");JSEngine.BaseCollection=Backbone.Collection.extend({initialize:function(b,a){this.pageActivated=_.bind(this.pageActivated,this);this.onFetchSuccess=_.bind(this.onFetchSuccess,this);this.onFetchFail=_.bind(this.onFetchFail,this);this.clearTimeout=_.bind(this.clearTimeout,this);this.onTransitionAway=_.bind(this.onTransitionAway,this);this.onBeforePageActivate=_.bind(this.onBeforePageActivate,this);a=a||{};this.options=a;this.customDataTransformerFunction=a.customDataTransformerFunction||this.customDataTransformerFunction;if(!_.isEmpty(a.sortString)){this.options.comparator=this.comparatorFunc}this.lastFetchTimeMs=0;helpers.assertParametersExistAndAddToObject(a,["page"],this);this.on("fetchSuccess",this.onFetchSuccess);this.on("fetchFail",this.onFetchFail);this.on("reActivate",this.pageActivated);Backbone.Collection.prototype.initialize.call(this,b,a)},bindToPageEvents:function(a){this.removeFromPageEvents(a);a.on("renderContent",this.pageActivated);a.on("transitionAway",this.onTransitionAway);a.on("beforeActivate",this.onBeforePageActivate);return this},removeFromPageEvents:function(a){a.off("renderContent",this.pageActivated);a.off("transitionAway",this.onTransitionAway);a.off("beforeActivate",this.onBeforePageActivate);return this},onBeforePageActivate:function(a,b){if(this.hasFeedChanged(b)){this.hasBeenFetched=false;this.trigger("feedChanging",this)}},onFetchSuccess:function(){delete this.isBeingFetched;if(this.options.collectionRefreshTimeout>0){var a=function(){this.fetch(this.options)}.createDelegate(this);this.timeOut=window.setTimeout(a,this.options.collectionRefreshTimeout)}this.hasBeenFetched=true;this.lastFetchTimeMs=new Date().getTime()},onTransitionAway:function(){this.clearTimeout()},clearTimeout:function(){clearTimeout(this.timeOut)},fetch:function(a){if(!this.isBeingFetched){this.isBeingFetched=true;this.trigger("fetchStart",this);this._fetch(a);return true}else{console.log("Already fetching:",this);return false}},_fetch:function(a){},onFetchFail:function(){delete this.isBeingFetched;if(this.options.collectionFailRetryTimeout>0){var a=function(){this.fetch(this.options)}.createDelegate(this);this.timeOut=window.setTimeout(a,this.options.collectionFailRetryTimeout)}},pageActivated:function(){var a=this.options;if(this.hasFeedChanged(this.options.applicationVariables)||this.options.collectionRefreshTimeout>0){a.hasFeedChanged=true;this.fetch(a);delete a.hasFeedChanged}},comparatorFunc:function(c,a){var b=a.sortString.split(".");if(b.length>0){return helpers.jsonPath(c,a.sortString)}else{return false}},parse:function(a){if(_.isArray(a)){for(var b=0;b<a.length;b++){if(!_.isArray(a[b])&&!_.isObject(a[b])){a[b]={value:a[b]}}}}return this.customDataTransformerFunction(a)},customDataTransformerFunction:function(a){return a},success:function(){this.trigger("fetchSuccess",this);this.trigger("fetchSuccessComplete",this)},fail:function(a,b){this.trigger("fetchFail",a,b)},set:function(b,j){j=j||{};var h=j.isEqual||false;if(!_.isFunction(h)){return Backbone.Collection.prototype.set.call(this,b,j)}var f,e;var d;var c=[];var g;for(f=0,e=b.length;f<e;f++){if(!(g=this._prepareModel(b[f],j))){continue}d=undefined;var a=_.filter(this.models,function(i){return h(i,g)});a=_.difference(a,c);if(a.length>0){d=a[0]}if(d){c.push(d);b[f]=d}}return Backbone.Collection.prototype.set.call(this,b,j)}});namespace("JSEngine");JSEngine.URLHelpers={parseParameters:function(f,a){var c=null,d;if(_.isEmpty(f)){f=this.getParamsFromHash()}if(!_.isEmpty(f)){d=a?f:this.urlDecode(f);try{c=jQuery.parseJSON(d)}catch(b){console.debug("Cannot parse '",d,"' to JSON")}}return c},urlDecode:function(a){return decodeURIComponent((a+"").replace(/\+/g,"%20"))},getParamsFromHash:function(){var c={};var b=window.location.hash;if(b){var a=window.location.hash.match(/{.*}/g);if(a&&a[0]){c=a[0]}}return c}};namespace("JSEngine");JSEngine.Model=Backbone.Model.extend({initialize:function(b,a){this.on("fetchSuccess",function(){this.hasBeenFetched=true}.createDelegate(this))}});namespace("JSEngine");JSEngine.AppRouter=Backbone.Router.extend({routes:{":pagename/*actions":"viewPageWithParams",":pagename":"viewPageByName","*path":"localeAndDeviceDetectionAndRouting"},initialize:function(a){a=a||{};if(!a.engineController){throw new Error("Unable to start Router without an EngineController being passed into the Constructor")}this.engineController=a.engineController},localeAndDeviceDetectionAndRouting:function(){var b=this.getDeviceRoutingObjects();if(b){var c=false;for(var a=0;a<b.length;a++){if(b[a].doCheck(navigator)){if(c==true&&b[a].page==undefined){continue}var d=((b[a].physicalPage!=undefined)?b[a].physicalPage:"")+((b[a].page!=undefined)?"#"+b[a].page:"");if(!helpers.endsWith(this.getWindow().location.pathname,d)){helpers.changeDocumentLocation(d);return}if(b[a].page==undefined){c=true}else{break}}}}console.log("No routing data found, routing back to default");this.viewDefaultPage()},getWindow:function(){return window},viewDefaultPage:function(){var a=$j("body").attr("data-first-page");if(a!=undefined){this.engineController.viewPage(a,null)}else{this.engineController.viewPage("",null)}},viewPageByName:function(a){this.engineController.viewPage(a,null)},viewPageWithParams:function(a,b){this.engineController.viewPage(a,JSEngine.URLHelpers.parseParameters(b,true))},getDeviceRoutingObjects:function(){var a=$j("#device-routing");if(a&&a.html()!=""){var c=jQuery.parseJSON(a.html());if(c){var d=[];for(var b=0;b<c.length;b++){if(JSEngine[c[b].type]){d.push(new JSEngine[c[b].type](c[b]))}}return d}else{console.log("Error parsing routingData",a)}}return null}});namespace("JSEngine");JSEngine.CollectionContainer=Backbone.Model.extend({initialize:function(a){a=a||{};helpers.assertParametersExist(a,["id","container","template","collection","elementWrapper"]);this.id=a.id;this.container=a.container;this.template=a.template;this.loadingTemplate=a.loadingTemplate;this.noDataTemplate=a.noDataTemplate;this.elementWrapper=a.elementWrapper;this.collection=a.collection;this.pager=a.pager;this.filter=a.filter;this.mustRenderContent=true;this.pagingCount=a.pagingCount;this.pagingTransitionSpeed=a.pagingTransitionSpeed||800;this.pagerChanged=true;this.includeWrappingDiv=(a.container.data&&!_.isUndefined(a.container.data("includeWrappingDiv")))?a.container.data("includeWrappingDiv"):true;this.config=a;if(!_.isUndefined(this.pager)){this.pager.on("onPagerChange",this.onPagerChange.createDelegate(this));this.container.addClass("swiper-container");this.doPagination=true}if(!_.isUndefined(this.filter)){this.filter.on("onFilterChanged",this.onFilterChange.createDelegate(this))}interfaceToolkit.pagination(this.elementWrapper.page.el,this.container);this.collection.on("fetchStart",this.onFetchStart.createDelegate(this));this.collection.on("fetchSuccess",this.onFetchSuccess.createDelegate(this));this.collection.on("fetchFail",this.onFetchFail.createDelegate(this));if(this.elementWrapper.page.isActive){this.collection.trigger("reActivate")}if(this.collection.hasBeenFetched){this.elementWrapper.page.on("activate",function(){this.onFetchStart();this.onFetchSuccess(this.collection)}.createDelegate(this))}Backbone.Model.prototype.initialize.call(this,a)},onFetchStart:function(){this.applyLoadTemplate(this.elementWrapper.applicationVariables)},onFetchSuccess:function(a){this.success(a,this.elementWrapper.applicationVariables);this.renderComplete()},onFetchFail:function(a,b){this.renderComplete()},onPagerChange:function(b,a){this.pagerChangeDetails=a;this.pagerChanged=true;this.activeSliderPageIndex=this.pagerChangeDetails.pageNumber},onFilterChange:function(a,b){this.mustRenderContent=true},onAfterPageActivate:function(){if(this.swiper){this.swiper.init();this.swiper.swipeTo(this.activeSliderPageIndex,0,false)}console.log("page change")},renderComplete:function(){if(this.pagerChanged){this.pagerChanged=false;if(this.pagerChangeDetails&&this.swiper){this.swiper.swipeTo(this.pagerChangeDetails.pageNumber,this.pagingTransitionSpeed,true)}}},applyLoadTemplate:function(b){if(!_.isEmpty(this.loadingTemplate)){var a=_.template(this.loadingTemplate,b);this.writeToContainer(a)}},writeToContainer:function(a){var b=this.container;if(this.includeWrappingDiv){b=$j('<div class="wrap swiper-wrapper"></div>');this.container.html(b)}b.html(a);return b},getModelsToRender:function(e,d){var f=e.models;if(!_.isUndefined(this.filter)){f=this.filter.getFilteredResults(e)}var b=this.container.data("itemLimit")||0;var c=this.container.data("itemOffset")||0;if(c>0){f=_.rest(f,c);e.length=f.length}if(b>0){f=_.first(f,b);e.length=f.length}if(!_.isUndefined(this.pager)){var a=this.pager._getPagingConfig(f,this.pagingCount,d,0,null);this.activeSliderPageIndex=this.pager.pageNumber;this.trigger("dataChanged",a)}return f},success:function(d,c,b){var a=this.writeToContainer("");var e=this.getModelsToRender(d,c);this.view=new JSEngine.CollectionView({container:a,template:this.template,noDataTemplate:this.noDataTemplate,pagingCount:this.pagingCount,doPagination:this.doPagination,models:e,activeSliderPageIndex:this.activeSliderPageIndex});this.view.render(c);this.createChildElementWrapper(this.elementWrapper);interfaceToolkit.scrollPanes(this.elementWrapper.page.el);a.removeClass("hide");if(!_.isUndefined(this.pager)){this.createSwiper(e,c,b)}this.trigger("dataLoaded",this,d)},createSwiper:function(c,b,a){helpers.setTimeout(function(){this.activeSliderPageIndex=0;this.swiper=new Swiper("#"+this.id,{simulateTouch:false,speed:this.pagingTransitionSpeed,onSlideChangeEnd:function(){var d=this.pager._getPagingConfig(c,this.pagingCount,b,0,null);this.trigger("dataChanged",d);this.activeSliderPageIndex=this.swiper.activeSlide;this.view.renderSlideChange(this.activeSliderPageIndex,b)}.createDelegate(this)});this.renderComplete()}.createDelegate(this),500)},createChildElementWrapper:function(a){if(this.childElementWrapper){this.childElementWrapper.cleanUp();delete this.childElementWrapper}this.childElementWrapper=new JSEngine.ElementWrapper({el:this.container,applicationVariables:a.applicationVariables,page:a.page,feedManager:a.feedManager,mediaManager:a.mediaManager,messageManager:a.messageManager})}});namespace("JSEngine");JSEngine.PlaylistContainer=Backbone.Model.extend({initialize:function(a){a=a||{};console.log("PlaylistContainer: initialize");helpers.assertParametersExist(a,["id","container","template","collection","elementWrapper"]);this.id=a.id;this.container=a.container;this.template=a.template;this.loadingTemplate=a.loadingTemplate;this.noDataTemplate=a.noDataTemplate;this.collection=a.collection;this.elementWrapper=a.elementWrapper;this.mustRenderContent=true;this.player=null;Backbone.Model.prototype.initialize.call(this,a)},comparatorFunc:function(c,a){var b=a.sortString.split(".");if(b.length>0){return jsonPath(c,a.sortString)}else{return false}},bindPlayer:function(a){this.player=a;this.player.on("playlistindexchange",function(){this.renderPlaylistChanges(this)}.createDelegate(this));this.player.on("playlistelementselected",function(b){this.player.player.playlistPlayItemByIndex(b)}.createDelegate(this))},onFilterChange:function(a,b){this.mustRenderContent=true},onPageLoad:function(a,b){if(this.mustRenderContent||this.collection.hasFeedChanged(b)){this.renderContent(b)}this.mustRenderContent=false},renderContent:function(b){var a=this.container.attr("data-always-fetch")!=="true";this.applyLoadTemplate(b);this.applicationVariables=b;this.collection.fetch({success:this.success.createDelegate(this,[this.collection,b],true),fail:this.fail.createDelegate(this,[b],true),useCachedCopy:a,applicationVariables:b,comparator:this.comparatorFunc})},renderPlaylistChanges:function(){var b=this.player.player.playlistGetCurrentItemIndex()*1;var a="";_.each($j(this.container).find("tr.track"),function(f,e){if(e==b){$j(f).addClass("highlight-row");a=_.values(this.collection.models[0].attributes)[b].title.eng}else{$j(f).removeClass("highlight-row")}},this);var d=((this.applicationVariables.audioTrackTuncationInPlayer)?this.applicationVariables.audioTrackTuncationInPlayer:18);var c=(b+1)+" of "+this.player.player.playlistGetInfo().length+" "+((a.length>d)?a.substr(0,d)+"...":a);$j("#track-meta").show();$j("#track-meta").html(c)},applyLoadTemplate:function(b){if(!_.isEmpty(this.loadingTemplate)){var a=_.template(this.loadingTemplate,b);$j(this.container).append(a)}},getModelsToRender:function(b,a){var c=b.models;return c},success:function(c,b){var a=new JSEngine.PlaylistView({container:this.container,template:this.template,noDataTemplate:this.noDataTemplate,models:this.getModelsToRender(c,b),playlist:this,type:$j(this.container).attr("data-playlist-type")});$j(this.container).find("tr.playlist-loading").remove();a.render(b);this.createChildElementWrapper(this.elementWrapper);interfaceToolkit.scrollPanes(this.elementWrapper.page.el);this.trigger("dataLoaded",this,c)},fail:function(a,b){console.debug("error loading");console.debug(a)},createChildElementWrapper:function(a){if(this.childElementWrapper){this.childElementWrapper.cleanUp();delete this.childElementWrapper}this.childElementWrapper=new JSEngine.ElementWrapper({el:this.container,applicationVariables:a.applicationVariables,page:a.page,feedManager:a.feedManager,mediaManager:a.mediaManager,messageManager:a.messageManager})}});namespace("JSEngine");JSEngine.Pager=Backbone.Model.extend({initialize:function(a){a=a||{};helpers.assertParametersExistAndAddToObject(a,["id"],this);this.pageNumber=this._getPageChangeDetails(a.applicationVariables).pageNumber},getPagedData:function(d,b,e,f,c){var a=this._getPagingConfig(d,b,e,f,c);return d.slice(a.startRecord,a.endRecord+1)},onPageChange:function(b,c){var a=this._getPageChangeDetails(c);if(a.hasChanged){this.pageNumber=a.pageNumber;this.trigger("onPagerChange",c,a)}},getCurrentPageNumber:function(){return this.pageNumber},hasChanged:function(a){return this._getPageChangeDetails(a).hasChanged},_getPageChangeDetails:function(b){var a=this._getPageNumber(b);return{hasChanged:(this.pageNumber!=a),pageNumber:a,previousPageNumber:this.pageNumber}},_getPageNumber:function(a){if(_.isObject(a)&&_.isObject(a.urlParams)&&_.isObject(a.urlParams[this.id])&&_.isNumber(a.urlParams[this.id].page)){return parseInt(a.urlParams[this.id].page,10)}return 0},_getPagingConfig:function(f,b,g,h,d){var a=this._getPageNumber(g);d=d||f.length;h=h||0;var c=a*b+h;var e=c+b+h-1;if((e-c)>=d){e=c+d-1}if(f.length<=c){c=f.length-1}if(f.length<=e){e=f.length-1}c=c<0?0:c;e=e<0?0:e;return this._createPagingConfig(c,e,h,f.length)},_createPagingConfig:function(a,b,d,c){if(a<0){throw new Error("Start record cannot be less than 0")}else{if(b>=c&&b!=0){throw new Error("End record must be less than totalRecords")}}return{startRecord:a,endRecord:b,hasNext:function(){var e=c>(b+d+1);return e},hasPrevious:function(){var e=(a-d)>0;return e}}}});namespace("JSEngine");JSEngine.PageWrapper=Backbone.Model.extend({initialize:function(a){a=a||{};helpers.assertParametersExistAndAddToObject(a,["name","el","transitionHandler","applicationVariables","feedManager","pageManager","mediaManager","messageManager","reportManager"],this);helpers.addParametersToObjectIfExist(a,["pagePreload"],this);this.lock=a.lock;this.locksToApplyOnActivate=a.locksToApplyOnActivate||[];this.pageLoadUrl=a.pageLoadUrl;this.pageLoadStratergy=a.pageLoadStratergy||"INLINE";this.scrollToTop=this.el.data("scrollToTop");this.pageActiveClass="ae-page-active-";this.isGlobalContainer=false;if(this.pagePreload){this.loadCb=function(){this.loadCb=undefined}.createDelegate(this);this.loadPageFromUrl(function(){if(this.loadCb){this.loadCb.call(this)}}.createDelegate(this))}this.on("activate",this.onPageActivate.createDelegate(this));this.on("transitionAway",this.onTransitionAway.createDelegate(this));this.on("hideModalWindow",this.onTransitionAway.createDelegate(this));this.addedActiveClass=false},onPageActivate:function(){this.isActive=true;if(!this.addedActiveClass){$j("body").addClass(this.pageActiveClass+this.name)}if(this.scrollToTop){this.doScrollToTop()}},doScrollToTop:function(){$j("body, html").scrollTop(0)},beforePageShow:function(a,b){var c=function(){if(this.applicationVariables.addActivePageClass&&this.applicationVariables.addActivePageClass.beforePageShow){$j("body").addClass(this.pageActiveClass+this.name);this.addedActiveClass=true}this.triggerWithCallback("beforePageShow",a,this,b);this.loadCb=undefined}.createDelegate(this);switch(this.pageLoadStratergy){case"ALWAYS_LOAD":if(this.pageLoadUrl){if(_.isUndefined(this.loadCb)){this.loadPageFromUrl(c)}else{this.loadCb=c}}else{throw new Error("If the page stratergy is ALWAYS_LOAD then the 'data-page-load-url' is required")}break;case"CACHE":if(!this.hasInitialized){if(this.pageLoadUrl){if(_.isUndefined(this.loadCb)){this.loadPageFromUrl(c)}else{this.loadCb=c}}else{throw new Error("Is the page stratergy is CACHED then the 'data-page-load-url' is required")}}else{c()}break;default:if(!this.hasInitialized){this.initPage(c)}else{c()}}},triggerWithCallback:function(a,c){if(!this._async_events){c();return}var e=[].slice.call(arguments,2);var j=this._async_events[a];if(j){var f,d=-1,b=j.length,g=0;var h=function(){g++;if(g>=b){c()}};e.unshift(h);while(++d<b){(f=j[d]).callback.apply(f.ctx,e)}}else{c()}},onAsync:function(a,d,c){this._async_events||(this._async_events={});var b=this._async_events[a]||(this._async_events[a]=[]);b.push({callback:d,context:c,ctx:c||this});return this},loadPageFromUrl:function(b){var c=function(){this.initPage(b)}.createDelegate(this);this.loadSegment(this.pageLoadUrl,this.el,c)},loadSegment:function(b,c,a){if(b.indexOf("?")>=0){b+="&"}else{b+="?"}b+="t="+(Math.random()*10000);$j.ajax({url:b,dataType:"html",success:function(e,d,f){c[0].innerHTML=e;a()}.createDelegate(this),error:function(d,f,e){this.cleanUp();this.trigger("segmentLoadError",{page:this,url:b,error:e})}.createDelegate(this)})},initPage:function(a){if(this.hasInitialized){this.childrenPageManager.cleanUp();this.elementWrapper.cleanUp();delete this.childrenPageManager;delete this.elementWrapper}var c=function(){this.childrenPageManager=this.createChildrenPageManager();this.elementWrapper=new JSEngine.ElementWrapper({page:this,el:this.el,feedManager:this.feedManager,applicationVariables:this.applicationVariables,mediaManager:this.mediaManager,messageManager:this.messageManager});this.hasInitialized=true;helpers.loadExternalTemplates(this.el,a)}.createDelegate(this);var d=this.el.find(".page-segment");if(d){var b=d.length;if(b>0){_.each(d,function(f){var e=function(){b--;if(b==0){c()}};var g=$j(f);this.loadSegment(g.attr("data-segment-load-url"),g,e)},this)}else{c()}}else{c()}},createChildrenPageManager:function(){var a=new JSEngine.PageManager({parentEl:this.el,locks:this.pageManager.locks,applicationVariables:this.pageManager.applicationVariables,transitionController:this.pageManager.transitionController,feedManager:this.pageManager.feedManager,mediaManager:this.mediaManager,messageManager:this.messageManager,reportManager:this.reportManager,parentPageManager:this.pageManager});return a},navigateToPageWithExtendedParams:function(b){var c=_.defaults(b,this.applicationVariables.urlParams);if(!_.isUndefined(this.name)){var a="#"+this.name+"/"+encodeURIComponent(JSON.stringify(c));helpers.changeDocumentLocation(a)}},onTransitionAway:function(){if($j("body").hasClass(this.pageActiveClass+this.name)){$j("body").removeClass(this.pageActiveClass+this.name)}},cleanUp:function(){this.el.empty();delete this.hasBeenViewed;delete this.hasInitialized;if(this.elementWrapper){this.elementWrapper.cleanUp();delete this.elementWrapper}if(this.childrenPageManager){this.childrenPageManager.cleanUp();delete this.childrenPageManager}}});namespace("JSEngine");JSEngine.Filter=Backbone.Model.extend({initialize:function(a){a=a||{};helpers.assertParametersExistAndAddToObject(a,["filter"],this);this.currentFilterJSON=this._getFilterString(a.applicationVariables)},getFilteredResults:function(b){var c=b.models;try{c=b.where(jQuery.parseJSON(this.currentFilterJSON))}catch(a){console.error("Error in the filter: "+this.currentFilterJSON)}return c},onPageChange:function(a,b){var c=this._getFilterString(b.urlParams);if(c!==this.currentFilterJSON){this.currentFilterJSON=c;this.trigger("onFilterChanged",[b])}},_getFilterString:function(b){try{return _.template(this.filter,b||{})}catch(a){return this.filter}}});namespace("JSEngine");JSEngine.CollectionContainerNavigationLink=Backbone.Model.extend({initialize:function(a){a=a||{};helpers.assertParametersExistAndAddToObject(a,["pageName","collectionContainer","link","applicationVariables"],this);this.direction=this.link.attr("data-direction");this.link.bind("click",this.click.createDelegate(this));this.collectionContainer.on("dataChanged",this.onDataChange.createDelegate(this))},click:function(c){var b=this.collectionContainer.pager.id;var a=this.getCurrentUrlParamsAsClone()||{};a[b]=a[b]||{};a[b].page=(a[b].page||0)+this.pageDirection;c.preventDefault();helpers.changeDocumentLocation("#"+this.getHashUrl(a))},onDataChange:function(a){this.setPagerLinks(a)},setPagerLinks:function(a){var b=0;switch(this.direction){case"next":b=1;if(a.hasNext()){this.link.removeClass("pagination-link-hide")}else{this.link.addClass("pagination-link-hide")}break;case"previous":b=-1;if(a.hasPrevious()){this.link.removeClass("pagination-link-hide")}else{this.link.addClass("pagination-link-hide")}break}this.pageDirection=b},getCurrentUrlParamsAsClone:function(){return $j.parseJSON(JSON.stringify(this.applicationVariables.urlParams))},getHashUrl:function(a){return this.pageName+"/"+JSON.stringify(a)}});namespace("JSEngine");JSEngine.CollectionContainerBarrier=Backbone.Model.extend({initialize:function(a){a=a||{};helpers.assertParametersExistAndAddToObject(a,["collectionContainer","el"],this);this.wallPosition=this.el.attr("data-wall-position");this.hideOnNoPages=this.el.attr("data-hide-on-no-pages")==="true";this.collectionContainer.on("dataChanged",this.onDataChange.createDelegate(this))},onDataChange:function(a){if(!a.hasNext()&&!a.hasPrevious()&&this.hideOnNoPages){this.el.addClass("hide")}else{this.el.removeClass("hide");switch(this.wallPosition){case"start":if(a.hasPrevious()){this.el.removeClass("pager-at-start")}else{this.el.addClass("pager-at-start")}break;case"end":if(a.hasNext()){this.el.removeClass("pager-at-end")}else{this.el.addClass("pager-at-end")}break}}}});namespace("JSEngine");JSEngine.Message=Backbone.Model.extend({initialize:function(a){a=a||{};helpers.assertParametersExistAndAddToObject(a,["template"],this);Backbone.Model.prototype.initialize.call(this)},show:function(d,a){var c=_.template(this.template,d);if(this.container){this.hide()}var b=helpers.getApplicationConfig();if(b&&b.vibrateOnPA&&"vibrate" in navigator){navigator.vibrate([500])}this.container=$j('<div class="messageBoxContainer"></div>');this.container.append(c);$j("#wrapper, #itk-wrapper").append(this.container);this.container.find('[data-template-matcher="closeBtn"], [data-template-matcher="okBtn"]').bind("click",function(e){e.preventDefault();this.hide();if(a){a()}}.createDelegate(this))},hide:function(){if(this.container){this.container.remove()}delete this.container;$j(document).off("focusin",this.restrictFocus)}});namespace("JSEngine");JSEngine.BasePlayer=Backbone.Model.extend({initialize:function(){this.errorHandlers={errorHandler:function(a){this.mediaManager.cleanUp(this.playerType);switch(a.code){case 1001:this.messageManager.mediaMessage.show(this.applicationVariables.messages.mediaMessages["1001"]);break;case 1002:this.messageManager.mediaMessage.show(this.applicationVariables.messages.mediaMessages["1002"]);break;case 1003:this.messageManager.mediaMessage.show(this.applicationVariables.messages.mediaMessages["1003"]);break;case 1004:this.messageManager.mediaMessage.show(this.applicationVariables.messages.mediaMessages["1004"]);break}},warningHandler:function(a){switch(a.code){case 2001:this.player.reloadWithPartialSupport();break;case 2002:console.log("Error 2002 code raised: Ignoring");break;case 2003:this.mediaManager.cleanUp(this.playerType);this.messageManager.mediaMessage.show(this.applicationVariables.messages.mediaMessages["2003"]);break}helpers.setTimeout(function(){$j(this.playerEl).avod("hideMessage")},this.applicationVariables.messages.mediaPlayerMessages.timeout)},debugHandler:function(a){switch(a.code){case 3001:console.debug("player not responding");break;case 3002:console.debug("video is frozen");break}}};this.baseHandlers={readyHandler:function(a){this.getIsVolumeSupported();if(!this.isVolumeSupported){$j(".vjs-controls").addClass("vjs-ios")}$j(".vjs-volume-control, .vjs-mute-control").remove()}}},setupBaseErrorListeners:function(){this.player.addEventListener(this.AVOD.Events.ERROR,this.errorHandlers.errorHandler.createDelegate(this));this.player.addEventListener(this.AVOD.Events.WARNING,this.errorHandlers.warningHandler.createDelegate(this));this.player.addEventListener(this.AVOD.Events.DEBUG,this.errorHandlers.debugHandler);this.player.addEventListener(this.AVOD.Events.READY,this.baseHandlers.readyHandler.createDelegate(this))},getIsVolumeSupported:function(){if(this.player.player){this.isVolumeSupported=this.player.canSetVolume()}},removeListeners:function(){this.trigger("beforeUnbind");this.off("all")},getMediaPlayerControlPluginPath:function(){var a=$j("meta[name='MediaPlayerControlPluginUri']");return a.length>0?a.attr("content"):""}});namespace("JSEngine");JSEngine.Captcha=Backbone.Model.extend({initialize:function(c){c=c||{};helpers.assertParametersExistAndAddToObject(c,["el","page"],this);var b=helpers.getConfigFromFromElement(this.el)||{};var d=["errorUrl","msgConfig"];helpers.assertParametersExistAndAddToObject(b,d,this);helpers.addParametersToObjectIfExist(b,["lang"],this);if(b.successUrl){this.successUrl=b.successUrl}this.associatedComponents=[];this.submitButton=$j(".captcha.form-component.submit-button[data-form='"+this.el.attr("id")+"']");this.refreshtButton=$j(".captcha.form-component.refresh-button[data-form='"+this.el.attr("id")+"']");this.image=$j("img.captcha.form-component[data-form='"+this.el.attr("id")+"']");this.inputText=$j(".captcha.form-component.text-input[data-form='"+this.el.attr("id")+"']");this.errorField=$j(".error-display-field[data-form='"+this.el.attr("id")+"']");_.each($j(".form-component[data-form='"+this.el.attr("id")+"']"),function(e){this.associatedComponents.push($j(e))},this);this.submitButton.bind("click",this.onSubmit.createDelegate(this));this.refreshtButton.bind("click",this.onRefresh.createDelegate(this));var a=function(e){if(e.keyCode===13){this.submitButton.click()}};this.inputText.on("keyup",a.createDelegate(this));this.submitButton.on("keyup",a.createDelegate(this));this.page.on("activate",this.refreshCaptcha.createDelegate(this));this.captchaChecker=new JSEngine.CaptchaChecker({page:this.page});Backbone.Model.prototype.initialize.call(this,c)},validate:function(b){var a=_.toArray(this.associatedComponents);this.validateComponent(a.pop(),a,b)},validateComponent:function(d,f,b){var e=d.data("validator");var a;if(!_.isEmpty(e)&&JSEngine.Validators[e]){a=function(i){if(!i){this.addErrorText(d.data("errorMessage"))}if(f.length>0){var h=f.pop();var g=function(j){b(i&&j)};this.validateComponent(h,f,g)}else{b(i)}}.createDelegate(this);JSEngine.Validators[e](d,a)}else{if(f.length>0){var c=f.pop();a=function(g){b(g)};this.validateComponent(c,f,a)}else{b(true)}}},refreshCaptcha:function(){JSEngine.IFAPIInitHelper.initialize("captcha/v1",function(b){var a=b[0];a.newChallenge(function(d,c){if(d){this.trigger("challengeError",d.text);return}this.image.attr("src",c.image_url);this.inputText.val("");this.challenge=c}.createDelegate(this))}.createDelegate(this))},onSubmit:function(b){this.errorField.removeClass("form-error");this.errorField.html("<ul />");var a=function(c){if(c&&this.challenge){var d=this.inputText.val();var e=this.challenge.id;JSEngine.IFAPIInitHelper.initialize("captcha/v1",function(g){var f=g[0];f.solveChallenge({challenge_id:e,solution:d},function(h,i){if(h){console.log("Captcha: There was a challengeOnSubmitError: "+JSON.stringify(h));this.trigger("challengeOnSubmitError",h);return}if(i){this.onCaptchaValid()}else{this.trigger("challengeNotValid");this.addErrorText(this.msgConfig.challengeNotValid);this.onValidationError();this.refreshCaptcha();return}}.createDelegate(this))}.createDelegate(this))}else{if(c){this.trigger("challengeOnSubmitError",{text:"Challenge does not exists"});return}else{this.onValidationError();this.trigger("validationError",{text:"Form not valid"})}}};this.validate(a.createDelegate(this))},onValidationError:function(){this.errorField.addClass("form-error")},addErrorText:function(a){if(a){this.errorField.find("ul").append("<li>"+a+"</li>")}},onCaptchaValid:function(){var a=function(b){if(b&&b.code==="401"){this.refreshCaptcha()}else{this.trigger("challengeValid");if(this.page.applicationVariables&&this.page.applicationVariables.urlParams){JSEngine.CaptchaHelper.goToReturnUrl(this.page.applicationVariables.urlParams)}else{helpers.changeDocumentLocation(this.getReturnUrl())}}}.createDelegate(this);JSEngine.CaptchaHelper.enableDeviceForWhitelist(a)},getReturnUrl:function(a){if(a&&a.returnUrl){return a.returnUrl}if(this.page.applicationVariables&&this.page.applicationVariables.urlParams){if(this.page.applicationVariables.urlParams.returnUrl){return this.page.applicationVariables.urlParams.returnUrl}}return this.successUrl},onRefresh:function(){this.refreshCaptcha()}});namespace("JSEngine");JSEngine.CaptchaChecker=Backbone.Model.extend({initialize:function(a){a=a||{};helpers.assertParametersExistAndAddToObject(a,["page"],this);this.page.onAsync("beforePageShow",this.checkCaptchaRequirementBeforePageShow.createDelegate(this));this.needCaptchaCheckForWispUrl=(a.applicationVariables&&a.applicationVariables.needCaptchaCheckForWispUrl&&a.applicationVariables.needCaptchaCheckForWispUrl=="true")?true:false;Backbone.Model.prototype.initialize.call(this,a)},checkCaptchaRequirementBeforePageShow:function(d,b,c){this.returnUrl="";this.errorPage="";if(c&&c.returnUrl){this.returnUrl=c.returnUrl}if(c&&c.errorPage){this.errorPage=c.errorPage}if(c&&c.post){this.post=c.post}if(JSEngine.EventHandler&&JSEngine.EventHandler.getEventState("eXConnectStatus")===null){if($j.cookie("eXConnectStatus_connectionState")==="false"){helpers.changeDocumentLocation(this.errorPage);console.log("CaptchaChecker: eXConnectStatus is not connected");return}else{var a=function(){this.checkCaptchaRequirementBeforePageShowCb.call(this,d,b,c);JSEngine.EventHandler.unSubscribe("eXConnectStatus","CaptchaChecker",a)}.createDelegate(this);JSEngine.EventHandler.subscribe("eXConnectStatus","CaptchaChecker",a);return}}else{if(!JSEngine.EventHandler||!JSEngine.EventHandler.getEventState("eXConnectStatus")||JSEngine.EventHandler.getEventState("eXConnectStatus").connectionState==false){helpers.changeDocumentLocation(this.errorPage);console.log("CaptchaChecker: eXConnectStatus is not connected");return}}this.checkCaptchaRequirementBeforePageShowCb.call(this,d,b,c)},checkCaptchaRequirementBeforePageShowCb:function(d,b,c){var a;if(c&&c.wisp){console.log("CaptchaChecker: enabling DeviceForWhitelist");a=function(e){if(e){if(e.code==401){console.log("CaptchaChecker: Device needs to go through captcha before Enabling Device For Whitelist")}else{console.log("CaptchaChecker: There was an error checking the wisp URL: "+JSON.stringify(e))}if(this.needCaptchaCheckForWispUrl){JSEngine.CaptchaHelper.checkCAPTCHARequirement(this.returnUrl,function(f,g){if(!f&&g){d()}else{if(!f&&!g){this.doOpenLink(this.returnUrl,c)}}}.createDelegate(this))}else{d()}}else{this.doOpenLink(this.returnUrl,c)}}.createDelegate(this);JSEngine.CaptchaHelper.enableDeviceForWhitelist(a)}else{console.log("CaptchaChecker: checking captcha requirement");a=function(g,f){if(!g){if(!f){this.doOpenLink(this.returnUrl,c)}else{console.log("CaptchaChecker: Device needs to go through captcha before continuing");d()}}else{if(g.code==404){var e=function(h){if(h){console.log("CaptchaChecker: Device needs to go through captcha before continuing. Error code: ",h.code);d()}else{this.doOpenLink(this.returnUrl,c)}}.createDelegate(this);JSEngine.CaptchaHelper.enableDeviceForWhitelist(e)}else{console.error("CaptchaChecker: "+JSON.stringify(g));this.trigger("captchaUrlOnSubmitError",g);d()}}}.createDelegate(this);JSEngine.CaptchaHelper.checkCAPTCHARequirement(this.returnUrl,a)}},doOpenLink:function(b,a){console.log("CaptchaChecker: Device already been through captcha so redirect to: "+b);JSEngine.CaptchaHelper.goToReturnUrl(a)}});namespace("JSEngine");JSEngine.DynamicContainer=Backbone.Model.extend({initialize:function(a){this.onFetchSuccess=_.bind(this.onFetchSuccess,this);this.applyLoadTemplate=_.bind(this.applyLoadTemplate,this);this.onFetchFail=_.bind(this.onFetchFail,this);this.onFeedChange=_.bind(this.onFeedChange,this);this.onBeforePageActivate=_.bind(this.onBeforePageActivate,this);this.onPageActivate=_.bind(this.onPageActivate,this);this.onAfterPageActivate=_.bind(this.onAfterPageActivate,this);a=a||{};this.options=this.config=a;helpers.assertParametersExistAndAddToObject(a,["el","page","applicationVariables","feedManager","mediaManager","messageManager"],this);helpers.addParametersToObjectIfExist(a,["responsiveSwiper","name","swiperIgnoreSlideChange","pageListeners","disablePageListeners"],this);this.page.dynamicContainers={};if(this.name){this.page.dynamicContainers[this.name]=this}if(this.responsiveSwiper){this.responsiveSwiper=JSON.parse(this.responsiveSwiper)}this.itemTemplate=helpers.parseTemplateMarkup(this.el,a.itemTemplateSelector)||helpers.parseTemplateMarkup($j("body"),"#"+a.template);this.loadingTemplate=helpers.parseTemplateMarkup(this.el,a.loadingTemplateSelector)||helpers.parseTemplateMarkup($j("body"),"#"+a.loadingTemplate);this.noDataTemplate=helpers.parseTemplateMarkup(this.el,a.noDataTemplateSelector)||helpers.parseTemplateMarkup($j("body"),"#"+a.noDataTemplate);this.errorTemplate=helpers.parseTemplateMarkup(this.el,a.errorTemplateSelector)||helpers.parseTemplateMarkup($j("body"),"#"+a.errorTemplate);this.bodyContainer=this.getContainerBodyElement(a.bodyContainerSelector);if(a.pager){this.pager={name:a.pager,pagingTransitionSpeed:(a.pagingTransitionSpeed||800),pagingCount:(a.pagingCount||1),pagingPagelinks:(a.pagerPagelinks||""),pagingPagelinksTemplate:(a.pagerPagelinksTemplate||""),pagingPagelinksCurrentClass:(a.pagerPagelinksCurrentClass||"")};this.navigationAtStartClass="ae-navigation-at-start-"+a.pager;this.navigationAtEndClass="ae-navigation-at-end-"+a.pager}this.includeWrappingDiv=((a.includeWrappingDiv==false)?false:true);this.itemLimit=a.itemLimit;this.itemOffset=a.itemOffset;this.filter=JSON.stringify(a.filter);this.collection=this.feedManager.getDataCollection(this.el,this.applicationVariables,this.page);this.collection.on("fetchStart",this.applyLoadTemplate);this.collection.on("fetchSuccess",this.onFetchSuccess);this.collection.on("fetchFail",this.onFetchFail);this.collection.on("feedChanging",this.onFeedChange);this.collection.on("change",this.onFetchSuccess);if(this.disablePageListeners!==true){if(this.pageListeners){this.pageListeners=this.pageListeners.replace(/\s/g,"");var b=this.pageListeners.split(",");_.each(b,function(c){switch(c){case"activate":this.page.on("renderContent",this.onPageActivate);break;case"afterActivate":this.page.on("afterActivate",this.onAfterPageActivate);break;default:}}.createDelegate(this))}else{this.page.on("renderContent",this.onPageActivate);this.page.on("afterActivate",this.onAfterPageActivate)}}if(this.page.isActive&&this.collection.hasBeenFetched){this.render()}else{if(this.page.isActive){this.collection.fetch(this.collection.options)}}},onFetchSuccess:function(){if(!_.isUndefined(this.pager)){if(!this.currentPageIndex){this.currentPageIndex=JSEngine.PagerHelpers.getPagingNumber(this.pager.name,this.applicationVariables)}}this.render(true)},onFetchFail:function(b,c){if(!_.isEmpty(this.errorTemplate)){var a=_.template(this.errorTemplate,this.applicationVariables);this.bodyContainer.html(a);delete this.swiper}},onBeforePageActivate:function(a,b){if(this.pager){$j("body").removeClass(this.navigationAtStartClass+"-updated");$j("body").removeClass(this.navigationAtEndClass+"-updated")}},onFeedChange:function(){if(this.childElementWrapper){this.childElementWrapper.cleanUp()}},onAfterPageActivate:function(){if(this.swiper){this.swiper.resizeFix()}},onPageActivate:function(){if(this.swiper){this.swiper.resizeFix()}if(this.collection.hasBeenFetched){var c=false;if(!_.isEmpty(this.filter)){var b=this._getFilterString();if(b!==this.currentFilterJSON){c=true}}if(!_.isUndefined(this.pager)){var a=JSEngine.PagerHelpers.getPagingNumber(this.pager.name,this.applicationVariables);if(this.currentPageIndex!=a){this.currentPageIndex=a;c=true}}if(!this.hasBeenRendered){c=true}else{if(this.collection.hasFeedChanged(this.applicationVariables)){c=true}}if(c){this.render()}}},writeToContainer:function(a){var b=this.bodyContainer;if(this.includeWrappingDiv){b=$j('<div class="wrap swiper-wrapper"></div>');this.bodyContainer.html(b)}b.html(a);return b},applyLoadTemplate:function(){if(!_.isEmpty(this.loadingTemplate)){var a=_.template(this.loadingTemplate,this.applicationVariables);this.bodyContainer.html(a);delete this.swiper}},getModelsToRender:function(){var a=this.collection.models;if(!_.isUndefined(this.collection.getModelsToRender)){a=this.collection.getModelsToRender(a)}if(!_.isUndefined(this.filter)&&this.filter!=="undefined"){this.currentFilterJSON=this._getFilterString();a=this.getFilteredResults()}if(this.itemOffset>0){a=_.rest(a,this.itemOffset)}if(this.itemLimit>0){a=_.first(a,this.itemLimit)}return a},render:function(b){this.hasBeenRendered=true;var e=this.getModelsToRender();if(this.pager){this.maxPages=Math.ceil(e.length/this.pager.pagingCount)-1;if(this.currentPageIndex>this.maxPages){if(this.swiperIgnoreSlideChange){this.currentPageIndex=this.maxPages;this.jumpToSlide(this.currentPageIndex)}else{var a=JSEngine.PagerHelpers.getChangeToPageParams(this.pager.name,this.maxPages,this.applicationVariables);helpers.navigateToPage(this.page,a);return}}else{if(this.currentPageIndex<0){if(this.swiperIgnoreSlideChange){this.currentPageIndex=0;this.jumpToSlide(0)}else{var a=JSEngine.PagerHelpers.getChangeToPageParams(this.pager.name,0,this.applicationVariables);helpers.navigateToPage(this.page,a);return}}}}if(!this.swiper||b){var d=this.bodyContainer;this.currentPageIndex=0;if(this.includeWrappingDiv){d=$j('<div class="wrap swiper-wrapper"></div>')}else{this.bodyContainer.empty()}var c=this.calculateOptions();this.view=new JSEngine.CollectionView({container:d,template:this.itemTemplate,noDataTemplate:this.noDataTemplate,pagingCount:(_.isObject(this.pager)?this.pager.pagingCount:1),doPagination:_.isUndefined(c.pager)||c.pager?_.isObject(this.pager):false,models:e,activeSliderPageIndex:this.currentPageIndex});this.destroyChildElementWrapper();this.view.render(this.applicationVariables);if(this.includeWrappingDiv){this.bodyContainer.html(d)}this.createChildElementWrapper();interfaceToolkit.scrollPanes(this.page.el);if(!_.isUndefined(this.pager)){this.createSwiper(e,function(){this.trigger("dataLoaded",this,this.collection);this.updateNavigationLinks()}.createDelegate(this))}else{this.trigger("dataLoaded",this,this.collection)}}else{this.view.renderSlideChange(this.currentPageIndex,this.applicationVariables);this.swiper.swipeTo(this.currentPageIndex,this.pager.pagingTransitionSpeed,false);this.swiper.fixLinks();this.updateNavigationLinks();this.trigger("dataChanged",{pageNumber:this.currentPageIndex})}if(this.pager&&this.maxPages>0&&this.pager.pagingPagelinks){this.renderPagelinks()}},renderPagelinks:function(){var b=$j(this.pager.pagingPagelinks),f=helpers.getTemplateMarkup(this.pager.pagingPagelinksTemplate),e=JSEngine.PagerHelpers.getPagingNumber(this.pager.name,this.applicationVariables),d=this.pager.pagingPagelinksCurrentClass||"ae-pager-pagelink-current",g={},h;var a=function(j){return function(k){var i=JSEngine.PagerHelpers.getChangeToPageParams(this.pager.name,j,this.applicationVariables);k.preventDefault();helpers.navigateToPage(this.page,i)}.createDelegate(this)}.createDelegate(this);b.empty();for(var c=0;c<=this.maxPages;c++){g.pagenum=c+1;h=$j(_.template(f,g)).appendTo(b);if(e===c){h.addClass(d);h.bind("click",function(i){i.preventDefault()})}else{h.bind("click",a(c))}}},updateNavigationLinks:function(){if(this.pager){if(this.currentPageIndex==this.maxPages){$j("body").addClass(this.navigationAtEndClass);$j("body").addClass(this.navigationAtEndClass+"-updated")}if(this.currentPageIndex==0){$j("body").addClass(this.navigationAtStartClass);$j("body").addClass(this.navigationAtStartClass+"-updated")}if(!$j("body").hasClass(this.navigationAtStartClass+"-updated")){$j("body").removeClass(this.navigationAtStartClass)}if(!$j("body").hasClass(this.navigationAtEndClass+"-updated")){$j("body").removeClass(this.navigationAtEndClass)}$j("body").removeClass(this.navigationAtEndClass+"-updated");$j("body").removeClass(this.navigationAtStartClass+"-updated")}},createSwiper:function(b,a){helpers.setTimeout(function(){var c=this.config.bodyContainerSelector||"#"+this.el.attr("id");if(_.isUndefined(this.config.swiperMode)){this.config.swiperMode="horizontal"}var d=this.calculateOptions();this.swiperConfig={simulateTouch:true,speed:this.pager.pagingTransitionSpeed,pagination:!_.isUndefined(this.config.swiperPagination)?this.config.swiperPagination:false,mode:(_.isUndefined(this.config.swiperResponsiveMediaSwitch)||!helpers.matchMedia(this.config.swiperResponsiveMediaSwitch).matches)?this.config.swiperMode:((this.config.swiperMode==="horizontal")?"vertical":"horizontal"),onSlideChangeEnd:function(){if(!d.pager){return}var g=JSEngine.PagerHelpers.getChangeToPageParams(this.pager.name,this.swiper.activeSlide,this.applicationVariables);helpers.navigateToPage(this.page,g)}.createDelegate(this)};if(this.swiperIgnoreSlideChange){this.swiperConfig.onSlideChangeEnd=function(g){if(!this.swiperSlideDirection){this.swiperSlideDirection=0}var h=-1;if(g.activeIndex-this.swiperSlideDirection>0){h=1}this.changeSlide(h);this.swiperSlideDirection=g.activeIndex}.createDelegate(this)}this.swiperConfig=_.extend(this.swiperConfig,helpers.extractPrefixedOptions(d,"swiper"));this.swiper=($j(c).find(".swiper-slide").length>0)?new Swiper(c,this.swiperConfig):{};var e=false;if(this.page&&this.page.pageManager&&this.page.pageManager.pageHistory){var f=this.page.pageManager.pageHistory;if(f.length>=2&&f[f.length-2].pageName===this.page.name){e=true}}if(this.currentPageIndex!=0&&e){this.swiper.swipeTo(this.currentPageIndex,this.pager.pagingTransitionSpeed,false)}this.resizeProxy=this.resizeProxy||this.resize.createDelegate(this);$j(window).off("resize",this.resizeProxy);$j(window).bind("resize",this.resizeProxy);a()}.createDelegate(this),500)},destroyChildElementWrapper:function(){if(this.childElementWrapper){this.childElementWrapper.cleanUp();delete this.childElementWrapper}},createChildElementWrapper:function(){if(this.childElementWrapper){throw new Error("DynamicContainer: Unable to create new child element wrapper until the old one is removed. Call 'destroyChildElementWrapper' first.")}this.childElementWrapper=new JSEngine.ElementWrapper({el:this.bodyContainer,applicationVariables:this.applicationVariables,page:this.page,feedManager:this.feedManager,mediaManager:this.mediaManager,messageManager:this.messageManager})},getFilteredResults:function(){var g=this.collection.models;var f={};try{if(_.isString(this.currentFilterJSON)){f=jQuery.parseJSON(this.currentFilterJSON)}else{f=this.currentFilterJSON}var c="";var a={};if(!_.isEmpty(f.specialFilter)){c=f.specialFilter.type;a=f.specialFilter.params;delete f.specialFilter}if(!_.isEmpty(f)){if(_.isArray(f)){var b=_.map(f,function(e){return this.collection.where(e)}.createDelegate(this));g=_.union.apply(undefined,b)}else{g=this.collection.where(f)}}if(!_.isEmpty(c)){g=JSEngine.CollectionFilters[c](g,a)}}catch(d){console.error("Error in the filter: "+this.currentFilterJSON)}return g},_getFilterString:function(){try{return _.template(this.filter,this.applicationVariables||{})}catch(a){return this.filter}},getContainerBodyElement:function(b){if(b){var a=this.el.find(b)||$j(b);if(a.length>0){return a}else{throw new Error("JSEngine.DynamicContainer: Unable to find the body container with the selector '"+b+"'")}}return this.el},getTemplateMarkup:function(b,a){var d=b.find(a);if(d.length>0){var c=$j(d[0]).html();c=c.replace("scr+","scr","g");c=c.replace("<+","<","g");c=c.replace("+>",">","g");return c}return null},cleanUp:function(){this.collection.off("fetchStart",this.applyLoadTemplate);this.collection.off("fetchSuccess",this.onFetchSuccess);this.collection.off("fetchFail",this.onFetchFail);this.collection.off("change",this.onFetchSuccess);if(this.pageListeners&&this.pageListeners.length>0){var a=this.pageListeners.split(",");_.each(a,function(b){if(b==="activate"){this.page.off("renderContent",this.onPageActivate)}if(b==="afterActivate"){this.page.off("afterActivate",this.onAfterPageActivate)}}.createDelegate(this))}else{this.page.off("renderContent",this.onPageActivate);this.page.off("afterActivate",this.onAfterPageActivate)}this.page.off("beforeActivate",this.onBeforePageActivate);if(this.swiper){this.swiper.destroy(true);delete this.swiper}},resize:function(b){b.preventDefault();var a=false;_.each(this.responsiveSwiper,function(c){var d=helpers.matchMedia(c.query).matches;if((d&&!c.active)||(!d&&c.active)){a=true}});if(a){this.render(true)}},calculateOptions:function(){var a=_.reduce(this.responsiveSwiper,function(b,c){if(helpers.matchMedia(c.query).matches){c.active=true;b=_.extend(b,c)}else{c.active=false}return b},_.clone(this.options));return a},changeSlide:function(a){this.currentPageIndex+=a;this.view.renderSlideChange(this.currentPageIndex,this.applicationVariables);this.swiper.swipeTo(this.currentPageIndex,this.pager.pagingTransitionSpeed,false);this.swiper.fixLinks();this.updateNavigationLinks()},jumpToSlide:function(a){if(this.view){this.view.renderSlideChange(a,this.applicationVariables);this.swiper.swipeTo(a,this.pager.pagingTransitionSpeed,false);this.swiper.fixLinks();this.updateNavigationLinks()}}});namespace("JSEngine");JSEngine.DynamicContainerNavigationLink=Backbone.Model.extend({initialize:function(a){a=a||{};helpers.assertParametersExistAndAddToObject(a,["el","page","applicationVariables","pager","direction"],this);helpers.addParametersToObjectIfExist(a,["containerName"],this);this.el.bind("click",this.click.createDelegate(this));if(this.direction=="next"){this.pageDirection=1}else{this.pageDirection=-1}this.navigationAtStartClass="ae-navigation-at-start-"+a.pager;this.navigationAtEndClass="ae-navigation-at-end-"+a.pager;var c="ae-nav-auto-link-"+Math.round(Math.random()*1000);this.el.addClass(c);var b=null;if(this.direction=="next"){this.pageDirection=1;b="body."+this.navigationAtEndClass+" ."+c+" { display: none !important; }"}else{this.pageDirection=-1;b="body."+this.navigationAtStartClass+" ."+c+" { display: none !important; }"}$j("head").append('<style type="text/css">'+b+"</style>")},click:function(d){d.preventDefault();var c=JSEngine.PagerHelpers.getPagingNumber(this.pager,this.applicationVariables);var a=c+this.pageDirection;if(this.containerName&&this.page.dynamicContainers&&this.page.dynamicContainers[this.containerName]){this.page.dynamicContainers[this.containerName].changeSlide(a)}else{var b=JSEngine.PagerHelpers.getChangeToPageParams(this.pager,a,this.applicationVariables);helpers.navigateToPage(this.page,b)}}});namespace("JSEngine");JSEngine.PageTransitionHandler=Backbone.Model.extend({initialize:function(a){a=a||{}},doTransition:function(f,c,h,a){var b=f.pop();if(b!==c){var d=this.getElementsToTransition(b,c);if(b){b.trigger("transitionAway");b.el.addClass("hide ae-hide");d.outElement.addClass("hide ae-hide")}else{this.hideAllMasterPagesButNew(c)}d.inElement.removeClass("hide ae-hide hidden");c.el.removeClass("hide ae-hide hidden")}f.push(c);try{c.trigger("renderContent",h)}catch(g){console.log("Error triggering 'renderContent'",g)}a()},beforeTransitionAway:function(c,b,d,a){a()},hideAllMasterPagesButNew:function(a){$j(".ae-master-page").not(a.el.parents(".ae-master-page").removeClass("hide ae-hide hidden")).addClass("hide ae-hide hidden")},getElementsToTransition:function(e,d){var b=d.el;var h=null;var c=null;var g=null;var a=null;var f=null;if(e){h=e.el;if(e.el.parents(".ae-master-page").length>0){a=e.el.parents(".ae-master-page").html();c=e.el.parents(".ae-master-page")}if(d.el.parents(".ae-master-page").length>0){f=d.el.parents(".ae-master-page").html();g=d.el.parents(".ae-master-page")}if(a!==f){if(c&&g){b=g;h=c}if(c&&!g){b=d.el;h=c}if(!c&&g){b=g;h=e.el}}}return{inElement:b,outElement:h}}});namespace("JSEngine");JSEngine.Status=Backbone.Model.extend({defaults:{online:false,timestamp:""},initialize:function(a){a=a||{};helpers.assertParametersExistAndAddToObject(a,["el","serviceName"],this);Backbone.Model.prototype.initialize.call(this,a);this.on("change",function(){this.show()}.createDelegate(this));this.container=this.el.find(".container-body");this.availableTemplate=_.template(helpers.parseTemplateMarkup(this.el,".online")||"");this.unavailableTemplate=_.template(helpers.parseTemplateMarkup(this.el,".offline")||"");this.errorTemplate=_.template(helpers.parseTemplateMarkup(this.el,".error")||"");var b=JSEngine.EventHandler.subscribe("eXConnectStatus","eXConnectStatusHandler",this.status.createDelegate(this));this.set("eXConnectStatus",b)},status:function(b){var a=this;var c=this.serviceName;this.set("eXConnectStatus",b);JSEngine.IFAPIInitHelper.initialize("status/v1",function(e){var d=e[0];d.status(c,function(f,g){if(f){a.onError(f);return}else{a.set("online",g.online)}})})},show:function(){var a={online:this.get("online"),eXConnectStatus:this.get("eXConnectStatus")};this.container.html("");if(this.get("online")){JSEngine.ViewHelper.renderItem(this.container,this.availableTemplate,a)}else{JSEngine.ViewHelper.renderItem(this.container,this.unavailableTemplate,a)}},onError:function(a){this.container.html("");JSEngine.ViewHelper.renderItem(this.container,this.errorTemplate,a)}});namespace("JSEngine");JSEngine.GlobalStatus=Backbone.Model.extend({initialize:function(a){a=a||{};helpers.assertParametersExistAndAddToObject(a,["el","applicationVariables","page","feedManager","mediaManager","messageManager"],this);Backbone.Model.prototype.initialize.call(this,a);this.container=this.el.find(".container-body");this.availableTemplate=_.template(helpers.getHtmlFromElement(this.el.find(".global-online")));this.unavailableTemplate=_.template(helpers.getHtmlFromElement(this.el.find(".global-offline")));var b="eXConnectStatusHandler_"+Math.random();JSEngine.EventHandler.subscribe("eXConnectStatus",b,this.show.createDelegate(this))},show:function(b){var a={online:b.connectionState,timeUntilCoverageChange:b.timeUntilCoverageChange,totalCoverageRemaining:b.totalCoverageRemaining};if(b.connectionState){JSEngine.ViewHelper.renderItem(this.container,this.availableTemplate,a)}else{JSEngine.ViewHelper.renderItem(this.container,this.unavailableTemplate,a)}this.createChildElementWrapper()},createChildElementWrapper:function(){if(this.childElementWrapper){this.childElementWrapper.cleanUp();delete this.childElementWrapper}this.childElementWrapper=new JSEngine.ElementWrapper({el:this.container,applicationVariables:this.applicationVariables,page:this.page,feedManager:this.feedManager,mediaManager:this.mediaManager,messageManager:this.messageManager})},cleanUp:function(){if(this.childElementWrapper){this.childElementWrapper.cleanUp();delete this.childElementWrapper}}});namespace("JSEngine");JSEngine.CaptchaURL=Backbone.Model.extend({initialize:function(a){a=a||{};var b=function(d,c){if(d){console.error("Captcha check: ",d)}else{if(c){this.el.click(this.onClick.createDelegate(this))}else{this.el.click(this.onClickWithoutCaptcha.createDelegate(this))}}};helpers.assertParametersExistAndAddToObject(a,["el"],this);this.href=this.el.attr("href");this.captchaPage=this.el.data("captchaPage");this.errorPage=this.el.data("errorPage");this.target=this.el.attr("target");if(a.destination&&a.destination!==""){JSEngine.IFAPIInitHelper.initialize("exconnect/v1",function(c){var d=c[0];d.checkCAPTCHARequirement(a.destination,b.createDelegate(this))}.createDelegate(this))}else{this.el.click(this.onClick.createDelegate(this))}Backbone.Model.prototype.initialize.call(this,a)},onClickWithoutCaptcha:function(a){if($j.cookie("eXConnectStatus_connectionState")==="false"){a.preventDefault();if(this.errorPage&&this.errorPage!==""){helpers.changeDocumentLocation(this.errorPage)}}},onClick:function(b){b.preventDefault();var a=(this.target==="_blank"?helpers.createNewWindow(this.target):window);helpers.navigateToPageNewTab(this.captchaPage,{returnUrl:this.href},a)}});namespace("JSEngine");JSEngine.WispURL=Backbone.Model.extend({initialize:function(a){var b=function(e,d){if(e){console.error("Wisp: ",e)}else{this.postParams=d.post_parameters;this.href=d.url}};var c=function(e,d){if(e){console.error("Captcha check: ",e)}else{if(d){this.el.click(this.onClick.createDelegate(this))}else{this.el.click(this.onClickWithoutCaptcha.createDelegate(this))}}};a=a||{};helpers.assertParametersExistAndAddToObject(a,["el"],this);this.href=this.el.attr("href");this.captchaPage=this.el.data("captchaPage");this.errorPage=this.el.data("errorPage");this.target=this.el.attr("target");this.linkTarget=this.el.data("linkTarget");this.openExternal=this.el.data("openExternal")||false;if(_.isUndefined(this.href)||this.href===""){JSEngine.IFAPIInitHelper.initialize("exconnect/v1",function(d){var e=d[0],f={};helpers.addParametersToObjectIfExist(a,["lang"],f);e.getWISP(f,b.createDelegate(this))}.createDelegate(this))}if(a.destination&&a.destination!==""){JSEngine.IFAPIInitHelper.initialize("exconnect/v1",function(d){var e=d[0];e.checkCAPTCHARequirement(a.destination,c.createDelegate(this))}.createDelegate(this))}else{this.el.click(this.onClick.createDelegate(this))}this.immediateRedirectUrl=this.el.attr("data-immediate-redirect-url");this.popupElementId=this.el.attr("data-popup-element-id");Backbone.Model.prototype.initialize.call(this,a)},onClickWithoutCaptcha:function(a){if($j.cookie("eXConnectStatus_connectionState")==="false"){a.preventDefault();if(this.errorPage&&this.errorPage!==""){helpers.changeDocumentLocation(this.errorPage)}}},onClick:function(d){d.preventDefault();var c=function(){JSEngine.CaptchaHelper.captchaWin=null};var b=null;var f={returnUrl:this.href,errorPage:this.errorPage,wisp:true};if(this.postParams){f=_.extend(f,{post:this.postParams})}var a=function(){try{b=(JSEngine.CaptchaHelper.captchaWin&&JSEngine.CaptchaHelper.captchaWin.window)?JSEngine.CaptchaHelper.captchaWin:null}catch(g){}var h=(b&&b.window)?b.window:undefined;var e=(this.target==="_blank"?helpers.createNewWindow(this.target,undefined,c):window)||h;if(!h){JSEngine.CaptchaHelper.captchaWin=e}helpers.navigateToPageNewTab(this.captchaPage,f,e)}.createDelegate(this);if(this.openExternal){helpers.openInBrowserApp(helpers.buildPageUrl(this.captchaPage,f,true),a)}else{a()}},_doShowPopup:function(){$j(this.popupElementId).show()}});namespace("JSEngine");JSEngine.PPVAContainer=Backbone.Model.extend({initialize:function(a){a=a||{};helpers.assertParametersExistAndAddToObject(a,["el","mediaUri","purchaseType","applicationVariables","page","feedManager","mediaManager","messageManager"],this);helpers.addParametersToObjectIfExist(a,["themeId","languageCode","currencyCode","confirmationRequired","formWidth","formHeight","isNested"],this);Backbone.Model.prototype.initialize.call(this,a);if(this.isNested){this.init();this.checkPaymentRequirement()}else{this.page.on("activate",function(){this.init();this.checkPaymentRequirement()}.createDelegate(this))}},init:function(){this.applicationVariables.urlParams=JSEngine.URLHelpers.parseParameters(null);this.renderedMediaUri=JSEngine.ViewHelper.renderString(this.mediaUri,this.applicationVariables);if(String(this.renderedMediaUri).indexOf(",")!==-1){this.renderedMediaUri=this.renderedMediaUri.split(",")}else{var a=new Array();a.push(this.renderedMediaUri);this.renderedMediaUri=a}if(!this.languageCode){this.languageCode="eng"}if(!this.currencyCode){this.currencyCode="usd"}this.container=this.el.find(".ae-ppva-payment-buttons-container");this.messagesContainer=this.el.find(".ae-ppva-payment-messages-container");this.paymentPlayButtonTemplate=_.template(helpers.getHtmlFromElement(this.el.find(".ae-ppva-play-button")));this.paymentBuyButtonTemplate=_.template(helpers.getHtmlFromElement(this.el.find(".ae-ppva-buy-button")));this.paymentPayedTemplate=_.template(helpers.getHtmlFromElement(this.el.find(".ae-ppva-payment-complete-payed")));this.paymentPayedAlreadyPurchasedTemplate=_.template(helpers.getHtmlFromElement(this.el.find(".ae-ppva-payment-complete-already-purchased")));this.paymentPaymentConfirmationRequiredTemplate=_.template(helpers.getHtmlFromElement(this.el.find(".ae-ppva-payment-confirmation-required")));this.paymentErrorTemplate=_.template(helpers.getHtmlFromElement(this.el.find(".ae-ppva-payment-error")))},checkPaymentRequirement:function(){var a={purchase_type:this.purchaseType,media_uris:this.renderedMediaUri};JSEngine.IFAPIInitHelper.initialize("avod/v1",function(c){var b=c[0];b.PPV.checkPaymentRequirement(a,this.handlePaymentRequired.createDelegate(this))}.createDelegate(this))},handlePaymentRequired:function(b,a){if(!b){var c={media_uri:this.renderedMediaUri.join(),urlParams:this.applicationVariables.urlParams};if(a){this.renderItem(this.container,this.paymentBuyButtonTemplate,c);this.container.find(".ae-ppva-buy-button-button").off("click");this.container.find(".ae-ppva-buy-button-button").bind("click",this.onBuyClick.createDelegate(this));this.createChildElementWrapper(this.container,function(){this.container.find(".ae-ppva-buy-button-button").off("click");this.container.find(".ae-ppva-buy-button-button").bind("click",this.onBuyClick.createDelegate(this))}.createDelegate(this))}else{this.renderItem(this.container,this.paymentPlayButtonTemplate,c);this.createChildElementWrapper(this.container)}this.messagesContainer.hide();this.container.show()}},onDismissClick:function(){Array.prototype.pop.apply(arguments).preventDefault();this.showButtons(".ae-ppva-message-dismiss-button");(arguments.length==1)&&arguments[0]()},onPurchaseCancelClick:function(a){a.preventDefault();this.showButtons(".ae-ppva-purchase-cancel-button")},onPurchaseConfirmClick:function(a){a.preventDefault();this.purchase();this.messagesContainer.find(".ae-ppva-purchase-confirm-button").off("click");this.messagesContainer.find(".ae-ppva-purchase-confirm-button").unbind("click");this.messagesContainer.hide()},showButtons:function(a){this.createChildElementWrapper(this.container);this.container.show();this.messagesContainer.find(a).off("click");this.messagesContainer.find(a).unbind("click");this.messagesContainer.hide()},showMessage:function(a){this.container.hide();this.messagesContainer.find(".ae-ppva-message-dismiss-button").off("click");this.messagesContainer.find(".ae-ppva-message-dismiss-button").bind("click",_.partial(this.onDismissClick,a).createDelegate(this));this.messagesContainer.show()},onBuyClick:function(a){a.preventDefault();JSEngine.IFAPIInitHelper.initialize("avod/v1",function(d){var b=d[0];var c={purchase_type:this.purchaseType,media_uris:this.renderedMediaUri,urlParams:this.applicationVariables.urlParams};if(this.themeId){c.theme_id=this.themeId}if(this.languageCode){c.lang=this.languageCode}if(this.formWidth){c.form_width=this.formWidth}if(this.formHeight){c.form_height=this.formHeight}b.PPV.initiatePayment(c,function(e,g){if(e){if(e.code+""!=="404"){this.renderItem(this.messagesContainer,this.paymentErrorTemplate,c);this.createChildElementWrapper(this.messagesContainer);this.showMessage()}else{this.container.show()}}else{this.container.hide();if(g.purchase_required){if(this.confirmationRequired){if(g.pay_type){this.handleConfirmationRequired(g.charge_amount,g.pay_type)}else{this.handleConfirmationRequired(g.charge_amount,"")}}else{this.purchase()}}else{var f={media_uri:this.renderedMediaUri.join(),urlParams:this.applicationVariables.urlParams};this.renderItem(this.container,this.paymentPlayButtonTemplate,f);this.createChildElementWrapper(this.container);this.renderItem(this.messagesContainer,this.paymentPayedAlreadyPurchasedTemplate,f);this.createChildElementWrapper(this.messagesContainer);this.showMessage()}}}.createDelegate(this))}.createDelegate(this))},handleConfirmationRequired:function(b,a){var c={pay_type:a,price:b,urlParams:this.applicationVariables.urlParams};this.renderItem(this.messagesContainer,this.paymentPaymentConfirmationRequiredTemplate,c);this.createChildElementWrapper(this.messagesContainer);this.messagesContainer.find(".ae-ppva-purchase-confirm-button").off("click");this.messagesContainer.find(".ae-ppva-purchase-confirm-button").bind("click",this.onPurchaseConfirmClick.createDelegate(this));this.messagesContainer.find(".ae-ppva-purchase-cancel-button").off("click");this.messagesContainer.find(".ae-ppva-purchase-cancel-button").bind("click",this.onPurchaseCancelClick.createDelegate(this));this.messagesContainer.show()},purchase:function(){JSEngine.IFAPIInitHelper.initialize("avod/v1",function(b){var a=b[0];var c={purchase_type:this.purchaseType,media_uris:this.renderedMediaUri,urlParams:this.applicationVariables.urlParams};a.PPV.purchase(c,function(e,d){if(e){this.renderItem(this.messagesContainer,this.paymentErrorTemplate,c);this.createChildElementWrapper(this.messagesContainer);this.showMessage()}else{if(d.code===200){var f={price:d.amount_charged,urlParams:this.applicationVariables.urlParams};this.renderItem(this.messagesContainer,this.paymentPayedTemplate,f);this.createChildElementWrapper(this.messagesContainer);this.showMessage(function(){var g={media_uri:this.renderedMediaUri.join(),urlParams:this.applicationVariables.urlParams};this.renderItem(this.container,this.paymentPlayButtonTemplate,g);this.createChildElementWrapper(this.container)}.createDelegate(this))}}}.createDelegate(this))}.createDelegate(this))},createChildElementWrapper:function(b,a){if(a){this.page.on("initComponentsComplete",a)}this.cleanUpChildElementWrapper();this.childElementWrapper=new JSEngine.ElementWrapper({el:b,applicationVariables:this.applicationVariables,page:this.page,feedManager:this.feedManager,mediaManager:this.mediaManager,messageManager:this.messageManager})},cleanUpChildElementWrapper:function(){if(this.childElementWrapper){this.childElementWrapper.cleanUp();delete this.childElementWrapper}},renderItem:function(a,b,c){this.cleanUpChildElementWrapper();JSEngine.ViewHelper.renderItem(a,b,c)},cleanUp:function(){if(this.childElementWrapper){this.childElementWrapper.cleanUp();delete this.childElementWrapper}}});namespace("JSEngine");JSEngine.DRMPluginContainer=Backbone.Model.extend({initialize:function(a){a=a||{};this.globalCheckOn=null;helpers.assertParametersExistAndAddToObject(a,["el","applicationVariables","page","feedManager","mediaManager","messageManager"],this);helpers.addParametersToObjectIfExist(a,["mediaUri","isNested","globalCheckOn"],this);if(this.globalCheckOn!==null&&this.globalCheckOn.config){console.log(this.globalCheckOn.config);var d=false,c,e,b;for(b=0;!d&&b<this.globalCheckOn.config.length;b++){c=this.globalCheckOn.config[b];if(typeof(c.regex)!=="undefined"){c.flags=(typeof(c.flags)==="string")?c.flags:"";e=new RegExp(c.regex,c.flags);d=e.test(navigator.userAgent)}}if(d){console.log("Should exclude");this.mediaUri=undefined}}Backbone.Model.prototype.initialize.call(this,a);this.template=_.template(helpers.getHtmlFromElement(this.el.find(".ae-drm-generic-message")));this.container=this.el.find(".ae-drm-required-software-container");this.applicationVariables.urlParams=JSEngine.URLHelpers.parseParameters(null);this.mediaUriRaw=this.mediaUri;this.mediaUri=JSEngine.ViewHelper.renderString(this.mediaUri,this.applicationVariables);switch(this.applicationVariables.drm.softwareRequired){case this.applicationVariables.drm.requiredSoftwareTypes.FLASH_PLUGIN:this.template=_.template(helpers.getHtmlFromElement(this.el.find(".ae-drm-flash-plugin-message")));break;case this.applicationVariables.drm.requiredSoftwareTypes.DRM_PLUGIN:this.template=_.template(helpers.getHtmlFromElement(this.el.find(".ae-drm-drm-plugin-message")));break;case this.applicationVariables.drm.requiredSoftwareTypes.IOS_APPLICATION:this.template=_.template(helpers.getHtmlFromElement(this.el.find(".ae-drm-ios-application-message")));break;case this.applicationVariables.drm.requiredSoftwareTypes.ANDROID_APPLICATION:this.template=_.template(helpers.getHtmlFromElement(this.el.find(".ae-drm-android-application-message")));break}if(this.isNested){this.show()}else{this.page.on("activate",this.show.createDelegate(this))}},show:function(){var a={message:this.applicationVariables.drm.softwareInstallMessage,link:this.applicationVariables.drm.requiredSoftwareLink,urlParams:this.applicationVariables.urlParams};this.mediaUri=JSEngine.ViewHelper.renderString(this.mediaUriRaw,this.applicationVariables);if(this.mediaUri){JSEngine.IFAPIInitHelper.initialize("avod/v1",function(c){var b=c[0];JSEngine.IFAPIInitHelper.initialize("metadata/v1",function(e){var d=e[0];d.mediaMetadata({media_uri:this.mediaUri},function(f,g){if(g.type==="videoAggregate"){console.log("DRMPluginContainer: mid "+this.mediaUri+" is an aggregate. Checking child media");d.childMedia({media_uri:g.media_uri},function(k,i){if(k){console.log("DRMPluginContainer: error while retrieving childMedia for "+this.media_uri,k);return}var j=g.media_uri;for(var h in i){if(i.hasOwnProperty(h)){j=h;break}}console.log("DRMPluginContainer: fetching metadata for mid "+j+" (part of the aggregate)");d.mediaMetadata({media_uri:j},function(l,m){this.checkDRMandAct(l,m,b,a)}.createDelegate(this))}.createDelegate(this))}else{console.log("DRMPluginContainer: mid "+this.mediaUri+" is not an aggregate");this.checkDRMandAct(f,g,b,a)}}.createDelegate(this))}.createDelegate(this))}.createDelegate(this))}else{if(this.applicationVariables.drm.softwareRequired===null){this.showNoDRMRequired()}else{this.showDRMRequired(a)}}},showNoDRMRequired:function(){this.createChildElementWrapper();this.el.find(".ae-drm-content").show();this.el.find(".ae-drm-required-software-container").hide()},showDRMRequired:function(a){if(a.deviceNotSupported){this.template=_.template(helpers.getHtmlFromElement(this.el.find(".ae-drm-device-not-supported-by-player")))}this.el.find(".ae-drm-content").hide();JSEngine.ViewHelper.renderItem(this.container.find(".ae-drm-required-software-message-placeholder"),this.template,a);this.createChildElementWrapper();this.el.find(".ae-drm-required-software-container").show()},checkDRMandAct:function(b,c,a,d){var e=(b||!c)?false:(c.playable!==a.Playable.YES);if(c.playable===a.Playable.NO){d.deviceNotSupported=true;this.showDRMRequired(d)}else{if(this.applicationVariables.drm.softwareRequired===null||!e){this.showNoDRMRequired()}else{this.showDRMRequired(d)}}},createChildElementWrapper:function(){if(this.childElementWrapper){this.childElementWrapper.cleanUp();delete this.childElementWrapper}this.childElementWrapper=new JSEngine.ElementWrapper({el:this.container,applicationVariables:this.applicationVariables,page:this.page,feedManager:this.feedManager,mediaManager:this.mediaManager,messageManager:this.messageManager})},cleanUp:function(){if(this.childElementWrapper){this.childElementWrapper.cleanUp();delete this.childElementWrapper}}});namespace("JSEngine");JSEngine.ServiceBlockingURL=Backbone.Model.extend({initialize:function(a){a=a||{};helpers.assertParametersExistAndAddToObject(a,["el","serviceNames","applicationVariables"],this);helpers.addParametersToObjectIfExist(a,["strictMode"],this);if(typeof this.strictMode==="undefined"){this.strictMode=true}if(this.applicationVariables.useServiceControl==false){throw new Error("The widget: ServiceBlockingURL requires ServiceControl what currently disabled.")}this.serviceDisabledStates={};this.el.click(this.onClick.createDelegate(this));_.each(this.serviceNames.split(","),function(b){b=$j.trim(b);this.serviceDisabledStates[b]=true;JSEngine.EventHandler.subscribe("serviceControlStatusChange:"+b,"serviceControlStatusChange_"+(_.uniqueId()),this.tryDisableService.createDelegate(this))}.createDelegate(this));Backbone.Model.prototype.initialize.call(this,a)},tryDisableService:function(a){this.serviceDisabledStates[a.serviceName]=(a.blocked||!a.enabled)},onClick:function(a){if(this.isDisabled()){a.preventDefault()}},isDisabled:function(){var a=new Function("lastState","state",(this.strictMode)?"return lastState || state":"return lastState && state");return _.reduce(this.serviceDisabledStates,a)}});namespace("JSEngine");JSEngine.ServiceBlockingRedirect=Backbone.Model.extend({initialize:function(a){a=a||{};helpers.assertParametersExistAndAddToObject(a,["page","serviceNames","redirectLocation","applicationVariables"],this);helpers.addParametersToObjectIfExist(a,["strictMode"],this);if(typeof this.strictMode==="undefined"){this.strictMode=true}if(this.applicationVariables.useServiceControl==false){throw new Error("The widget: ServiceBlockingRedirect requires ServiceControl what currently disabled.")}this.serviceDisabledStates={};_.each(this.serviceNames.split(","),function(b){b=$j.trim(b);this.serviceDisabledStates[b]=true;JSEngine.EventHandler.subscribe("serviceControlStatusChange:"+b,"serviceControlStatusChange_"+(_.uniqueId()),this.serviceStatusChange.createDelegate(this))}.createDelegate(this));this.page.on("activate",function(){if(this.isDisabled()){this.doRedirection()}}.createDelegate(this));Backbone.Model.prototype.initialize.call(this,a)},serviceStatusChange:function(a){if(a.blocked||!a.enabled){this.serviceDisabledStates[a.serviceName]=true}else{this.serviceDisabledStates[a.serviceName]=false}if(this.page.isActive&&this.isDisabled()){this.doRedirection()}},doRedirection:function(){helpers.changeDocumentLocation(this.redirectLocation)},isDisabled:function(){var a=new Function("lastState","state",(this.strictMode)?"return lastState || state":"return lastState && state");return _.reduce(this.serviceDisabledStates,a)}});namespace("JSEngine");JSEngine.DeviceRouteChecker=Backbone.Model.extend({initialize:function(a){a=a||{};helpers.addParametersToObjectIfExist(a,["page","physicalPage"],this);if(this.page==undefined&&this.physicalPage==undefined){throw new "Nothing to redirect to"}},doCheck:function(a){return true}});namespace("JSEngine");JSEngine.NewDynamicContainer=Backbone.Model.extend({initialize:function(a){this.onViewChange=_.bind(this.onViewChange,this);this.config=a=a||{};helpers.assertParametersExistAndAddToObject(a,["el","page","applicationVariables","feedManager","mediaManager","messageManager"],this);this.itemTemplate=helpers.parseTemplateMarkup(this.el,a.itemTemplateSelector)||helpers.parseTemplateMarkup($j("body"),"#"+a.template);this.loadingTemplate=helpers.parseTemplateMarkup(this.el,a.loadingTemplateSelector)||helpers.parseTemplateMarkup($j("body"),"#"+a.loadingTemplate);this.noDataTemplate=helpers.parseTemplateMarkup(this.el,a.noDataTemplateSelector)||helpers.parseTemplateMarkup($j("body"),"#"+a.noDataTemplate);this.errorTemplate=helpers.parseTemplateMarkup(this.el,a.errorTemplateSelector)||helpers.parseTemplateMarkup($j("body"),"#"+a.errorTemplate);this.bodyContainer=this.getContainerBodyElement(a.bodyContainerSelector);this.includeWrappingDiv=((a.includeWrappingDiv==false)?false:true);this.collection=this.feedManager.getDataCollection(this.el,this.applicationVariables,this.page);this.collection.on("fetchFail",this.onFetchFail);this.collection.on("clear",this.onCollectionClear.createDelegate(this));this.view=this.createView();if(this.page.isActive&&!this.collection.hasBeenFetched){this.collection.fetch({applicationVariables:this.config.applicationVariables})}else{if(this.page.isActive){this.view.render()}}},onFetchFail:function(b,c){if(this.view){this.view.clear()}if(!_.isEmpty(this.errorTemplate)){var a=_.template(this.errorTemplate,this.applicationVariables);this.bodyContainer.html(a);delete this.swiper}},createView:function(){var b=this.bodyContainer;if(this.includeWrappingDiv){b=$j('<div class="wrap swiper-wrapper"></div>');this.bodyContainer.html(b)}else{this.bodyContainer.empty()}var a=new JSEngine.NewCollectionView({container:b,template:this.itemTemplate,noDataTemplate:this.noDataTemplate,pagingCount:1,doPagination:false,collection:this.collection,activeSliderPageIndex:this.currentPageIndex||0,slideClasses:this.config.slideClasses,itemClasses:this.config.itemClasses,applicationVariables:this.config.applicationVariables,page:this.config.page,feedManager:this.config.feedManager,mediaManager:this.config.mediaManager,messageManager:this.config.messageManager});a.on("change",this.onViewChange);return a},render:function(a){this.hasBeenRendered=true;this.view.render()},onViewChange:function(){this.trigger("change",this)},onCollectionClear:function(){this.trigger("clear",this)},cleanUp:function(){this.off()},getContainerBodyElement:function(b){if(b){var a=this.el.find(b)||$j(b);if(a.length>0){return a}else{throw new Error("JSEngine.DynamicContainer: Unable to find the body container with the selector '"+b+"'")}}return this.el}});namespace("JSEngine");JSEngine.FeedManager=Backbone.Model.extend({initialize:function(a){a=a||{};this.dataCollections={};this.dataCollectionOwners=[]},getDataCollection:function(b,d,c){var f=this.getFeedConfig(b,d,c);if(!_.isEmpty(b.data("name"))){if(f.name&&f.name.indexOf(b.data("name"))==-1){f.name=f.name+"_"+b.data("name")}}if(!_.isEmpty(b.data("customDataTransformerFunction"))){var a=jsonPath(window,b.data("customDataTransformerFunction"));if(a&&a.length>0&&_.isFunction(a[0])){f.customDataTransformerFunction=a[0]}else{console.warn("FeedManager: Unable to find customDataTransformerFunction: "+b.data("customDataTransformerFunction"))}}if(!this.dataCollections[f.name]||f.name=="MixedCollection"){var e=null;if(_.isUndefined(JSEngine[f.collectionType])){e=new JSEngine.GenericCollection(undefined,f)}else{e=new JSEngine[f.collectionType](undefined,f)}e.on("cleanup",function(){this.dataCollections=_.omit(this.dataCollections,f.name)}.createDelegate(this));if((_.isUndefined(e.cacheable)||e.cacheable)&&(f.useCachedCopy)){this.dataCollections[f.name]=e;this.dataCollectionOwners.push({el:b,collection:e})}return e.bindToPageEvents(c)}else{return this.dataCollections[f.name].bindToPageEvents(c)}},getDataCollectionByName:function(b){var a=[];if(!this.dataCollections[b]){var c=_.filter(_.keys(this.dataCollections),function(d){return d.indexOf(b)!==-1});if(c){a=this.dataCollections[c]}}else{a=this.dataCollections[b]}return a},getDataCollectionByCollectionName:function(a){return this.dataCollections[_.find(_.keys(this.dataCollections),function(b){return b.indexOf(a)!=-1})]},getCollectionByOwnerEl:function(a){return _.find(this.dataCollectionOwners,function(b){return b.el[0]===a[0]})},getFeedConfig:function(e,h,f){var d=e.attr("data-collection-type")||"GenericCollection";var c;switch(d){case"ExtvStationsCollection":c={collectionType:d,seat_class:"all",useCachedCopy:e.attr("data-always-fetch")!=="true",applicationVariables:h,useSorting:jQuery.parseJSON(e.attr("data-use-sorting")),sortString:e.attr("data-sort-string"),collectionRefreshTimeout:e.data("refreshInterval")||0,collectionFailRetryTimeout:e.data("failRetryTimeout")||0,page:f,bypassCommissionCheck:(e.data("bypassCommission")&&e.data("bypassCommission")==true)||false,listenToChannelChange:e.data("listenToChannelChange")};break;case"CategoriesCollection":c={collectionType:d,jsonPathToIdInApplicationVariables:e.attr("data-json-path-to-id"),seat_class:"all",alwaysFetch:e.data("alwaysFetch"),useCachedCopy:e.attr("data-always-fetch")!=="true",applicationVariables:h,useSorting:jQuery.parseJSON(e.attr("data-use-sorting")),sortString:e.attr("data-sort-string"),collectionRefreshTimeout:e.data("refreshInterval")||0,collectionFailRetryTimeout:e.data("failRetryTimeout")||0,page:f};break;case"CategoryMediaCollection":c={collectionType:d,name:"CategoryMediaCollection_"+(e.data("name")||f.name||Math.floor(Math.random()*100000))+"_"+(e.attr("data-json-path-to-category-id")||e.attr("data-static-category-id")),jsonPathToCategoryIdInApplicationVariables:e.attr("data-json-path-to-category-id"),staticCategoryIdInApplicationVariables:e.attr("data-static-category-id"),seat_class:"all",useCachedCopy:e.attr("data-always-fetch")!=="true",applicationVariables:h,useSorting:jQuery.parseJSON(e.attr("data-use-sorting")),sortString:e.attr("data-sort-string"),collectionRefreshTimeout:e.data("refreshInterval")||0,collectionFailRetryTimeout:e.data("failRetryTimeout")||0,page:f};break;case"ContextualCollection":c={collectionType:d,path:e.data("bindPath"),data:e.data("boundData"),useCachedCopy:e.attr("data-always-fetch")!=="true",applicationVariables:h,useSorting:jQuery.parseJSON(e.attr("data-use-sorting")),sortString:e.attr("data-sort-string"),collectionRefreshTimeout:e.data("refreshInterval")||0,collectionFailRetryTimeout:e.data("failRetryTimeout")||0,page:f};break;case"MediaMetadataCollection":c={collectionType:d,name:"MediaMetadataCollection_"+(e.data("name")||f.name||Math.floor(Math.random()*100000))+"_"+(e.attr("data-json-path-to-media-id")||e.attr("data-static-media-id")),jsonPathToMediaIdInApplicationVariables:e.attr("data-json-path-to-media-id"),staticMediaIdInApplicationVariables:e.attr("data-static-media-id"),seat_class:"all",alwaysFetch:e.data("alwaysFetch"),useCachedCopy:e.attr("data-always-fetch")!=="true",applicationVariables:h,useSorting:jQuery.parseJSON(e.attr("data-use-sorting")),sortString:e.attr("data-sort-string"),collectionRefreshTimeout:e.data("refreshInterval")||0,collectionFailRetryTimeout:e.data("failRetryTimeout")||0,page:f};break;case"MixedCollection":c={collectionType:d,mixedFilter:jQuery.parseJSON(e.attr("data-filter-mixed")),seat_class:"all",useCachedCopy:e.attr("data-always-fetch")!=="true",applicationVariables:h,useSorting:jQuery.parseJSON(e.attr("data-use-sorting")),sortString:e.attr("data-sort-string"),collectionRefreshTimeout:e.data("refreshInterval")||0,collectionFailRetryTimeout:e.data("failRetryTimeout")||0,page:f};break;case"ChildMediaCollection":var b="ChildMediaCollection_"+e.attr("data-json-path-to-media-child-id")+"_"+e.attr("data-static-media-child-id");c={name:b,collectionType:d,jsonPathToMediaChildIdInApplicationVariables:e.attr("data-json-path-to-media-child-id"),staticMediaChildIdInApplicationVariables:e.attr("data-static-media-child-id"),seat_class:"all",useCachedCopy:e.attr("data-always-fetch")!=="true",applicationVariables:h,useSorting:jQuery.parseJSON(e.attr("data-use-sorting")),sortString:e.attr("data-sort-string"),collectionRefreshTimeout:e.data("refreshInterval")||0,collectionFailRetryTimeout:e.data("failRetryTimeout")||0,page:f};break;case"MixedCollection":c={collectionType:d,mixedFilter:jQuery.parseJSON(e.attr("data-filter-mixed")),seat_class:"all"};break;case"NewsProvidersCollection":c={collectionType:d,useCachedCopy:e.attr("data-always-fetch")!=="true",applicationVariables:h,useSorting:jQuery.parseJSON(e.attr("data-use-sorting")),sortString:e.attr("data-sort-string"),collectionRefreshTimeout:e.data("refreshInterval")||0,collectionFailRetryTimeout:e.data("failRetryTimeout")||0,page:f,listenToUpdateEvent:e.data("listenToUpdateEvent")};break;case"NewsCategoriesCollection":c={collectionType:d,jsonPathToProviderIdInApplicationVariables:e.attr("data-json-path-to-provider-id"),staticProviderIdInApplicationVariables:e.attr("data-static-provider-id"),useCachedCopy:e.attr("data-always-fetch")!=="true",applicationVariables:h,useSorting:jQuery.parseJSON(e.attr("data-use-sorting")),sortString:e.attr("data-sort-string"),collectionRefreshTimeout:e.data("refreshInterval")||0,collectionFailRetryTimeout:e.data("failRetryTimeout")||0,page:f,listenToUpdateEvent:e.data("listenToUpdateEvent")};break;case"NewsArticlesCollection":c={collectionType:d,jsonPathToProviderIdInApplicationVariables:e.attr("data-json-path-to-provider-id"),jsonPathToCategoryIdInApplicationVariables:e.attr("data-json-path-to-category-id"),staticProviderIdInApplicationVariables:e.attr("data-static-provider-id"),staticCategoryIdInApplicationVariables:e.attr("data-static-category-id"),useCachedCopy:e.attr("data-always-fetch")!=="true",applicationVariables:h,useSorting:jQuery.parseJSON(e.attr("data-use-sorting")),sortString:e.attr("data-sort-string"),collectionRefreshTimeout:e.data("refreshInterval")||0,collectionFailRetryTimeout:e.data("failRetryTimeout")||0,page:f,listenToUpdateEvent:e.data("listenToUpdateEvent")};break;case"NewsArticlesCollectionWithImages":c={collectionType:d,jsonPathToProviderIdInApplicationVariables:e.attr("data-json-path-to-provider-id"),jsonPathToCategoryIdInApplicationVariables:e.attr("data-json-path-to-category-id"),staticProviderIdInApplicationVariables:e.attr("data-static-provider-id"),staticCategoryIdInApplicationVariables:e.attr("data-static-category-id"),useCachedCopy:e.attr("data-always-fetch")!=="true",applicationVariables:h,useSorting:jQuery.parseJSON(e.attr("data-use-sorting")),sortString:e.attr("data-sort-string"),collectionRefreshTimeout:e.data("refreshInterval")||0,collectionFailRetryTimeout:e.data("failRetryTimeout")||0,page:f,listenToUpdateEvent:e.data("listenToUpdateEvent")};break;case"NewsArticleCollection":c={collectionType:d,jsonPathToArticleIdInApplicationVariables:e.attr("data-json-path-to-article-id"),staticArticleIdInApplicationVariables:e.attr("data-static-article-id"),useCachedCopy:e.attr("data-always-fetch")!=="true",applicationVariables:h,useSorting:jQuery.parseJSON(e.attr("data-use-sorting")),sortString:e.attr("data-sort-string"),collectionRefreshTimeout:e.data("refreshInterval")||0,collectionFailRetryTimeout:e.data("failRetryTimeout")||0,page:f,listenToUpdateEvent:e.data("listenToUpdateEvent")};break;case"RegionListWeatherCollection":c={collectionType:d,useCachedCopy:e.attr("data-always-fetch")!=="true",applicationVariables:h,useSorting:jQuery.parseJSON(e.attr("data-use-sorting")),sortString:e.attr("data-sort-string"),collectionRefreshTimeout:e.data("refreshInterval")||0,collectionFailRetryTimeout:e.data("failRetryTimeout")||0,page:f,listenToUpdateEvent:e.data("listenToUpdateEvent")};break;case"CityListWeatherCollection":c={collectionType:d,jsonPathToRegionIdInApplicationVariables:e.attr("data-json-path-to-region-id"),staticRegionIdInApplicationVariables:e.attr("data-static-region-id"),useCachedCopy:e.attr("data-always-fetch")!=="true",applicationVariables:h,useSorting:jQuery.parseJSON(e.attr("data-use-sorting")),sortString:e.attr("data-sort-string"),collectionRefreshTimeout:e.data("refreshInterval")||0,collectionFailRetryTimeout:e.data("failRetryTimeout")||0,page:f,listenToUpdateEvent:e.data("listenToUpdateEvent")};break;case"CityCurrentWeatherCollection":c={collectionType:d,jsonPathToRegionIdInApplicationVariables:e.attr("data-json-path-to-region-id"),staticRegionIdInApplicationVariables:e.attr("data-static-region-id"),jsonPathToCityIdInApplicationVariables:e.attr("data-json-path-to-city-id"),staticCityIdInApplicationVariables:e.attr("data-static-city-id"),useCachedCopy:e.attr("data-always-fetch")!=="true",applicationVariables:h,useSorting:jQuery.parseJSON(e.attr("data-use-sorting")),sortString:e.attr("data-sort-string"),collectionRefreshTimeout:e.data("refreshInterval")||0,collectionFailRetryTimeout:e.data("failRetryTimeout")||0,page:f,listenToUpdateEvent:e.data("listenToUpdateEvent")};break;case"CityForecastWeatherCollection":c={collectionType:d,jsonPathToCityIdInApplicationVariables:e.attr("data-json-path-to-city-id"),staticCityIdInApplicationVariables:e.attr("data-static-city-id"),jsonPathToForecastDaysInApplicationVariables:e.attr("data-json-path-to-forecast-days"),staticForecastDaysInApplicationVariables:e.attr("data-static-forecast-days"),useCachedCopy:e.attr("data-always-fetch")!=="true",applicationVariables:h,useSorting:jQuery.parseJSON(e.attr("data-use-sorting")),sortString:e.attr("data-sort-string"),collectionRefreshTimeout:e.data("refreshInterval")||0,collectionFailRetryTimeout:e.data("failRetryTimeout")||0,page:f,listenToUpdateEvent:e.data("listenToUpdateEvent"),disableCityNameLookup:e.data("disableCityNameLookup")};break;case"FlightDataCollection":c={collectionType:d,jsonPathToFlightDataFunctionInApplicationVariables:e.attr("data-json-path-to-flight-data-function"),useCachedCopy:e.attr("data-always-fetch")!=="true",applicationVariables:h,useSorting:jQuery.parseJSON(e.attr("data-use-sorting")),sortString:e.attr("data-sort-string"),collectionRefreshTimeout:e.data("refreshInterval")||0,collectionFailRetryTimeout:e.data("failRetryTimeout")||0,page:f};break;case"FlightDataWaypointsCollection":c={collectionType:d,numPoints:e.attr("data-static-number-of-waypoints"),useCachedCopy:e.attr("data-always-fetch")!=="true",applicationVariables:h,useSorting:jQuery.parseJSON(e.attr("data-use-sorting")),sortString:e.attr("data-sort-string"),collectionRefreshTimeout:e.data("refreshInterval")||0,collectionFailRetryTimeout:e.data("failRetryTimeout")||0,page:f};break;case"UrlReplaceCollection":c={collectionType:d,seat_class:"all",item:e,xs:"true"===e.attr("data-xs"),useCachedCopy:e.attr("data-always-fetch")!=="true",applicationVariables:h,useSorting:jQuery.parseJSON(e.attr("data-use-sorting")),sortString:e.attr("data-sort-string"),collectionRefreshTimeout:e.data("refreshInterval")||0,collectionFailRetryTimeout:e.data("failRetryTimeout")||0,page:f};break;case"GenericXSCollection":c={collectionType:d,seat_class:"all",url:e.attr("data-url"),path:e.attr("data-array-path")||"",alwaysFetch:e.data("alwaysFetch"),useCachedCopy:e.attr("data-always-fetch")!=="true",applicationVariables:h,useSorting:jQuery.parseJSON(e.attr("data-use-sorting")),sortString:e.attr("data-sort-string"),collectionRefreshTimeout:e.data("refreshInterval")||0,collectionFailRetryTimeout:e.data("failRetryTimeout")||0,page:f};break;case"DestinationCurrentWeatherCollection":c={collectionType:"DestinationCurrentWeatherCollection",forecastDays:e.data("forecastDays"),page:f,listenToUpdateEvent:e.data("listenToUpdateEvent")};break;case"PlaylistCollection":c={};c.mediaManager=f.mediaManager;default:var a=e.attr("data-url");var g=e.attr("data-array-path")||"";if(_.isUndefined(c)){var c={}}if(!_.isUndefined(e.data("name"))){c.name=e.data("name")}c=_.extend(c,e.data());c=_.extend({collectionType:d,url:a,path:g,name:e.data("name")||(a+"_"+g+"_"+(f.name||Math.floor(Math.random()*100000))),alwaysFetch:e.data("alwaysFetch"),useCachedCopy:e.attr("data-always-fetch")!=="true",applicationVariables:h,useSorting:jQuery.parseJSON(e.attr("data-use-sorting")),sortString:e.attr("data-sort-string"),collectionRefreshTimeout:e.data("refreshInterval")||0,collectionFailRetryTimeout:e.data("failRetryTimeout")||0,page:f},c);return c}if(!c.name){c.name=d+"_"+(e.data("name")||f.name||Math.floor(Math.random()*100000))}return c}});namespace("JSEngine");JSEngine.PageManager=Backbone.Model.extend({initialize:function(a){a=a||{};helpers.assertParametersExistAndAddToObject(a,["parentEl","locks","transitionController","feedManager","applicationVariables","mediaManager","messageManager","reportManager"],this);helpers.addParametersToObjectIfExist(a,["parentPageManager"],this);this.pages={};this.currentPageStack=[];this.pageHistory=[];this.pageQueue=[];this.scrollTo=null;this.transitionInProgressClass="ae-transitioning";if(this.applicationVariables.pageCleanupIsEnabled){if(this.applicationVariables.applicationCaching&&this.applicationVariables.applicationCaching.maxPages){this.MAXPAGEQUEUE=this.applicationVariables.applicationCaching.maxPages}else{this.MAXPAGEQUEUE=20}}if(this.applicationVariables.pageHistoryIsEnabled){if(this.applicationVariables.applicationCaching&&this.applicationVariables.applicationCaching.maxPageHistory){this.MAXPAGEHISTORYQUEUE=this.applicationVariables.applicationCaching.maxPageHistory}else{this.MAXPAGEHISTORYQUEUE=20}}this.initPages();this.initGlobalComponents()},createLocks:function(a){this.locksToApplyOnActivate=a},initPages:function(){if(!this.applicationVariables.urlParams){this.applicationVariables.urlParams={}}this.applicationVariables.urlParams=JSEngine.URLHelpers.parseParameters(null);_.each(this.parentEl.find(".pseudo-page"),function(g){var a=$j(g);var d=this.getPageStandardName(a.attr("id"));var b=a.attr("data-lock");var i=a.attr("data-locks-apply-on-activate")||this.locksToApplyOnActivate||"";var h=a.attr("data-page-load-url");var c=a.attr("data-page-load-stratergy");var f=a.data("pagePreload");var e=(a.data("type")?helpers.getType(a.data("type")):null)||JSEngine.PageWrapper;if(f&&this.applicationVariables.pageCleanupIsEnabled){this.MAXPAGEQUEUE--}this.pages[d]=new e({name:d,el:a,pageManager:this,mediaManager:this.mediaManager,feedManager:this.feedManager,transitionHandler:this.transitionController.getPageHandler(a.attr("data-page-transition-handler")),lock:this.locks[b],locksToApplyOnActivate:i.split(" "),applicationVariables:this.applicationVariables,pageLoadUrl:h,pageLoadStratergy:c,messageManager:this.messageManager,reportManager:this.reportManager,pagePreload:f});this.pages[d].on("segmentLoadError",this.onSegmentLoadError.createDelegate(this));if(!this.firstPage){this.firstPage=this.pages[d]}},this);if(!_.isEmpty(this.pages)){if(this.applicationVariables.pageCleanupIsEnabled){if(this.MAXPAGEQUEUE<1){throw"Page queue won't work because the applicationCaching:maxPages setting is lower than the amount of the pages with pagePreload enabled"}else{if(this.MAXPAGEQUEUE<=5){console.log("Pages will be swapped in and out the cache very often, please review your applicationCaching:maxPages setting")}}}}},onSegmentLoadError:function(a){this.trigger("pageLoadError",a)},getPageStandardName:function(a){return(a||"").toLowerCase().replace(/\W/g,"_")},initGlobalComponents:function(){this.globalContainers=[];_.each(this.parentEl.find(".global-container"),function(a){var b=new JSEngine.GlobalWrapper({el:$j(a),pageManager:this,feedManager:this.feedManager,applicationVariables:this.applicationVariables,mediaManager:this.mediaManager,messageManager:this.messageManager});this.globalContainers.push(b)},this)},viewPage:function(b,a){var c=b.split("#");b=this.getPageStandardName(c[0]);interfaceToolkit.contextualLinkHighlighting();JSEngine.prevSelectedMenu=JSEngine.currentlySelectedMenu;JSEngine.currentlySelectedMenu=b;if(this.pages[b]){this.pages[b].anchor=c[1];this.showPage(this.pages[b],a,b)}else{if(this.firstPage){this.showPage(this.firstPage,a,b)}else{console.error("Unable to find any pseudo-page's")}}},showPage:function(d,b,c){var a=function(){$j("body").removeClass("hide-until-app-initialised").removeClass("ae-hide-until-app-initialised");this.doShowPage(d,b,c)}.createDelegate(this);if(this.applicationVariables.pageHistoryIsEnabled&&!(d instanceof JSEngine.ErrorPageWrapper)){this.updateHistory({pageName:c,location:window.location.href})}d.beforePageShow(a,b)},doShowPage:function(b,a,g){if(b.lock){if(b.lock.isLocked){var d=function(i){if(i){console.debug("Show page: ",b);this.showPage(b,a)}}.createDelegate(this);b.lock.showLock(b,d);console.debug("Show lock");return}}if(b.locksToApplyOnActivate){for(var f=0;f<b.locksToApplyOnActivate.length;f++){if(this.locks[b.locksToApplyOnActivate[f]]){this.locks[b.locksToApplyOnActivate[f]].lock()}}}if(g=="home-landing"||g=="splash"){$j("#primary-navigation").addClass("hide")}else{$j("#primary-navigation").removeClass("hide")}interfaceToolkit.autoRedirect(b.el);var j=this.applicationVariables.urlParams;this.applicationVariables.urlParams=a;b.lastUrl=window.location.href;if(_.isUndefined(this.hasBeenInitialized)){this.hasBeenInitialized=true}if(_.isUndefined(b.hasBeenViewed)){b.hasBeenViewed=true;b.trigger("firstActivate",b,this.applicationVariables)}b.trigger("beforeActivate",b,this.applicationVariables);if(this.currentPageStack.length>0){var h=this.currentPageStack[this.currentPageStack.length-1];if(!_.isEqual(j,a)){if(this.currentPageStack.length>0){var e={currentParams:j,newParams:a};h.trigger("urlParamChange",e)}}}b.trigger("activate",b,this.applicationVariables);this.trigger("pageChanged");if(b.el.attr("data-reporting-string")){this.reportManager.push(b.el.attr("data-reporting-string"),{page:b,urlParams:a})}var c=function(){if(this.applicationVariables.blockNavigationDuringTransition){$j("html").addClass(this.transitionInProgressClass)}b.transitionHandler.doTransition(this.currentPageStack,b,this.applicationVariables,this.onPageTransitionComplete.createDelegate(this,[b],true))}.createDelegate(this);if(this.currentPageStack.length>0){h.transitionHandler.beforeTransitionAway(this.currentPageStack,b,this.applicationVariables,c.createDelegate(this,[b],true))}else{c()}},onPageTransitionComplete:function(f){interfaceToolkit.scrollPanes(f.el,true);var d=f.el.find("a.media-player"),b;if(d&&(d.attr("data-type")=="audio"||d.attr("data-type")=="radio")){d.trigger("click")}if(f.el.data("title")){helpers.setWindowTitle(f.el.data("title"))}f.trigger("afterActivate",f,this.applicationVariables);if(!this.applicationVariables.disableAccessibility){var a=$j(".pseudo-page").not(".hide");var e=a.find(".aria-focus").length>0?a.find(".aria-focus").first().attr("tabindex","-1"):a.find(":header").first().attr("tabindex","-1");helpers.setTimeout(function(){e.focus()},500)}if(f.anchor){var c=$j("#"+f.anchor);if(c.length>0){$j("html,body").animate({scrollTop:c.offset().top},0)}}if(this.applicationVariables.pageCleanupIsEnabled){this.updatePageQueue(f)}if(this.applicationVariables.blockNavigationDuringTransition){$j("html").removeClass(this.transitionInProgressClass)}if(this.scrollTo){b=this.scrollTo;$j(b.scrollableTarget).animate({scrollTop:$j(b.selector).offset().top-b.offset},b.speed);this.scrollTo=null}},getApplicationVariables:function(){return this.applicationVariables},cleanUp:function(){this.off("all")},updatePageQueue:function(b){if(b.pagePreload){return}this.pageQueue.push(b);if(this.pageQueue.length>this.MAXPAGEQUEUE){var a=this.pageQueue.shift();if(a!==b){a.cleanUp()}}},updateHistory:function(a){this.pageHistory.push(a);if(this.pageHistory.length>this.MAXPAGEHISTORYQUEUE){this.pageHistory.shift()}},componentEvents:undefined,getComponentEvents:function(){if(!_.isUndefined(this.parentPageManager)){return this.parentPageManager.getComponentEvents()}if(_.isUndefined(this.componentEvents)){this.componentEvents=_.extend({},Backbone.Events)}return this.componentEvents},waitForComponent:function(c,d,a){var b=function(e){a(e);this.getComponentEvents().off("compInit:"+c,b)}.createDelegate(this);this.getComponentEvents().on("compInit:"+c,b)},waitForComponents:function(d,a){if(d.length===0){a();return}var c=d.shift();var e;if(c.value){e=c.value}else{if(c.name){e=c.dependency[c.name]}else{console.error("An error occurred in waitForComponents - no matching value or name on the component config")}}if(_.isUndefined(c.lookup.call(c.scope,e))){var b=function(f){if(!_.isEmpty(d)){d[0].dependency=c.lookup.call(c.scope,e)}this.waitForComponents(d,a);this.getComponentEvents().off("compInit:"+e,b)}.createDelegate(this);this.getComponentEvents().on("compInit:"+e,b)}else{if(!_.isEmpty(d)){d[0].dependency=c.lookup.call(c.scope,e)}this.waitForComponents(d,a)}},setScrollOnNewPage:function(a){if(a&&a.hasOwnProperty("scrollableTarget")&&a.hasOwnProperty("selector")){this.scrollTo={scrollableTarget:a.scrollableTarget,selector:a.selector,offset:a.offset||0,speed:a.speed||"slow"}}else{console.error("PageManager.setScrollOnNewPage error: at least 'scrollableTarget' and 'selector' property has to be provided!")}}});namespace("JSEngine");JSEngine.MessageManager=Backbone.Model.extend({initialize:function(a){a=a||{};helpers.assertParametersExistAndAddToObject(a,["applicationVariables"],this);Backbone.Model.prototype.initialize.call(this);this.paMessage=new JSEngine.Message({template:helpers.getTemplateMarkup("paMessageBox")});this.systemMessage=new JSEngine.Message({template:helpers.getTemplateMarkup("sysMessageBox")});this.mediaMessage=new JSEngine.Message({template:helpers.getTemplateMarkup("mediaMessageBox")});this.handlers={decompressionHandler:function(b){this.systemMessage.show(this.applicationVariables.messages.sysMessages.decompression)},paOffHandler:function(b){this.paMessage.hide()},paAudioHandler:function(b){this.paMessage.show(this.applicationVariables.messages.paMessages.paAudio)},paVideoHandler:function(b){this.paMessage.show(this.applicationVariables.messages.paMessages.paVideo)},paVideoAHandler:function(b){this.paMessage.show(this.applicationVariables.messages.paMessages.paVideoA)},paOtherHandler:function(b){this.paMessage.show(this.applicationVariables.messages.paMessages.paOther)}};this.subscribe()},subscribe:function(){JSEngine.EventHandler.subscribe("paoff","systemPAOffHandler",this.handlers.paOffHandler.createDelegate(this),this);JSEngine.EventHandler.subscribe("paaudio","systemPAAudioHandler",this.handlers.paAudioHandler.createDelegate(this),this);JSEngine.EventHandler.subscribe("pavideo","systemPAVideoHandler",this.handlers.paVideoHandler.createDelegate(this),this);JSEngine.EventHandler.subscribe("pavideoa","systemPAVideoAHandler",this.handlers.paVideoAHandler.createDelegate(this),this);JSEngine.EventHandler.subscribe("paother","systemPAOtherHandler",this.handlers.paOtherHandler.createDelegate(this),this)}});namespace("JSEngine");JSEngine.MediaManager=Backbone.Model.extend({players:undefined,playlists:undefined,AVOD:undefined,initialize:function(a){a=a||{};this.players=[];this.playlists=[];var b=["applicationVariables"];helpers.assertParametersExistAndAddToObject(a,b,this);Backbone.Model.prototype.initialize.call(this)},initService:function(b,a){JSEngine.IFAPIInitHelper.initialize("avod/v1",function(d){var c=d[0];if(c.support.platform.vod!=c.Platform.NONE||c.support.platform.aod!=c.Platform.NONE){this.AVOD=c;b.AVOD=c;if(a){a(b)}}}.createDelegate(this),function(c){console.log(c.text)})},createMediaPlayer:function(a){var b=this.getCurrentPlayer(a.playerType);if(a.playerNum<=1){if(b){this.cleanUp(a.playerType)}}this._createMediaPlayer(a)},_createMediaPlayer:function(d){var b="media-player-overlay-container";var c="media-player-overlay";var e="ignore-drag-to-click ";switch(d.playerType){case"audio":case"radio":e+="media-player offset";b=b+"-audio-"+d.playerSequenceNumber;c=c+"-audio-"+d.playerSequenceNumber;break;case"video":e+="media-player cover hide";b=b+"-video-"+d.playerSequenceNumber;c=c+"-video-"+d.playerSequenceNumber;break;case"tv":e="media-player cover hide";b=b+"-video-"+d.playerSequenceNumber;c=c+"-video-"+d.playerSequenceNumber;break}var a=$j('<div class="'+e+'" id="'+b+'"></div>');a.append($j('<div id="'+c+'"></div>'));if(!_.isUndefined(d.playerContainer)){$j(d.playerContainer).append(a)}else{$j("body").append(a)}d.container="#"+b;d.playerEl="#"+c;if(_.isUndefined(this.AVOD)){this.initService(d,this._createPlayerByType.createDelegate(this))}else{d.AVOD=this.AVOD;this._createPlayerByType(d)}},cleanUp:function(e,b){if(_.isUndefined(e)){throw"type is required"}if(_.isUndefined(this.players)){return}var d=_.filter(this.players,function(f){return(f.type==e)});var a=function(f){f.removeListeners();f.player.remove();f.off();$j(f.container).remove()};if(_.isUndefined(b)){this.players=_.filter(this.players,function(f){return !(_.contains(d,f))});_.each(d,function(g,f){a(g.player)})}else{var c=_.find(d,function(f){return c.name==b});this.players=_.filter(this.players,function(f){return f!=c});if(!c){return}a(c.player)}},pausePlayers:function(){_.each(this.players,function(a){a.player.pause()})},removePlayer:function(c,a,b){this.players=_.reject(this.players,function(e){var d=(e.name==a&&e.type==c&&e.player==b);if(d){e.player.off("stateChange",e.stateChange)}return d})},addPlayer:function(d,b,c){if(!this.getByName(b)){var e={type:d,player:c};if(!_.isUndefined(b)){e.name=b}var a=this.stateChange.createDelegate(this,[e.player],1);e.player.on("stateChange",a);e.stateChange=a;this.players.push(e);this.trigger("playerAdded",e)}},stateChange:function(b,a){_.each(this.players,function(c){if(_.isEqual(c.player,a)){return}else{if(c.player.getState()==="play"&&b==="play"){c.player.pause()}}})},getByName:function(a){var b=_.find(this.players,function(c){return c.name==a});if(_.isUndefined(b)){return undefined}return b.player},getCurrentlyPlayingPlayer:function(){var a=_.find(this.players,function(b){return b.player.getState()==="play"});return a?a.player:null},removePlaylist:function(a,b){this.playlists=_.reject(this.playlists,function(c){return(c.name==a&&c.playlist==b)})},addPlaylist:function(a,c){var b={playlist:c};if(!_.isUndefined(a)){b.name=a}this.playlists.push(b);this.trigger("playlistAdded",b)},getPlaylistByName:function(b){var a=_.find(this.playlists,function(c){return c.name==b});if(_.isUndefined(a)){return undefined}return a.playlist}});namespace("JSEngine");JSEngine.ReportManager=Backbone.Model.extend({initialize:function(a){a=a||{};helpers.assertParametersExistAndAddToObject(a,["applicationVariables"],this);Backbone.Model.prototype.initialize.call(this);this.queue=[];this.looping=false;this.takeNext=false;this.logType="push";if(this.applicationVariables.reporting){if(this.applicationVariables.reporting.logType){this.logType=this.applicationVariables.reporting.logType}this.applicationVariables.reporting.timeout=this.applicationVariables.reporting.timeout||1000;this.start()}},push:function(b,d){try{var c=_.template(b,d);this.queue.push(c)}catch(a){console.debug("Error transforming reporting template: '"+b+"' with the data:");console.debug(d)}},start:function(){helpers.setTimeout(this.send.createDelegate(this),this.applicationVariables.reporting.timeout)},send:function(){var a=this.queue.pop();if(a){this.makeRequest(this.applicationVariables.reporting.baseUrl+a)}else{this.start()}},makeRequest:function(a){if(this.logType==="push"){this.makeRequestNonPaxus(a)}else{this.makeRequestPaxus(a)}},makeRequestNonPaxus:function(a){$j.post(a,"",function(){this.send()}.createDelegate(this)).fail(function(b){if(b.status-500>=0){this.queue.push(a.replace(this.applicationVariables.reporting.baseUrl,""));this.start()}else{this.send()}}.createDelegate(this))},makeRequestPaxus:function(b){var a={screen:b};JSEngine.IFAPIInitHelper.initialize("analytics/v1",function(d){var e=d[0];var c=function(f){if(f){this.queue.push(a);this.start()}else{this.send()}}.createDelegate(this);e[this.logType](a,c)}.createDelegate(this),function(){this.makeRequestNonPaxus(a)}.createDelegate(this))}});namespace("JSEngine");JSEngine.DragAndDropManager=Backbone.Model.extend({enabled:true,toCleanup:[],initialize:function(a){a=a||{};if(a.disabled){this.enabled=!a.disabled}if(a.el){a.el.on("toggleDisabled",function(){var b=a.el.find("[draggable]");b.attr("draggable",""+!b.attr("draggable"));this.enabled=!this.enabled}.createDelegate(this))}$j(".ignore-touch-start").css("pointer-events","none")},reset:function(){_.each(this.toCleanup,function(a){a.$el.off(a.type,a.fn)});this.toCleanup=[];this.dragItems=[];this.dropItems=[]},dragItems:[],dragItem:undefined,dropItems:[],addDragItem:function(b,a){this.dragItems.push(b);this.addDragItemTouch(b,a)},addDragItemTouch:function(c,b){c.addClass("ae-draggable");var d={};var a;var g=function(h){if(!this.enabled){return}$j(".ignore-touch-start").css("pointer-events","auto");if(Modernizr.touch){d.pageX=h.originalEvent.touches[0].pageX;d.pageY=h.originalEvent.touches[0].pageY}else{d.pageX=h.pageX;d.pageY=h.pageY}a=_.clone(c.offset());c.addClass("ae-dragging");c.next(".ae-draggable").addClass("ae-dragging-next");c.prev(".ae-draggable").addClass("ae-dragging-prev");c.css("z-index","666");this.trigger("dragstart",b)}.createDelegate(this);var f=function(k,n){if(!this.enabled){return}if(_.isUndefined(a)){var m=c.closest(".ae-draggable");m.css("left","");m.css("top","");m.css("position","");m.css("z-index","");m.css("display","");m.siblings(".ae-dragging-next").removeClass("ae-dragging-next");m.siblings(".ae-dragging-prev").removeClass("ae-dragging-prev");$j(".ae-dragging").removeClass("ae-dragging");return}var o={};var h=a.left-d.pageX;var l=a.top-d.pageY;if(Modernizr.touch){k.preventDefault();if(n){o.pageX=n.pageX-h;o.pageY=n.pageY-l}else{o.pageX=k.originalEvent.touches[0].pageX;o.pageY=k.originalEvent.touches[0].pageY;this.touchToMouseEvents(k,c)}}else{if(n){o.pageX=n.pageX-h;o.pageY=n.pageY-l}else{o.pageX=k.pageX;o.pageY=k.pageY}}var j=c;var i=j.offsetParent();j.css("left",((o.pageX+h)-i.offset().left)+"px");j.css("top",((o.pageY+l)-i.offset().top)+"px");j.css("position","absolute")}.createDelegate(this);var e=function(k){if(!this.enabled){return}var j;var h;var n;if(Modernizr.touch){h=k.originalEvent.changedTouches[0].pageX;n=k.originalEvent.changedTouches[0].pageY;this.touchToMouseOut()}else{h=k.pageX;n=k.pageY}c.css("pointer-events","none");$j(".ignore-drop").css("pointer-events","none");c.hide();j=document.elementFromPoint(h,n);c.show();c.css("pointer-events","auto");$j(".ignore-drop").css("pointer-events","auto");j=$j(j).closest(".ae-droppable");var m=c.closest(".ae-draggable");m.css("left","");m.css("top","");m.css("position","");m.css("z-index","");m.css("display","");m.siblings(".ae-dragging-next").removeClass("ae-dragging-next");m.siblings(".ae-dragging-prev").removeClass("ae-dragging-prev");$j(".ae-dragging").removeClass("ae-dragging");$j(".ignore-touch-start").css("pointer-events","none");if(j.length===0){b.trigger("fetchSuccess");return}j=j[0];var l=this.findDropModelById(j.id);if(_.isUndefined(l)){b.trigger("fetchSuccess");return}var i=b;this.trigger("drop",l,i);k.preventDefault()}.createDelegate(this);if(Modernizr.touch){c.on("touchstart",g);c.on("touchmove",f);c.on("touchend",e);this.toCleanup=this.toCleanup.concat([{$el:c,type:"touchstart",fn:g},{$el:c,type:"touchmove",fn:f},{$el:c,type:"touchend",fn:e}])}else{c.on("movestart",g);c.on("move",f);c.on("moveend",e);this.toCleanup=this.toCleanup.concat([{$el:c,type:"movestart",fn:g},{$el:c,type:"move",fn:f},{$el:c,type:"moveend",fn:e}])}},touchToMouseEvents:function(d,c){var a=d.originalEvent.touches[0].pageX;var e=d.originalEvent.touches[0].pageY;c.css("pointer-events","none");elem=helpers.elementFromPoint(a,e);var b=$j(elem);if(b.hasClass("trigger-mouse-events")){if(!b.hasClass("ae-in")){b.trigger("mouseover");b.addClass("ae-in")}c.css("pointer-events","auto");return}this.touchToMouseOut()},touchToMouseOut:function(){var a=$j(".ae-in");if(a.length>0){a.trigger("mouseout");a.removeClass("ae-in")}},addDropItem:function(b,a){this.dropItems=_.filter(this.dropItems,function(c){if(c.$el.is(b)){return false}if(c.model===a){return false}return true});if(!b.attr("id")){b.attr("id",_.uniqueId("dd_"))}this.dropItems.push({$el:b,model:a});this.addDropItemTouch(b,a)},addDropItemTouch:function(b,a){b.addClass("ae-droppable")},findDropModelById:function(b){var a=_.find(this.dropItems,function(c){if(c.$el.attr("id")==b){return true}return false});if(_.isUndefined(a)){return}return a.model}});namespace("JSEngine.Media");JSEngine.Media.BasePlayer=Backbone.Model.extend({initialize:function(a){this.options=a||{};helpers.assertParametersExistAndAddToObject(a,["el","page","applicationVariables","mediaContainerSelector","uriParameterName","mediaManager","type"],this);var c=this.type.split(".");this.el.addClass("ae-player-type-"+c[(c.length-1)]);helpers.addParametersToObjectIfExist(a,["posterParameterName","name","initIfapiPlayer","autoInstall","excludeSkinOn","onTogglePlayer","onTogglePlayerOnDelay","onTogglePlayerOffDelay","goFsOnPlay","closeHtmlFullScreenOnPa","closeFlashFullScreenOnPa","closeIosFullScreenOnPa","closeAndroidFullScreenOnPa","forceCleanup","androidHidePlayerOnPa","iosHidePlayerOnPa","autoSetSoundtrack","soundtrack","soundtrackParameterName"],this);this.mediaManager.addPlayer(this.type,this.name,this);this.mediaUri=a.mediaUri||("<%= urlParams."+this.uriParameterName+" %>");this.staticMediaUri=a.mediaUri;this.dynamicMediaUri="<%= urlParams."+this.uriParameterName+" %>";if(this.initIfapiPlayer){this.createPlayerOnce()}if(this.onTogglePlayer){this.el.on("togglePlayer",function(d,e){if(_.isUndefined(this.player)){return}if(e.onState===true){if(this.onTogglePlayerOnDelay){helpers.setTimeout(function(){this.player.show()}.createDelegate(this),this.onTogglePlayerOnDelay)}else{this.player.show()}}else{if(this.onTogglePlayerOffDelay){helpers.setTimeout(function(){this.player.show()}.createDelegate(this),this.onTogglePlayerOffDelay)}else{this.player.show()}}}.createDelegate(this))}var b=function(){if(_.isUndefined(this.player)){return}this.player.show()}.createDelegate(this);this.page.on("toggleButtonClose",b);this.childMediaUriParameterName=a.childMediaUriParameterName;this.childItemMediaUri=a.childItemMediaUri||((this.childMediaUriParameterName)?("<%= urlParams."+this.childMediaUriParameterName+" %>"):null);Backbone.Model.prototype.initialize.call(this,a);this.page.on("transitionAway urlParamChange",this.pageClose.createDelegate(this));this.page.on("afterActivate",function(){if(this.player){this.player.show()}}.createDelegate(this));if(this.page.isActive){this.pageActive()}else{this.page.on("activate",this.pageActive.createDelegate(this))}this.paOffEventId="paoff_"+(_.uniqueId());this.paOnEventId="paon_"+(_.uniqueId());JSEngine.EventHandler.subscribe("paoff",this.paOffEventId,this.paOffEvent.createDelegate(this));JSEngine.EventHandler.subscribe("paaudio",this.paOnEventId,this.paOnEvent.createDelegate(this));JSEngine.EventHandler.subscribe("pavideo",this.paOnEventId,this.paOnEvent.createDelegate(this));JSEngine.EventHandler.subscribe("pavideoa",this.paOnEventId,this.paOnEvent.createDelegate(this));JSEngine.EventHandler.subscribe("paother",this.paOnEventId,this.paOnEvent.createDelegate(this));this.on("stateChange",function(d){this.state=d}.createDelegate(this));if(window){window.onpopstate=function(d){if(this.player){if(this.player.getDisplayState()=="absolute"){this.player.cancelFullScreen()}if(this.player.isVOD()&&this.player.isiOSSDK()){this.page.pageManager.trigger("showQRibbon")}}}.createDelegate(this)}this.on("clearPlaylist",function(){this.stop();this.el.removeClass("ae-media-loaded");this.hide()}.createDelegate(this));this.resizeEventName=("onorientationchange" in window&&!navigator.userAgent.match(/android/i))?"orientationchange":"resize"},paOffEvent:function(){if(this.player){$j(window).off(this.resizeEventName,this.forceHidePlayer.createDelegate(this));if($j("body").hasClass("ie8")||((this.player.isAndroidSDK()&&this.androidHidePlayerOnPa)||(this.player.isiOSSDK()&&this.iosHidePlayerOnPa))){this.player.show();delete this.playerIsHidden}}delete this.lastState;if(this.player){if(this.wasInFullScreen){this.player.requestFullScreen("FullScreenType.ABSOLUTE");console.log("Player: Fullscreen re-instated");delete this.wasInFullScreen}helpers.setTimeout(function(){this.player.show()}.createDelegate(this),0);if(this.options.useSkin){var a=$j(this.mediaContainerSelector);a.avod("showTemplate","player_controls")}}},paOnEvent:function(){this.lastState=this.state;if(this.player){if(this.player.isAbsoluteFullScreen()){console.log("Player: In Fullscreen");if((this.options.closeHtmlFullScreenOnPa&&this.player.isHtml())||(this.options.closeFlashFullScreenOnPa&&this.player.isFlash())||(this.options.closeIosFullScreenOnPa&&this.player.isiOSSDK())||(this.options.closeAndroidFullScreenOnPa&&this.player.isAndroidSDK())){this.wasInFullScreen=this.player.cancelFullScreen();console.log("Player: Fullscreen cancelled")}}if(this.options.useSkin){if(this.page.isActive&&(this.player.isFlash()||this.player.isiOSSDK()||this.player.isAndroidSDK())&&(this.player.isVOD()||this.player.isTV())){var a=$j(this.mediaContainerSelector);a.avod("showTemplate","pa")}}$j(window).on(this.resizeEventName,this.forceHidePlayer.createDelegate(this));if($j("body").hasClass("ie8")){this.player.hide()}if((this.player.isAndroidSDK()&&this.androidHidePlayerOnPa)||(this.player.isiOSSDK()&&this.iosHidePlayerOnPa)){this.player.cancelFullScreen();this.player.hide();this.playerIsHidden=true}else{if(this.player.isiOSSDK()||this.player.isAndroidSDK()){this.player.show()}}}},forceHidePlayer:function(){if(this.playerIsHidden){this.player.hide()}},pageActive:function(){var c=this.getMediaUri();var b=this.getPosterUrl();var a=this.getChildItemMediaUri();if(!this.player){this.createPlayerOnce(function(){this._loadPlayer(c,a,b);this.currentMediaUri=c;this.currentChildItemMediaUri=a}.createDelegate(this))}else{if(c!==this.currentMediaUri||a!==this.currentChildItemMediaUri){this._loadPlayer(c,a,b);this.currentMediaUri=c;this.currentChildItemMediaUri=a}else{if(c===this.currentMediaUri){this.loadPlayer(c)}}}},createPlayerOnce:function(a){if(_.isUndefined(this.createPlayerCbs)){this.createPlayerCbs=[]}else{if(!_.isUndefined(a)){this.createPlayerCbs.push(a)}return}if(!_.isUndefined(a)){this.createPlayerCbs.push(a)}this.createPlayer(function(){if(!_.isUndefined(this.createPlayerCbs)){_.each(this.createPlayerCbs,function(b){b.call(this)}.createDelegate(this));this.createPlayerCbs=undefined}}.createDelegate(this))},createPlayer:function(a){this.el.addClass("ae-media-loading");JSEngine.IFAPIInitHelper.initialize("avod/v1",function(f){this.AVOD=f[0];var i=function(n){if(this.goFsOnPlay===true){if((this.player.isiOSSDK()||this.player.isAndroidSDK())&&this.player.isVOD()){this.player.requestFullScreen(true)}}this.player.removeEventListener(this.AVOD.Events.CAN_PLAY,i)};var j=function(p){if(!this.playerReady){this.player.removeEventListener(this.AVOD.Events.READY,j);this.playerReady=true;var o=_.invert(this.AVOD.Platform);var n=o[this.player.getPlatformType()];this.el.addClass("ae-player-"+n);this.trigger("playerReady",p)}this.setLastVolume()}.createDelegate(this);var l=function(n){this.trigger("playerError-"+n.code,n);helpers.getHtmlEl().addClass("ae-media-player-error-"+n.code);this.el.addClass("ae-media-player-error")}.createDelegate(this);var c=function(o){this.trigger("playerWarning-"+o.code,o);if(o.code==2001){if(this.options.allowPartialSupport||_.isUndefined(this.options.allowPartialSupport)){this.player.reloadWithPartialSupport();var n=function(p){this.el.addClass("ae-media-player-warning-2001");this.el.addClass("ae-media-player-warning")}.createDelegate(this);this.player.addEventListener(this.AVOD.Events.PLAYING,n);return}}this.el.addClass("ae-media-player-warning-"+o.code);this.el.addClass("ae-media-player-warning")}.createDelegate(this);var k=function(o){this.el.removeClass("ae-media-loading");this.el.addClass("ae-media-loaded");this.trigger("dataLoaded",this);this.loading=false;var n=helpers.getHtmlEl();n.removeClass("ae-media-player-loading");switch(this.getState()){case"stop":this.stop();break;case"pause":this.pause();break}this.removeErrorAndWarnClasses()}.createDelegate(this);var g=function(n){this.trigger("playerContinue");this.removeErrorAndWarnClasses()}.createDelegate(this);var m=false;var d=function(n){var o=_.clone(this.player.playlistGetInfo());this.trigger("stateChange","ended");this.togglePlayStateClasses("ended");if(this.player&&this.player.isVOD()){if(_.isUndefined(o)||m){helpers.windowHistoryGoBack(1)}}if(m){m=false;this.trigger("stateChange","playlistEnded");this.togglePlayStateClasses("playlist-ended")}}.createDelegate(this);var b=function(n){m=true}.createDelegate(this);this.onPlaylistIndexChange=function(n){var o=this.player.playlistGetCurrentItemIndex();var q=this.player.playlistGetInfo();if(!_.isUndefined(o)&&q&&(q.length>0)&&q[o]){this.currentChildItemMediaUri=q[o];var p={};p[this.uriParameterName]=this.currentMediaUri;if(this.childMediaUriParameterName){p[this.childMediaUriParameterName]=this.currentChildItemMediaUri}this.trigger("playlistIndexChanged",q[o])}else{console.warn("BasePlayer: onPlaylistIndexChange: unable to find the mediaUri that is playing")}}.createDelegate(this);this.onPlaylistChange=function(n){this.trigger("playlistChanged")}.createDelegate(this);this.player=this.createNewPlayer(this.AVOD);this.setAutoplay();this.player.addEventListener(this.AVOD.Events.READY,j);this.player.addEventListener(this.AVOD.Events.ERROR,l);this.player.addEventListener(this.AVOD.Events.WARNING,c);this.player.addEventListener(this.AVOD.Events.LOADED_DATA,k);this.player.addEventListener(this.AVOD.Events.PLAYING,g);this.player.addEventListener(this.AVOD.Events.PLAYLIST_INDEX_CHANGE,this.onPlaylistIndexChange);this.player.addEventListener(this.AVOD.Events.PLAYLIST_CHANGE,this.onPlaylistChange);this.player.addEventListener(this.AVOD.Events.PLAY,this.onPlayerPlay.createDelegate(this));this.player.addEventListener(this.AVOD.Events.STOP,this.onPlayerStop.createDelegate(this));this.player.addEventListener(this.AVOD.Events.PAUSE,this.onPlayerPause.createDelegate(this));this.player.addEventListener(this.AVOD.Events.ENDED,d);this.player.addEventListener(this.AVOD.Events.PLAYLIST_END,b);this.player.addEventListener(this.AVOD.Events.LOAD_START,this.onPlayerLoadStart.createDelegate(this));this.player.addEventListener(this.AVOD.Events.CAN_PLAY,i.createDelegate(this));this.player.addEventListener(this.AVOD.Events.SOUNDTRACK_CHANGED,this.onSoundtrackChanged.createDelegate(this));this.player.addEventListener(this.AVOD.Events.VOLUME_CHANGE,function(){this.storeCurrentVolume()}.createDelegate(this));if(!_.isUndefined(this.options.storageType)){var e=new JSEngine.WebStore([],{storageName:this.name,storageType:this.options.storageType});var h=function(){var n=this.player.playlistGetInfo();e.sync("update",n,this)}.createDelegate(this);e.sync("read",null,{success:function(n){this.addPlaylistMediaUris(n);this.player.addEventListener(this.AVOD.Events.PLAYLIST_CHANGE,h)}.createDelegate(this)});JSEngine.EventHandler.subscribe("flightEvents:flightChange","player_flightChange_"+_.uniqueId(),function(){this.clearPlaylist();h()}.createDelegate(this))}if(this.options.useSkin){this.skinPlayer(this.player,a)}else{if(a){a()}}}.createDelegate(this))},setAutoplay:function(){var a=false;var b=function(d){var g=this.player,c,e={all:true,android:g.isAndroidSDK(),ios:g.isiOSSDK(),flash:g.isFlash()};for(var f=d.length-1;f>=0;f--){c=d[f].toLowerCase();if(e.hasOwnProperty(c)&&e[c]){return true}}return false}.createDelegate(this);if(this.options.autoplayOn){a=b(this.options.autoplayOn)}else{if(this.options.autoplay){if(typeof(this.options.autoplay)==="string"){a=(this.options.autoplay==="true")?true:false}else{a=this.options.autoplay}}}if(a){this.posterUrl=this.options.posterUrl||""}else{this.posterUrl=this.options.posterUrl||"<%= urlParams."+this.posterParameterName+" %>"}this.autoplay=a},getRootPath:function(){var a=window.location.href;if(a.lastIndexOf("#")>0){a=a.substring(0,a.lastIndexOf("#"))}a=a.substring(0,a.lastIndexOf("/"));return a},changeUrlsToAbsoluteInSkinObject:function(b,a){var c=function(h,f){var e,g,j;if(_.isObject(h)&&!_.isFunction(h)){for(e in h){g=h[e];h[e]=c(g,e)}}else{if(_.isArray(h)){for(var d=0;d<h.length;d++){h[d]=c(h[d])}}else{if(_.isString(h)&&f&&f=="url"){h=h.replace(/^\//,"");h=h.replace(/\/$/,"");j=h.split("/");h=a;for(var d=0;d<j.length;d++){if(j[d]===".."){h=h.substring(0,h.lastIndexOf("/"))}else{if(j[d]!=="."){h=h+"/"+j[d]}}}}}}return h};c(b)},skinPlayer:function(e,a){var h=$j("meta[name='MediaPlayerControlPluginUri']");var g=h.length>0?h.attr("content"):"";var c,b;var d;if(this.options.skinPlayerControlsConfigSelector){if(this.el.find(this.options.skinPlayerControlsConfigSelector).length){d=helpers.getConfigFromFromElement(this.el.find(this.options.skinPlayerControlsConfigSelector))}else{if($j(this.options.skinPlayerControlsConfigSelector).length){d=helpers.getConfigFromFromElement($j(this.options.skinPlayerControlsConfigSelector))}}}if(!d){d=helpers.getConfigFromFromElement($j("#ae-media-skin-player-controls"))}this.changeUrlsToAbsoluteInSkinObject(d,this.getRootPath());var f={avodPlayer:e,mediaManager:this.mediaManager,controlSwf:g,defaultFlashConfig:d,skipSeekInSeconds:this.options.skipSeekInSeconds,onComplete:function(){var i=$j(this.mediaContainerSelector);if(d){i.avod("setTemplate","player_controls",null,d);i.avod("showTemplate","player_controls")}c=(this.options.skinPassengerAnnouncementConfigSelector?helpers.getConfigFromFromElement(this.el.find(this.options.skinPassengerAnnouncementConfigSelector)):helpers.getConfigFromFromElement("#ae-media-skin-passenger-announcement"))||undefined;if(c){i.avod("setTemplate","pa",null,c)}else{console.warn("BasePlayer: Unable to find 'pa' skinning components for required elements: #ae-media-skin-passenger-announcement")}c=helpers.getConfigFromFromElement("#ae-media-skin-end-of-media");b=(this.skinEndOfMediaSelector)?this.el.find(this.skinEndOfMediaSelector):null;if(c&&b&&b.length>0){i.avod("setTemplate","end_of_media",b,c)}else{console.warn("BasePlayer: Unable to find 'end_of_playlist' skinning components for required elements: #ae-media-skin-end-of-media",this.skinEndOfMediaSelector)}c=helpers.getConfigFromFromElement("#ae-media-skin-end-of-playlist");b=(this.skinEndOfPlaylistSelector)?this.el.find(this.skinEndOfPlaylistSelector):null;if(c&&b&&b.length>0){i.avod("setTemplate","end_of_playlist",b,c)}else{console.warn("BasePlayer: Unable to find 'end_of_playlist' skinning components for required elements: #ae-media-skin-end-of-playlist",this.skinEndOfPlaylistSelector)}}.createDelegate(this)};if(this.excludeSkinOn&&this.excludeSkinOn.config){f.excludedDevices=this.excludeSkinOn.config}if(a){f.onReady=a}$j(this.mediaContainerSelector).avod(f)},createNewPlayer:function(a){throw new Error("BasePlayer: createNewPlayer: Needs to be implemented")},removeErrorAndWarnClasses:function(){helpers.removeClassByPrefix(this.el,"ae-media-player-error");helpers.removeClassByPrefix(helpers.getHtmlEl(),"ae-media-player-error");helpers.removeClassByPrefix(this.el,"ae-media-player-warning");this.el.removeClass("ae-media-loading")},onPlayerStop:function(a){this.trigger("stateChange","stop");this.togglePlayStateClasses("stop");if(this.player&&this.player.isVOD()&&this.player.isiOSSDK()){this.page.pageManager.trigger("showQRibbon")}},onPlayerPlay:function(a){this.trigger("stateChange","play");this.togglePlayStateClasses("play")},onPlayerPause:function(a){this.trigger("stateChange","pause");this.togglePlayStateClasses("pause")},onSoundtrackChanged:function(){console.info("onSoundtrackChanged")},play:function(b,a){if(this.getState()!=="pause"||(this.getState()==="pause"&&a!==this.currentChildItemMediaUri)){this._loadPlayer(b||this.currentMediaUri,a)}this.player.play();this.onPlayerPlay()},_loadPlayer:function(c,a,b){if(c!==this.currentMediaUri){this.removeErrorAndWarnClasses();this.el.addClass("ae-media-loading");if(c===""){window.player=this.player;c=undefined}this.loadPlayer(c)}if(a&&this.player){this.player.playlistPlayItemByMediaURI(a)}},loadPlayer:function(c){try{if(_.isUndefined(c)){return}this.loading=true;var d=helpers.getHtmlEl();d.addClass("ae-media-player-loading");if(!this.autoplay||this.player.isHtml()){var h=function(){this.player.removeEventListener(this.AVOD.Events.READY,h);this.loading=false}.createDelegate(this);this.player.addEventListener(this.AVOD.Events.READY,h)}else{var b=function(){this.player.removeEventListener(this.AVOD.Events.LOADED_DATA,b);if(this.player.playlistGetCurrentItemIndex&&this.player.playlistGetCurrentItemIndex()!==0){this.player.playlistPlayItemByIndex(0)}this.loading=false}.createDelegate(this);this.player.addEventListener(this.AVOD.Events.LOADED_DATA,b)}var a={media_uri:c+"",autoplay:this.autoplay,poster_url:this.getPosterUrl(this.posterUrl)};if(this.player.isVOD()){a={media_uris:(c+"").split(","),autoplay:this.autoplay,poster_url:this.getPosterUrl(this.posterUrl)}}var f=function(e){this.player.load(e);if(this.el.is(":visible")||!this.onTogglePlayer){this.player.show()}}.createDelegate(this);if(this.player.isVOD()){if(this.autoSetSoundtrack&&!this.getSoundtrackCodeFromParams()){this.getMetadata(c,function(e,i){if(e){console.error(e)}else{if(i.hasOwnProperty("soundtrack")){a.soundtrack_code=this.getSoundtrackCode(i.soundtrack);if(!a.soundtrack_code){delete a.soundtrack_code}}}f(a)}.createDelegate(this))}else{if(this.getSoundtrackCodeFromParams()){a.soundtrack_code=this.getSoundtrackCodeFromParams()}f(a)}}else{f(a)}}catch(g){this.loading=false;var d=helpers.getHtmlEl();d.removeClass("ae-media-player-loading");console.error("Loading media failed");console.error(g)}},getMetadata:function(b,a){JSEngine.IFAPIInitHelper.initialize("metadata/v1",function(c){var d=c[0];d.mediaMetadata({media_uri:b},a)})},getSoundtrackCode:function(c){var b,d,a=JSEngine.LanguageHelper.getCode3FromLocale(this.applicationVariables.language);_.each(c,function(e){if(e.language_iso===a){b=e.language_code}if(e.language_iso==="eng"){d=e.language_code}});return b?b:d},pageClose:function(){if(!this.options.persistent){if(this.player){this.stop();this.hide()}}else{if(this.player){this.pause();this.hide()}}},stop:function(){if(this.getState()!=="stop"){try{this.player.stop();this.onPlayerStop()}catch(a){console.error("Stopping media failed");console.error(a)}}},setRepeatMode:function(b){if(b<0||b>2){throw new Error("BasePlayer: Invalid mode used for setting repeat mode.")}try{this.player.playlistSetRepeatMode(b)}catch(a){console.error("Setting repeat mode failed.");console.error(a)}},getRepeatMode:function(){try{return this.player.playlistGetRepeatMode()}catch(a){console.error("Getting repeat mode failed.");console.error(a)}},setShuffle:function(a){if(!_.isBoolean(a)){throw new Error("BasePlayer: Invalid option passed to setShuffle. Expects a boolean.")}try{this.player.playlistSetShuffle(a)}catch(b){console.error("Setting shuffle mode failed.");console.error(b)}},getShuffle:function(){try{return this.player.playlistGetShuffle()}catch(a){console.error("Getting shuffle mode failed.")}},hide:function(){try{this.player.hide()}catch(a){console.error("Hiding media failed");console.error(a)}},pause:function(){if(this.getState()!=="pause"){if(this.player===undefined){return}try{this.player.pause();this.onPlayerPause()}catch(a){console.error("Pausing media failed");console.error(a)}}},togglePlayStateClasses:function(b){var a=helpers.getHtmlEl();helpers.removeClassByPrefix(a,"ae-media-player-state-"+this.name);helpers.removeClassByPrefix(a,"ae-media-player-state-any");a.addClass("ae-media-player-state-any-"+b);a.addClass("ae-media-player-state-"+this.name+"-"+b);if(this.player&&this.player.isAOD()&&this.player.isiOSSDK()&&b===this.AVOD.Events.ENDED){this.player.show()}},getState:function(){return this.state||"stop"},getMediaUri:function(){var a="";if(this.dynamicMediaUri){try{a=_.template(this.dynamicMediaUri+"",this.applicationVariables)||""}catch(b){}}if(_.isEmpty(a)||_.isUndefined(a)||a=="undefined"){a=this.staticMediaUri}return a},getSoundtrackCodeFromParams:function(){var a="";if(this.soundtrackParameterName){try{a=_.template("<%= urlParams."+this.soundtrackParameterName+" %>",this.applicationVariables)||""}catch(b){}}return a||this.soundtrack||""},getPosterUrl:function(a){if(a){try{return _.template(a+"",this.applicationVariables)||""}catch(b){}}return""},getChildItemMediaUri:function(){if(this.childItemMediaUri){try{var b=_.template(this.childItemMediaUri+"",this.applicationVariables)||"";if(_.isEmpty(b)){return null}else{try{return parseInt(b,10)}catch(a){}return b+""}}catch(a){}}return null},isReady:function(){if(_.isUndefined(this.playerReady)){return false}return this.playerReady},getCurrentUri:function(){var a=this.player.playlistGetInfo();return a[this.player.playlistGetCurrentItemIndex()]},getPlaylistMediaUris:function(){if(_.isUndefined(this.player)){this.createPlayerOnce();return}return this.player.playlistGetInfo()},removePlaylistMediaUris:function(c,a){a=a||{};if(_.isUndefined(this.player)){this.createPlayerOnce();return}if(a.silent){this.player.removeEventListener("playlistchange",this.onPlaylistChange);this.player.removeEventListener("playlistindexchange",this.onPlaylistIndexChange)}var b=false;_.each(c,function(d){if(d===this.currentChildItemMediaUri||d===this.currentMediaUri){b=true}return this.player.playlistRemoveItemByMediaURI(d)}.createDelegate(this));if(b){this.pause();this.player.playlistPlayNext()}if(a.silent){this.player.addEventListener("playlistchange",this.onPlaylistChange);this.player.addEventListener("playlistindexchange",this.onPlaylistIndexChange)}},removePlaylistMediaIndex:function(a){if(this.player.playlistGetInfo()[0]===""){a++}return this.player.playlistRemoveItemByIndex(a)},addPlaylistMediaUris:function(d,a){a=a||{};var c=function(){this.player.playlistAddItemByMediaURI(d)}.createDelegate(this);if(_.isUndefined(this.player)){if(a.buffered){this.createPlayerOnce(c)}else{this.createPlayerOnce()}return}if(!this.loading||!this.playerReady){this.loading=true;var b=helpers.getHtmlEl();b.addClass("ae-media-player-loading");d=_.union(d,this.player.playlistGetInfo());if(!_.isEmpty(d)){this.player.load({media_uris:d,autoplay:this.autoplay,poster_url:this.getPosterUrl(this.posterUrl)})}return}c()},getPlaylistIndex:function(){if(_.isUndefined(this.player)){this.createPlayerOnce();return}var a=this.player.playlistGetCurrentItemIndex();if(a>0&&this.player.playlistGetInfo()[0]===""){a--}return a},insertPlaylistMediaUris:function(c,b){b=b||{};var a=b.at;if(this.player.playlistGetInfo().length>0&&this.player.playlistGetInfo()[0]===""){a++}this.player.playlistAddItemByMediaURI(c,a)},cleanUp:function(){if((this.mediaContainerSelector&&$j(this.mediaContainerSelector).length>0)||this.forceCleanup){if(this.player){this.player.remove();delete this.player}$j(this.container).remove();this.mediaManager.removePlayer(this.type,this.name,this)}},clearPlaylist:function(){if(_.isUndefined(this.player)||_.isEmpty(this.player.playlistGetInfo())){return}var c=_.clone(this.player.playlistGetInfo());for(var a=0;a<c.length;a++){var b=c[a];this.player.playlistRemoveItemByMediaURI(b)}},setPlaylistIndex:function(a){this.player.playlistPlayItemByIndex(a)},onPlayerLoadStart:function(){if(this.player&&this.player.isVOD()&&this.player.isiOSSDK()){this.page.pageManager.trigger("hideQRibbon")}},getLastKnownVolume:function(){return helpers.localStorage("volume")||1},storeCurrentVolume:function(){if(this.player&&this.player.isFlash()&&this.player.canSetVolume()){helpers.localStorage("volume",this.player.getVolume())}},setLastVolume:function(){if(this.player&&this.player.isFlash()&&this.player.canSetVolume()){this.player.setVolume(this.getLastKnownVolume())}}});namespace("JSEngine");JSEngine.CollectionView=Backbone.View.extend({initialize:function(a){a=a||{};helpers.assertParametersExistAndAddToObject(a,["container","template","models"],this);this.noDataTemplate=a.noDataTemplate;this.doPagination=a.doPagination;this.pagingCount=a.pagingCount;this.activeSliderPageIndex=a.activeSliderPageIndex||0;Backbone.View.prototype.initialize.call(this,a)},render:function(c){if(this.models.length==0){if(!_.isEmpty(this.noDataTemplate)){var a=_.template(this.noDataTemplate,c||{});this.container.append(a)}}else{var b=this.pagingCount,d=this.container;this.pageElements=[];_(this.models).each(function(f,e){var g=_.clone(c||{});g.data=f.attributes;if(g.data){g.data.collectionIndex=e}if(this.doPagination&&(b>=this.pagingCount)){d=$j("<div />");d.addClass("swiper-slide");this.container.append(d);b=0;this.pageElements.push(d)}else{if(!this.doPagination){this.renderItem(d,g)}}b++},this);if(this.doPagination){this.renderSlideChange(this.activeSliderPageIndex,c)}}},renderSlideChange:function(c,f){for(var b=0;b<this.pageElements.length;b++){if(this.pageElements[b].html()===""){var e=b*this.pagingCount;var d=(b*this.pagingCount)+this.pagingCount;var a=this.models.slice(e,d);_.each(a,function(g){var h=_.clone(f||{});h.data=g.attributes;this.renderItem(this.pageElements[b],h)},this)}}},renderItem:function(a,f){try{var b=_.template(this.template,f);b=helpers.parseNestedTemplates(b);var c=$j("<div/>").append(b);_.each(c.find(".transform"),function(e){var i=$j(e);var h=i.attr("data-format-type");var g=JSEngine.TextHelpers[h];if(g){g.parse(i)}},this);_.each(c.find("[data-also-show-for]"),function(e){var g=c.find("#"+$j(e).attr("data-also-show-for"));var h=$j(e).html();$j(g).html(h).show()},this);_.each(c.find(".databound"),function(e){$j(e).data("boundData",f)},this);a.append(c.contents())}catch(d){console.debug("Error transforming template: '"+this.template+"' with the data:");console.debug(f);console.debug(d)}}});namespace("JSEngine");JSEngine.NewCollectionView=Backbone.View.extend({initialize:function(a){this.render=_.bind(this.render,this);this.config=a||{};helpers.assertParametersExistAndAddToObject(this.config,["container","template","collection"],this);this.noDataTemplate=this.config.noDataTemplate;this.doPagination=this.config.doPagination;this.pagingCount=this.config.pagingCount||1;this.activeSliderPageIndex=this.config.activeSliderPageIndex||0;this.slideItems=[];Backbone.View.prototype.initialize.call(this,this.config);this.collection.on("add",this.render);this.collection.on("remove",this.render);this.collection.on("reset",this.render)},cleanUp:function(){this.clear();this.collection.off("add",this.render);this.collection.off("remove",this.render);this.collection.off("reset",this.render);this.off()},clear:function(){_.each(this.slideItems,function(a){_.each(a,function(b){b.cleanUp()})},this);this.slideItems=[];this.container.empty()},render:function(){this.clear();if(this.collection.models.length==0){if(!_.isEmpty(this.noDataTemplate)){var a=_.template(this.noDataTemplate,this.config.applicationVariables||{});this.container.html(a)}}else{var b=this.pagingCount;var d=-1;var c;_.each(this.collection.models,function(f){if(b>=this.pagingCount){d++;this.slideItems[d]=[];c=$j("<div />");c.addClass("swiper-slide");c.addClass(this.config.slideClasses||"");this.container.append(c);b=0}var e=new JSEngine.ModelView({model:f,container:$j("<div />").addClass(this.config.itemClasses||""),template:this.template,applicationVariables:this.config.applicationVariables,page:this.config.page,feedManager:this.config.feedManager,mediaManager:this.config.mediaManager,messageManager:this.config.messageManager});c.append(e.container);this.slideItems[d].push(e);if(!this.doPagination){e.render()}b++},this);if(this.doPagination){this.renderSlideChange(this.activeSliderPageIndex)}this.trigger("change",this)}},renderSlideChange:function(b){for(var a=0;a<this.slideItems.length;a++){if(b==a||(b==a-1)||(b==a+1)){_.each(this.slideItems[a],function(c){if(_.isEmpty(c.container.html())){c.render()}})}else{_.each(this.slideItems[a],function(c){c.clear()})}}}});namespace("JSEngine");JSEngine.ModelView=Backbone.View.extend({initialize:function(a){this.render=_.bind(this.render,this);a=a||{};helpers.assertParametersExistAndAddToObject(a,["container","template","model","applicationVariables","page","feedManager","mediaManager","messageManager"],this);Backbone.View.prototype.initialize.call(this,a);this.model.on("change",this.render)},cleanUp:function(){this.clear();this.model.off("change",this.render)},clear:function(){if(this.childElementWrapper){this.childElementWrapper.cleanUp()}this.container.empty()},render:function(){this.clear();var d=_.clone(this.applicationVariables);d.data=this.model.attributes;try{var a=_.template(this.template,d);a=helpers.parseNestedTemplates(a);var b=$j("<div/>").append(a);_.each(b.find(".transform"),function(e){var h=$j(e);var g=h.attr("data-format-type");var f=JSEngine.TextHelpers[g];if(f){f.parse(h)}},this);_.each(b.find("[data-also-show-for]"),function(e){var f=b.find("#"+$j(e).attr("data-also-show-for"));var g=$j(e).html();$j(f).html(g).show()},this);_.each(b.find(".databound"),function(e){$j(e).data("boundData",d)},this);this.container.html(b.contents());this.childElementWrapper=new JSEngine.ElementWrapper({el:this.container,applicationVariables:this.applicationVariables,page:this.page,feedManager:this.feedManager,mediaManager:this.mediaManager,messageManager:this.messageManager})}catch(c){console.log("ModelView: Error transforming template: '"+this.template+"' with the data:");console.log(d);console.log("ModelView: element",this.container)}}});namespace("JSEngine");JSEngine.DragAndDropView=Backbone.View.extend({initialize:function(a){a=a||{};helpers.assertParametersExistAndAddToObject(a,["container","template","models","dragAndDropManager"],this);helpers.addParametersToObjectIfExist(a,["noDataTemplate"],this);Backbone.View.prototype.initialize.call(this,a)},renderedItems:[],render:function(d,b){if(b!=undefined){this.models=b}if(this.models.length==0){this.container.empty();if(!_.isEmpty(this.noDataTemplate)){var l=_.template(this.noDataTemplate,d||{});this.container.append('<div class="ae-no-data-template">'+l+"</div>")}}else{var f;this.container.find(".ae-no-data-template").remove();for(f=0;f<this.models.length;f++){if(!this.models[f].hasBeenFetched){continue}var g=this.models[f];var m=$j(this.container.children().get(f));var c=undefined;if(f<this.renderedItems.length){c=this.renderedItems[f];if(_.isEqual(g.attributes,c.model.attributes)){this.renderedItems[f].model=g}}var h;var a=this.container;if(m.length!=0&&!_.isUndefined(c)&&_.isEqual(g.attributes,c.model.attributes)){continue}else{if(m.length!=0&&(h=this.findEl(f,g))){m.before(h);this.renderedItems.splice(f,0,{$el:h,model:this.models[f]})}else{var k=_.clone(d)||{};k.data=g.attributes;k.index=f;h=this.renderItem(undefined,k,this.models[f]);if(!_.isUndefined(this.models[f].setEl)&&_.isFunction(this.models[f].setEl)){this.models[f].setEl(h)}if(m.length!=0){m.before(h)}else{this.container.append(h)}this.renderedItems.splice(f,0,{$el:h,model:this.models[f]})}}h.find("[data-media-index]").attr("data-media-index",f)}this.renderedItems.splice(f,this.renderedItems.length-f);for(var e=f;e<this.container.children().length;e++){$j(this.container.children().get(e)).remove()}}},findEl:function(b,a){for(var c=(b+1);c<this.renderedItems.length;c++){if(_.isEqual(a.attributes,this.renderedItems[c].model.attributes)){return this.renderedItems[c].$el}}return undefined},renderItem:function(a,d,b){var c=$j("<div/>").append(_.template(this.template,d));_.each(c.find(".transform"),function(e){var h=$j(e);var g=h.attr("data-format-type");var f=JSEngine.TextHelpers[g];if(f){f.parse(h)}},this);_.each(c.find("[data-also-show-for]"),function(e){var f=c.find("#"+$j(e).attr("data-also-show-for"));var g=$j(e).html();$j(f).html(g).show()},this);_.each(c.find(".databound"),function(e){$j(e).data("boundData",d)},this);if(c.children().length!=1){throw new Error("children have to be 1")}if(!c.children().attr("id")){c.children().attr("id",_.uniqueId("dd_"))}if(!_.isUndefined(a)){this.dragAndDropManager.addDragItem(c.children(),b);this.dragAndDropManager.addDropItem(c.children(),b);a.append(c.children())}else{return c.children()}}});namespace("JSEngine");JSEngine.PlaylistView=Backbone.View.extend({initialize:function(a){a=a||{};helpers.assertParametersExistAndAddToObject(a,["container","template","models","playlist","type"],this);this.noDataTemplate=a.noDataTemplate;Backbone.View.prototype.initialize.call(this,a)},render:function(b){if(this.models.length==0){if(!_.isEmpty(this.noDataTemplate)){var a=_.template(this.noDataTemplate,b||{});this.container.append(a)}}else{_(this.models).each(function(e){var d=_.clone(b||{});d.data=e.attributes;var c=1;_(d.data).each(function(j,g){var i=_.clone(b||{});i.data=j;i.data.templateRowIndex=c;try{var f=$j(_.template(this.template,i));f[0].onclick=function(l){l.preventDefault();if(!this.playlist.player||!this.playlist.player.player.player){var k=$j("div.pseudo-page:visible").find("a.media-player");k.attr("data-track-uri",i.data.media_uri);k.trigger("click");this.playlist.player=this.playlist.childElementWrapper.mediaManager.getCurrentPlayer(this.type)}else{if(this.type=="video"){var k=$j("div.pseudo-page:visible").find("a.media-player");k.attr("data-track-uri",i.data.media_uri);k.trigger("click")}else{this.playlist.player.player.playlistPlayItemByIndex((i.data.templateRowIndex-1))}}}.createDelegate(this);_.each(f.find(".transform"),function(k){var n=$j(k);var m=n.attr("data-format-type");var l=JSEngine.TextHelpers[m];if(l){l.parse(n)}},this);$j(this.container).append(f)}catch(h){console.debug("Error transforming template: '"+this.template+"' with the data:");console.debug(i.data)}c++},this)},this)}}});namespace("JSEngine");JSEngine.ViewHelper={renderItem:function(a,c,f){try{var b=$j("<div>"+helpers.parseNestedTemplates(c(f))+"</div>");_.each(b.find(".transform"),function(e){var i=$j(e);var h=i.attr("data-format-type");var g=JSEngine.TextHelpers[h];if(g){g.parse(i)}},this);_.each(b.find("[data-also-show-for]"),function(e){var g=b.find("#"+$j(e).attr("data-also-show-for"));var h=$j(e).html();$j(g).html(h).show()},this);_.each(b.find(".databound"),function(e){$j(e).data("boundData",f)},this);a.html(b.html())}catch(d){console.debug("Error transforming template: '"+c+"' with the data:");console.debug(f);console.debug(d)}},renderString:function(a,b){b=(!b)?{}:b;if(a&&!_.isEmpty(a)){if(String(a).indexOf("<%")!==-1){a=_.template(a+"",b)}}return a}};namespace("JSEngine");JSEngine.UberAccordionView=Backbone.View.extend({title:"uberAccordionView",initialize:function(a){a=a||{};helpers.assertParametersExistAndAddToObject(a,["container","headerTemplate","itemTemplate"],this);this.noDataTemplate=a.noDataTemplate;this.itemTemplate=a.itemTemplate;this.page=a.page;this.feedManager=a.feedManager;this.mediaManager=a.mediaManager;this.messageManager=a.messageManager;this.applicationVariables=a.applicationVariables;Backbone.View.prototype.initialize.call(this,a)},render:function(d,e){this.models=e;if(this.models.length==0){if(!_.isEmpty(this.noDataTemplate)){var b=_.template(this.noDataTemplate,d||{});this.container.append(b)}}else{if(!_.isEmpty(this.itemTemplate)){var a=$j("<ul/>");this.cleanUp();this.container.append(a);this.pageElements=[];var c=0;_(this.models).each(function(f){var g=_.clone(d||{});g.data=f.attributes;g.itemNo=c;this.renderItem(a,g);c++},this);this.createChildElementWrapper(this.container)}}},cleanUp:function(){if(this.childElementWrapper){this.childElementWrapper.cleanUp();delete this.childElementWrapper}this.container.empty()},renderItem:function(b,i){try{var d=$j("<h1/>").append(_.template(this.headerTemplate,i));var a=$j("<li/>");a.append(d);var f="";if($j(this.itemTemplate).hasClass("widget")||$j(this.itemTemplate).hasClass("ae-comp")){var c=helpers.parseNestedTemplates(_.template(this.itemTemplate,i));a.append($j(c))}else{f=$j("<div/>").append(_.template(this.itemTemplate,i));a.append(f)}_.each(a.find(".transform"),function(e){var k=$j(e);var j=k.attr("data-format-type");var h=JSEngine.TextHelpers[j];if(h){h.parse(k)}},this);b.append(a)}catch(g){console.debug("Error transforming itemTemplate: '"+this.itemTemplate+"' with the data:");console.debug(i)}},createChildElementWrapper:function(a){this.childElementWrapper=new JSEngine.ElementWrapper({el:a,applicationVariables:this.applicationVariables,page:this.page,feedManager:this.feedManager,mediaManager:this.mediaManager,messageManager:this.messageManager})}});namespace("JSEngine");JSEngine.GrowableView=Backbone.View.extend({modelViews:[],currentDisplayCount:0,initialize:function(a){this.options=a||{};helpers.assertParametersExistAndAddToObject(this.options,["container","template","models","growCount","startCount"],this);helpers.addParametersToObjectIfExist(this.options,["noDataTemplate","growHideClass"],this);this.growHideClass=this.growHideClass||"ae-hide";Backbone.View.prototype.initialize.call(this,this.options)},cleanUp:function(){this.off();this.clear()},clear:function(){_.each(this.modelViews,function(a){a.cleanUp()});this.modelViews=[];this.container.empty()},render:function(a){this.clear();this.currentDisplayCount=0;if(this.models.length===0){if(!_.isEmpty(this.noDataTemplate)){var b=_.template(this.noDataTemplate,a||{});this.container.append(b)}this.trigger("change",this);return}_.each(this.models,function(d,e){var c=new JSEngine.ModelView({model:d,container:$j("<div />").appendTo(this.container).addClass(this.options.itemClasses||"").addClass(this.growHideClass),template:this.template,applicationVariables:this.options.applicationVariables,page:this.options.page,feedManager:this.options.feedManager,mediaManager:this.options.mediaManager,messageManager:this.options.messageManager});c.render();this.modelViews.push(c)},this);this.grow(this.startCount)},canGrow:function(){return this.currentDisplayCount<this.modelViews.length},grow:function(c){var a=this.currentDisplayCount;for(var b=a;b<(a+c);b++){this.currentDisplayCount++;if(b<this.modelViews.length){this.modelViews[b].container.removeClass(this.growHideClass)}else{break}}this.trigger("change",this);return this}});namespace("JSEngine");JSEngine.PageLock=Backbone.Model.extend({initialize:function(a){a=a||{};helpers.assertParametersExistAndAddToObject(a,["name","isLocked","el"],this);this.displayLockTimeoutSeconds=a.displayLockTimeoutSeconds||5},lock:function(){this.isLocked=true},startUnlockTimeout:function(a){if(this.unlockTimeoutTimer){window.clearTimeout(this.unlockTimeoutTimer)}this.unlockTimeoutTimer=helpers.setTimeout(function(){window.clearTimeout(this.unlockTimeoutTimer);this.el.removeClass("unlock-status-locked unlock-status-unlocking").addClass("unlock-status-unlocked");helpers.windowHistoryGoBack(1);if(a){a(false)}}.createDelegate(this),this.displayLockTimeoutSeconds)},showLock:function(d,a){var c=this;(function b(g){var k=parseInt(g.attr("data-unlock-duration"))*1000;var j=g.find($j(".unlock-link"));var i=g.find($j(".unlock-modal"));var f=g.find($j(".unlock-mask"));var h=null;g.removeClass("unlock-status-unlocked").addClass("unlock-status-locked");c.startUnlockTimeout(a);j.unbind("mousedown touchstart").bind("mousedown touchstart",function(){$j(this).addClass("active");h=window.setTimeout(function(){l()},k);c.startUnlockTimeout(a);return false}).unbind("mouseup touchend").bind("mouseup touchend",function(){$j(this).removeClass("active");clearTimeout(h);return false}).bind("mouseleave",function(){$j(this).removeClass("active");c.startUnlockTimeout(a);clearTimeout(h)});function e(){g.addClass("unlock-status-unlocking")}function l(){window.clearTimeout(c.unlockTimeoutTimer);g.removeClass("unlock-status-locked unlock-status-unlocking").addClass("unlock-status-unlocked");c.isLocked=false;if(a){a(true)}}})(this.el)}});namespace("JSEngine");JSEngine.PageLockRedirect=Backbone.Model.extend({initialize:function(a){a=a||{};helpers.assertParametersExistAndAddToObject(a,["name","isLocked","$page"],this)},lock:function(){this.isLocked=true},unlock:function(){this.isLocked=false},showLock:function(){helpers.navigateToPage(this.$page.attr("id"),{toUrl:Backbone.history.getFragment()})}});namespace("JSEngine");JSEngine.TabHandler=Backbone.Model.extend({initialize:function(){this.wapplets=[];this.init()},init:function(){$j("ul.tabs").each(function(a,b){var c={};c.id=$j(b).attr("data-tab-wapplet-id");$j(b).find("li").each(function(d,e){$j(e).find("a").click(function(f){f.preventDefault();this.toggle($j(f.target))}.createDelegate(this))}.createDelegate(this));this.wapplets.push(c);$j(b).find("li:first a").each(function(d,e){$j(e).click()})}.createDelegate(this))},findWapplet:function(a){var c=undefined;for(var b=0;b<this.wapplets.length;b++){if(this.wapplets[b].id==a){c=this.wapplets[b]}}return c},toggle:function(c){var b=c.parent().attr("data-tab-content-id");var a=c.parent().attr("data-tab-wappplet-id");var d=this.findWapplet(a);c.parent().removeClass("active").removeClass("inactive");c.parent().addClass("active");c.removeClass("active").removeClass("inactive");c.addClass("active");$j("ul.tabs li").each(function(e,f){if($j(f).attr("data-tab-wappplet-id")==a&&$j(f).attr("id")!=c.parent().attr("id")){$j(f).removeClass("active").removeClass("inactive");$j(f).addClass("inactive");$j(f).find("a").removeClass("active").removeClass("inactive");$j(f).find("a").addClass("inactive")}});$j("#"+b).show();$j("div[id^=tab-content-]").each(function(f,e){if($j(e).attr("data-tab-wappplet-id")==a&&$j(e).attr("id")!=b){$j(e).hide()}})}});namespace("JSEngine");JSEngine.ElementWrapper=Backbone.Model.extend({initialize:function(a){a=a||{};helpers.assertParametersExistAndAddToObject(a,["page","feedManager","el","applicationVariables","mediaManager","messageManager"],this);this.filters={};this.pagers={};this.collectionContainers={};this.collectionContainerLinks=[];this.collectionContainerBarriers=[];this.components=[];this.createOrRemoveListeners("on");this.initMediaPlayerLinks(this.el);this.initMediaPlayers(this.el);this.initComponents();this.initWidgets();this.initStaticLinks()},cleanUp:function(){this.createOrRemoveListeners("off");this.off("all");var a=this.widgets.concat(this.components).concat(this.collectionContainers);_.each(a,function(b){if(_.isFunction(b.cleanUp)){b.cleanUp()}})},createOrRemoveListeners:function(a){this.page[a]("activate",this.onPageActivate,this);this.page[a]("beforeActivate",this.onPageBeforeActivate,this)},onPageActivate:function(){var a=_.toArray(arguments);a.unshift("activate");this.trigger.apply(this,a)},onPageBeforeActivate:function(){var a=_.toArray(arguments);a.unshift("beforeActivate");this.trigger.apply(this,a)},initWidgets:function(){this.widgets=[];_.each(this.el.find(".widget"),function(f,e){var d,c,b,g,a;d=$j(f);c=d.data("type");var h=helpers.createComponentElementParameters(d,this.page,this.feedManager,this.mediaManager,this.messageManager,this.applicationVariables);if(!_.isUndefined(JSEngine.Widgets[c])){g=new JSEngine.Widgets[c](h);this.widgets.push(g)}},this);this.trigger("initWidgetsComplete")},initStaticLinks:function(){var a=this.applicationVariables;_.each(this.el.find("a.ae-template"),function(b){var d=$j(b);var c=d.attr("href");d.on("click touchend",function(g){if(!g.isDefaultPrevented()&&!_.isUndefined(c)){g.preventDefault();var f=_.template(c,a);helpers.changeDocumentLocation(f)}})})},initComponents:function(){_.each(this.el.find(".ae-comp"),function(b,c){var a=$j(b);if(a.data("type")==="status"){a.data("type","JSEngine.Status")}else{if(a.data("type")==="captchaUrl"){a.data("type","JSEngine.CaptchaURL")}else{if(a.data("type")==="wispUrl"){a.data("type","JSEngine.WispURL")}else{if(a.data("type")==="captcha"){a.data("type","JSEngine.Captcha")}else{if(a.data("type")==="global-status"){a.data("type","JSEngine.GlobalStatus")}}}}}if(a.data("initDelay")){helpers.setTimeout(function(){this.initGenericComponent(a)}.createDelegate(this),a.data("initDelay"))}else{this.initGenericComponent(a)}}.createDelegate(this));this.page.trigger("initComponentsComplete")},initGenericComponent:function(comp){if(comp.data("loaded")===true){return}if(comp.data("type")){var types=jsonPath(window,comp.data("type"));if(types&&types.length>0){var type=types[0];var params=helpers.createComponentElementParameters(comp,this.page,this.feedManager,this.mediaManager,this.messageManager,this.applicationVariables);try{var component=new type(params);if(comp.data("with")){_.each(comp.data("with"),function(item,name){_.extend(component,eval("window."+name));if(!_.isUndefined(component.initialize)){component.initialize.apply(component,item.initParams)}})}this.components.push(component);if(!_.isUndefined(comp.data("name"))){this.page.pageManager.getComponentEvents().trigger("compInit:"+comp.data("name"),{comp:component})}comp.data("loaded",true)}catch(e){console.error("initGenericComponent: Error creating component of type: "+comp.data("type"));console.error(comp);console.error(e)}return}}},convertCollectionContainersToDynamicContainers:function(){$j(".collection-container").addClass("ae-comp");var a=$j(".collection-container:not([data-type])");a.data("type","JSEngine.DynamicContainer")},__oldCreateCollectionContainers:function(){_.each(this.el.find(".collection-container"),function(n){var a=$j(n);var c=a.attr("id");var k=helpers.getTemplateMarkup(a.attr("data-template"));var m=helpers.getTemplateMarkup(a.attr("data-loading-template"));var g=helpers.getTemplateMarkup(a.attr("data-no-data-template"));var l=jQuery.parseJSON(a.attr("data-filter-mixed"));var f=this.feedManager.getDataCollection(a,this.applicationVariables,this.page);var d;var b;var j;if(a.attr("data-pager")){var e=a.attr("data-pager");d=this.getNewOrExistingPager(e,this.el);j=parseInt(a.attr("data-paging-count"),10)}if(a.attr("data-filter")){var i=a.attr("data-filter");b=this.getNewOrExistingFilter(i)}var h=new JSEngine.CollectionContainer({id:c,container:a,feedManager:this.feedManager,template:k,loadingTemplate:m,noDataTemplate:g,collection:f,elementWrapper:this,pager:d,pagingCount:j,filter:b,mixedFilter:l});if(h.pager){_.each(this.el.find('.navigation-link[data-collection-container="'+c+'"]'),function(q){var p=$j(q);var o=new JSEngine.CollectionContainerNavigationLink({pageName:this.page.name,collectionContainer:h,link:p,applicationVariables:this.applicationVariables});this.collectionContainerLinks.push(o)},this);_.each(this.el.find('.navigation-barrier[data-collection-container="'+c+'"]'),function(p){var o=$j(p);var q=new JSEngine.CollectionContainerBarrier({collectionContainer:h,el:o});this.collectionContainerBarriers.push(q)},this)}this.collectionContainers[c]=h},this)},getNewOrExistingPager:function(a){if(_.isUndefined(this.pagers[a])){this.pagers[a]=new JSEngine.Pager({id:a,urlParams:this.applicationVariables.urlParams});this.on("beforeActivate",this.pagers[a].onPageChange,this.pagers[a])}return this.pagers[a]},getNewOrExistingFilter:function(a){if(_.isUndefined(this.filters[a])){this.filters[a]=new JSEngine.Filter({filter:a,urlParams:this.applicationVariables.urlParams});this.on("beforeActivate",this.filters[a].onPageChange,this.filters[a])}return this.filters[a]},initMediaPlayerLinks:function(a){_.each($j(a).find("a[rel=no-default]"),function(c){var e=$j(c);e.css("visibility","hidden");if(!_.isUndefined(e.attr("data-uri"))){var b={playerType:e.attr("data-type"),autoPlay:e.attr("data-autoplay"),playerW:e.attr("data-playerW"),playerH:e.attr("data-playerH"),mediaUri:e.attr("data-uri"),posterUrl:e.attr("data-poster"),sClass:e.attr("data-sClass"),hClass:e.attr("data-hClass"),persist:((_.isUndefined(e.attr("data-media-is-persistent")))?null:e.attr("data-media-is-persistent")),videoJSImgPath:e.attr("data-videojs-image-path"),aodSkinEl:((_.isUndefined(e.attr("data-skinEl")))?null:e.attr("data-skinEl")),applicationVariables:this.applicationVariables,skinContainerEl:((_.isUndefined(e.attr("data-skinEl-container")))?null:e.attr("data-skinEl-container")),playerNum:1,playerSequenceNumber:0,messageManager:this.messageManager,useSkin:((_.isUndefined(e.attr("data-use-skin"))||e.attr("data-use-skin")=="false")?false:true),mediaManager:this.mediaManager,playerContainer:e.attr("data-player-container")};b.cb=function(){}.createDelegate(this);var d=function(g){if(g){if(g.returnValue){g.returnValue=false}else{g.preventDefault()}}if(b.playerType!="audio"&&b.playerType!="radio"){if(g){if($j(g.target).attr("data-track-uri")!=undefined&&$j(g.target).attr("data-track-uri")!=null){b.mediaUri=$j(g.target).attr("data-track-uri")}}this.mediaManager.createMediaPlayer(b)}else{var f=this.mediaManager.players[b.playerType];if(f){if(b.playerType=="audio"){f.player.play()}else{f.player.playlistPlayItemByIndex(0)}}else{this.mediaManager.createMediaPlayer(b)}}e.css("visibility","visible")}.createDelegate(this);e.attr("data-link-processed","true");if(!_.isUndefined(e.attr("data-link-processed"))){e[0].onclick=d}}if(e.attr("data-type")!="audio"&&e.attr("data-type")!="radio"){e.css("visibility","visible")}},this)},initMediaPlayers:function(b){var a=function(){var c=0;_.each($j(b).find(".media-player"),function(f){var e=$j(f);if(!_.isUndefined(e.attr("data-uri"))){var d={playerType:e.attr("data-type"),autoPlay:((_.isUndefined(e.attr("data-autoplay"))||e.attr("data-autoplay")=="false")?false:true),playerW:e.attr("data-playerW"),playerH:e.attr("data-playerH"),mediaUri:e.attr("data-uri"),posterUrl:((_.isUndefined(e.attr("data-poster")))?null:e.attr("data-poster")),sClass:e.attr("data-sClass"),hClass:e.attr("data-hClass"),persist:((_.isUndefined(e.attr("data-media-is-persistent")))?null:e.attr("data-media-is-persistent")),videoJSImgPath:((_.isUndefined(e.attr("data-videojs-image-path")))?null:e.attr("data-videojs-image-path")),applicationVariables:this.applicationVariables,aodSkinEl:((_.isUndefined(e.attr("data-skinEl")))?null:e.attr("data-skinEl")),skinContainerEl:((_.isUndefined(e.attr("data-skinEl-container")))?null:e.attr("data-skinEl-container")),playerNum:$j(b).find("div.media-player").length,playerSequenceNumber:c,messageManager:this.messageManager,useSkin:((_.isUndefined(e.attr("data-use-skin"))||e.attr("data-use-skin")=="false")?false:true),mediaManager:this.mediaManager,playerContainer:e.attr("data-player-container")};helpers.setTimeout(function(){this.mediaManager.createMediaPlayer(d)}.createDelegate(this),10000);c++}},this)}.createDelegate(this);this.mediaManager.initService({},a)}});namespace("JSEngine");JSEngine.TextHelpers={dateTimeFormat:{trimLeadingZero:function(a){return a.replace(/^([0:]*)(.*)([0-9]:[0-9]{1,2}$)/,"$2$3")},parse:function(d,h){var f=JSEngine.DataAttributeHelper;var b=d.attr("data-input-format");var c=f.get(d,"output-format");var a=d.attr("data-output-locale");var e;var g;h=h||{};if(_.isObject(c)){_.extend(h,c.params||{});c=c.val}e=moment($j.trim(d.html()),b);if(e&&c){if(a){e.lang(a)}g=e.format(c);if(_.isObject(h)){if(h.cut==="1"||h.cut==="true"||h.cut===true||h.cut===1){g=this.trimLeadingZero(g)}}d.html(g)}else{console.warn("Unable to parse datetime '"+$j.trim(d.html())+"' as format '"+b+"'")}}},textTrucationFormat:{parse:function(d){var e=d.data("truncateFrom");var b="";var a=d.data("toLastCharacter");var f=d.html();if(f.length>e){f=f.substr(0,e);b=d.data("ellipsis")||""}if(a){var c=f.lastIndexOf(a);if(c>0){f=f.substr(0,c)}}d.html(f+b)}},unitsToDateFormat:{parse:function(c){try{var a=c.attr("data-input-format");var b=c.attr("data-output-format");if(a!="ss"&&a!="mm"){console.warn("Invalid input format");return}var d=moment.utc(0,0,0,0,0,0);switch(a){case"ss":d.seconds($j.trim(c.html())*1);break;case"mm":d.minutes($j.trim(c.html())*1);break}c.html(d.format(b))}catch(f){console.warn("Unable to parse datetime 's' as format '"+a+"'")}}},dateToUnitsFormat:{parse:function(d){try{var a=d.attr("data-input-format");var c=d.attr("data-output-format").toLowerCase();var b=["ss","mm","hh"];if(!_.contains(b,c)){console.warn("Invalid out format");return}var f=moment($j.trim(d.html()),a);switch(c){case"ss":d.html(moment.duration(f).asSeconds());break;case"mm":d.html(moment.duration(f).asMinutes());break;case"hh":d.html(f.hours());break}}catch(g){console.warn("Unable to parse datetime 's' as format '"+a+"'")}}},roundNumber:{parse:function(e){var h,d,g,b,c,f;d=parseFloat(e.html());if(!isNaN(d)){decimalPlaces=e.data("decimalPlaces")||0;g=e.data("removeTrailingZeros")||false;b=d.toFixed(decimalPlaces);if(g){c=/(0)$/;f=/(\.)$/;atPoint=false;b=(function a(i){if(i.match(c)){return a(i.replace(c,""))}else{if(i.match(f)){i.replace(f,"")}}return i}(b))}return e.html(b)}else{console.warn("Unable to parse element contents to specified decimal place as it is Not A Number :: "+e.get(0))}}},firstLetterOfWordToUppercase:{parse:function(a){var b=a.html();if(!(a&&b)){return}b=b.toLowerCase().replace(/\w\S*/g,function(c){return c.charAt(0).toUpperCase()+c.substr(1)});return a.html(b)}},mphToKmph:{parse:function(a){var b=a.html()*1;b=Math.round(b*1.60934);return a.html(b)}},feetToMeters:{parse:function(a){var b=a.html()*1;b=Math.round(b*0.3048);return a.html(b)}},unitsToUnits:{prase:function(a){var d=a.attr("data-input-units");var b=a.attr("data-output-units");var c=a.html()*1;switch(d){case"kmph":break;case"mph":c=c*1.60934;break;case"nmph":c=c*1.852;break;case"feet":c=c*0.3048;break;case"meters":break;case"km":c=c*1000;break;case"nm":c=c*1852;break;case"miles":c=c*1609.344;break;case"F":c=((c-32)*(5/9));break;case"C":break;default:throw"Unrecognized units in"}switch(b){case"kmph":break;case"mph":c=c/1.60934;break;case"nmph":c=c/1.852;break;case"feet":c=c/0.3048;break;case"meters":break;case"km":c=c/1000;break;case"nm":c=c/1852;break;case"miles":c=c/1609.344;break;case"F":c=(c*(9/5))+32;break;case"C":break;default:throw"Unrecognized units out"}c=Math.round(c);return a.html(c)}}};namespace("JSEngine");JSEngine.Validators={required:function(b,a){var d=b.val();var c=b.attr("type");if(c=="checkbox"){a(b.is(":checked"))}else{if(!_.isEmpty(d)||d==true){a(true)}else{a(false)}}}};namespace("JSEngine");JSEngine.CaptchaHelper={checkCAPTCHARequirement:function(b,a){JSEngine.IFAPIInitHelper.initialize("exconnect/v1",function(c){var d=c[0];console.log(d);d.checkCAPTCHARequirement(b,function(e,f){if(!e){a(null,f)}else{a(e,f)}})})},enableDeviceForWhitelist:function(a){JSEngine.IFAPIInitHelper.initialize("exconnect/v1",function(b){var c=b[0];c.enableDeviceForWhitelist(function(d){if(!d){a(null)}else{a(d)}})})},doCheckAndNavigate:function(b,c,d){d=d||window;var a=function(f,e){if(!f){if(e){helpers.navigateToPage(c,{returnUrl:b},d)}else{helpers.changeDocumentLocation(b,d)}}else{console.error("CaptchaURL: "+JSON.stringify(f))}};JSEngine.CaptchaHelper.checkCAPTCHARequirement(b,a)},goToReturnUrl:function(b){if(b&&b.post){var a=$j("<form></form>");a.attr("method","post");a.attr("action",b.returnUrl);a=_.reduce(b.post,function(d,e,f){var c=$j("<input/>");c.attr("type","hidden");c.attr("name",f);c.attr("value",e);d.append(c);return d}.createDelegate(this),a);$j(document.body).append(a);a.submit()}else{if(b.returnUrl){helpers.changeDocumentLocation(b.returnUrl)}}}};namespace("JSEngine");JSEngine.AirportInfoHelper={icaoCodeLookups:{},icaoCodeLookupCallbacks:{},cityNameByICAO:function(b,a){b.icao_code=(b.icao_code+"").toLowerCase();b.lang=(b.lang+"").toLowerCase();if(this.icaoCodeLookups[b.icao_code]&&this.icaoCodeLookups[b.icao_code][b.lang]){a(null,this.icaoCodeLookups[b.icao_code][b.lang])}else{if(this.icaoCodeLookupCallbacks[b.icao_code]&&this.icaoCodeLookupCallbacks[b.icao_code][b.lang]){this.icaoCodeLookupCallbacks[b.icao_code][b.lang].push(a)}else{this.icaoCodeLookupCallbacks[b.icao_code]={};this.icaoCodeLookupCallbacks[b.icao_code][b.lang]=new Array();this.icaoCodeLookupCallbacks[b.icao_code][b.lang].push(a);JSEngine.IFAPIInitHelper.initialize("airport_info/v1",function(c){var d=c[0];console.debug("JSEngine.AirportInfoHelper.cityNameByICAO is requesting data for city: "+b.icao_code);d.cityNameByICAO(b,function(f,e){console.debug("JSEngine.AirportInfoHelper.cityNameByICAO got data for city: "+b.icao_code);if(!this.icaoCodeLookups[b.icao_code]){this.icaoCodeLookups[b.icao_code]={}}if(!this.icaoCodeLookups[b.icao_code][b.lang]){this.icaoCodeLookups[b.icao_code][b.lang]={}}this.icaoCodeLookups[b.icao_code][b.lang]=e;_.each(this.icaoCodeLookupCallbacks[b.icao_code][b.lang],function(g){if(!f){g(null,e)}else{g(f,null)}});delete this.icaoCodeLookupCallbacks[b.icao_code][b.lang]}.createDelegate(this))}.createDelegate(this))}}},cityNamesByICAO:function(h,c,b){var e=h.length;var a={};var f=0;var g=20;var i=1;var d=function(j){if(j<e){var k={icao_code:h[j],lang:c};JSEngine.AirportInfoHelper.cityNameByICAO(k,function(m,l){f++;if(!m){a[h[j]]=l}if(f===e){b(a)}});if((j+1)%g==0){console.debug("cityNamesByICAO: batching "+(j-g+1)+" to "+(j+1)+" of "+e);d(j+1)}else{d(j+1)}}};d(0)}};namespace("JSEngine");JSEngine.PagerHelpers={getPagingNumber:function(a,b){if(_.isObject(b)&&_.isObject(b.urlParams)&&_.isObject(b.urlParams[a])&&_.isNumber(b.urlParams[a].page)){return parseInt(b.urlParams[a].page,10)}return 0},getPageParams:function(a,b){if(_.isObject(b)&&_.isObject(b.urlParams)&&_.isObject(b.urlParams[a])&&_.isObject(b.urlParams[a].data)){return b.urlParams[a].data}return{}},getChangeToPageParams:function(c,a,e,d){var b={};if(_.isObject(e)&&_.isObject(e.urlParams)){b=_.clone(e.urlParams)}if(!_.isObject(b[c])){b[c]={}}b[c].data=_.clone(d||{});b[c].page=a;return b}};namespace("JSEngine");JSEngine.IFAPIInitHelper={services:{},serviceInitialisationQueue:{},serviceInitialisationErrorQueue:{},hasBeenInitialized:function(a){return _.has(this.services,a)},isInitialising:function(a){return _.isArray(this.serviceInitialisationQueue[a])},initialize:function(b,a,c){var d=b;if(_.isArray(b)){d=b.join("")}if(this.hasBeenInitialized(d)){console.debug("JSEngine.IFAPIInitHelper using already existing "+d+" service");a(this.services[d])}else{if(this.isInitialising(d)){console.debug("JSEngine.IFAPIInitHelper already initialising service "+d+", adding to queue");this.serviceInitialisationQueue[d].push(a);if(c&&typeof c==="function"){this.serviceInitialisationErrorQueue[d].push(c)}}else{console.debug("JSEngine.IFAPIInitHelper initializing "+d+" service");this.serviceInitialisationQueue[d]=new Array();this.serviceInitialisationQueue[d].push(a);this.serviceInitialisationErrorQueue[d]=new Array();if(c&&typeof c==="function"){this.serviceInitialisationErrorQueue[d].push(c)}InFlight.initService(b,function(){console.debug("JSEngine.IFAPIInitHelper service "+b+" initialise complete");this.services[d]=arguments;_.each(this.serviceInitialisationQueue[d],function(e,f){e(this.services[d])}.createDelegate(this));delete this.serviceInitialisationQueue[d]}.createDelegate(this),function(e){if(e&&e.text){console.log(e.text)}_.each(this.serviceInitialisationErrorQueue[d],function(g,f){g(e)}.createDelegate(this));delete this.serviceInitialisationQueue[d];delete this.serviceInitialisationErrorQueue[d];delete this.services[d]}.createDelegate(this))}}}};namespace("JSEngine");JSEngine.CollectionFilters={excludeCurrent:function(d,b){var a=b.fieldNameToMatch;var c=b.value;return _.filter(d,function(e){return e.attributes[a]!==c})}};namespace("JSEngine");JSEngine.TemplateHelpers={getCoverImage:function(c,b){var a="";if(b==="poster"){a=this.getPosterImage(c)||this.getSynopsisImage(c)}else{a=this.getSynopsisImage(c)||this.getPosterImage(c)}return a},getPosterImage:function(a){return a.poster_url?(a.poster_url.size_1||a.poster_url.size_2||a.poster_url.size_3||""):""},getSynopsisImage:function(a){return a.synopsis_url?(a.synopsis_url.size_1||a.synopsis_url.size_2||a.synopsis_url.size_3||""):""}};namespace("JSEngine");JSEngine.LanguageHelper={findWhere:function(b,a){return _.findWhere(b,a)||{}},getCode2FromLocale:function(a){return this.findWhere(this.getData(),{iso639_1:this.extractLanguageCode(a)}).iso639_1||null},getCode3FromLocale:function(a){var b=_.where(this.getData(),{iso639_1:this.extractLanguageCode(a)});if(b.length===0){return null}else{if(b.length===1){return b[0].iso639_2en}else{return this.findWhere(b,{locale:this.lowerCaseLocale(a)}).iso639_2en||null}}},getNameFromCode2:function(a){return this.findWhere(this.getData(),{iso639_1:a}).name||null},getNameFromCode3:function(a){return this.findWhere(this.getData(),{iso639_2en:a}).name||this.findWhere(this.getData(),{iso639_2:a}).name||null},extractLanguageCode:function(a){return this.lowerCaseLocale(a).substr(0,2)},lowerCaseLocale:function(a){return(typeof a==="string"&&a.toLowerCase())||""},getData:function(){return[{iso639_1:"ab",iso639_2:"abk",iso639_2en:"abk",iso639_3:"abk",name:"Abkhaz"},{iso639_1:"aa",iso639_2:"aar",iso639_2en:"aar",iso639_3:"aar",name:"Afar"},{iso639_1:"af",iso639_2:"afr",iso639_2en:"afr",iso639_3:"afr",name:"Afrikaans"},{iso639_1:"ak",iso639_2:"aka",iso639_2en:"aka",iso639_3:"aka",name:"Akan"},{iso639_1:"sq",iso639_2:"sqi",iso639_2en:"alb",iso639_3:"sqi",name:"Albanian"},{iso639_1:"am",iso639_2:"amh",iso639_2en:"amh",iso639_3:"amh",name:"Amharic"},{iso639_1:"ar",iso639_2:"ara",iso639_2en:"ara",iso639_3:"ara",name:"Arabic"},{iso639_1:"an",iso639_2:"arg",iso639_2en:"arg",iso639_3:"arg",name:"Aragonese"},{iso639_1:"hy",iso639_2:"hye",iso639_2en:"arm",iso639_3:"hye",name:"Armenian"},{iso639_1:"as",iso639_2:"asm",iso639_2en:"asm",iso639_3:"asm",name:"Assamese"},{iso639_1:"av",iso639_2:"ava",iso639_2en:"ava",iso639_3:"ava",name:"Avaric"},{iso639_1:"ae",iso639_2:"ave",iso639_2en:"ave",iso639_3:"ave",name:"Avestan"},{iso639_1:"ay",iso639_2:"aym",iso639_2en:"aym",iso639_3:"aym",name:"Aymara"},{iso639_1:"az",iso639_2:"aze",iso639_2en:"aze",iso639_3:"aze",name:"Azerbaijani"},{iso639_1:"bm",iso639_2:"bam",iso639_2en:"bam",iso639_3:"bam",name:"Bambara"},{iso639_1:"ba",iso639_2:"bak",iso639_2en:"bak",iso639_3:"bak",name:"Bashkir"},{iso639_1:"eu",iso639_2:"eus",iso639_2en:"baq",iso639_3:"eus",name:"Basque"},{iso639_1:"be",iso639_2:"bel",iso639_2en:"bel",iso639_3:"bel",name:"Belarusian"},{iso639_1:"bn",iso639_2:"ben",iso639_2en:"ben",iso639_3:"ben",name:"Bengali"},{iso639_1:"bh",iso639_2:"bih",iso639_2en:"bih",iso639_3:"",name:"Bihari"},{iso639_1:"bi",iso639_2:"bis",iso639_2en:"bis",iso639_3:"bis",name:"Bislama"},{iso639_1:"bs",iso639_2:"bos",iso639_2en:"bos",iso639_3:"bos",name:"Bosnian"},{iso639_1:"br",iso639_2:"bre",iso639_2en:"bre",iso639_3:"bre",name:"Breton"},{iso639_1:"bg",iso639_2:"bul",iso639_2en:"bul",iso639_3:"bul",name:"Bulgarian"},{iso639_1:"my",iso639_2:"mya",iso639_2en:"bur",iso639_3:"mya",name:"Burmese"},{iso639_1:"ca",iso639_2:"cat",iso639_2en:"cat",iso639_3:"cat",name:"Catalan"},{iso639_1:"ch",iso639_2:"cha",iso639_2en:"cha",iso639_3:"cha",name:"Chamorro"},{iso639_1:"ce",iso639_2:"che",iso639_2en:"che",iso639_3:"che",name:"Chechen"},{iso639_1:"ny",iso639_2:"nya",iso639_2en:"nya",iso639_3:"nya",name:"Chichewa"},{iso639_1:"zh",iso639_2:"zho",iso639_2en:"zho",iso639_3:"zho",name:"Chinese - Traditional",locale:"zh-hant"},{iso639_1:"zh",iso639_2:"zhk",iso639_2en:"zhk",iso639_3:"zhk",name:"Chinese - Simplified",locale:"zh-hans"},{iso639_1:"cv",iso639_2:"chv",iso639_2en:"chv",iso639_3:"chv",name:"Chuvash"},{iso639_1:"kw",iso639_2:"cor",iso639_2en:"cor",iso639_3:"cor",name:"Cornish"},{iso639_1:"co",iso639_2:"cos",iso639_2en:"cos",iso639_3:"cos",name:"Corsican"},{iso639_1:"cr",iso639_2:"cre",iso639_2en:"cre",iso639_3:"cre",name:"Cree"},{iso639_1:"hr",iso639_2:"hrv",iso639_2en:"hrv",iso639_3:"hrv",name:"Croatian"},{iso639_1:"cs",iso639_2:"ces",iso639_2en:"cze",iso639_3:"ces",name:"Czech"},{iso639_1:"da",iso639_2:"dan",iso639_2en:"dan",iso639_3:"dan",name:"Danish"},{iso639_1:"dv",iso639_2:"div",iso639_2en:"div",iso639_3:"div",name:"Divehi"},{iso639_1:"nl",iso639_2:"nld",iso639_2en:"dut",iso639_3:"nld",name:"Dutch"},{iso639_1:"dz",iso639_2:"dzo",iso639_2en:"dzo",iso639_3:"dzo",name:"Dzongkha"},{iso639_1:"en",iso639_2:"eng",iso639_2en:"eng",iso639_3:"eng",name:"English"},{iso639_1:"eo",iso639_2:"epo",iso639_2en:"epo",iso639_3:"epo",name:"Esperanto"},{iso639_1:"et",iso639_2:"est",iso639_2en:"est",iso639_3:"est",name:"Estonian"},{iso639_1:"ee",iso639_2:"ewe",iso639_2en:"ewe",iso639_3:"ewe",name:"Ewe"},{iso639_1:"fo",iso639_2:"fao",iso639_2en:"fao",iso639_3:"fao",name:"Faroese"},{iso639_1:"fj",iso639_2:"fij",iso639_2en:"fij",iso639_3:"fij",name:"Fijian"},{iso639_1:"fi",iso639_2:"fin",iso639_2en:"fin",iso639_3:"fin",name:"Finnish"},{iso639_1:"fr",iso639_2:"fra",iso639_2en:"fre",iso639_3:"fra",name:"French"},{iso639_1:"ff",iso639_2:"ful",iso639_2en:"ful",iso639_3:"ful",name:"Fula"},{iso639_1:"gl",iso639_2:"glg",iso639_2en:"glg",iso639_3:"glg",name:"Galician"},{iso639_1:"ka",iso639_2:"kat",iso639_2en:"geo",iso639_3:"kat",name:"Georgian"},{iso639_1:"de",iso639_2:"deu",iso639_2en:"ger",iso639_3:"deu",name:"German"},{iso639_1:"el",iso639_2:"ell",iso639_2en:"gre",iso639_3:"ell",name:"Greek"},{iso639_1:"gn",iso639_2:"grn",iso639_2en:"grn",iso639_3:"grn",name:"Guaraní"},{iso639_1:"gu",iso639_2:"guj",iso639_2en:"guj",iso639_3:"guj",name:"Gujarati"},{iso639_1:"ht",iso639_2:"hat",iso639_2en:"hat",iso639_3:"hat",name:"Haitian"},{iso639_1:"ha",iso639_2:"hau",iso639_2en:"hau",iso639_3:"hau",name:"Hausa"},{iso639_1:"he",iso639_2:"heb",iso639_2en:"heb",iso639_3:"heb",name:"Hebrew"},{iso639_1:"hz",iso639_2:"her",iso639_2en:"her",iso639_3:"her",name:"Herero"},{iso639_1:"hi",iso639_2:"hin",iso639_2en:"hin",iso639_3:"hin",name:"Hindi"},{iso639_1:"ho",iso639_2:"hmo",iso639_2en:"hmo",iso639_3:"hmo",name:"Hiri Motu"},{iso639_1:"hu",iso639_2:"hun",iso639_2en:"hun",iso639_3:"hun",name:"Hungarian"},{iso639_1:"ia",iso639_2:"ina",iso639_2en:"ina",iso639_3:"ina",name:"Interlingua"},{iso639_1:"id",iso639_2:"ind",iso639_2en:"ind",iso639_3:"ind",name:"Indonesian"},{iso639_1:"ie",iso639_2:"ile",iso639_2en:"ile",iso639_3:"ile",name:"Interlingue"},{iso639_1:"ga",iso639_2:"gle",iso639_2en:"gle",iso639_3:"gle",name:"Irish"},{iso639_1:"ig",iso639_2:"ibo",iso639_2en:"ibo",iso639_3:"ibo",name:"Igbo"},{iso639_1:"ik",iso639_2:"ipk",iso639_2en:"ipk",iso639_3:"ipk",name:"Inupiaq"},{iso639_1:"io",iso639_2:"ido",iso639_2en:"ido",iso639_3:"ido",name:"Ido"},{iso639_1:"is",iso639_2:"isl",iso639_2en:"ice",iso639_3:"isl",name:"Icelandic"},{iso639_1:"it",iso639_2:"ita",iso639_2en:"ita",iso639_3:"ita",name:"Italian"},{iso639_1:"iu",iso639_2:"iku",iso639_2en:"iku",iso639_3:"iku",name:"Inuktitut"},{iso639_1:"ja",iso639_2:"jpn",iso639_2en:"jpn",iso639_3:"jpn",name:"Japanese"},{iso639_1:"jv",iso639_2:"jav",iso639_2en:"jav",iso639_3:"jav",name:"Javanese"},{iso639_1:"kl",iso639_2:"kal",iso639_2en:"kal",iso639_3:"kal",name:"Greenlandic"},{iso639_1:"kn",iso639_2:"kan",iso639_2en:"kan",iso639_3:"kan",name:"Kannada"},{iso639_1:"kr",iso639_2:"kau",iso639_2en:"kau",iso639_3:"kau",name:"Kanuri"},{iso639_1:"ks",iso639_2:"kas",iso639_2en:"kas",iso639_3:"kas",name:"Kashmiri"},{iso639_1:"kk",iso639_2:"kaz",iso639_2en:"kaz",iso639_3:"kaz",name:"Kazakh"},{iso639_1:"km",iso639_2:"khm",iso639_2en:"khm",iso639_3:"khm",name:"Khmer"},{iso639_1:"ki",iso639_2:"kik",iso639_2en:"kik",iso639_3:"kik",name:"Kikuyu"},{iso639_1:"rw",iso639_2:"kin",iso639_2en:"kin",iso639_3:"kin",name:"Kinyarwanda"},{iso639_1:"ky",iso639_2:"kir",iso639_2en:"kir",iso639_3:"kir",name:"Kyrgyz"},{iso639_1:"kv",iso639_2:"kom",iso639_2en:"kom",iso639_3:"kom",name:"Komi"},{iso639_1:"kg",iso639_2:"kon",iso639_2en:"kon",iso639_3:"kon",name:"Kongo"},{iso639_1:"ko",iso639_2:"kor",iso639_2en:"kor",iso639_3:"kor",name:"Korean"},{iso639_1:"ku",iso639_2:"kur",iso639_2en:"kur",iso639_3:"kur",name:"Kurdish"},{iso639_1:"kj",iso639_2:"kua",iso639_2en:"kua",iso639_3:"kua",name:"Kwanyama"},{iso639_1:"la",iso639_2:"lat",iso639_2en:"lat",iso639_3:"lat",name:"Latin"},{iso639_1:"lb",iso639_2:"ltz",iso639_2en:"ltz",iso639_3:"ltz",name:"Luxembourgish"},{iso639_1:"lg",iso639_2:"lug",iso639_2en:"lug",iso639_3:"lug",name:"Ganda"},{iso639_1:"li",iso639_2:"lim",iso639_2en:"lim",iso639_3:"lim",name:"Limburgish"},{iso639_1:"ln",iso639_2:"lin",iso639_2en:"lin",iso639_3:"lin",name:"Lingala"},{iso639_1:"lo",iso639_2:"lao",iso639_2en:"lao",iso639_3:"lao",name:"Lao"},{iso639_1:"lt",iso639_2:"lit",iso639_2en:"lit",iso639_3:"lit",name:"Lithuanian"},{iso639_1:"lu",iso639_2:"lub",iso639_2en:"lub",iso639_3:"lub",name:"Luba-Katanga"},{iso639_1:"lv",iso639_2:"lav",iso639_2en:"lav",iso639_3:"lav",name:"Latvian"},{iso639_1:"gv",iso639_2:"glv",iso639_2en:"glv",iso639_3:"glv",name:"Manx"},{iso639_1:"mk",iso639_2:"mkd",iso639_2en:"mac",iso639_3:"mkd",name:"Macedonian"},{iso639_1:"mg",iso639_2:"mlg",iso639_2en:"mlg",iso639_3:"mlg",name:"Malagasy"},{iso639_1:"ms",iso639_2:"msa",iso639_2en:"may",iso639_3:"msa",name:"Malay"},{iso639_1:"ml",iso639_2:"mal",iso639_2en:"mal",iso639_3:"mal",name:"Malayalam"},{iso639_1:"mt",iso639_2:"mlt",iso639_2en:"mlt",iso639_3:"mlt",name:"Maltese"},{iso639_1:"mi",iso639_2:"mri",iso639_2en:"mao",iso639_3:"mri",name:"Māori"},{iso639_1:"mr",iso639_2:"mar",iso639_2en:"mar",iso639_3:"mar",name:"Marathi (Marāṭhī)"},{iso639_1:"mh",iso639_2:"mah",iso639_2en:"mah",iso639_3:"mah",name:"Marshallese"},{iso639_1:"mn",iso639_2:"mon",iso639_2en:"mon",iso639_3:"mon",name:"Mongolian"},{iso639_1:"na",iso639_2:"nau",iso639_2en:"nau",iso639_3:"nau",name:"Nauru"},{iso639_1:"nv",iso639_2:"nav",iso639_2en:"nav",iso639_3:"nav",name:"Navajo"},{iso639_1:"nb",iso639_2:"nob",iso639_2en:"nob",iso639_3:"nob",name:"Norwegian Bokmål"},{iso639_1:"nd",iso639_2:"nde",iso639_2en:"nde",iso639_3:"nde",name:"Northern Ndebele"},{iso639_1:"ne",iso639_2:"nep",iso639_2en:"nep",iso639_3:"nep",name:"Nepali"},{iso639_1:"ng",iso639_2:"ndo",iso639_2en:"ndo",iso639_3:"ndo",name:"Ndonga"},{iso639_1:"nn",iso639_2:"nno",iso639_2en:"nno",iso639_3:"nno",name:"Norwegian Nynorsk"},{iso639_1:"no",iso639_2:"nor",iso639_2en:"nor",iso639_3:"nor",name:"Norwegian"},{iso639_1:"ii",iso639_2:"iii",iso639_2en:"iii",iso639_3:"iii",name:"Nuosu"},{iso639_1:"nr",iso639_2:"nbl",iso639_2en:"nbl",iso639_3:"nbl",name:"Southern Ndebele"},{iso639_1:"oc",iso639_2:"oci",iso639_2en:"oci",iso639_3:"oci",name:"Occitan"},{iso639_1:"oj",iso639_2:"oji",iso639_2en:"oji",iso639_3:"oji",name:"Ojibwe"},{iso639_1:"cu",iso639_2:"chu",iso639_2en:"chu",iso639_3:"chu",name:"Old Church Slavonic"},{iso639_1:"om",iso639_2:"orm",iso639_2en:"orm",iso639_3:"orm",name:"Oromo"},{iso639_1:"or",iso639_2:"ori",iso639_2en:"ori",iso639_3:"ori",name:"Oriya"},{iso639_1:"os",iso639_2:"oss",iso639_2en:"oss",iso639_3:"oss",name:"Ossetian"},{iso639_1:"pa",iso639_2:"pan",iso639_2en:"pan",iso639_3:"pan",name:"Panjabi"},{iso639_1:"pi",iso639_2:"pli",iso639_2en:"pli",iso639_3:"pli",name:"Pāli"},{iso639_1:"fa",iso639_2:"fas",iso639_2en:"per",iso639_3:"fas",name:"Persian"},{iso639_1:"pl",iso639_2:"pol",iso639_2en:"pol",iso639_3:"pol",name:"Polish"},{iso639_1:"ps",iso639_2:"pus",iso639_2en:"pus",iso639_3:"pus",name:"Pashto"},{iso639_1:"pt",iso639_2:"por",iso639_2en:"por",iso639_3:"por",name:"Portuguese"},{iso639_1:"qu",iso639_2:"que",iso639_2en:"que",iso639_3:"que",name:"Quechua"},{iso639_1:"rm",iso639_2:"roh",iso639_2en:"roh",iso639_3:"roh",name:"Romansh"},{iso639_1:"rn",iso639_2:"run",iso639_2en:"run",iso639_3:"run",name:"Kirundi"},{iso639_1:"ro",iso639_2:"ron",iso639_2en:"rum",iso639_3:"ron",name:"Romanian"},{iso639_1:"ru",iso639_2:"rus",iso639_2en:"rus",iso639_3:"rus",name:"Russian"},{iso639_1:"sa",iso639_2:"san",iso639_2en:"san",iso639_3:"san",name:"Sanskrit (Saṁskṛta)"},{iso639_1:"sc",iso639_2:"srd",iso639_2en:"srd",iso639_3:"srd",name:"Sardinian"},{iso639_1:"sd",iso639_2:"snd",iso639_2en:"snd",iso639_3:"snd",name:"Sindhi"},{iso639_1:"se",iso639_2:"sme",iso639_2en:"sme",iso639_3:"sme",name:"Northern Sami"},{iso639_1:"sm",iso639_2:"smo",iso639_2en:"smo",iso639_3:"smo",name:"Samoan"},{iso639_1:"sg",iso639_2:"sag",iso639_2en:"sag",iso639_3:"sag",name:"Sango"},{iso639_1:"sr",iso639_2:"srp",iso639_2en:"srp",iso639_3:"srp",name:"Serbian"},{iso639_1:"gd",iso639_2:"gla",iso639_2en:"gla",iso639_3:"gla",name:"Scottish Gaelic"},{iso639_1:"sn",iso639_2:"sna",iso639_2en:"sna",iso639_3:"sna",name:"Shona"},{iso639_1:"si",iso639_2:"sin",iso639_2en:"sin",iso639_3:"sin",name:"Sinhala"},{iso639_1:"sk",iso639_2:"slk",iso639_2en:"slo",iso639_3:"slk",name:"Slovak"},{iso639_1:"sl",iso639_2:"slv",iso639_2en:"slv",iso639_3:"slv",name:"Slovene"},{iso639_1:"so",iso639_2:"som",iso639_2en:"som",iso639_3:"som",name:"Somali"},{iso639_1:"st",iso639_2:"sot",iso639_2en:"sot",iso639_3:"sot",name:"Southern Sotho"},{iso639_1:"es",iso639_2:"spa",iso639_2en:"spa",iso639_3:"spa",name:"Spanish"},{iso639_1:"su",iso639_2:"sun",iso639_2en:"sun",iso639_3:"sun",name:"Sundanese"},{iso639_1:"sw",iso639_2:"swa",iso639_2en:"swa",iso639_3:"swa",name:"Swahili"},{iso639_1:"ss",iso639_2:"ssw",iso639_2en:"ssw",iso639_3:"ssw",name:"Swati"},{iso639_1:"sv",iso639_2:"swe",iso639_2en:"swe",iso639_3:"swe",name:"Swedish"},{iso639_1:"ta",iso639_2:"tam",iso639_2en:"tam",iso639_3:"tam",name:"Tamil"},{iso639_1:"te",iso639_2:"tel",iso639_2en:"tel",iso639_3:"tel",name:"Telugu"},{iso639_1:"tg",iso639_2:"tgk",iso639_2en:"tgk",iso639_3:"tgk",name:"Tajik"},{iso639_1:"th",iso639_2:"tha",iso639_2en:"tha",iso639_3:"tha",name:"Thai"},{iso639_1:"ti",iso639_2:"tir",iso639_2en:"tir",iso639_3:"tir",name:"Tigrinya"},{iso639_1:"bo",iso639_2:"bod",iso639_2en:"tib",iso639_3:"bod",name:"Tibetan Standard"},{iso639_1:"tk",iso639_2:"tuk",iso639_2en:"tuk",iso639_3:"tuk",name:"Turkmen"},{iso639_1:"tl",iso639_2:"tgl",iso639_2en:"tgl",iso639_3:"tgl",name:"Tagalog"},{iso639_1:"tn",iso639_2:"tsn",iso639_2en:"tsn",iso639_3:"tsn",name:"Tswana"},{iso639_1:"to",iso639_2:"ton",iso639_2en:"ton",iso639_3:"ton",name:"Tonga (Tonga Islands)"},{iso639_1:"tr",iso639_2:"tur",iso639_2en:"tur",iso639_3:"tur",name:"Turkish"},{iso639_1:"ts",iso639_2:"tso",iso639_2en:"tso",iso639_3:"tso",name:"Tsonga"},{iso639_1:"tt",iso639_2:"tat",iso639_2en:"tat",iso639_3:"tat",name:"Tatar"},{iso639_1:"tw",iso639_2:"twi",iso639_2en:"twi",iso639_3:"twi",name:"Twi"},{iso639_1:"ty",iso639_2:"tah",iso639_2en:"tah",iso639_3:"tah",name:"Tahitian"},{iso639_1:"ug",iso639_2:"uig",iso639_2en:"uig",iso639_3:"uig",name:"Uyghur"},{iso639_1:"uk",iso639_2:"ukr",iso639_2en:"ukr",iso639_3:"ukr",name:"Ukrainian"},{iso639_1:"ur",iso639_2:"urd",iso639_2en:"urd",iso639_3:"urd",name:"Urdu"},{iso639_1:"uz",iso639_2:"uzb",iso639_2en:"uzb",iso639_3:"uzb",name:"Uzbek"},{iso639_1:"ve",iso639_2:"ven",iso639_2en:"ven",iso639_3:"ven",name:"Venda"},{iso639_1:"vi",iso639_2:"vie",iso639_2en:"vie",iso639_3:"vie",name:"Vietnamese"},{iso639_1:"vo",iso639_2:"vol",iso639_2en:"vol",iso639_3:"vol",name:"Volapük"},{iso639_1:"wa",iso639_2:"wln",iso639_2en:"wln",iso639_3:"wln",name:"Walloon"},{iso639_1:"cy",iso639_2:"cym",iso639_2en:"wel",iso639_3:"cym",name:"Welsh"},{iso639_1:"wo",iso639_2:"wol",iso639_2en:"wol",iso639_3:"wol",name:"Wolof"},{iso639_1:"fy",iso639_2:"fry",iso639_2en:"fry",iso639_3:"fry",name:"Western Frisian"},{iso639_1:"xh",iso639_2:"xho",iso639_2en:"xho",iso639_3:"xho",name:"Xhosa"},{iso639_1:"yi",iso639_2:"yid",iso639_2en:"yid",iso639_3:"yid",name:"Yiddish"},{iso639_1:"yo",iso639_2:"yor",iso639_2en:"yor",iso639_3:"yor",name:"Yoruba"},{iso639_1:"za",iso639_2:"zha",iso639_2en:"zha",iso639_3:"zha",name:"Zhuang"},{iso639_1:"zu",iso639_2:"zul",iso639_2en:"zul",iso639_3:"zul",name:"Zulu"}]}};namespace("JSEngine.Widgets");JSEngine.Widgets.DynamicContainerWidget=Backbone.Model.extend({requiredParams:["el","page","applicationVariables","feedManager","mediaManager","messageManager"],initialize:function(b){helpers.assertParametersExistAndAddToObject(b,this.requiredParams,this);var a,c=this.el;this.template=helpers.parseTemplateMarkup(c,b.itemTemplateSelector)||helpers.parseTemplateMarkup($j("body"),"#"+b.template);this.loadingTemplate=helpers.parseTemplateMarkup(c,b.loadingTemplateSelector)||helpers.parseTemplateMarkup($j("body"),"#"+b.loadingTemplate);this.noDataTemplate=helpers.parseTemplateMarkup(c,b.noDataTemplateSelector)||helpers.parseTemplateMarkup($j("body"),"#"+b.noDataTemplate);this.errorTemplate=helpers.parseTemplateMarkup(c,b.errorTemplateSelector)||helpers.parseTemplateMarkup($j("body"),"#"+b.errorTemplate);a=b.dynamicContainer||b.containerSelector;this.dynamicContainer=a?c.find(a):c;this.dynamicContainer=b.containerSelector?c.find(b.containerSelector):c;this.itemLimit=b.itemLimit;this.itemOffset=b.itemOffset;this.filter=JSON.stringify(b.filter);this.oldStyledWidget=b.oldStyledWidget;if(this.oldStyledWidget){this.createDynamicContainer(c,null,true)}this.collection=this.feedManager.getDataCollection(c,this.applicationVariables,this.page);this.collection.on("fetchStart",_.bind(this._templatize,this,"loadingTemplate",this.applicationVariables));this.collection.on("fetchSuccess",this.renderView.createDelegate(this));this.collection.on("fetchFail",_.bind(this._templatize,this,"errorTemplate",this.applicationVariables));if(this.page.isActive&&this.collection.hasBeenFetched){this.renderView()}else{if(this.page.isActive&&!this.collection.hasBeenFetched){this.collection.trigger("reActivate",this.page,this.applicationVariables)}}},_templatize:function(a,c){var b=this[a];if(!_.isEmpty(b)){b=_.template(b,c);this.dynamicContainer.html(b)}},renderView:function(){this.dynamicContainer.empty();this.view=new JSEngine.CollectionView({container:this.dynamicContainer,template:this.template,noDataTemplate:this.noDataTemplate,models:this.getModelsToRender(),doPagination:false});this.view.render(this.applicationVariables);this.createChildElementWrapper();this.trigger("dataLoaded",this,this.collection);this.trigger("renderComplete")},getModelsToRender:function(){var b=this.collection.models,a;if(!_.isUndefined(this.collection.getModelsToRender)){b=this.collection.getModelsToRender(b)}if(!_.isUndefined(this.filter)&&this.filter!=="undefined"){a=this._parseFilter(this.filter);if(a){b=this.filterResults(a)}}if(this.itemOffset>0){b=_.rest(b,this.itemOffset)}if(this.itemLimit>0){b=_.first(b,this.itemLimit)}return b},createChildElementWrapper:function(){if(this.childElementWrapper){this.childElementWrapper.cleanUp();delete this.childElementWrapper}this.childElementWrapper=new JSEngine.ElementWrapper({el:this.el,applicationVariables:this.applicationVariables,page:this.page,feedManager:this.feedManager,mediaManager:this.mediaManager,messageManager:this.messageManager})},filterResults:function(b){var d=this.collection.models,c="",a={};if(!_.isEmpty(b.specialFilter)){c=b.specialFilter.type;a=b.specialFilter.params;delete b.specialFilter}if(!_.isEmpty(b)){d=this.collection.where(b)}if(!_.isEmpty(c)){d=JSEngine.CollectionFilters[c](d,a)}return d},_parseFilter:function(a){try{return jQuery.parseJSON(_.template(a,this.applicationVariables||{}))}catch(b){console.error("Error in the filter: ",a);return null}},handleDynamicContainers:function(b,a){var c=b.dynamicContainer||b.dynamicContainers;console.warn("This feature 'handleDynamicContainers' is deprecated - DynamicContainerWidget");if(!c){return}helpers.assertParametersExistAndAddToObject(b,this.requiredParams,this);c=c.split(/\,/);_.each(c,function(d){d=$j.trim(d);this.createDynamicContainer($j(d),function(){a(b)}.createDelegate(this),true)}.createDelegate(this))},createDynamicContainer:function(d,a,b){var e,c;console.warn("This feature 'createDynamicContainer' is deprecated - DynamicContainerWidget");this.dynamicContainers||(this.dynamicContainers=[]);a=_.isFunction(a)?a:function(){};e=helpers.createComponentElementParameters(d,this.page,this.feedManager,this.mediaManager,this.messageManager,this.applicationVariables);if(!b||!this.oldStyledWidget){c=new JSEngine.Widgets.DynamicContainerWidget(e)}else{c=new JSEngine.DynamicContainer(e)}c.on("dataLoaded",a);this.dynamicContainers.push(c);return c}});namespace("JSEngine.Widgets");JSEngine.Widgets.HashChangeClass=Backbone.Model.extend({initialize:function(){var a;this.currentHash=this._history=[window.location.hash];this._handlers=[];this.eventSupport=true,this.length=0,a=function(){this.eventSupport=false;this.setFallback()};if(window){if(window.onhashchange!==undefined){if(window.addEventListener){window.addEventListener("hashchange",_.bind(this.check,this),false)}else{if(window.attachEvent){window.attachEvent("onhashchange",_.bind(this.check,this))}else{a.call(this)}}}else{a.call(this)}}},onHashChange:function(){var a,b;for(a=0;a<this.length;a++){b=this._handlers[a];if(b){if(_.has(b,"callbacks")){this.callFunctionsArrayPassingHash(b.callbacks);if(_.has(b,"_once")&&b._once){this._handlers.splice(a,1)}}}}if(!this.eventSupport){this.setFallback()}},check:function(){var a=window.location.hash;if(a===this.currentHash){return}this.currentHash=this._history[this._history.length]=a;this.onHashChange()},setFallback:function(){helpers.setTimeout(_.bind(this.check,this),200)},_add:function(e,b,d){var c,a;b=b||[];if(!e){throw new Error("To Subscribe to the HashChange you need to provide an id key")}c=this.getIndex(e);if(c>-1){this._handlers[c].callbacks=b;a=c}else{this._handlers.push({id:e,callbacks:b,_once:d==="this._once"||false});a=this.length}if(d==="activate"){if(this._handlers[a]&&_.has(this._handlers[a],"callbacks")){this.callFunctionsArrayPassingHash(this._handlers[a].callbacks)}}this.length+=1},getIndex:function(b){for(var a=0;a<this.length;a++){if(this._handlers[a]&&this._handlers[a].id===b){return a}}return -1},callFunctionsArrayPassingHash:function(a){_.each(a,function(b){if(_.isFunction(b)){b(window.location.hash)}})},subscribe:function(a){this._add(a,_.slice(arguments,1));return this},activate:function(a){this._add(a,_.slice(arguments,1),"activate");return this},once:function(){this._add(null,_.slice(arguments),"once");return this},unsubscribe:function(b){var a;a=this.getIndex(b);if(a===-1){return}this._handler.splice(a,1);this.length-=1;return this},hash:function(){return window.location.hash},clear:function(){var c=0,a=arguments.length,b;for(;c<a;c++){if(arguments[c]!==undefined){b=this.getIndex(arguments[c]);if(b>-1){this._handler.splice(b,1);this.length-=1}}}},clearAll:function(a){if(a==="repeat"){this._handler=[];this.length=0}else{if(a==="this._once"){}else{this._handler=[];this.length=0}}return this}});JSEngine.HashChange=new JSEngine.Widgets.HashChangeClass();namespace("JSEngine");JSEngine.Validators={required:function(b,a){var d=b.val();var c=b.attr("type");if(c=="checkbox"){a(b.is(":checked"))}else{if(!_.isEmpty(d)||d==true){a(true)}else{a(false)}}}};namespace("JSEngine");JSEngine.ErrorPageWrapper=JSEngine.PageWrapper.extend({initialize:function(a){JSEngine.PageWrapper.prototype.initialize.call(this,a);this.pageManager.on("pageLoadError",this.onPageLoadError.createDelegate(this))},onPageLoadError:function(){var a=this.el.attr("id");if(a){helpers.changeDocumentLocation("#"+a.replace("#",""))}},cleanUp:function(){this.off()}});namespace("JSEngine");JSEngine.BaseLiveTextNewsCollection=JSEngine.BaseCollection.extend({initialize:function(c,a){a=a||{};JSEngine.BaseCollection.prototype.initialize.call(this,c,a);if(a.listenToUpdateEvent){var b="ltnUpdate_"+Math.random();JSEngine.EventHandler.subscribe("ltnUpdate",b,function(){this.fetch(this.options)}.createDelegate(this))}},convertWeatherDegreeCelciusToCelciusAndFahrenheit:function(a){if(a!==undefined&&a!==null){return{celsius:a,fahrenheit:Math.round((((a*9)/5)+32))}}else{return{celsius:"n/a",fahrenheit:"n/a"}}}});namespace("JSEngine");JSEngine.WebStore=Backbone.Collection.extend({initialize:function(b,a){helpers.assertParametersExistAndAddToObject(a,["storageName"],this);if(a.storageType){this.storageType=a.storageType}else{this.storageType="sessionStorage"}Backbone.Collection.prototype.initialize.call(this,b,a)},sync:function(e,d,a){a=a||{};var c=this.getStorage();if(e=="create"||e=="update"||e=="patch"){c[this.storageName]=JSON.stringify(d);if(a.success){a.success()}}else{if(e==="read"){if(_.isUndefined(c[this.storageName])){a.success([]);return}var b=JSON.parse(c[this.storageName]);a.success(b)}}},getStorage:function(){if(this.storageType==="sessionStorage"){return sessionStorage}else{if(this.storageType==="localStorage"){return localStorage}}}});namespace("JSEngine");JSEngine.GlobalWrapper=JSEngine.PageWrapper.extend({initialize:function(a){a=a||{};helpers.assertParametersExistAndAddToObject(a,["el","applicationVariables","feedManager","pageManager","mediaManager","messageManager"],this);this.loadUrl=a.loadUrl;this.isActive=true;this.isGlobalContainer=true;if(this.loadUrl){this.loadFromUrl()}else{this.init()}},loadFromUrl:function(){var b=function(){this.init()}.createDelegate(this);this.loadSegment(this.loadUrl,this.el,b)},loadSegment:function(b,c,a){if(b.indexOf("?")>=0){b+="&"}else{b+="?"}b+="t="+(Math.random()*10000);$j.ajax({url:b,dataType:"html",success:function(e,d,f){c[0].innerHTML=e;a()}.createDelegate(this),error:function(d,f,e){this.cleanUp();this.trigger("segmentLoadError",{page:this,url:b,error:e})}.createDelegate(this)})},init:function(){var b=function(){this.elementWrapper=new JSEngine.ElementWrapper({page:this,el:this.el,feedManager:this.feedManager,applicationVariables:this.applicationVariables,mediaManager:this.mediaManager,messageManager:this.messageManager});this.trigger("firstActivate",this,this.applicationVariables);this.trigger("beforeActivate",this,this.applicationVariables);var e=function(){this.trigger("activate",this,this.applicationVariables);this.trigger("renderContent",this,this.applicationVariables);this.trigger("afterActivate",this,this.applicationVariables)}.createDelegate(this);var d=_.toArray(this._async_events).length;var f=0;_.each(this._async_events,function(i,h){var g=function(){f++;if(f===d){e()}};this.triggerWithCallback(h,g)}.createDelegate(this))}.createDelegate(this);var c=this.el.find(".page-segment");if(c){var a=c.length;if(a>0){_.each(c,function(e){var d=function(){a--;if(a==0){b()}};var f=$j(e);this.loadSegment(f.attr("data-segment-load-url"),f,d)},this)}else{b()}}else{b()}}});namespace("JSEngine.Media");JSEngine.Media.SeekingBasePlayer=JSEngine.Media.BasePlayer.extend({initialize:function(a){this.currentSeeks={};helpers.addParametersToObjectIfExist(a,["seekEnabled"],this);JSEngine.Media.BasePlayer.prototype.initialize.call(this,a)},loadPlayer:function(a){if(this.seekEnabled){if(this.currentSeeks[a]){var b=function(){this.player.removeEventListener(this.AVOD.Events.LOADED_DATA,b);this.player.seek(Math.round(this.currentSeeks[a]))}.createDelegate(this);this.player.addEventListener(this.AVOD.Events.LOADED_DATA,b)}}},onPlayerStop:function(a){if(this.seekEnabled){var b=this.currentMediaUri||this.currentChildItemMediaUri;this.currentSeeks[b]=this.player.getCurrentTime()}JSEngine.Media.BasePlayer.prototype.onPlayerStop.call(this)},onPlayerPause:function(a){if(this.seekEnabled){var b=this.currentMediaUri||this.currentChildItemMediaUri;this.currentSeeks[b]=this.player.getCurrentTime()}JSEngine.Media.BasePlayer.prototype.onPlayerPause.call(this)}});namespace("JSEngine.WidgetUtils");JSEngine.WidgetUtils.hyphensToCamel=function(a){return a.replace(/-([a-z])/g,function(b){return b[1].toUpperCase()})};JSEngine.WidgetUtils.camelToHyphens=function(a){return a.replace(/([a-z][A-Z])/g,function(b){return b[0]+"-"+b[1].toLowerCase()})};JSEngine.WidgetUtils.jQueryfy=function(c,d){var e,b,a;d=d||this._attributes;c=c||this.jQueryfyList;e=-1;b=c.length;while(++e<b){a=c[e];if(d[a]){d[a]=$j(d[a])}}return d};JSEngine.WidgetUtils.Matcher={exact:function(b,a){if(b===a){return true}else{return false}},_contains:function(b,a){if(b.indexOf(a)>-1){return true}return false},_greatest:function(b,a){if(b.indexOf(a)>-1){if(a.length>this._greatestValue.length){this._greatestValue=a;return true}}return false},_greatestReset:function(){this._greatestValue=""},"ref-contains":function(b,a){return this._contains(a,b)},"uri-greatest":function(b,a){return this._greatest(a,b)},"uri-contains":function(b,a){return this._contains(b,a)},"ref-greatest":function(b,a){return this._greatest(b,a)},"closest-match":function(c,b){var d,a;d=this._greatest(c,b);a=this._greatest(b,c);if(d||a){return true}return false}};JSEngine.WidgetUtils.GetTransition=function(){var c=$j("div")[0],a=["ms","O","Webkit","Moz"],b;_.each(a,function(d){if(c.style[d+"Transition"]!==undefined){return b=d+"Transition"}});return b};JSEngine.WidgetUtils.CheckTouchSupport=function(){var a=document.documentElement;if("ontouchstart" in a||"touchmove" in a||"touchend" in a){return true}else{return false}};namespace("JSEngine.Widgets");JSEngine.Widgets.Accordion=Backbone.Model.extend({initialize:function(a){this._ACCORDION=a;this._SUMMARY_ELEMENTS=this._ACCORDION.find(".summary");this._SUMMARY_LINKS=null;this._DISCLOSURE_ELEMENTS=this._ACCORDION.find("div.disclosure");this._SLIDE_DURATION=200;this.getSummaryLinks();this.setAccordion();var b=this;this._SUMMARY_LINKS.bind("click",function(c){c.preventDefault();b.resetAccordion();if($j(this).parent().next(".disclosure").is(":hidden")){$j(this).removeClass("accordion-closed").addClass("accordion-open");$j(this).parent().next(".disclosure").stop(true,false).slideToggle(b._SLIDE_DURATION)}})},getSummaryLinks:function(){this._SUMMARY_ELEMENTS.wrapInner($j('<a class="icon" href="#"></a>'));this._SUMMARY_LINKS=this._SUMMARY_ELEMENTS.find("a")},resetAccordion:function(){this._DISCLOSURE_ELEMENTS.slideUp(this._SLIDE_DURATION);this._SUMMARY_LINKS.removeClass("accordion-open").addClass("accordion-closed")},setAccordion:function(){this._ACCORDION.attr({"aaa:atomic":"true","aaa:live":"polite"});this._DISCLOSURE_ELEMENTS.hide();this._SUMMARY_LINKS.addClass("accordion-closed")}});namespace("JSEngine.Widgets");JSEngine.Widgets.TabComponent=Backbone.Model.extend({initialize:function(b){var a;this.page=b.page;if(b.collectionType){var f=helpers.createComponentElementParameters(b.el,b.page,b.feedManager,b.mediaManager,b.messageManager,b.applicationVariables);this.dynamicContainer=new JSEngine.DynamicContainer(f);this.dynamicContainer.on("dataLoaded",function(){this.onCollectionFetchSuccess(b)}.createDelegate(this))}else{if(b.collectionContainer&&_.isString(b.collectionContainer)){var c=b.collectionContainer.split(/\s*,\s*/);var e=c.length;var d=0;_.each(c,function(g){var h=$j(g);var i=helpers.createComponentElementParameters(h,b.page,b.feedManager,b.mediaManager,b.messageManager,b.applicationVariables);this.dynamicContainer=new JSEngine.DynamicContainer(i);this.dynamicContainer.on("dataLoaded",function(){if(++d===e){this.onCollectionFetchSuccess(b)}}.createDelegate(this))},this)}else{this.onCollectionFetchSuccess(b)}}},onCollectionFetchSuccess:function(a){this.initialised=true;el=a.el;this._COMPONENT=el;this._CURRENT_CLASS=el.data("currentClass")||"current";this._TAG_NAV_CONT=el.data("tabNavigation")||".tab-navigation";this._TAG_LINK_INDENTIFIER=el.data("tagLink")||"a";this._TAB_NAVIGATION=this._COMPONENT.find(this._TAG_NAV_CONT);this._TAB_LINKS=this._TAB_NAVIGATION.find(this._TAG_LINK_INDENTIFIER);this._FIRST_TAB_LINK=this._TAB_LINKS.first();this._TAB_PANELS=this._COMPONENT.find(".panel");this._FIRST_TAB_PANEL=this._TAB_PANELS.first();this._TAB_HEADERS=this._COMPONENT.find(".tab-header");this._TAB_HEADERS.wrapInner($j('<a href="#"></a>'));this._TAB_HEADER_LINKS=this._COMPONENT.find(".tab-header a");this.prepare();this.attachTabEvent()},attachTabEvent:function(){var a=this;this._TAB_LINKS.each(function(){$j(this).bind("click",function(c){c.preventDefault();if($j(this).attr("class")!==a._CURRENT_CLASS){var b="a"+$j(this).attr("href");a.clearLinks();a.hidePanels();$j(this).attr("class",a._CURRENT_CLASS);a._COMPONENT.find(b).parent().show().attr("aria-hidden","false");a.page.trigger("tabComponentsTabChange",c.target)}})});this._TAB_HEADER_LINKS.bind("click",function(c){c.preventDefault();var b="#"+$j(this).parent().next().find("a.named-anchor").attr("id");a._TAB_LINKS.filter('a[href="'+b+'"]').trigger("click")})},prepare:function(){this._TAB_PANELS.attr("role","tabpanel");this._TAB_NAVIGATION.attr("role","tablist");this._TAB_LINKS.attr("role","tab");this._TAB_LINKS.each(function(){$j(this).attr("id",this.hash.substr(1).replace("anchor","link"))});this._TAB_PANELS.each(function(){if($j(this).find("a.named-anchor").attr("id")){var a=$j(this).find("a.named-anchor").attr("id").replace("anchor","link");$j(this).attr("aria-labelledby",a)}});this.hidePanels();this._FIRST_TAB_LINK.addClass(this._CURRENT_CLASS);this._FIRST_TAB_PANEL.show().attr("aria-hidden","false")},clearLinks:function(){this._TAB_LINKS.removeClass(this._CURRENT_CLASS)},hidePanels:function(){this._TAB_PANELS.hide().attr("aria-hidden","true")}});namespace("JSEngine.Widgets");JSEngine.Widgets.NavigationIndicator=JSEngine.Widgets.DynamicContainerWidget.extend({commaRegex:/\,/,initialize:function(a){var b=[];helpers.assertParametersExistAndAddToObject(a,["el","page","applicationVariables","feedManager","mediaManager","messageManager"],this);this._attributes={onstateAddClass:null,onstateRemoveClass:null,uriSplitBefore:null,uriSplitAfter:null,refSplitBefore:null,refSplitAfter:null,target:"a",matchType:"exact",buttonLink:null,displayPosition:null,displayPositionTwo:null,displayPositionThree:null,matchOn:"href",matchOnPrefix:null,matchOnSuffix:null,preventDefaultOnstate:false};this.navButtonAttributes={onstateAddClass:null,onstateRemoveClass:null,menuOnstateAddClass:null,menuOnstateRemoveClass:null,closeCover:null,coverOnstateRemoveClass:"hide",coverOnstateAddClass:null};this.prepareList=["onstateAddClass","onstateRemoveClass","matchOn","uriSplitBefore","uriSplitAfter","refSplitBefore","refSplitAfter"];this.navButtonPrepareList=["onstateAddClass","onstateRemoveClass","menuOnstateAddClass","menuOnstateRemoveClass","coverOnstateAddClass","coverOnstateRemoveClass"];this.displayPositionsAttributes=["displayPosition","displayPositionTwo","displayPositionThree"];this.jQueryfyList=["buttonLink","displayPosition","displayPositionTwo","displayPositionThree"];this._history={current:{},previous:{}};this.matcher=JSEngine.WidgetUtils.Matcher;this.jQueryfy=JSEngine.WidgetUtils.jQueryfy;this.touch=Modernizr.touch;this.buttonStatus=false;b=this.el.data("dynamicContainer")||this.el.data("dynamicContainers");this.initSubNavPositioningOnWindowResize();if(!b){this._postInit(this.el);return}b=b.split(this.commaRegex);_.each(b,function(c){c=$j.trim(c);this.createDynamicContainer($j(c),function(){this._postInit(this.el)}.createDelegate(this))}.createDelegate(this))},_postInit:function(c){var e,d=this,b=this.realiseAttributes(c),a;this.prepare(b,this.prepareList);this.jQueryfy(this.jQueryfyList,b);if(this.isJQuery(b.buttonLink)){this.btn=this.buttonInitialise(b.buttonLink)}if(b.preventDefaultOnstate){if(!b.onstateAddClass){b.onstateAddClass=_.uniqueId("onstate-")}a=new RegExp("(^|\\s+)"+b.onstateAddClass+"(\\s+|$)");this.el.find(b.target).on("click",function(f){if(!!this.className.match(a)){f.preventDefault()}})}e=c.attr("id")||_.uniqueId("nav_indicator_");JSEngine.HashChange.activate(e,function(f){helpers.setTimeout(function(){d.respond(f)},300)})},buttonInitialise:function(b){var a,c=this;b=b||this._attributes.buttonLink;a=this.realiseAttributes(b,this.navButtonAttributes);if(this.navButtonAttributes.closeCover){this.navButtonCoverInitialise(this.navButtonAttributes)}this.prepare(a,this.navButtonPrepareList);b.on("click",function(d){d.preventDefault();c.buttonHandle(d)});return b},navButtonCoverInitialise:function(a){a.closeCover=$j(a.closeCover);if(a.closeCover.length>0){$j(window).on("resize",function(){this.setCloseCoverSize()}.createDelegate(this));this.closeCoverSet=true}},setCloseCoverSize:function(){if(this.navButtonAttributes.closeCover&&this.navButtonAttributes.closeCover.length>0){this.navButtonAttributes.closeCover.css({width:$j("html").outerWidth(),height:$j("html").outerHeight()})}},realiseAttributes:function(c,a){var d,b;a=a||this._attributes;_.each(a,function(f,e){b=c.data(e);if(!this.isNullOrVoid(b)){a[e]=b}}.createDelegate(this));return a},prepare:function(a,b){if(!(a&&b)){return[]}_.each(b,function(c){a[c]=helpers.attributeValueToArray(a[c]," ")});return a},preparePipeString:function(a){if(_.isArray(a)&&a.length>1){return a.join("|")}else{return a[0]}},addSlashes:(function(){var a=/([^A-z0-9\t\s])/g;return function(b){return b.replace(a,"\\$1")}}()),split:function(d,a,e){var c,b;if(a.length>0){b=this.preparePipeString(a);c=new RegExp("("+b+")(.*)");if(e==="before"){d=d.replace(c,"")}else{if(e==="after"){result=c.exec(d);if(result&&result[2]){d=result[2]}}}}return d},prepareHashForMatch:function(b){var a=this._attributes;b=this.split(b,a.uriSplitBefore,"before");b=this.split(b,a.uriSplitAfter,"after");b=a.matchOnPrefix?a.matchOnPrefix+b:b;b=a.matchOnSuffix?b+a.matchOnSuffix:b;return b},respond:function(e){var b,d,f,c,a;b=this._attributes;e=this.prepareHashForMatch(e);f=this;if(this.matcher._contains(b.matchType,"greatest")||b.matchType==="closest-match"){this.matcher._greatestReset()}_.each(b.matchOn,function(g){f.el.find(b.target).each(function(){var i,j,h=$j(this);j=h.attr(g);if(f.isNullOrVoid(j)){return}j=f.split(j,b.refSplitBefore,"before");j=f.split(j,b.refSplitAfter,"after");if(e===""){if(e===j){c=h}}else{i=f.matcher[b.matchType];if(j&&i&&_.isFunction(i)){a=f.matcher[b.matchType](e,j);if(a===true){a=false;c=h}}}})});if(_.isEmpty(this._history.current)){this._history.current={id:e,el:c}}else{if(this._history.current.id!==e){this._history.previous=_.clone(this._history.current);this._history.current.id=e;this._history.current.el=c}}this.updateUI({current:this._history.current.el,previous:this._history.previous.el});if(this._history.current.el&&this._history.current.el.hasClass(b.onstateAddClass)&&!c.hasClass(b.onstateAddClass)){c.addClass.apply(c,b.onstateAddClass)}return c},updateUI:function(f){var b,g,e,c,a,d;b=this._attributes;e=[b.displayPosition,b.displayPositionTwo,b.displayPositionThree];if(b.onstateAddClass.length>0){this.el.find("."+b.onstateAddClass).removeClass.apply(this.el.find("."+b.onstateAddClass),b.onstateAddClass);if(f.previous){f.previous.removeClass.apply(f.previous,b.onstateAddClass)}if(f.current){f.current.addClass.apply(f.current,b.onstateAddClass)}}if(b.onstateRemoveClass.length>0){if(f.previous){f.previous.addClass.apply(f.previous,b.onstateRemoveClass)}if(f.current){f.current.removeClass.apply(f.current,b.onstateRemoveClass)}}g=f.current&&_.isFunction(f.current.text)?f.current.text():"";_.each(e,function(h){if(!_.isNull(h)&&h.length>0){h.html(g)}});this.setSubNavPosition()},buttonHandle:function(g,c){var b,h,d,a,f;if(!c){g.preventDefault()}a=this.btn;d=this.el;b=this.navButtonAttributes;h=this;f=function(i){h.el.off("click",f);if(h.el.find(i.target).length>0){h.closeCoverSet=false;b.closeCover.off("click",f);if(b.coverOnstateAddClass.length>0){b.closeCover.removeClass.apply(b.closeCover,b.coverOnstateAddClass)}if(b.coverOnstateRemoveClass){b.closeCover.addClass.apply(b.closeCover,b.coverOnstateRemoveClass)}h.buttonHandle(i,true);return}if(h.closeCoverSet){h.closeCoverSet=false;b.closeCover.off("click",f);if(b.coverOnstateAddClass.length>0){b.closeCover.removeClass.apply(b.closeCover,b.coverOnstateAddClass)}if(b.coverOnstateRemoveClass){b.closeCover.addClass.apply(b.closeCover,b.coverOnstateRemoveClass)}}h.buttonHandle(i)};if(this.closeCoverSet){this.closeCoverSet=false;if(b.coverOnstateAddClass.length>0){b.closeCover.removeClass.apply(b.closeCover,b.coverOnstateAddClass)}if(b.coverOnstateRemoveClass){b.closeCover.addClass.apply(b.closeCover,b.coverOnstateRemoveClass)}}if(this.buttonStatus){if(b.onstateAddClass.length>0){a.removeClass.apply(a,b.onstateAddClass)}if(b.onstateRemoveClass.length>0){a.addClass.apply(a,b.onstateRemoveClass)}if(b.menuOnstateAddClass.length>0){d.removeClass.apply(d,b.menuOnstateAddClass)}if(b.menuOnstateRemoveClass.length>0){d.addClass.apply(d,b.menuOnstateRemoveClass)}this.buttonStatus=false}else{if(b.onstateAddClass.length>0){a.addClass.apply(a,b.onstateAddClass)}if(b.onstateRemoveClass.length>0){a.removeClass.apply(a,b.onstateRemoveClass)}if(b.menuOnstateAddClass.length>0){d.addClass.apply(d,b.menuOnstateAddClass)}if(b.menuOnstateRemoveClass.length>0){d.removeClass.apply(d,b.menuOnstateRemoveClass)}if(b.closeCover){if(b.closeCover.length>0){helpers.setTimeout(function(){this.setCloseCoverSize();if(b.coverOnstateRemoveClass.length>0){b.closeCover.removeClass.apply(b.closeCover,b.coverOnstateRemoveClass)}if(b.coverOnstateAddClass.length>0){b.closeCover.addClass.apply(b.closeCover,b.coverOnstateAddClass)}this.closeCoverSet=true;b.closeCover.on("click",f)}.createDelegate(this),100)}}this.el.on("click",f);this.buttonStatus=true}},isJQuery:function(a){return a instanceof jQuery},isNullOrVoid:function(a){if(a===null||a===void 0){return true}return false},subNavPositioningIsEnabled:function(){var a=this.attributes.subnavPositioningEnabledWhen;return !!(a&&(a===true||(window.matchMedia(a)||{}).matches))},setSubNavPosition:function(){var a=$j(window).width();if(this.subNavPositioningIsEnabled()){this.el.find("li > ul").each(function(){var e=$j(this),h=e.attr("id"),g=$j("#"+h+"-parent"),c={},b,f,d;e.css({display:"block",position:"static",visiblity:"hidden"});c.width=e.width();if(g.length){c.parentLink={};c.parentLink.left=g.offset().left;c.parentLink.width=g.width();b=Math.round(c.parentLink.left+(c.parentLink.width/2)-(c.width/2));f=0;d=10;if(b+c.width>=a){f=b+c.width-a;d=0}e.css({left:b-f-18,"margin-left":d})}e.css({display:"",position:"",visiblity:""})})}else{this.el.find("li > ul").attr("style","")}},initSubNavPositioningOnWindowResize:function(){if(this.attributes.subnavPositioningEnabledWhen){$j(window).on("resize",_.debounce(this.setSubNavPosition.createDelegate(this),50));if(this.page.pageManager){this.page.pageManager.on("pageChanged",this.setSubNavPosition.createDelegate(this))}}}});namespace("JSEngine.Widgets");JSEngine.Widgets.SimpleScroll=Backbone.Model.extend({initialize:function(a){helpers.assertParametersExistAndAddToObject(a,["el"],this);var b;if(a.hasOwnProperty("enabledWhen")){b=window.matchMedia(a.enabledWhen);this.scrollEnabled=b.matches;b.addListener(function(){this.scrollEnabled=b.matches}.createDelegate(this))}else{this.scrollEnabled=true}this.location=$j(a.cssSelector);this.offset=a.offsetFromTop||50;this.speed=a.speed||"slow";this.preventDefault=a.preventDefault||false;this.anchorOnNewPage=a.anchorOnNewPage||false;this.scrollableTarget=a.scrollableTarget||"html,body";if(this.anchorOnNewPage){this.el.click(function(c){if(this.scrollEnabled){a.page.pageManager.setScrollOnNewPage({scrollableTarget:this.scrollableTarget,selector:a.cssSelector,offset:this.offset,speed:this.speed})}}.createDelegate(this))}else{if(this.location&&this.location.length>0){this.el.click(function(c){if(this.scrollEnabled){$j("html,body").animate({scrollTop:this.location.offset().top-this.offset},this.speed)}if(this.preventDefault){c.preventDefault()}}.createDelegate(this))}}}});namespace("JSEngine.Widgets");JSEngine.Widgets.SwiperCarousel=Backbone.Model.extend({idMatcher:/^\#([\w]*)$/,spaceMatcher:/(\s+)/g,swiperEnabled:true,initialize:function(b){this.init=_.bind(this.init,this);this.onPageVisible=_.bind(this.onPageVisible,this);this.onDynamicContainerChange=_.bind(this.onDynamicContainerChange,this);var c,a;helpers.assertParametersExistAndAddToObject(b,["el","swiperContainerSelector","page","applicationVariables","feedManager","mediaManager","messageManager"],this);helpers.addParametersToObjectIfExist(b,["disableAutoResize","ignoreAria","responsiveModeSwitch","mode","initialSlide"],this);this.options=b;this.onResize=this.onResize.createDelegate(this);this.slideClass="."+(b.slideClass||(b.slideClass="swiper-slide"));this.wrapperClass="."+(b.wrapperClass||(b.wrapperClass="swiper-wrapper"));this.restartOnPageVisible=(b.restartOnPageVisible)?b.restartOnPageVisible:false;this.extraWrapperClasses=b.extraWrapperClasses||[];if(b.nextPreviousEvent){this.nextPreviousEvent=b.nextPreviousEvent}if(_.isUndefined(b.speed)){b.speed=300}b.mode=b.mode||"horizontal";this.slidesPerSlide=b&&!_.isUndefined(b.slidesPerSlide)?b.slidesPerSlide:1;this.slidesPerPage=_.isUndefined(b.slidesPerPage)?1:b.slidesPerPage;this.pagination=b.pagination=b&&!_.isUndefined(b.pagination)?b.pagination:"";this.createPagination=b&&!_.isUndefined(b.createPagination)?b.createPagination:false;this.paginationAsNavigation=b&&!_.isUndefined(b.paginationAsNavigation)?b.paginationAsNavigation:true;this.initNavigation(b);this.container=this.el.find(this.swiperContainerSelector);if(this.container.length===0){this.container=$j(this.swiperContainerSelector)}this.container.on("toggleDisabled",function(){this.toggleSwiper(false)}.createDelegate(this));if(!this.swiperContainerSelector.match(this.idMatcher)){c=this.contextualize(this.el);this.swiperContainerSelector=c+" "+this.swiperContainerSelector}if(b.refreshSwiperOnToggle){this.container.on("toggleSwiperRefresh",function(){if(this.swiper){if(this.el.find(".swiper-slide").length>0){var d=function(){this.swiper.reInit();this.swiper.createPagination()}.createDelegate(this);if(_.isNumber(b.refreshSwiperOnToggle)){helpers.setTimeout(d,b.refreshSwiperOnToggle)}else{d()}}}}.createDelegate(this))}this.applicationVariables=b.applicationVariables;this.feedManager=b.feedManager;this.mediaManager=b.mediaManager;this.messageManager=b.messageManager;a=$j("body");this.oldBrowser=(a.hasClass("ie6")||a.hasClass("ie7")||a.hasClass("ie8")||!document.querySelectorAll)?true:false;if(this.container.length===0){throw new Error("Unable to create SwiperCarousel as the container with selector '"+this.swiperContainerSelector+"' was not found")}if(this.container.data("type")=="JSEngine.DynamicContainer"){this.createDynamicContainer(JSEngine.DynamicContainer)}else{if(this.container.data("type")=="JSEngine.NewDynamicContainer"){this.createDynamicContainer(JSEngine.NewDynamicContainer);this.dynamicContainer.on("change",this.onDynamicContainerChange);this.dynamicContainer.on("clear",this.onDynamicContainerClear.createDelegate(this))}else{if(this.container.data("type")=="JSEngine.SortableContainer"){this.createSortableContainer()}else{this.init()}}}this.page.on("renderContent",this.onPageVisible);this.page.on("afterActivate",this.onPageVisible);if(this.options.reinitOnFeed&&this.dynamicContainer&&this.dynamicContainer.collection){this.dynamicContainer.collection.once("fetchSuccess",function(){this.dynamicContainer.collection.on("fetchSuccess",function(){this.reInitSwiper()}.createDelegate(this))}.createDelegate(this))}},contextualize:function(d){var c,b,e,a;if(!d.context){return d}c=d.context;a=c.tagName||"";b=(c.className||"").replace(this.spaceMatcher,".");e=c.id?"#"+c.id:"";return a+e+(b?"."+b:"")},onPageVisible:function(){if(this.swiper&&_.isFunction(this.swiper.resizeFix)){this.swiper.resizeFix();if(this.restartOnPageVisible){this.swiper.swipeTo(this.initialSlide?this.initialSlide:0,0);this.swiper.startAutoPlay()}}},onDynamicContainerClear:function(){if(this.swiper){$j(this.swiper.wrapper).css("left","0px")}},onDynamicContainerChange:function(){if(this.swiper){this.swiper.wrapper=this.container.children().first()[0];this.swiper.reInit()}else{this.init()}},createDynamicContainer:function(a){var b=helpers.createComponentElementParameters(this.container,this.page,this.feedManager,this.mediaManager,this.messageManager,this.applicationVariables);this.dynamicContainer=new a(b);this.dynamicContainer.on("dataLoaded",this.init);if(this.page.isActive&&this.dynamicContainer.collection.hasBeenFetched){this.init();helpers.setTimeout(function(){this.swiper.resizeFix()}.createDelegate(this),500)}},reInitSwiper:function(){if(!_.isUndefined(this.swiper)&&this.page.isActive){this.swiper.destroy();this.swiper=new Swiper(this.swiperContainerSelector,this.swiperOptions);this.swiper.resizeFix();this.initPagination()}},createSortableContainer:function(){var b=helpers.createComponentElementParameters(this.container,this.page,this.feedManager,this.mediaManager,this.messageManager,this.applicationVariables);this.dynamicContainer=new JSEngine.SortableContainer(b);var a=function(){if(this.container.find(".swiper-wrapper").children().length==0){return}this.init.call(this);this.dynamicContainer.on("dataLoaded",function(){if(this.container.find(".swiper-wrapper").children().length==0){return}if(!_.isUndefined(this.swiper)){this.swiper.reInit()}}.createDelegate(this));this.dynamicContainer.off("dataLoaded",a)}.createDelegate(this);this.dynamicContainer.on("dataLoaded",a)},init:function(){if(this.el.data("hasSwiper")){return}var i,a,b,d,h,c;try{this.mode=this.matchModeResponsive(this.options.mode,this.options.responsiveModeSwitch);i=_.clone(this.options);i.mode=this.mode;i.resizeEvent="resize";this.loop=this.options.loop||false;if(this.options.holdPlugin){i.plugins={hold:this.holdPlugin};i.hold=true}if(!_.isUndefined(this.disableAutoResize)){i.disableAutoResize=this.disableAutoResize}else{i.disableAutoResize=true}if(!_.isUndefined(this.initialSlide)){i.initialSlide=this.initialSlide}else{i.initialSlide=0}if(!_.isUndefined(this.ignoreAria)){i.ignoreAria=this.ignoreAria}else{i.ignoreAria=false}this.swiperOptions=i;this.swiper=new Swiper(this.swiperContainerSelector,i);this.swiper.resizeFix();this.resetNavigationButtons();this.el.data("hasSwiper",true);if($j(this.swiperContainerSelector).closest("ul[data-accordion-active]")){var g=this;$j(this.swiperContainerSelector).closest("ul[data-accordion-active]").on("ua-slide-changed",function(){g.swiper.resizeFix()})}i.onSlideChangeStart=this.options.onSlideChangeStart;if(this.options.mouseInterrupt){this.el.off();a=function(){this.mouseInterrupted=!this.mouseInterrupted;if(this.mouseInterrupted){this.swiper.stopAutoPlay()}else{this.swiper.startAutoPlay()}}.createDelegate(this);this.el.hover(a,a)}h=this.el.find(this.wrapperClass);h.addClass.apply(h,this.extraWrapperClasses);if(this.oldBrowser){this.completeFallback=!_.isFunction(this.swiper.swipeNext);if(!this.completeFallback){c=h.parent();if(c.css("position")==="static"){c.css("position","relative")}h.css("position","absolute")}else{this.initFallback(this.options);this.setAutoplayFallback(this.options.autoPlay)}}if(this.pagination&&this.createPagination&&this.paginationAsNavigation){this.initPagination()}if(this.options.jsonPathToMatcher){this.matchPathToAppVariable(this.applicationVariables,this.options.jsonPathToMatcher)}this.swiper.fixLinks();if(!_.isUndefined(this.options.responsiveModeSwitch)){$j(window).on("resize",this.onResize)}this.fixWidth();this.createChildElementWrapper();this.firstInit=false}catch(f){console.warn("Error initialising Carousel",this.el.getPath(),f.message);throw f}},holdPlugin:function(a,g){var d=0;var f=0;var e;var b=33;var c={onSetTransform:function(i){if(f>d){d=f}if(e){return}var h=i.x,n=i.y;var k=$j(".ae-dragging").offsetParent();var m=0;var l=0;if(k.length>0){m=k.position().left;l=k.position().top}var j=function(){var q=$j(".ae-dragging");d-=b;if(d<0){helpers.clearInterval(e);e=undefined}if(q.length>0){var p=q.offsetParent().position().left-m;var o=q.offsetParent().position().top-l;m=q.offsetParent().position().left;l=q.offsetParent().position().top;if(Modernizr.touch){q.trigger("touchmove",{pageX:q.offset().left-p,pageY:q.offset().top-o})}else{q.trigger("move",{pageX:q.offset().left-p,pageY:q.offset().top-o})}}};e=helpers.setInterval(j,b)},onSetTransition:function(h){f=h.duration}};return c},matchPathToAppVariable:function(a,c){var b=jsonPath(a,c);if(!_.isArray(b)||b.length===0){return}b=b[0];this.el.find(this.slideClass).each(function(d,e){if(e.getAttribute("data-matcher")===b){this.swiper.swipeTo(d,this.slidesPerSlide);if(this.oldBrowser){this.setSlide(d,this.slidesPerSlide)}}}.createDelegate(this))},setAutoplayFallback:function(c){var b,a=false;if(!c){return}b=true;this.loopAutoPlayInterval=setInterval(function(){if(b&&!this.mouseInterrupted){b=false;this.navigateFallBack("next")}b=true}.createDelegate(this),c)},initNavigationHover:function(b){this.nextButton=this.el.find(b.nextButton);this.previousButton=this.el.find(b.previousButton);var a;this.nextButton.on("mouseover",function(d){var c=function(){this.swiper.swipeNext()}.createDelegate(this);a=helpers.setInterval(c,b.speed)}.createDelegate(this));this.nextButton.on("mouseout",function(c){if(a){helpers.clearInterval(a)}});this.previousButton.on("mouseover",function(d){var c=function(){this.swiper.swipePrev()}.createDelegate(this);a=helpers.setInterval(c,b.speed)}.createDelegate(this));this.previousButton.on("mouseout",function(c){if(a){helpers.clearInterval(a)}})},resetNavigationButtons:function(){if(this.slidesPerPage===1||_.isUndefined(this.swiper.slides)){return}var b=Math.ceil(this.swiper.slides.length/this.slidesPerPage)-1;var a=Math.ceil(this.swiper.activeIndex/this.slidesPerPage);if(a===0){this.previousButton.addClass("ae-hide")}else{this.previousButton.removeClass("ae-hide")}if(a===b){this.nextButton.addClass("ae-hide")}else{this.nextButton.removeClass("ae-hide")}},initNavigation:function(a){this.nextButton=this.el.find(a.nextButton);this.previousButton=this.el.find(a.previousButton);if(this.nextPreviousEvent&&this.nextPreviousEvent==="hover"){this.initNavigationHover(a)}this.nextButton.on("click",function(c){var b;c.preventDefault();if(!(this.swiper&&!this.completeFallback)){this.navigateFallBack("next");return}if(a.loop){this.swiper.swipeNext();if(this.completeFallback){this.setSlide(this.swiper.activeIndex+1,this.slidesPerSlide)}}else{if(a.slidesPerSlide=="auto"){b=this.swiper.activeIndex+1}else{b=this.swiper.activeIndex+a.slidesPerSlide}if(this.completeFallback){this.swiper.swipeTo(b);this.setSlide(this.swiper.activeIndex,a.slidesPerSlide);return}while(!this.swiper.swipeTo(b)){if(b<0){break}b--}this.resetNavigationButtons.call(this)}}.createDelegate(this));this.previousButton.on("click",function(c){var b;c.preventDefault();if(!(this.swiper&&!this.completeFallback)){this.navigateFallBack("prev");return}if(a.loop){this.swiper.swipePrev()}else{if(a.slidesPerSlide=="auto"){b=this.swiper.activeIndex-1}else{b=this.swiper.activeIndex-a.slidesPerSlide}if(b<0){b=0}this.swiper.swipeTo(b);this.resetNavigationButtons.call(this)}}.createDelegate(this))},initPagination:function(){$j(this.pagination).find("> span").each(function(b,a){$j(a).on("click",function(d){var c=b;this.swiper.stopAutoPlay();this.swiper.swipeTo(b);this.swiper.startAutoPlay();if(this.completeFallback){this.setSlide(c,this.slidesPerSlide)}}.createDelegate(this))}.createDelegate(this))},setSlide:function(b,d){var c=this.el.find(this.slideClass),f=c.length-1,a,e;d=d||1;if(f<1){return}if(d<2){c.each(function(h,g){if(h===b){$j(g).show();if(this.paginate){this.setPaginationFallBack(h,true)}}else{$j(g).hide();if(this.paginate){this.setPaginationFallBack(h,false)}}}.createDelegate(this))}else{a=(b+d)-1;c.each(function(h,g){if(h>=b&&h<=a){$j(g).show();if(this.paginate){this.setPaginationFallBack(h,true)}}else{$j(g).hide();if(this.paginate){this.setPaginationFallBack(h,false)}}}.createDelegate(this))}this.slideIndex=b},initFallback:function(b){var c,a="";this.slideIndex=0;this.slideCount=this.el.find(this.slideClass).length;this.setSlide(this.slideIndex,this.slidesPerSlide);if(!b.createPagination||this.slideCount===1){return}if(!b.pagination){console.warn('Please set a pagination selector e.g. data-pagination="#selector"');return}this.paginate=true;this.paginationContainer=$j(b.pagination);this.paginationClass=b.paginationClass||"swiper-pagination-switch";this.paginationActiveClass=b.paginationActiveClass||"swiper-active-switch";for(c=0;c<this.slideCount;c++){a+='<span class="'+this.paginationClass+'"></span>'}this.paginationContainer.html(a);this.setPaginationFallBack(0,true)},navigateFallBack:function(a){if(a==="next"){if(this.slideIndex===(this.slideCount-1)){this.slideIndex=-1}this.setSlide(this.slideIndex+1,this.slidesPerSlide)}else{if(a==="prev"){if(this.slideIndex===0){this.slideIndex=this.slideCount-1}this.setSlide(this.slideIndex-1,this.slidesPerSlide)}else{if(typeof a==="number"){}}}},setPaginationFallBack:function(b,a){if(a){this.paginationContainer.children().eq(b).addClass(this.paginationActiveClass)}else{this.paginationContainer.children().eq(b).removeClass(this.paginationActiveClass)}},createChildElementWrapper:function(){this.childElementWrapper=new JSEngine.ElementWrapper({el:this.container,applicationVariables:this.applicationVariables,page:this.page,feedManager:this.feedManager,mediaManager:this.mediaManager,messageManager:this.messageManager})},toggleSwiper:function(a){if(this.swiperEnabled){if(_.isUndefined(this.swiper)){return}this.swiper.destroy(true);this.container.find("> .swiper-wrapper").css("width","");this.container.find("> .swiper-wrapper").css("height","");$j(window).off("resize",this.onResize);if(_.isUndefined(a)||a){delete this.swiper}}else{delete this.swiper;this.init()}this.swiperEnabled=!this.swiperEnabled},cleanUp:function(){if(this.swiper){this.swiper.destroy(true);delete this.swiper}this.swiperEnabled=false;this.el.data("hasSwiper",false);this.el.empty();$j(this.swiperContainerSelector).empty();if(this.dynamicContainer){this.dynamicContainer.cleanUp()}if(this.childElementWrapper){this.childElementWrapper.cleanUp()}this.off();this.page.off("renderContent",this.onPageVisible);this.page.off("afterActivate",this.onPageVisible)},fixWidth:function(a){if(this.el.is(":visible")){if(a){this.el.css("width","")}this.el.width(Math.round(parseFloat(this.el.width())))}},onResize:function(a){a.preventDefault();if(_.isUndefined(this.swiper)){return}this.fixWidth(true);this.swiper.resizeFix()},matchModeResponsive:function(f,a){if(_.isUndefined(a)){return f}var c=a;var d="";try{var e=JSON.parse(a);if(_.isArray(e)){e=e[0]}c=e.query;d=e.swiperMode}catch(b){}if(helpers.matchMedia(c).matches){if(!_.isEmpty(d)){return d}else{return((f==="horizontal")?"vertical":"horizontal")}}else{return f}}});namespace("JSEngine.Widgets");JSEngine.Widgets.LanguageLink=Backbone.Model.extend({initialize:function(a){helpers.assertParametersExistAndAddToObject(a,["el"],this);this.langLink=this.el;this.page=this.langLink.data("page");this.language=this.langLink.data("lang");this.deepLink=this.langLink.data("deep-link");this.mapping=a.applicationVariables?a.applicationVariables.pageLanguageMapping:null;this.el.click(function(g){var d=/\b-[A-z]+\b-\*.html/;if(g.preventDefault){g.preventDefault()}var b=helpers.getDocumentLocation();var f=helpers.getHashUrl(b.hash);var h=helpers.getStUrl(b.pathname);var c=null;if(this.language){if(h!=null){c=this.replaceLang(b,this.language)}else{c=this.replaceURL(b,this.language)}if(this.page){c=this.replaceFinalUrl(c,this.page)}else{if(this.mapping&&this.mapping[f]){c=this.replaceFinalUrl(c,this.mapping[f])}else{if(!this.deepLink){c=this.replaceFinalUrl(c,"")}}}if(c){helpers.changeDocumentLocation(c)}else{console.debug("Not possible to find the url for the language: "+this.language+"and page: "+this.page)}}}.createDelegate(this))},replaceURL:function(a,c){var b=/\/[A-z]+\/(index.*\.html)?$/;c="/"+c+"/";return a.pathname.replace(b,c+"$1")+a.hash},replaceLang:function(a,c){var b=/\b-[A-z]+\b-/;c="-"+c+"-";return a.pathname.replace(b,c)+a.hash},replaceFinalUrl:function(a,b){var c=a.split("#");return c[0]+b}});namespace("JSEngine.Widgets");JSEngine.Widgets.NotifyExitButton=Backbone.Model.extend({initialize:function(a){helpers.assertParametersExistAndAddToObject(a,["el"],this);this.el.click(function(b){this.appNotifyExit()}.createDelegate(this))},appNotifyExit:function(){InFlight.exit(function(a){if(a){console.log("JSEngine.IFAPIInitHelper InFlight error response: ",a)}else{console.log("JSEngine.IFAPIInitHelper succesfully notified app for exit")}})}});namespace("JSEngine.Widgets");JSEngine.Widgets.LockLink=Backbone.Model.extend({initialize:function(a){helpers.assertParametersExistAndAddToObject(a,["el","page","locksApplyOnActivate"],this);this.el.click(function(){a.page.pageManager.createLocks(a.locksApplyOnActivate)})}});namespace("JSEngine.Widgets");JSEngine.Widgets.SimpleLinkMatch=Backbone.Model.extend({initialize:function(a){helpers.assertParametersExistAndAddToObject(a,["el","page","applicationVariables","activeClass","urlMatchParams"],this);helpers.addParametersToObjectIfExist(a,["pageListener"],this);if(!this.hasOwnProperty("pageListener")){this.pageListener="activate"}if(this.pageListener==="none"){this.activate()}else{this.page.on(this.pageListener,this.activate.createDelegate(this))}},activate:function(){var b=0,c=0,d=this.urlMatchParams||{},a=this.applicationVariables.urlParams||{};_.each(d,function(f,e){if(a[e]===f){c++}b++});if(c===b){this.el.addClass(this.activeClass)}else{this.el.removeClass(this.activeClass)}}});namespace("JSEngine.Widgets");JSEngine.Widgets.UberAccordion=Backbone.Model.extend({initialize:function(a){this.render=_.bind(this.render,this);this.applyLoadTemplate=_.bind(this.applyLoadTemplate,this);this.onFetchFail=_.bind(this.onFetchFail,this);this.onFeedChange=_.bind(this.onFeedChange,this);helpers.assertParametersExistAndAddToObject(a,["el","page","applicationVariables","feedManager","mediaManager","messageManager"],this);this.config=a;this.headerTemplate=helpers.parseTemplateMarkup(this.el,a.headerTemplateSelector);this.itemTemplate=helpers.parseTemplateMarkup(this.el,a.itemTemplateSelector);this.loadingTemplate=helpers.parseTemplateMarkup(this.el,a.loadingTemplateSelector);this.noDataTemplate=helpers.parseTemplateMarkup(this.el,a.noDataTemplateSelector);this.container=a.accordionContainerSelector?this.el.find(a.accordionContainerSelector):this.el;this.accordionConfig={};_.each(a,function(e,c){if(c.indexOf("accordion")==0){var d=c.substring(c.indexOf("accordion")+9,c.length);d=d.substring(0,1).toLowerCase()+d.substring(1,d.length);this.accordionConfig[d]=e}}.createDelegate(this));this.view=new JSEngine.UberAccordionView({container:this.container,headerTemplate:this.headerTemplate,itemTemplate:this.itemTemplate,noDataTemplate:this.noDataTemplate,page:this.page,applicationVariables:this.applicationVariables,feedManager:this.feedManager,mediaManager:this.mediaManager,messageManager:this.messageManager});if(!_.isUndefined(this.el.data("collectionType"))){this.createContainer()}else{if(this.page.isActive){this.init()}else{var b=function(){this.page.off("afterActivate",b);this.init()}.createDelegate(this);this.page.on("afterActivate",b)}}},createContainer:function(){var a=helpers.createComponentElementParameters(this.container,this.page,this.feedManager,this.mediaManager,this.messageManager,this.applicationVariables);this.collection=this.feedManager.getDataCollection(this.el,this.applicationVariables,this.page);this.collection.on("fetchStart",this.applyLoadTemplate);this.collection.on("fetchSuccess",this.render);this.collection.on("fetchFail",this.onFetchFail);this.collection.on("feedChanging",this.onFeedChange);if(this.page.isActive&&this.collection.hasBeenFetched){this.render()}else{if(this.page.isActive&&!this.collection.hasBeenFetched){this.collection.trigger("reActivate",this.page,this.applicationVariables)}}},onFeedChange:function(){if(this.view){this.view.cleanUp()}},onFetchFail:function(a,b){},applyLoadTemplate:function(){if(!_.isEmpty(this.loadingTemplate)){var a=_.template(this.loadingTemplate,this.applicationVariables);this.container.html(a)}},init:function(){this.accordion=this.container.uberAccordion(this.accordionConfig)},cleanUp:function(){if(this.collection){this.collection.removeFromPageEvents(this.page);this.collection.off("fetchStart",this.applyLoadTemplate);this.collection.off("fetchSuccess",this.render);this.collection.off("fetchFail",this.onFetchFail)}},render:function(){var b=this.collection.models;try{this.view.render(this.applicationVariables,b);this.init()}catch(a){console.log("Error initialising UberAccordion",this.el.getPath(),a.message)}}});namespace("JSEngine.Widgets");JSEngine.Widgets.MatchDimensions=Backbone.View.extend({initialize:function(b){var a,e,f,d;helpers.assertParametersExistAndAddToObject(b,["el","page"],this);this.page=b.page;var c;if(b.hasOwnProperty("enabledWhen")){c=window.matchMedia(b.enabledWhen);this.resizeEnabled=c.matches;c.addListener(function(){this.resizeEnabled=c.matches}.createDelegate(this))}else{this.resizeEnabled=true}a=b.criticalsToMatch||b.criticalToMatch||"";a=a?a.split(" "):["height"];e=b.selectorsToMatch||b.selectorToMatch||"";f=e?this.el.find(e):this.el.children();d=b.reevalOnResize||true;if(this.page.isActive){this._postInit(f,a,d);this.page.on("afterActivate",_.bind(this._postInit,this,f,a,d))}else{this.page.on("afterActivate",_.bind(this._postInit,this,f,a,d))}},_postInit:function(b,c,a){this.loopCriticals(b,c);if(a&&window){this.setOnResize(b,c)}this.page.on("tabComponentsTabChange",function(d){this.loopCriticals(b,c)}.createDelegate(this))},loopCriticals:function(a,b){_.each(b,function(c){if(c){if(this.resizeEnabled){this.match(a,c)}else{a[c]("auto")}}},this)},setOnResize:function(a,b){$j(window).on("resize",function(){this._postInit(a,b)}.createDelegate(this))},match:function(d,e){var c,a;if(_.isFunction(d[e])){d[e]("auto");c=d.map(function(){if(e==="height"&&!$j(this).is(":visible")){return 0}else{return $j(this)[e]()}}).get();if(e==="height"){var b=_.reduce(c,function(f,g){return f+(g>0?1:0)},0);if(b>1){d[e](Math.max.apply(null,c))}else{d[e]("")}}else{d[e](Math.max.apply(null,c))}}}});namespace("JSEngine.Widgets");JSEngine.Widgets.AlphaNavigationBar=Backbone.Model.extend({initialize:function(a){helpers.assertParametersExistAndAddToObject(a,["el","page","applicationVariables","feedManager","mediaManager","messageManager","pager","path"],this);this.config=a;this.container=a.alphaNavSelector?this.el.find(a.alphaNavSelector):this.el;this.showAllAlphaLetters=a.showAllAlphaLetters||false;this.removeActiveClassDelay=a.removeActiveClassDelay||2000;this.page.onAsync("beforePageShow",this.beforePageShow.createDelegate(this))},beforePageShow:function(a,d,b){if(!this.collection){var c=this.page.el.find(".collection-container[data-pager='"+this.pager+"' ]");this.collection=this.feedManager.getCollectionByOwnerEl(c)?this.feedManager.getCollectionByOwnerEl(c).collection:"";if(this.collection){this.pagingCount=c.data("pagingCount");this.collection.on("fetchSuccess",this.renderItems.createDelegate(this));if(this.collection.hasBeenFetched){this.renderItems()}}}a()},handleLetters:function(){var c={};var b={};c.notUsed={};_.each(this.collection.models,function(g,f){var i=jsonPath(g.attributes,this.path);if(i.length>0){var h=i[0];var e=h.substring(0,1).toUpperCase();if(!/[A-Z]/i.test(e)){e="#"}if(!c[e]){var d=Math.floor(f/this.pagingCount);c[e]=d}if(!b[e]){b[e]=[]}b[e].push(h)}}.createDelegate(this));if(this.showAllAlphaLetters){var a=0;_.each("ABCDEFGHIJKLMNOPQRSTUVWXYZ#".split(""),function(e,d){if(!c[e]){c[e]=a}else{a=c[e]}if(!b[e]){c.notUsed[e]=true}else{c.notUsed[e]=false}}.createDelegate(this))}return this.sortLetter(c)},renderItems:function(){var f=$j("<ul/>"),g={},i={},c,d,e,h,b,a;g=this.handleLetters();i=g.notUsed;delete g.notUsed;c=this.container;h=JSEngine.PagerHelpers.getPageParams(this.pager,this.applicationVariables);b=!_.isEmpty(h)?h.letter:"";c.empty();c.append(f);d=$j('<div class="ae-alpha-nav-overlay" />').appendTo(c);_.each(g,function(k,m){var l=i[m]?" ae-alpha-nav-letter-disabled":"";var j=$j('<li class="ae-alpha-nav-letter-'+m+l+'">'+m+"</li>");if(b&&m===b){a=j}if(!i[m]){j.on("click",this.onClickHandler.createDelegate(this,[j,k,m,d],1))}f.append(j)},this);this.setClasses(d,null,a,null,b);this.timeout=helpers.setTimeout(this.removeActiveOverlayClass.createDelegate(this),this.removeActiveClassDelay||1000)},onClickHandler:function(g,d,a,f,c){var b;g.preventDefault();b=JSEngine.PagerHelpers.getChangeToPageParams(this.pager,a,this.applicationVariables,{letter:f});this.page.navigateToPageWithExtendedParams(b);this.setClasses(c,currentLink,d,currentLetter,f);helpers.clearTimeout(this.timeOut);this.timeOut=helpers.setTimeout(this.removeActiveOverlayClass.createDelegate(this),this.removeActiveClassDelay||1000)},setClasses:function(d,b,c,e,a){if(a){e=e||"";d.removeClass("ae-alpha-nav-letter-overlay-"+e).addClass("ae-alpha-nav-letter-overlay-"+a).addClass("ae-alpha-nav-active-overlay").data("letterOverlay",a).text(a);if(b){b.removeClass("ae-alpha-nav-selected")}c.addClass("ae-alpha-nav-selected")}else{a="A"}currentLetter=a;currentLink=c},removeActiveOverlayClass:function(){$j(".ae-alpha-nav-active-overlay").removeClass("ae-alpha-nav-active-overlay");this.busy=false},sortLetter:function(d){var c=[];var e={};var a=false;for(var b in d){if(d.hasOwnProperty(b)){c.push(b)}}c.sort();_.each(c,function(f){if(f!="#"){e[f]=d[f]}else{a=true}});if(a){e["#"]=d["#"]}return e}});namespace("JSEngine.Widgets");JSEngine.Widgets.ToggleButton=Backbone.Model.extend({initialize:function(c){helpers.assertParametersExistAndAddToObject(c,["el","page","elementSelector","toggleType"],this);helpers.addParametersToObjectIfExist(c,["ifExistsSelector"],this);this.config=c;this.parentEl=(!!c.inCurrentPage&&this.page.name)?this.page.el:$j(document);this.targetEl=this.parentEl.find(this.elementSelector);if(c.toggleEvent){this.toggleEvent=c.toggleEvent}if(c.ariaHideOn){this.ariaHideOn=c.ariaHideOn}if(c.ariaSelector){this.ariaSelector=c.ariaSelector;this.targetAriaEl=this.parentEl.find(this.ariaSelector)}else{this.targetAriaEl=this.targetEl}if(c.ariaFocusId){this.ariaFocusId=c.ariaFocusId;this.ariaFocusIdEl=document.getElementById(this.ariaFocusId);if(this.ariaFocusIdEl){if(!this.ariaFocusIdEl.setAttribute){this.ariaFocusIdEl.setAttribute("aria-hidden","false")}this.ariaFocusIdEl.setAttribute("tabindex","-1")}window.dialogOpen=window.dialogOpen||{};window.dialogOpen[this.ariaFocusId]=false}if(this.toggleType!=="alternate"){this.toggleClass=this.el.data("toggleClass")||"default-toggle-class"}else{if(this.toggleType==="alternate"){var b=this.el.data("toggleClass");this.toggleClass=b?b.split(/\s*[\,|\|]\s*/):["default-toggle-class"];if(this.toggleClass.length===1){this.toggleClass.push("")}this.prevToggleIndex=0;this.nextToggleIndex=1;var a=c.startingClass;if(_.isString(a)){var e=_.indexOf(this.toggleClass,a);if(a===""&&e===-1){this.nextToggleIndex=0;this.prevToggleIndex=this._prevIndex(this.nextToggleIndex,this.toggleClass.length)}else{this.nextToggleIndex=this._nextIndex(e,this.toggleClass.length);this.prevToggleIndex=this._prevIndex(this.nextToggleIndex,this.toggleClass.length)}}}}this.el.on("click",this.doToggleAction.createDelegate(this));if(c.toggleHideOnPageChanged===true){var d=function(){this.page.trigger("toggleButtonClose");helpers.setTimeout(function(){if(this.toggleType==="alternate"){this.alternate()}else{if(this.ariaHideOn){if(this.ariaHideOn==="removeClass"){if(this.targetAriaEl.attr("aria-hidden")=="false"){this.targetAriaEl.attr("aria-hidden","true")}}}this.targetEl.removeClass(this.toggleClass)}}.createDelegate(this),5)}.createDelegate(this);this.page.pageManager.on("pageChanged",d)}if(c.buttonHideOnFullScreen===true){this.page.pageManager.on("showQRibbon",this.showQRibbon.createDelegate(this));this.page.pageManager.on("hideQRibbon",this.hideQRibbon.createDelegate(this))}},showQRibbon:function(){this.el.parent().removeClass("hide")},hideQRibbon:function(){this.el.parent().addClass("hide")},cacheClickedElement:function(){window.originalFocus=window.originalFocus||{};window.originalFocus[this.ariaFocusId]=window.originalFocus[this.ariaFocusId]||document.activeElement;window.originalFocus[this.ariaFocusId].setAttribute("tabindex","-1")},doToggleAction:function(b){b.preventDefault();this.targetEl=this.parentEl.find(this.elementSelector);if(this.ifExistsSelector&&!this.targetEl.hasClass(this.toggleClass)&&this.targetEl.find(this.ifExistsSelector).length===0){return}if(this.targetAriaEl){this.targetAriaEl=this.parentEl.find(this.ariaSelector)}if(this.ariaFocusId){this.cacheClickedElement()}if(this.ariaFocusId){window.dialogOpenFocusEvent=window.dialogOpenFocusEvent||{};if(!window.dialogOpenFocusEvent[this.ariaFocusId]){window.dialogOpenFocusEvent[this.ariaFocusId]=true;$j(document).on("focusin",this.restrictFocus.createDelegate(this))}else{window.dialogOpenFocusEvent[this.ariaFocusId]=false;$j(document).off("focusin",this.restrictFocus.createDelegate(this))}}var c=undefined;switch(this.toggleType){case"on":this.targetEl.addClass(this.toggleClass);c=true;if(this.ariaHideOn){if(this.ariaHideOn==="addClass"){this.targetAriaEl.attr("aria-hidden","true")}else{this.targetAriaEl.attr("aria-hidden","false")}}break;case"off":this.targetEl.removeClass(this.toggleClass);c=false;if(this.ariaHideOn){if(this.ariaHideOn==="removeClass"){this.targetAriaEl.attr("aria-hidden","true")}else{this.targetAriaEl.attr("aria-hidden","false")}}break;case"toggle":if(this.ariaHideOn){var a=this.ariaSelector?this.targetAriaEl:this.targetEl;a.each(function(d,e){var e=$j(e);if(e.prop("tagName")=="HTML"){return}if(e.attr("aria-hidden")=="true"){this.ariaShow(e)}else{this.ariaHide(e)}}.createDelegate(this))}this.targetEl.each(function(d,e){$j(e).toggleClass(this.toggleClass)}.createDelegate(this));c=this.targetEl.hasClass(this.toggleClass)?true:false;break;case"alternate":this.alternate();break}if(this.toggleEvent){this.targetEl.trigger(this.toggleEvent,{onState:c})}},ariaHide:function(a){if(this.ariaFocusId){window.dialogOpen[this.ariaFocusId]=false;window.originalFocus[this.ariaFocusId].focus()}helpers.setTimeout(function(){a.attr("aria-hidden","true")}.createDelegate(this),100)},ariaShow:function(a){a.attr("aria-hidden","false");if(this.ariaFocusId){window.dialogOpen[this.ariaFocusId]=true;if(this.ariaFocusIdEl){helpers.setTimeout(function(){this.ariaFocusIdEl.focus()}.createDelegate(this),200)}}},restrictFocus:function(a){if(window.dialogOpen[this.ariaFocusId]&&!_.contains(this.ariaFocusIdEl,a.target)){a.stopPropagation();helpers.setTimeout(function(){this.ariaFocusIdEl.focus()}.createDelegate(this),200)}},alternate:function(){var b=this.nextToggleIndex;var a=this.prevToggleIndex;this.targetEl=this.parentEl.find(this.elementSelector);this.targetEl.each(function(c,e){var e=$j(e);var f=this.toggleClass[a];var d=this.toggleClass[b];f&&e.removeClass(f);d&&e.addClass(d)}.createDelegate(this));this.prevToggleIndex=b;this.nextToggleIndex=this._nextIndex(b,this.toggleClass.length)},_nextIndex:function(b,a){return(b+=1)<a?b:0},_prevIndex:function(b,a){return(b-=1)<0?a-1:b}});namespace("JSEngine.Widgets");JSEngine.Widgets.SingleImageLightbox=Backbone.Model.extend({DEFAULT_POPUP_CLASS:"image-popup-vertical-fit",initialize:function(a){this.config=a||{};helpers.assertParametersExistAndAddToObject(this.config,["el"],this);this.el.addClass(this.DEFAULT_POPUP_CLASS);this.config.additionalClasses=this.config.additionalClasses||"";var b={type:"image",closeOnContentClick:true,mainClass:this.config.additionalClasses,image:{verticalFit:true}};if(helpers.assertTrue(this.config.hideCloseButton)){b=_.extend(b,{closeMarkup:""})}this.el.magnificPopup(b)}});namespace("JSEngine.Widgets");JSEngine.Widgets.ScrollPane=JSEngine.Widgets.DynamicContainerWidget.extend({initialize:function(b){var a;helpers.assertParametersExistAndAddToObject(b,["el","page","containerSelector"],this);this.attributes=b;this.container=this.el.find(b.containerSelector);this.initialized=false;this.continueInitialisation(b,this._postInit)},continueInitialisation:function(c,b){var a;c=c||{};if(!_.isFunction(b)){b=function(){}}if(this.page.isActive){d.call(this)}else{a=_.bind(d,this);this.page.on("afterActivate",a)}function d(){if(a){this.page.off("afterActivate",a)}if(!c.collectionType){b.call(this,c)}else{this.on("renderComplete",_.bind(b,this,c));this.on("fetchSuccess",_.bind(b,this,c));JSEngine.Widgets.DynamicContainerWidget.prototype.initialize.call(this,c)}}},_postInit:function(a){if(!this.started){this.started=true;helpers.getWindowEl().on("resize",_.bind(this.decideInitialisation,this,true))}this.decideInitialisation()},decideInitialisation:function(a){if(!this.checkDisplay()){this.tearDown();return}if(this.api&&a){this.api.reinitialise()}else{if(this.initialized){this.container.data("jsp",null)}if($j(this.container).is(":visible")){this.container.jScrollPane(this.attributes);this.api=this.container.data("jsp");this.initialized=true}}},checkDisplay:function(){var a=(this.attributes||{}).matchMedia;return _.isString(a)?helpers.matchMedia(a).matches:true},reInitContainer:function(a){a=a||this.attributes.containerSelector;if(!this.container||!this.container.is(this.el.find(a))){var b=this.container=this.el.find(a);return b}},tearDown:function(){if(this.api){this.api.destroy();delete this.api}this.container.data("jsp",null);this.initialized=false;this.reInitContainer(this.attributes.containerSelector)}});namespace("JSEngine.Widgets");JSEngine.Widgets.Marquee=JSEngine.Widgets.DynamicContainerWidget.extend({initialize:function(b){var d,a;helpers.assertParametersExistAndAddToObject(b,["el","page"],this);this.container=b.containerSelector?this.el.find(b.containerSelector):this.el;if(this.page.isActive){c.call(this)}else{a=_.bind(c,this);this.page.on("afterActivate",a)}function c(){if(a){a=null;this.page.off("afterActivate",a)}if(!b.collectionType){this._postInit(b)}else{this.on("renderComplete",_.bind(this._postInit,this,b));JSEngine.Widgets.DynamicContainerWidget.prototype.initialize.call(this,b)}}},_postInit:function(a){if(a.oneTimeLeftToRight){this.oneTimeLeftToRight(a)}else{this._advancedMarquee(a)}},_advancedMarquee:function(b){var a=this.marquee=this.container.marquee(b);if(b.mouseInterrupt){a.on("mouseover",function(){a.trigger("stop")}).on("mouseout",function(){a.trigger("start")})}if(b.windowResize&&window){helpers.getWindowEl().on("resize",function(){a.resizeMarquee()})}if(b.drag){a.on("mousedown",function(c){a.data("drag",true).data("x",c.clientX).data("scrollX",this.scrollLeft)}).on("mouseup",function(){a.data("drag",false)}).on("mousemove",function(c){if(a.data("drag")==true){this.scrollLeft=a.data("scrollX")+(a.data("x")-c.clientX)}})}},oneTimeLeftToRight:function(a){this.oneTimeLeftToRightInit();helpers.getWindowEl().on("resize",function(){this.tearDown.call(this,a)}.createDelegate(this))},oneTimeLeftToRightInit:function(){if(this.container.data("setup")){return}this.container.data("setup",true);this.timeout1=helpers.setTimeout(this.oneTimeLeftToRightSetup.createDelegate(this),3000)},oneTimeLeftToRightSetup:function(){this.text=this.container.html();this.height=this.container.height();this.container.height(this.height);if(this.container.find(".custom-marquee-inner").length<1){this.container.wrapInner('<div class="custom-marquee-inner"/>')}this.textContainer=this.container.find(".custom-marquee-inner");if(this.container[0].offsetWidth<this.container[0].scrollWidth){this.parentPaddingLeft=Math.round(parseInt(this.container.parent().css("padding-left")));this.textWidth=this.textContainer.width();this.containerWidth=this.container.width();this.distance=Math.round(this.textWidth-this.containerWidth);this.time=this.distance*30;this.window=$j(window);this.container.parent().css({transition:"none","padding-left":0});if(Modernizr.csstransitions&&Modernizr.csstransforms){var a="translateX("+this.parentPaddingLeft+"px)";this.textContainer.css({"-webkit-transform":a,"-moz-transform":a,"-ms-transform":a,"-o-transform":a,transform:a})}else{this.textContainer.css("left",this.parentPaddingLeft)}this.oneTimeLeftToRightanimate();this.interval1=setInterval(this.oneTimeLeftToRightanimate.createDelegate(this),10000)}},oneTimeLeftToRightanimate:function(){if(this.isOnScreen()){if(Modernizr.csstransitions&&Modernizr.csstransforms){var a="translateX(-"+this.distance+"px)";this.textContainer.css({transition:"all "+this.time+"ms linear","-webkit-transition":"all "+this.time+"ms linear","-webkit-transform":a,"-moz-transform":a,"-ms-transform":a,"-o-transform":a,transform:a})}else{this.textContainer.animate({left:-this.distance},this.time,"linear")}this.timeout2=helpers.setTimeout(function(){if(Modernizr.csstransitions&&Modernizr.csstransforms){var b="translateX("+this.parentPaddingLeft+"px)";this.textContainer.css({transition:"","-webkit-transition":"","-webkit-transform":b,"-moz-transform":b,"-ms-transform":b,"-o-transform":b,transform:b})}else{this.textContainer.stop().css({transition:"",left:this.parentPaddingLeft})}}.createDelegate(this),this.time+1500)}},isOnScreen:function(b){if(!this.container.is(":visible")){return false}var f=this.window.scrollLeft();var a=this.window.scrollTop();var e=this.container.offset();var d=e.left;var c=e.top;if(c+this.container.height()>=a&&c<=a+this.window.height()&&d+this.container.width()>=f&&d<=f+this.window.width()){return true}else{return false}},tearDown:function(a){helpers.clearTimeout(this.timeout1);helpers.clearTimeout(this.timeout2);clearInterval(this.interval1);this.container.attr("style","").parent().attr("style","");$j(this.textContainer).stop().attr("style","");this.container.find("custom-marquee-inner").remove();this.container.html(this.text);this.container.data("setup",false);this.oneTimeLeftToRightInit(a)}});namespace("JSEngine.Widgets");JSEngine.Widgets.ProxyDomElement=JSEngine.Widgets.DynamicContainerWidget.extend({initialize:function(c){var b;helpers.assertParametersExistAndAddToObject(c,["el","proxyElementSelector","page"],this);this.inPage=!!c.inCurrentPage||false;b=this.page.name;this.proxyElements=(this.inPage&&b)?this.page.el.find(this.proxyElementSelector):$j(this.proxyElementSelector);dynContainers=c.dynamicContainers||c.dynamicContainer;function a(){_.each(dynContainers,function(d){d=$j.trim(d);this.createDynamicContainer($j(d),function(){this.setContents(this.el)}.createDelegate(this),true)}.createDelegate(this))}if(!dynContainers){if(this.page.isActive){this.setContents()}else{this.page.on("afterActivate",this.setContents.createDelegate(this))}return}else{JSEngine.Widgets.DynamicContainerWidget.prototype.initialize.apply(this,arguments);dynContainers=dynContainers.split(/\s*\,\s*/);if(this.page.isActive){a.call(this)}else{this.page.on("afterActivate",a.createDelegate(this))}}},setContents:function(){var a="";this.proxyElements.each(function(){a+=this.innerHTML+" "});a=$j.trim(a);a=a.replace(this.doubleSpaceReg," ");if(a){this.el.html(a)}},doubleSpaceReg:/\s{2,}/g});namespace("JSEngine.Widgets");JSEngine.Widgets.Puzzle=Backbone.Model.extend({from$els:[],to$els:[],dragAndDropManager:undefined,initialize:function(a){helpers.assertParametersExistAndAddToObject(a,["el","page","lockName"],this);helpers.addParametersToObjectIfExist(_.defaults(a,{waitFail:0,waitSuccess:0}),["waitFail","waitSuccess"],this);this.page.on("renderContent",function(){if(!_.isUndefined(a.applicationVariables.urlParams)&&!_.isUndefined(a.applicationVariables.urlParams.toUrl)){this.toUrl=a.applicationVariables.urlParams.toUrl}this.randomize();$j("#ae-puzzle-alternative-feedback").text("");$j("#ae-puzzle-alternative-answer").val("")}.createDelegate(this));this.dragAndDropManager=new JSEngine.DragAndDropManager();this.dragAndDropManager.on("drop",this.onDrop,this);_.each(this.el.find(".ae-puzzle-from"),function(c){var b=$j(c);if(!b.attr("id")){b.attr("id",_.uniqueId("puzzle_"))}this.from$els.push(b);this.dragAndDropManager.addDragItem(b,b)}.createDelegate(this));_.each(this.el.find(".ae-puzzle-to"),function(c){var b=$j(c);if(!b.attr("id")){b.attr("id",_.uniqueId("puzzle_"))}this.to$els.push(b);this.dragAndDropManager.addDropItem(b,b)}.createDelegate(this));this.challange$el=this.el.find(".ae-challange");this.randomize();this.accessibleForm()},accessibleForm:function(){var a=$j(".ae-puzzle-alternative ");a.on("click",function(b){b.preventDefault();this.page.pageManager.locks[this.lockName].unlock();if(_.isUndefined(this.toUrl)){helpers.changeDocumentLocation("#")}else{helpers.changeDocumentLocation("#"+this.toUrl)}}.createDelegate(this))},randomize:function(){this.from$el=_.shuffle(this.from$els)[0];this.to$el=_.shuffle(this.to$els)[0];var a=helpers.getTemplateMarkup(this.challange$el.attr("data-template"));this.challange$el.html(_.template(a,{to_word:this.to$el.attr("data-word"),from_word:this.from$el.attr("data-word")}))},onDrop:function(c,b){if(c.is(this.to$el)&&b.is(this.from$el)){c.addClass("ae-to-success");b.addClass("ae-from-success");helpers.setTimeout(function(){c.removeClass("ae-to-success");b.removeClass("ae-from-success");this.page.pageManager.locks[this.lockName].unlock();if(_.isUndefined(this.toUrl)){helpers.changeDocumentLocation("#")}else{helpers.changeDocumentLocation("#"+this.toUrl)}}.createDelegate(this),this.waitSuccess)}else{c.addClass("ae-to-fail");b.addClass("ae-from-fail");var a=this;helpers.setTimeout(function(){c.removeClass("ae-to-fail");b.removeClass("ae-from-fail");this.randomize()}.createDelegate(this),this.waitFail)}}});namespace("JSEngine.Widgets");JSEngine.Widgets.BackButton=Backbone.Model.extend({initialize:function(a){helpers.assertParametersExistAndAddToObject(a,["el","page"],this);this.config=a;this.el.on("click",this.doGoBackAction.createDelegate(this))},doGoBackAction:function(c){c.preventDefault();if(!_.isEmpty(this.page.pageManager.pageHistory)){var a=this.page.pageManager.pageHistory.pop();var b=this.page.pageManager.pageHistory.pop();this.page.pageManager.updateHistory(a);if(b&&b.location){helpers.changeDocumentLocation(b.location)}}else{helpers.windowHistoryGoBack(1)}}});namespace("JSEngine.Widgets");JSEngine.Widgets.Battery=Backbone.Model.extend({initialize:function(a){helpers.assertParametersExistAndAddToObject(a,["el","page"],this);this.battery=navigator.battery||navigator.webkitBattery||navigator.mozBattery;this.config=a;this.batteryCheckTimerMins=this.config.batteryCheckTimerMins||2;this.batteryToolbarShowSeconds=this.config.batteryToolbarShowSeconds||5;this.batteryVibrateOnCharge=this.config.batteryVibrateOnCharge||false;this.batteryLowLevel=this.config.batteryLowLevel||15;this.html=$j("html");this.timer=null;if(this.battery){this.getandUpdateBatteryLevel();this.checkCharging();setInterval(function(){this.getandUpdateBatteryLevel()}.createDelegate(this),1000*60*this.batteryCheckTimerMins);this.battery.addEventListener("chargingchange",function(){this.checkCharging();this.showBatteryToolbar()}.createDelegate(this),false)}else{this.el.hide()}},getandUpdateBatteryLevel:function(){this.batteryLevel=this.battery.level;if(!isNaN(this.battery.level)){this.batteryLevel=Math.round(this.battery.level*100);this.el.find("#ae-battery-level").css("width",this.batteryLevel+"%").text(this.batteryLevel+"%")}this.checkLowLevel()},checkLowLevel:function(){if(this.batteryLevel<this.batteryLowLevel){this.html.addClass("ae-low-battery-level");this.showBatteryToolbar()}else{this.html.removeClass("ae-low-battery-level")}},showBatteryToolbar:function(){this.html.addClass("ae-show-battery-toolbar");this.timer=helpers.setTimeout(function(){this.html.removeClass("ae-show-battery-toolbar")}.createDelegate(this),this.batteryToolbarShowSeconds*1000)},checkCharging:function(){if(this.battery.charging){this.html.addClass("ae-battery-charging");if("vibrate" in navigator&&this.batteryVibrateOnCharge===true){navigator.vibrate([1000])}}else{this.html.removeClass("ae-battery-charging")}}});namespace("JSEngine.Widgets");JSEngine.Widgets.Odometer=Backbone.Model.extend({initialize:function(a){helpers.assertParametersExistAndAddToObject(a,["el","page"],this);this.config=a;this.number=this.config.number;this.el=$j(this.el);if(this.page.isActive){window.Odometer.init()}else{this.page.on("afterActivate",window.Odometer.init)}this.triggerOdometer()},triggerOdometer:function(){this.el.css("opacity",0);setTimeout(function(){this.el.text(this.number);this.el.css({opacity:1})}.createDelegate(this),200)}});namespace("JSEngine.Widgets");JSEngine.Widgets.CollectionMatch=Backbone.Model.extend({initialize:function(b){helpers.assertParametersExistAndAddToObject(b,["el","name","matchingClass","collectionName","fromValue","toAttr","feedManager","applicationVariables"],this);this.feed=this.feedManager.getDataCollectionByName(this.collectionName);var a=false;var a=this.getEventByCtxAttr("collectionClearName");if(!a){this.feed.on("change",this.feedClear.createDelegate(this),_.extend(this.feed,{collectionClearName:this.name}))}var d=this.getEventByCtxAttr("collectionChangeName");var c={fromValue:this.fromValue,toAttr:this.toAttr,el:this.el};if(!d){this.feed.on("change",this.feedChange,_.extend(this.feed,{self:this,collectionChangeName:(this.name),scopeData:[c]}))}else{d.ctx.scopeData.push(c)}},getEventByCtxAttr:function(a){if(this.feed._events&&this.feed._events.change){return _.find(this.feed._events.change,function(b){return b.ctx&&b.ctx[a]===this.name}.createDelegate(this))}return false},feedClear:function(){$j("."+this.matchingClass+"[data-name='"+this.name+"']").removeClass(this.matchingClass)},feedChange:function(){var b=this.self;var c=JSEngine.DynamicContainer.prototype.getModelsToRender.call({collection:b.feed,filter:b.feed.options.filter,applicationVariables:b.applicationVariables,_getFilterString:JSEngine.DynamicContainer.prototype._getFilterString,getFilteredResults:JSEngine.DynamicContainer.prototype.getFilteredResults,itemOffset:0,itemLimit:0});if(c.length===0){return}var a=_.filter(this.scopeData,function(d){return !_.isUndefined(_.find(c,function(e){return(""+e.get(d.toAttr)===""+d.fromValue)}))});_.each(a,function(d){d.el.addClass(b.matchingClass)})}});namespace("JSEngine.Widgets");JSEngine.Widgets.Clouds=Backbone.Model.extend({initialize:function(a){helpers.assertParametersExistAndAddToObject(a,["el","page"],this);helpers.addParametersToObjectIfExist(a,["ifExistsSelector"],this);this.config=a;if(Modernizr.csstransforms3d){this.layers=[];this.objects=[];this.isVisible=true;$j("html").addClass("ae-clouds");this.el=$j(this.el);this.el[0].innerHTML='<div  id="cloud-bg3" class="cloud-container">											<div class="cloud-bg cloud-bg3"></div>										</div>										<div  id="cloud-bg2" class="cloud-container">											<div class="cloud-bg cloud-bg2 "></div>										</div>										<div  id="cloud-bg" class="cloud-container">											<div class="cloud-bg"></div>										</div>										<div id="viewport">											<div id="world">											</div>										</div>';this.el.prependTo("body");this.world=document.getElementById("world");this.viewport=document.getElementById("viewport");this.cloudBg=document.getElementById("cloud-bg");this.cloudBg2=document.getElementById("cloud-bg2");this.cloudBg3=document.getElementById("cloud-bg3");this.distance=0;this.perspective=400;this.worldXAngle=0;this.worldYAngle=0;this.MAGIC_NUMBER=30;this.orientationSupport=!!window.DeviceOrientationEvent;this.desktop=!navigator.userAgent.match(/(iPhone|iPod|iPad|Android|BlackBerry|BB10|mobi|tablet|opera mini|nexus 7)/i);this.vh=null;this.vw=null;this.viewport.style.webkitPerspective=this.perspective;this.viewport.style.MozPerspective=this.perspective+"px";this.viewport.style.oPerspective=this.perspective;this.getDimensions();this.generate();$j(window).on("mousemove",this.onMouseMove.createDelegate(this));if(this.orientationSupport){$j(window).on("deviceorientation",this.onDeviceOrientation.createDelegate(this));$j(window).on("orientationchange",this.getDimensions.createDelegate(this))}this.update();setTimeout(function(){this.world.className+=" active"},300);helpers.setInterval(this.isVisibleCheck.createDelegate(this),1000)}},createCloud:function(){var b=document.createElement("div");b.className="cloudBase";var k=((this.vw-200)/2)-(Math.random()*(this.vw-200));k=(k>-70&&k<70)?(k<0)?k-300:k+300:k;var g=100;var f=256-(Math.random()*512);f=-100-(Math.random()*200);var l="translateX( "+k+"px ) translateY( "+g+"px ) translateZ( "+f+"px )";this.transform(b,l);this.world.appendChild(b);var e=0,h=4+Math.round(Math.random()*3);for(e;e<h;e++){var c=document.createElement("img");c.style.opacity=0;c.className="cloudLayer";c.setAttribute("src","../PanasonicAero-JS-Engine/app/img/clouds/cloud.png");var k=256-(Math.random()*512);var g=256-(Math.random()*512);var f=100-(Math.random()*200);var i=Math.random()*360;var m=0.25+Math.random();var d=[true,false][Math.round(Math.random())];k*=0.2;g*=0.2;c.data={x:k,y:g,z:f,origZ:f-500,a:i,s:m,opacity:0.8,speed:0.1*Math.random(),rotateClockwise:d};var l="translateX( "+k+"px ) translateY( "+g+"px ) translateZ( "+f+"px ) rotateZ( "+i+"deg ) scale( "+m+" )";this.transform(c,l);b.appendChild(c);this.layers.push(c)}return b},transform:function(a,b){a.style.webkitTransform=b;a.style.MozTransform=b;a.style.oTransform=b;a.style.msTransform=b;a.style.transform=b},getDimensions:function(){this.vh=window.innerHeight;this.vw=window.innerWidth},generate:function(){this.objects=[];if(this.world.hasChildNodes()){while(this.world.childNodes.length>=1){this.world.removeChild(this.world.firstChild)}}var a=0;for(a;a<5;a++){this.objects.push(this.createCloud())}},updateView:function(){var a="translateZ( "+this.distance+"px ) rotateX( "+this.worldXAngle+"deg) rotateY( "+this.worldYAngle+"deg)";this.transform(world,a);this.transform(this.cloudBg," scaleX("+(1.05)+") translateX("+(-this.worldYAngle*1.5)+0+"px) translateY("+(this.worldXAngle*1.5)+"px)");this.transform(this.cloudBg2,"  scaleX("+(1.05)+") translateX("+(-this.worldYAngle*2)+0+"px) translateY("+(this.worldXAngle*2)+"px)");this.transform(this.cloudBg3,"  scaleX("+(1.05)+") translateX("+(-this.worldYAngle*2)+0+"px) translateY("+(this.worldXAngle*2)+"px)")},onMouseMove:function(a){if(this.isVisible){this.worldYAngle=-(0.5-(a.clientX/window.innerWidth))*10;this.worldXAngle=(0.5-(a.clientY/window.innerHeight))*10-10;this.updateView()}},isVisibleCheck:function(){if(this.el.css("display")!=="none"){this.isVisible=true}else{this.isVisible=false}},onDeviceOrientation:function(b){if(!this.desktop&&b.beta!==null&&b.gamma!==null){this.orientationStatus=1;var a=(b.beta||0)/this.MAGIC_NUMBER;var c=(b.gamma||0)/this.MAGIC_NUMBER;a=a*10;c=c*10;if(this.vw>this.vh){this.worldXAngle=c;this.worldYAngle=a}else{this.worldYAngle=c;this.worldXAngle=a}this.updateView()}},update:function(){var a=0,d=this.layers.length;for(a;a<d;a++){var c=this.layers[a];if(c.data.rotateClockwise){c.data.a+=c.data.speed}else{c.data.a-=c.data.speed}c.data.z+=(50*c.data.speed);if(c.data.z>(this.perspective)){c.opacity=0}else{c.opacity=0.8}if(c.data.z>(this.perspective*2)){c.data.z=c.data.origZ}var b="translateX( "+c.data.x+"px ) translateY( "+c.data.y+"px ) translateZ( "+c.data.z+"px ) rotateY( "+(-this.worldYAngle)+"deg ) rotateX( "+(-this.worldXAngle)+"deg ) rotateZ( "+c.data.a+"deg ) scale( "+c.data.s+")";c.style.opacity=c.opacity;c.style.webkitTransform=b;c.style.MozTransform=b;c.style.oTransform=b}requestAnimationFrame(this.update.bind(this))}});(function(){var b=0;var c=["ms","moz","webkit","o"];for(var a=0;a<c.length&&!window.requestAnimationFrame;++a){window.requestAnimationFrame=window[c[a]+"RequestAnimationFrame"];window.cancelRequestAnimationFrame=window[c[a]+"CancelRequestAnimationFrame"]}if(!window.requestAnimationFrame){window.requestAnimationFrame=function(h,e){var d=new Date().getTime();var f=Math.max(0,16-(d-b));var g=window.setTimeout(function(){h(d+f)},f);b=d+f;return g}}if(!window.cancelAnimationFrame){window.cancelAnimationFrame=function(d){clearTimeout(d)}}}());namespace("JSEngine.Widgets");JSEngine.Widgets.OneMediaBanner=Backbone.Model.extend({initialize:function(c){var b=(c.hasOwnProperty("refreshOnPageChange"))?c.refreshOnPageChange:true,e,a;this.bannerService=null;helpers.assertParametersExistAndAddToObject(c,["el","page","feedManager","mediaManager","messageManager","applicationVariables","template"],this);helpers.addParametersToObjectIfExist(c,["advanced","video","languageId","icao"],this);if(c["default"]){this.def=c["default"]}this.templateContent=helpers.parseTemplateMarkup(this.el,this.template);e=(this.page.isGlobalContainer)?this.page.pageManager:this.page;a=(this.page.isGlobalContainer)?"pageChanged":"activate";var d=function(){this.getBanner();e.off(a,d);if(b){e.on(a,this.getBanner.createDelegate(this))}}.createDelegate(this);e.on(a,d)},_getBanner:function(){for(var c=0;c<this.configs.length;c++){if(this.configs[c].matchMedia.matches){var a=this.configs[c];var b={zone_path:a.zonePath,zone_width:a.width,zone_height:a.height};if(this.languageId){b.language_id=this.languageId}if(this.video){b.video=this.video}if(this.icao){b.icao=this.icao}this.bannerService.getBanner(b,function(e,d){if(e){console.error("OneMediaBanner widget failed to get banner with params: ",b)}else{this.banner=d;this.insertBannerToDom(a)}}.createDelegate(this));break}this.el.html("")}},getBanner:function(){if(this.bannerService){this._getBanner()}else{JSEngine.IFAPIInitHelper.initialize("one_media/v1",function(b){this.configs=[];this.bannerService=b[0];if(this.advanced instanceof Array){this.configs=this.configs.concat(this.advanced)}if(this.def instanceof Object){this.configs.push(_.extend(this.def,{query:"(min-width: 0px)"}))}for(var c=0;c<this.configs.length;c++){var a=this.configs[c];if(a.query&&a.zonePath&&a.width&&a.height){this.configs[c].matchMedia=window.matchMedia(a.query.replace("@media",""));this.configs[c].matchMedia.addListener(function(){this._getBanner()}.createDelegate(this))}}this._getBanner()}.createDelegate(this))}},insertBannerToDom:function(a){if(!_.isEmpty(this.templateContent)){var b=_.template(this.templateContent,{banner:this.banner,width:a.width,height:a.height});this.el.html(b);this.createChildElementWrapper(this.el)}},createChildElementWrapper:function(a){if(this.childElementWrapper){this.childElementWrapper.cleanUp();delete this.childElementWrapper}this.childElementWrapper=new JSEngine.ElementWrapper({el:a,applicationVariables:this.applicationVariables,page:this.page,feedManager:this.feedManager,mediaManager:this.mediaManager,messageManager:this.messageManager})},cleanUp:function(){if(this.childElementWrapper){this.childElementWrapper.cleanUp();delete this.childElementWrapper}}});namespace("JSEngine.Widgets");JSEngine.Widgets.Maps=Backbone.Model.extend({initialize:function(a){helpers.assertParametersExistAndAddToObject(a,["el","page","template"],this);this.templateContent=helpers.parseTemplateMarkup(this.el,"#"+this.template);this.onResizeDelay=(a.hasOwnProperty("onResizeDelay"))?a.onResizeDelay:1000;JSEngine.IFAPIInitHelper.initialize("maps/v1",function(b){this.mapService=b[0];this.mapService.getFlightMaps(function(c,d){if(c){console.error("Can't retrieve flight maps:",c)}else{this.maps=d;this.page.on("afterActivate",function(){this.selectMap();this.registerMapUpdateHandler();this.registerWindowSizeChangeHandler();this.render()}.createDelegate(this))}}.createDelegate(this))}.createDelegate(this))},selectMap:function(){var c=this.el.width(),a=Number.POSITIVE_INFINITY;for(var b=this.maps.length-1,e,d;b>=0;b--){e=this.maps[b];d=Math.abs(e.width-c);if(d<a){a=d;this.map=e}}},registerMapUpdateHandler:function(){this.mapService.onFlightMapUpdate(this.map,function(a){this.map=a;this.render()}.createDelegate(this))},registerWindowSizeChangeHandler:function(){helpers.getWindowEl().on("resize",_.debounce(function(){this.selectMap();this.render()}.createDelegate(this),this.onResizeDelay))},render:function(){var a=_.template(this.templateContent,{map:this.map});this.el.html(a)}});namespace("JSEngine.Widgets");JSEngine.Widgets.TemplateSwitcher=Backbone.Model.extend({configs:[],initialize:function(a){this.configs=[];var b;a=a||{};helpers.assertParametersExistAndAddToObject(a,["el","page","applicationVariables","feedManager","mediaManager","messageManager"],this);$j(this.el).children("script").each(function(e,c){var g=$j(c).data("condition"),f=$j(c).data("condition-params"),d=_.template(helpers.getHtmlFromElement($j(c)));if(typeof(g)==="undefined"){g="default"}this.configs.push({condition:g,params:f,template:d})}.createDelegate(this));b=this.getTemplateContent();if(b){JSEngine.ViewHelper.renderItem(this.el,b,{});this.createChildElementWrapper(this.el)}else{console.error("No applicable template found.")}},getTemplateContent:function(){var b=this.getUserAgent(),a=null;_.each(this.configs,function(c){var d=new RegExp(c.condition,c.params);if(!a&&c.condition==="default"){a=c.template}else{if(b.match(d)){a=c.template}}});return a},getUserAgent:function(){return navigator.userAgent},createChildElementWrapper:function(b,a){if(a){this.page.on("initComponentsComplete",a)}if(this.childElementWrapper){this.childElementWrapper.cleanUp();delete this.childElementWrapper}this.childElementWrapper=new JSEngine.ElementWrapper({el:b,applicationVariables:this.applicationVariables,page:this.page,feedManager:this.feedManager,mediaManager:this.mediaManager,messageManager:this.messageManager})},cleanUp:function(){if(this.childElementWrapper){this.childElementWrapper.cleanUp();delete this.childElementWrapper}}});namespace("JSEngine");JSEngine.Widgets.SoftwareInstallWidget=Backbone.Model.extend({initialize:function(a){a=a||{};helpers.assertParametersExistAndAddToObject(a,["el","applicationVariables","page","feedManager","mediaManager","messageManager","requireInstall"],this);this.requireInstall=this.requireInstall.split("|")||[];this.template=helpers.getHtmlFromElement(this.el.find(".ae-si-default"));switch(this.applicationVariables.drm.softwareRequired){case this.applicationVariables.drm.requiredSoftwareTypes.FLASH_PLUGIN:if(this.requireInstall.indexOf("flash")!==-1){this.template=helpers.getHtmlFromElement(this.el.find(".ae-si-flash"));console.info("flash")}break;case this.applicationVariables.drm.requiredSoftwareTypes.IOS_APPLICATION:if(this.requireInstall.indexOf("ios")!==-1){this.template=helpers.getHtmlFromElement(this.el.find(".ae-si-ios"));console.info("ios")}break;case this.applicationVariables.drm.requiredSoftwareTypes.ANDROID_APPLICATION:if(this.requireInstall.indexOf("android")!==-1){this.template=helpers.getHtmlFromElement(this.el.find(".ae-si-android"));console.info("and")}break}this.renderTemplate()},renderTemplate:function(){if(this.template){this.template=_.template(this.template);var a={message:this.applicationVariables.drm.softwareInstallMessage,link:this.applicationVariables.drm.requiredSoftwareLink,urlParams:this.applicationVariables.urlParams};JSEngine.ViewHelper.renderItem(this.el,this.template,a);this.createChildElementWrapper()}else{console.error("Missing template for "+this.applicationVariables.drm.softwareRequired)}},createChildElementWrapper:function(){if(this.childElementWrapper){this.childElementWrapper.cleanUp();delete this.childElementWrapper}this.childElementWrapper=new JSEngine.ElementWrapper({el:this.el,applicationVariables:this.applicationVariables,page:this.page,feedManager:this.feedManager,mediaManager:this.mediaManager,messageManager:this.messageManager})},cleanUp:function(){if(this.childElementWrapper){this.childElementWrapper.cleanUp();delete this.childElementWrapper}}});namespace("JSEngine.Widgets");JSEngine.Widgets.ExternalLink=Backbone.Model.extend({initialize:function(a){helpers.assertParametersExistAndAddToObject(a,["el","page"],this);JSEngine.IFAPIInitHelper.initialize("app_bridge/v1",function(b){var c=b[0];if(c.getBridgeType()!==c.BridgeType.NONE&&typeof c.sendMessage==="function"){this.el.click(function(f){var e=this.el.attr("href"),g=RegExp("^(https?:)?//");f.preventDefault();if(!g.test(e)){e=helpers.internalUrlToFullPath(e)}var d=c.sendMessage("app.open_browser",e)}.createDelegate(this))}}.createDelegate(this))}});namespace("JSEngine.Widgets");JSEngine.Widgets.ParallaxScroll=Backbone.Model.extend({initialize:function(a){var c,b;helpers.assertParametersExistAndAddToObject(a,["el","speed","contentSelector"],this);this.speed*=1;if(this.speed!==1){this.speed--;this.$win=helpers.getWindowEl();this.offset=a.offset?a.offset*1:0;this.$content=this.el.find(this.contentSelector);b=".parallax_"+_.uniqueId();this.events="scroll"+b;if("ontouchmove" in window){this.events+=" touchmove"+b}if(a.hasOwnProperty("enabledWhen")){c=window.matchMedia(a.enabledWhen);this.setScrolling(c.matches);c.addListener(function(){this.setScrolling(c.matches)}.createDelegate(this))}else{this.setScrolling(true)}}},setScrolling:function(a){if(a){this.doScroll();this.$win.on(this.events,this.doScroll.createDelegate(this))}else{this.resetPos();this.$win.off(this.events)}},setPos:function(b){var a="translate3d(0px, "+b+"px, 0px)";this.$content.css({"-webkit-transform":a,transform:a})},resetPos:function(){this.setPos(this.offset*-1)},doScroll:function(){var a=-(this.$win.scrollTop()*this.speed+this.offset);this.setPos(a)}});namespace("JSEngine");JSEngine.GenericCollection=JSEngine.BaseCollection.extend({initialize:function(b,a){a=a||{};helpers.assertParametersExist(a,["path","url"]);this.path=a.path;this.url=a.url;this.fetchedUrl=null;this.alwaysFetch=a.alwaysFetch;JSEngine.BaseCollection.prototype.initialize.call(this,b,a)},parse:function(b){var a=_.isEmpty(this.path)?[b]:jsonPath(b,this.path);if(typeof a[0]=="Array"){return a[0]}else{return _.flatten(a[0],true)}},hasFeedChanged:function(b){var a=this.url;if(b){a=_.template(a,b)}return this.alwaysFetch||a!==this.fetchedUrl},_fetch:function(b){b=b||{};var a=this.url;if(b.applicationVariables){a=_.template(a,b.applicationVariables)}if(this.fetchedUrl!==a){this.hasBeenFetched=false}if(!this.hasBeenFetched||!b.useCachedCopy){this.fetchedUrl=a;Backbone.Collection.prototype.fetch.call(this,{success:this._success.createDelegate(this,b,true),error:this._error.createDelegate(this,b,true),url:a})}else{this._success()}},_success:function(){this.hasBeenFetched=true;this.success()},_error:function(c,a,b){this.hasBeenFetched=false;this._response=a;this.fail(a,a);console.debug("error loading");console.debug(a)}});namespace("JSEngine");JSEngine.CategoriesCollection=JSEngine.BaseCollection.extend({initialize:function(b,a){a=a||{};this.alwaysFetch=a.alwaysFetch;helpers.addParametersToObjectIfExist(a,["jsonPathToIdInApplicationVariables"],this);helpers.assertParametersExistAndAddToObject(a,["seat_class"],this);JSEngine.BaseCollection.prototype.initialize.call(this,b,a)},getId:function(b){if(b){if(!_.isEmpty(this.jsonPathToIdInApplicationVariables)){var a=jsonPath(b,this.jsonPathToIdInApplicationVariables);if(_.isArray(a)&&a.length>0){return a[0]}}}return null},hasFeedChanged:function(b){var a=this.getId(b);if(this.lastFetchTimeMs<(new Date().getTime()-300000)||this.alwaysFetch||(a!==this.currentId)){return true}else{return false}},_fetch:function(c){c=c?_.clone(c):{};var b=this.getId(c.applicationVariables);var a=!c.useCachedCopy;a=a?true:(!this.hasBeenInitialised);if(a){JSEngine.IFAPIInitHelper.initialize("metadata/v1",function(e){var g=e[0];if(c.parse===undefined){c.parse=true}var f=this;var d=function(i,k){if(i){if(_.isFunction(c.error)){var h=Backbone.wrapError(c.error,f,c);h(i)}this.trigger("fetchFail",i,k)}else{this.hasBeenInitialised=true;var j=_.toArray(k);if(c.useSorting){f.comparator=function(l){return c.comparator(l,c)}}if(b){j=_.filter(j,function(l){return l.id===b})}f[c.add?"add":"reset"](j,c);this.currentId=b;if(c.useSorting){f.sort()}this.trigger("fetchSuccess",f)}}.createDelegate(this);g.categories({seat_class:this.seat_class},d)}.createDelegate(this))}else{this.trigger("fetchSuccess",this)}}});namespace("JSEngine");JSEngine.CategoryMediaCollection=JSEngine.BaseCollection.extend({initialize:function(b,a){a=a||{};this.alwaysFetch=a.alwaysFetch;helpers.assertParametersExistAndAddToObject(a,["seat_class","jsonPathToCategoryIdInApplicationVariables"],this);helpers.addParametersToObjectIfExist(a,["staticCategoryIdInApplicationVariables"],this);JSEngine.BaseCollection.prototype.initialize.call(this,b,a)},hasFeedChanged:function(b){var a=this.getCategoryId(b);return this.alwaysFetch||a!==this.currentCategoryId},getCategoryId:function(b){if(b){if(!_.isEmpty(this.jsonPathToCategoryIdInApplicationVariables)){var a=jsonPath(b,this.jsonPathToCategoryIdInApplicationVariables);if(_.isArray(a)&&a.length>0){return a[0]}}if(this.staticCategoryIdInApplicationVariables!=undefined){return this.staticCategoryIdInApplicationVariables}}return null},_fetch:function(b){b=b?_.clone(b):{};var a=this.getCategoryId(b.applicationVariables);JSEngine.IFAPIInitHelper.initialize("metadata/v1",function(d){var f=d[0];if(b.parse===undefined){b.parse=true}var e=this;var c=function(h,j){if(h){if(_.isFunction(b.error)){var g=Backbone.wrapError(b.error,e,b);g(h)}this.trigger("fetchFail",h,j)}else{var i=_.toArray(j);if(b.useSorting){e.comparator=function(k){return b.comparator(k,b)}}e[b.add?"add":"reset"](i,b);this.currentCategoryId=a;if(b.useSorting){e.sort()}this.trigger("fetchSuccess",e)}}.createDelegate(this);f.categoryMedia({seat_class:this.seat_class,category_id:a},c)}.createDelegate(this))}});namespace("JSEngine");JSEngine.MediaMetadataCollection=JSEngine.BaseCollection.extend({initialize:function(b,a){a=a||{};this.alwaysFetch=a.alwaysFetch;helpers.assertParametersExistAndAddToObject(a,["seat_class","jsonPathToMediaIdInApplicationVariables"],this);helpers.addParametersToObjectIfExist(a,["staticMediaIdInApplicationVariables"],this);JSEngine.BaseCollection.prototype.initialize.call(this,b,a)},hasFeedChanged:function(b){var a=this.getMediaId(b);return this.alwaysFetch||a!==this.currentMediaId},getMediaId:function(b){if(b){if(!_.isEmpty(this.jsonPathToMediaIdInApplicationVariables)){var a=jsonPath(b,this.jsonPathToMediaIdInApplicationVariables);if(_.isArray(a)&&a.length>0){return a[0]}}if(this.staticMediaIdInApplicationVariables!=undefined){return this.staticMediaIdInApplicationVariables}}return null},_fetch:function(b){b=b?_.clone(b):{};var a=this.getMediaId(b.applicationVariables);JSEngine.IFAPIInitHelper.initialize("metadata/v1",function(d){var f=d[0];if(b.parse===undefined){b.parse=true}var e=this;var c=function(h,i){if(h){if(_.isFunction(b.error)){var g=Backbone.wrapError(b.error,e,b);g(h)}this.trigger("fetchFail",h,i)}else{if(b.useSorting){e.comparator=function(j){return b.comparator(j,b)}}e[b.add?"add":"reset"](e.parse(i),b);this.currentMediaId=a;if(b.useSorting){e.sort()}this.trigger("fetchSuccess",e)}}.createDelegate(this);f.mediaMetadata({seat_class:this.seat_class,media_uri:a},c)}.createDelegate(this))}});namespace("JSEngine");JSEngine.MixedCollection=JSEngine.BaseCollection.extend({initialize:function(b,a){a=a||{};this.alwaysFetch=a.alwaysFetch;helpers.assertParametersExistAndAddToObject(a,["seat_class","mixedFilter"],this);JSEngine.BaseCollection.prototype.initialize.call(this,b,a)},hasFeedChanged:function(b){var a=this.getCategoryIds(b);return this.alwaysFetch||!_.isEqual(a,this.currentCategoryIds)},getCategoryIds:function(){var a=null;if(!_.isEmpty(this.mixedFilter)){a=this.mixedFilter.cats}return a},_fetch:function(b){b=b?_.clone(b):{};var a=this.getCategoryIds();var d=0;var c=this.mixedFilter.link_types;JSEngine.IFAPIInitHelper.initialize("metadata/v1",function(f){var h=f[0];if(b.parse===undefined){b.parse=true}var g=this;g.reset();var e=function(j,l){if(j){if(_.isFunction(b.error)){var i=Backbone.wrapError(b.error,g,b);i(j)}this.trigger("fetchFail",g)}else{var k=_.toArray(l);if(b.useSorting){g.comparator=function(m){return b.comparator(m,b)}}g.parse=function(m){_.each(m,function(o,n,p){o.linkType=c[d]});return this.customDataTransformerFunction(m)};g.add(k,b);this.currentCategoryIds=a;if(d==a.length-1){if(b.useSorting){g.sort()}this.trigger("fetchSuccess",g)}else{h.categoryMedia({seat_class:this.seat_class,category_id:a[d+1]},e)}}d++}.createDelegate(this);h.categoryMedia({seat_class:this.seat_class,category_id:a[0]},e)}.createDelegate(this))}});namespace("JSEngine");JSEngine.ChildMediaCollection=JSEngine.BaseCollection.extend({initialize:function(b,a){a=a||{};this.alwaysFetch=a.alwaysFetch;helpers.assertParametersExistAndAddToObject(a,["jsonPathToMediaChildIdInApplicationVariables"],this);helpers.addParametersToObjectIfExist(a,["staticMediaChildIdInApplicationVariables"],this);JSEngine.BaseCollection.prototype.initialize.call(this,b,a)},hasFeedChanged:function(a){var b=this.getMediaChildId(a);return this.alwaysFetch||b!==this.currentMediaChildId},getMediaChildId:function(b){if(b){if(!_.isEmpty(this.jsonPathToMediaChildIdInApplicationVariables)){var a=jsonPath(b,this.jsonPathToMediaChildIdInApplicationVariables);if(_.isArray(a)&&a.length>0){return a[0]}}}if(this.staticMediaChildIdInApplicationVariables!=undefined){return this.staticMediaChildIdInApplicationVariables}return null},parse:function(a){return JSEngine.BaseCollection.prototype.parse.call(this,_.toArray(a))},_fetch:function(a){a=a?_.clone(a):{};var b=this.getMediaChildId(a.applicationVariables);JSEngine.IFAPIInitHelper.initialize("metadata/v1",function(d){var f=d[0];if(a.parse===undefined){a.parse=true}var e=this;var c=function(h,i){if(h){if(_.isFunction(a.error)){var g=Backbone.wrapError(a.error,e,a);g(h)}this.trigger("fetchFail",h,i)}else{if(a.useSorting){e.comparator=function(j){return a.comparator(j,a)}}e[a.add?"add":"reset"](e.parse(i),a);this.currentMediaChildId=b;if(a.useSorting){e.sort()}this.trigger("fetchSuccess",e)}}.createDelegate(this);f.childMedia({media_uri:b},c)}.createDelegate(this))}});namespace("JSEngine");JSEngine.PlaylistCollection=JSEngine.BaseCollection.extend({initialize:function(b,a){this.onPlayerStateChange=_.bind(this.onPlayerStateChange,this);this.onPlayersPlaylistInit=_.bind(this.onPlayersPlaylistInit,this);this.onPlayerReady=_.bind(this.onPlayerReady,this);a=a||{};helpers.assertExists(a.mediaPlayerName,"There is no media player or media player name");helpers.assertExists(a.mediaManager,"No media manager has been defined");helpers.assertExists(a.page,"No page manager has been defined");helpers.addParametersToObjectIfExist(a,["name","playingClass"],this);this.addingClassName="ae-playlist-"+this.name+"-adding";this.mediaPlayerName=a.mediaPlayerName;if(!_.isUndefined(a.playlistToggleButton)){this.playlistToggleButton=a.playlistToggleButton;this.playlistToggleButtonClass=a.playlistToggleButtonClass||"ae-playlist-has-items";this.playlistContainerToggleClass=a.playlistContainerToggleClass||"state-open-playlist";this.togglePlaylistButtons()}this.on("clearPlayList",this.togglePlaylistButtons.createDelegate(this));a.mediaManager.on("playerAdded",function(c){if(c.player.name===a.mediaPlayerName){this.init(a.models,a)}}.createDelegate(this));if(a.mediaManager.getByName(a.mediaPlayerName)){this.init(a.models,a)}if(this.name!==undefined){a.mediaManager.addPlaylist(this.name,this);this.mediaManager=a.mediaManager}this.queue=[];JSEngine.BaseCollection.prototype.initialize.call(this,b,a)},init:function(b,a){if(this.player){this.player.off("stateChange",this.onPlayerStateChange);this.player.off("dataLoaded",this.onPlayersPlaylistInit);this.player.off("playerReady",this.onPlayerReady)}this.player=a.mediaManager.getByName(a.mediaPlayerName);this.player.on("stateChange",this.onPlayerStateChange);this.player.on("dataLoaded",this.onPlayersPlaylistInit);this.player.on("playerReady",this.onPlayerReady)},onPlayerReady:function(){this.fetch({})},onPlayersPlaylistInit:function(){this.fetch({})},model:function(b,a){return new JSEngine.PlaylistItem(b,a)},togglePlaylistButtons:function(){if(this.models.length>0){$j(this.playlistToggleButton).addClass(this.playlistToggleButtonClass).attr("aria-hidden","false")}else{$j(this.playlistToggleButton).removeClass(this.playlistToggleButtonClass).attr("aria-hidden","true");if(this.playlistContainerToggleClass){$j("."+this.playlistContainerToggleClass).removeClass(this.playlistContainerToggleClass)}this.trigger("change",this)}},playlistChange:function(){var a=helpers.getHtmlEl();var b="ae-playlist-"+this.name+"-status-";if(this.models.length>0){a.addClass(b+"populated")}else{a.removeClass(b+"populated");if(!_.isUndefined(this.player)){this.player.trigger("clearPlaylist")}}},togglePlaylistLinks:function(a,b){switch(a){case"add":_.each(b,function(c){$j('[data-type="JSEngine.Media.PlaylistLink"][data-media-uri="'+c.get("media_uri")+'"][data-link-type="add"]').addClass("item-added")});break;case"remove":_.each(b,function(c){$j('[data-type="JSEngine.Media.PlaylistLink"][data-media-uri="'+c.get("media_uri")+'"][data-link-type="add"]').removeClass("item-added")});break;case"clear":$j('[data-type="JSEngine.Media.PlaylistLink"][data-media-uri][data-link-type="add"]').removeClass("item-added");break}},hasFeedChanged:function(b){if(this.player){var a=this.player.getMediaUri();if(a!==this.oldMediaUri){this.oldMediaUri=a;console.warn("PlaylistCollection feed has changed");return true}else{return false}}else{return false}},_fetch:function(a){a=a?_.clone(a):{};if(_.isUndefined(this.player)){console.log("PlaylistCollection: player is not yet initialised");delete this.isBeingFetched;return}var b=this.player.getPlaylistMediaUris();if(_.isUndefined(b)){delete this.isBeingFetched;return}this.successfulFetch=true;b=_.filter(b,function(c){return(c!=="")});this.reset([],{silent:true});if(b.length>0&&!a.hasFeedChanged){this.add(_.map(b,function(c){return{media_uri:c}}),{silent:true,complete:function(){delete this.isBeingFetched;this.reset(this.models);this.trigger("fetchSuccess",this);this.onPlayerStateChange()}.createDelegate(this)})}else{delete this.isBeingFetched;this.togglePlaylistButtons();this.togglePlaylistLinks("clear");this.playlistChange()}},onPlayerStateChange:function(d){d=d||this.player.getState();var b=this.player.getPlaylistIndex();var c=false;var a=this.models[b];_.each(this.models,function(e){if(e===a){c=c||e.get("playState")===d;e.set("playState",d);e.trigger("change")}else{c=c||e.get("playState")===d;e.set("playState","stop");e.trigger("change")}})},addMediaUris:function(b){b=_.map(b,function(c){return""+c});var a=b.length>1;if(a){helpers.getHtmlEl().addClass(this.addingClassName)}this.player=this.mediaManager.getByName(this.mediaPlayerName);b=_.difference(b,this.player.getPlaylistMediaUris());this.player.addPlaylistMediaUris(b);this.add(_.map(b,function(c){return{media_uri:c}}),{silent:true,complete:function(){if(a){helpers.getHtmlEl().removeClass(this.addingClassName)}this.trigger("reset",this.models)}.createDelegate(this)})},removeMediaUris:function(a){a=_.map(a,function(c){return""+c});this.player.removePlaylistMediaUris(a);var b=_.filter(this.models,function(c){return _.contains(a,c.get("media_uri"))});this.remove(b)},removeMediaIndex:function(a){this.player.removePlaylistMediaIndex(a);this.remove([this.at(a)])},remove:function(b,a){a=a||{};Backbone.Collection.prototype.remove.call(this,b,a);if(!a.silent){if(this.playlistToggleButton){this.togglePlaylistButtons();this.togglePlaylistLinks("remove",(_.isArray(b)?b:[b]))}}this.playlistChange()},add:function(f,b){b=b||{};var d=_.clone(this.models);Backbone.Collection.prototype.add.call(this,f,_.extend({silent:true},b));var a=_.difference(this.models,d);var c=this.models.length;var e=function(){c--;if(c===0){if(!b.silent){_.each(a,function(g){this.trigger("add",g,this,b)},this)}if(this.playlistToggleButton){this.togglePlaylistButtons();this.togglePlaylistLinks("add",a)}this.hasBeenFetched=true;if(b.complete){b.complete()}this.playlistChange()}}.createDelegate(this);if(this.models.length>0){_.each(this.models,function(g){this.fetchModel(g,e)},this)}else{if(b.complete){b.complete()}}},fetchModel:function(c,b){var a=function(){c.hasBeenFetched=true;b()};if(c.hasBeenFetched){b()}else{c.fetch({success:a,error:a})}},cleanUp:function(){if(!_.isUndefined(this.mediaManager)){this.mediaManager.removePlaylist(this.name,this)}if(this.player){this.player.off("stateChange",this.onPlayerStateChange);this.player.off("playlistInitialised",this.onPlayersPlaylistInit);this.player.off("dataLoaded",this.onPlayersPlaylistInit);this.player.off("playlistChanged",this.onPlayersPlaylistInit);this.player.off("playerReady",this.onPlayerReady)}this.trigger("cleanup",this)},getShuffle:function(){return this.player.getShuffle()},setShuffle:function(a){return this.player.setShuffle(a)},getRepeatMode:function(){return this.player.getRepeatMode()},setRepeatMode:function(a){return this.player.setRepeatMode(a)},clear:function(){this.player.clearPlaylist();this.reset();this.togglePlaylistButtons();this.togglePlaylistLinks("clear");this.playlistChange();this.trigger("clear",this)},onTransitionAway:function(){JSEngine.BaseCollection.prototype.onTransitionAway.call(this);this.cleanUp()}});namespace("JSEngine");JSEngine.NewsProvidersCollection=JSEngine.BaseLiveTextNewsCollection.extend({initialize:function(b,a){a=a||{};this.alwaysFetch=a.alwaysFetch;JSEngine.BaseLiveTextNewsCollection.prototype.initialize.call(this,b,a)},hasFeedChanged:function(){if(this.hasBeenInitialised&&!this.alwaysFetch){return false}else{return true}},_fetch:function(b){b=b?_.clone(b):{};var a=!b.useCachedCopy|(!this.hasBeenInitialised);if(a){JSEngine.IFAPIInitHelper.initialize("livetextnews/v1",function(d){var e=d[0];if(b.parse===undefined){b.parse=true}var f=this;var c=function(h,j){if(h){if(_.isFunction(b.error)){var g=Backbone.wrapError(b.error,f,b);g(h)}this.fail(h,j)}else{j=j.langs["en"]["providers"];this.hasBeenInitialised=true;var i=_.toArray(j);if(b.useSorting){f.comparator=function(k){return b.comparator(k,b)}}f[b.add?"add":"reset"](i,b);if(b.useSorting){f.sort()}this.success()}}.createDelegate(this);e.providers(c)}.createDelegate(this))}else{this.success()}}});namespace("JSEngine");JSEngine.NewsCategoriesCollection=JSEngine.BaseLiveTextNewsCollection.extend({initialize:function(b,a){a=a||{};this.alwaysFetch=a.alwaysFetch;helpers.assertParametersExistAndAddToObject(a,["jsonPathToProviderIdInApplicationVariables"],this);helpers.addParametersToObjectIfExist(a,["staticProviderIdInApplicationVariables"],this);JSEngine.BaseLiveTextNewsCollection.prototype.initialize.call(this,b,a)},hasFeedChanged:function(b){var a=this.getProviderId(b);return this.alwaysFetch||a!==this.currentProviderId},getProviderId:function(b){if(b){if(!_.isEmpty(this.jsonPathToProviderIdInApplicationVariables)){var a=jsonPath(b,this.jsonPathToProviderIdInApplicationVariables);if(_.isArray(a)&&a.length>0){return a[0]}}if(this.staticProviderIdInApplicationVariables!=undefined){return this.staticProviderIdInApplicationVariables}}return null},_fetch:function(a){a=a?_.clone(a):{};var b=this.getProviderId(a.applicationVariables);JSEngine.IFAPIInitHelper.initialize("livetextnews/v1",function(d){var e=d[0];if(a.parse===undefined){a.parse=true}var f=this;var c=function(h,j){if(h){if(_.isFunction(a.error)){var g=Backbone.wrapError(a.error,f,a);g(h)}this.fail(h,j)}else{var i=_.toArray(j);if(a.useSorting){f.comparator=function(k){return a.comparator(k,a)}}f[a.add?"add":"reset"](i,a);this.currentProviderId=b;if(a.useSorting){f.sort()}this.success()}}.createDelegate(this);e.categories({provider_id:b},c)}.createDelegate(this))}});namespace("JSEngine");JSEngine.NewsArticlesCollection=JSEngine.BaseLiveTextNewsCollection.extend({initialize:function(b,a){a=a||{};this.alwaysFetch=a.alwaysFetch;helpers.assertParametersExistAndAddToObject(a,["jsonPathToProviderIdInApplicationVariables","jsonPathToCategoryIdInApplicationVariables"],this);helpers.addParametersToObjectIfExist(a,["staticProviderIdInApplicationVariables","staticCategoryIdInApplicationVariables"],this);JSEngine.BaseLiveTextNewsCollection.prototype.initialize.call(this,b,a)},hasFeedChanged:function(c){var b=this.getProviderId(c);var a=this.getCategoryId(c);return this.alwaysFetch||(b!==this.currentProviderId)||(a!==this.currentCategoryId)},getProviderId:function(b){if(b){if(!_.isEmpty(this.jsonPathToProviderIdInApplicationVariables)){var a=jsonPath(b,this.jsonPathToProviderIdInApplicationVariables);if(_.isArray(a)&&a.length>0){return a[0]}}if(this.staticProviderIdInApplicationVariables!=undefined){return this.staticProviderIdInApplicationVariables}}return null},getCategoryId:function(b){if(b){if(!_.isEmpty(this.jsonPathToCategoryIdInApplicationVariables)){var a=jsonPath(b,this.jsonPathToCategoryIdInApplicationVariables);if(_.isArray(a)&&a.length>0){return a[0]}}if(this.staticCategoryIdInApplicationVariables!=undefined){return this.staticCategoryIdInApplicationVariables}}return null},_fetch:function(b){b=b?_.clone(b):{};var c=this.getProviderId(b.applicationVariables);var a=this.getCategoryId(b.applicationVariables);JSEngine.IFAPIInitHelper.initialize("livetextnews/v1",function(e){var f=e[0];if(b.parse===undefined){b.parse=true}var g=this;var d=function(i,k){if(i){if(_.isFunction(b.error)){var h=Backbone.wrapError(b.error,g,b);h(i)}this.fail(i,k)}else{k=k[a].articles;var j=_.toArray(k);if(b.useSorting){g.comparator=function(l){return b.comparator(l,b)}}g[b.add?"add":"reset"](j,b);this.currentProviderId=c;this.currentCategoryId=a;if(b.useSorting){g.sort()}this.success()}}.createDelegate(this);f.categories({provider_id:c},d)}.createDelegate(this))}});namespace("JSEngine");JSEngine.NewsArticleCollection=JSEngine.BaseLiveTextNewsCollection.extend({initialize:function(b,a){a=a||{};this.alwaysFetch=a.alwaysFetch;helpers.assertParametersExistAndAddToObject(a,["jsonPathToArticleIdInApplicationVariables"],this);helpers.addParametersToObjectIfExist(a,["staticArticleIdInApplicationVariables"],this);JSEngine.BaseLiveTextNewsCollection.prototype.initialize.call(this,b,a)},hasFeedChanged:function(b){var a=this.getArticleId(b);return this.alwaysFetch||a!==this.currentArticleId},getArticleId:function(b){if(b){if(!_.isEmpty(this.jsonPathToArticleIdInApplicationVariables)){var a=jsonPath(b,this.jsonPathToArticleIdInApplicationVariables);if(_.isArray(a)&&a.length>0){return a[0]}}if(this.staticArticleIdInApplicationVariables!=undefined){return this.staticArticleIdInApplicationVariables}}return null},_fetch:function(b){b=b?_.clone(b):{};var a=this.getArticleId(b.applicationVariables);JSEngine.IFAPIInitHelper.initialize("livetextnews/v1",function(d){var e=d[0];if(b.parse===undefined){b.parse=true}var f=this;var c=function(h,i){if(h){if(_.isFunction(b.error)){var g=Backbone.wrapError(b.error,f,b);g(h)}this.fail(h,i)}else{if(b.useSorting){f.comparator=function(j){return b.comparator(j,b)}}f[b.add?"add":"reset"](f.parse(i),b);this.currentArticleId=a;if(b.useSorting){f.sort()}this.injectCaptions();this.success()}}.createDelegate(this);e.article({id:a},c)}.createDelegate(this))},injectCaptions:function(){_.each(this.models,function(a){var c=a.get("images");if(c&&c.length>0){var b=$j("<div>"+a.get("body")+"</div>");_.each(c,function(e){var d=b.find("img[src='"+e.url+"']");_.each(d,function(g){g=$j(g);g.wrap('<div class="ae-figure"></div>');var f=$j('<span class="ae-figcaption" ></span>');f.html(e.caption);g.parent().append(f);if(g.attr("align")){g.parent().addClass("ae-figure-align-"+g.attr("align"));g.removeAttr("align")}})});a.set("body",b.html())}})}});namespace("JSEngine");JSEngine.NewsArticlesCollectionWithImages=JSEngine.NewsArticlesCollection.extend({initialize:function(b,a){JSEngine.NewsArticlesCollection.prototype.initialize.call(this,b,a)},checkAsyncReady:function(b,a,d){if(b===a){var c=_.toArray(d);if(this.options.useSorting){collection.comparator=function(e){return this.options.comparator(e,this.options)}}this[this.options.add?"add":"reset"](c,this.options);if(this.options.useSorting){this.collection.sort()}this.success()}},_fetch:function(b){b=b?_.clone(b):{};var c=this.getProviderId(b.applicationVariables);var a=this.getCategoryId(b.applicationVariables);this.currentProviderId=c;this.currentCategoryId=a;JSEngine.IFAPIInitHelper.initialize("livetextnews/v1",function(e){var f=e[0];if(b.parse===undefined){b.parse=true}var g=this;var d=function(j,k){if(j){if(_.isFunction(b.error)){var i=Backbone.wrapError(b.error,g,b);i(j)}this.fail(j,k)}else{k=k[a].articles;var l=Object.keys(k);var h=0;for(index in l){(function(m){f.article({id:m},function(n,o){if(o.images.length>0){k[m].image_url=o.images[0].url}h++;this.checkAsyncReady(l.length,h,k)}.createDelegate(this))}.createDelegate(g))(k[l[index]].id)}}}.createDelegate(this);f.categories({provider_id:c},d)}.createDelegate(this))}});namespace("JSEngine");JSEngine.CityCurrentWeatherCollection=JSEngine.BaseLiveTextNewsCollection.extend({initialize:function(b,a){a=a||{};this.alwaysFetch=a.alwaysFetch;helpers.assertParametersExistAndAddToObject(a,["jsonPathToCityIdInApplicationVariables","jsonPathToRegionIdInApplicationVariables"],this);helpers.addParametersToObjectIfExist(a,["staticRegionIdInApplicationVariables","staticCityIdInApplicationVariables"],this);JSEngine.BaseLiveTextNewsCollection.prototype.initialize.call(this,b,a)},hasFeedChanged:function(c){var a=this.getCityId(c);var b=this.getRegionId(c);return this.alwaysFetch||((a!==this.currentCityId)||(b!==this.currentRegionId))},getCityId:function(b){if(b){if(!_.isEmpty(this.jsonPathToCityIdInApplicationVariables)){var a=jsonPath(b,this.jsonPathToCityIdInApplicationVariables);if(_.isArray(a)&&a.length>0){return a[0]}}if(this.staticCityIdInApplicationVariables!=undefined){return this.staticCityIdInApplicationVariables}}return null},getRegionId:function(b){if(b){if(!_.isEmpty(this.jsonPathToRegionIdInApplicationVariables)){var a=jsonPath(b,this.jsonPathToRegionIdInApplicationVariables);if(_.isArray(a)&&a.length>0){return a[0]}}if(this.staticRegionIdInApplicationVariables!=undefined){return this.staticRegionIdInApplicationVariables}}return null},_fetch:function(b){b=b?_.clone(b):{};var a=this.getCityId(b.applicationVariables);var c=this.getRegionId(b.applicationVariables);var d=b.applicationVariables.language||"en";JSEngine.IFAPIInitHelper.initialize("livetextnews/v1",function(f){var g=f[0];if(b.parse===undefined){b.parse=true}var h=this;var e=function(k,l){if(k){if(_.isFunction(b.error)){var j=Backbone.wrapError(b.error,h,b);j(k)}this.fail(k,l)}else{var i=function(n,m){l=l.regions[c]["cities"][a];if(!n){l.name=m}else{console.debug(n.text)}if(b.useSorting){h.comparator=function(o){return b.comparator(o,b)}}h[b.add?"add":"reset"](h.parse(l),b);this.currentCityId=a;this.currentRegionId=c;if(b.useSorting){h.sort()}this.success()}.createDelegate(this);JSEngine.AirportInfoHelper.cityNameByICAO({icao_code:a,lang:d},i)}}.createDelegate(this);g.currentWeather(e)}.createDelegate(this))},parse:function(a){if(a){a=JSEngine.BaseCollection.prototype.parse.call(this,a);if(a.current_temp){var b=a.current_temp;a.current_temp={celsius:b,fahrenheit:(((b*9)/5)+32)}}}return a}});namespace("JSEngine");JSEngine.CityForecastWeatherCollection=JSEngine.BaseLiveTextNewsCollection.extend({initialize:function(b,a){a=a||{};this.alwaysFetch=a.alwaysFetch;helpers.assertParametersExistAndAddToObject(a,["jsonPathToCityIdInApplicationVariables","jsonPathToForecastDaysInApplicationVariables"],this);helpers.addParametersToObjectIfExist(a,["staticCityIdInApplicationVariables","staticForecastDaysInApplicationVariables","disableCityNameLookup"],this);JSEngine.BaseLiveTextNewsCollection.prototype.initialize.call(this,b,a)},hasFeedChanged:function(c){var a=this.getCityId(c);var b=this.getForecastDays(c);return this.alwaysFetch||((a!==this.currentCityId)||(b!==this.currentForecastDays))},getCityId:function(b){if(b){if(!_.isEmpty(this.jsonPathToCityIdInApplicationVariables)){var a=jsonPath(b,this.jsonPathToCityIdInApplicationVariables);if(_.isArray(a)&&a.length>0){return a[0]}}if(this.staticCityIdInApplicationVariables!=undefined){return this.staticCityIdInApplicationVariables}}return null},getForecastDays:function(b){if(b){if(!_.isEmpty(this.jsonPathToCityIdInApplicationVariables)){var a=jsonPath(b,this.jsonPathToForecastDaysInApplicationVariables);if(_.isArray(a)&&a.length>0){return a[0]}else{if(this.staticForecastDaysInApplicationVariables!=undefined){return this.staticForecastDaysInApplicationVariables}}}else{if(this.staticForecastDaysInApplicationVariables!=undefined){return this.staticForecastDaysInApplicationVariables}}}return null},_fetch:function(b){b=b?_.clone(b):{};var a=this.getCityId(b.applicationVariables);var c=this.getForecastDays(b.applicationVariables);var e=(b.applicationVariables&&b.applicationVariables.language)?b.applicationVariables.language:"en";if(c==undefined){var d=3;c=d}JSEngine.IFAPIInitHelper.initialize("livetextnews/v1",function(g){var h=g[0];if(b.parse===undefined){b.parse=true}var i=this;var f=function(l,m){if(l){if(_.isFunction(b.error)){var k=Backbone.wrapError(b.error,i,b);k(l)}this.fail(l,m)}else{var j=function(o,n){var p=_.toArray(m);if(!o){_.each(p,function(q){q.cityName=n})}else{console.debug(o.text)}if(b.useSorting){i.comparator=function(q){return b.comparator(q,b)}}i[b.add?"add":"reset"](p,b);this.currentCityId=a;this.currentForecastDays=c;if(b.useSorting){i.sort()}this.success()}.createDelegate(this);if(!this.disableCityNameLookup){JSEngine.AirportInfoHelper.cityNameByICAO({icao_code:a,lang:e},j)}else{j(null,a)}}}.createDelegate(this);h.forecastWeather({icao_code:a,days:c},f)}.createDelegate(this))},parse:function(a){if(a){a=JSEngine.BaseCollection.prototype.parse.call(this,a);if(_.isArray(a)){_.each(a,function(b){b.high_temp=this.convertWeatherDegreeCelciusToCelciusAndFahrenheit(b.high_temp);b.low_temp=this.convertWeatherDegreeCelciusToCelciusAndFahrenheit(b.low_temp);b.current_temp=this.convertWeatherDegreeCelciusToCelciusAndFahrenheit(b.current_temp)},this)}}return a}});namespace("JSEngine");JSEngine.CityListWeatherCollection=JSEngine.BaseLiveTextNewsCollection.extend({initialize:function(b,a){a=a||{};this.alwaysFetch=a.alwaysFetch;this.useCachedCopy=a.useCachedCopy;helpers.assertParametersExistAndAddToObject(a,["jsonPathToRegionIdInApplicationVariables"],this);helpers.addParametersToObjectIfExist(a,["staticRegionIdInApplicationVariables"],this);JSEngine.BaseLiveTextNewsCollection.prototype.initialize.call(this,b,a)},hasFeedChanged:function(b){var a=this.getRegionId(b);return this.alwaysFetch||(a!==this.currentRegionId)||!this.useCachedCopy},getRegionId:function(b){if(b){if(!_.isEmpty(this.jsonPathToRegionIdInApplicationVariables)){var a=jsonPath(b,this.jsonPathToRegionIdInApplicationVariables);if(_.isArray(a)&&a.length>0){return a[0]}}if(this.staticRegionIdInApplicationVariables!=undefined){return this.staticRegionIdInApplicationVariables}}return null},_fetch:function(a){a=a?_.clone(a):{};var b=this.getRegionId(a.applicationVariables);var c=a.applicationVariables.language||"en";JSEngine.IFAPIInitHelper.initialize("livetextnews/v1",function(e){var f=e[0];a.parse=(a.parse===undefined)?true:a.parse;var g=this;var d=function(k,o){var m=[];if(k){if(_.isFunction(a.error)){var h=Backbone.wrapError(a.error,g,a);h(k)}this.fail(k,o)}else{if(_.isArray(o.regions[b].cities)){for(var p in o.regions[b].cities){if(_.isObject(o.regions[b].cities[p])){m.push(o.regions[b].cities[p])}}}else{m=_.toArray(o.regions[b].cities)}var j=0;var l=[];_.each(m,function(i){l.push(i.icao_code)});JSEngine.AirportInfoHelper.cityNamesByICAO(l,c,function(i){_.each(m,function(n){n.name=i[n.icao_code]});if(a.useSorting){g.comparator=function(n){return a.comparator(n,a)}}g[a.add?"add":"reset"](m,a);this.currentRegionId=b;if(a.useSorting){g.sort()}this.success()}.createDelegate(this))}}.createDelegate(this);f.currentWeather(d)}.createDelegate(this))}});namespace("JSEngine");JSEngine.DestinationCurrentWeatherCollection=JSEngine.BaseLiveTextNewsCollection.extend({initialize:function(b,a){a=a||{};this.forecastDays=a.forecastDays||5;this.error=a.error;JSEngine.BaseLiveTextNewsCollection.prototype.initialize.call(this,b,a)},hasFeedChanged:function(a){return true},_fetch:function(a){a=a?_.clone(a):{};JSEngine.IFAPIInitHelper.initialize("flightdata/v1",function(b){var c=b[0];c.destinationICAO(function(e,d){if(e){console.error("DestinationCurrentWeatherCollection: ",e);this.fail()}else{JSEngine.IFAPIInitHelper.initialize("livetextnews/v1",function(f){var g=f[0];g.forecastWeather({icao_code:d,days:this.forecastDays},this.weatherReturned.createDelegate(this,[d,a],true))}.createDelegate(this))}}.createDelegate(this))}.createDelegate(this))},weatherReturned:function(e,f,d,b){if(e||!f){if(_.isFunction(this.error)){var a=Backbone.wrapError(this.error,collection,b);a(e)}this.fail(e,f)}else{for(var c=0;c<f.length;c++){f[c]=this.parse(f[c]);f[c].icao_code=d}this.reset(f,b);this.success()}},parse:function(a){if(a){a=JSEngine.BaseLiveTextNewsCollection.prototype.parse.call(this,a);a.high_temp=this.convertWeatherDegreeCelciusToCelciusAndFahrenheit(a.high_temp);a.low_temp=this.convertWeatherDegreeCelciusToCelciusAndFahrenheit(a.low_temp);a.current_temp=this.convertWeatherDegreeCelciusToCelciusAndFahrenheit(a.current_temp)}return a}});namespace("JSEngine");JSEngine.FlightDataCollection=JSEngine.BaseCollection.extend({initialize:function(b,a){a=a||{};helpers.assertParametersExistAndAddToObject(a,["jsonPathToFlightDataFunctionInApplicationVariables"],this);JSEngine.BaseCollection.prototype.initialize.call(this,b,a)},hasFeedChanged:function(){return true},_fetch:function(m,k){m=m?_.clone(m):{};if(m.parse===undefined){m.parse=true}var f="en";if(this.options.applicationVariables&&this.options.applicationVariables.language){f=this.options.applicationVariables.language}var g=this,b=this.jsonPathToFlightDataFunctionInApplicationVariables,d=b.split(" "),i=d.length,h={},a=function(o,p){if(o){if(_.isFunction(m.error)){var n=Backbone.wrapError(m.error,g,m);n(o)}this.trigger("fetchFail",o,p)}else{if(b!="currentCoordinates"){var q=new Object();q.value=p;p=q}p=[p];g[m.add?"add":"reset"](g.parse(p),m);this.trigger("fetchSuccess",g)}return}.createDelegate(this),c={arguments:null,finalCallback:null,completed:false,contex:null,counter:0,_loopEnded:false,init:function(n,o){this.finalCallback=n;this.contex=o||null},newCall:function(){this.counter++},callDone:function(){this.counter--;this.arguments=arguments;this._check()},loopEnded:function(){this._loopEnded=true;this._check()},_check:function(){if(this._loopEnded&&this.counter===0&&!this.completed){this.finalCallback.apply(this.contex,this.arguments);this.completed=true}}},l=function(r,s,q){if(q=="destinationICAO"||q=="originICAO"){var o=function(u,v){var t={icao:s,name:u?"":v};if(u){console.debug(u.text)}h[q]=t;c.callDone(r,h)};JSEngine.AirportInfoHelper.cityNameByICAO({icao_code:s,lang:f},o)}else{if(q=="groundSpeed"||q=="headWindSpeed"||q=="windSpeed"){var n=Math.round(s*1.609344);h[q+"Kmph"]=n}if(q=="altitude"){var p=Math.round(s*0.3048);h[q+"M"]=p}h[q]=s;c.callDone(r,h)}}.createDelegate(this),j=function(o,n){for(var p=0;p<i;p++){var q=n[p];if(q!==""){if(q!=="waypoints"){(function(r){if(_.isFunction(o[r])){c.newCall();o[r](function(s,t){l(s,t,r)})}else{if(o[r]){c.newCall();l(null,o[r],r)}else{console.error(r+" is not a function or variable in theFlightData section of the InFlight API. Check the documentation.")}}})(q);c.loopEnded()}else{throw new Error("Waypoints api needs to be called by its own Collection")}}}},e=function(n){c.init(a,this);j(n[0],d)}.createDelegate(this);JSEngine.IFAPIInitHelper.initialize("flightdata/v1",e)}});namespace("JSEngine");JSEngine.FlightDataWaypointsCollection=JSEngine.BaseCollection.extend({initialize:function(b,a){a=a||{};helpers.assertParametersExistAndAddToObject(a,["numPoints"],this);JSEngine.BaseCollection.prototype.initialize.call(this,b,a)},hasFeedChanged:function(){return true},_fetch:function(a){a=a?_.clone(a):{};JSEngine.IFAPIInitHelper.initialize("flightdata/v1",function(d){var b=d[0];if(a.parse===undefined){a.parse=true}var e=this;var c=function(g,i){if(g){if(_.isFunction(a.error)){var f=Backbone.wrapError(a.error,e,a);f(g)}this.trigger("fetchFail",g,i)}else{var h=_.toArray(i);if(a.useSorting){e.comparator=function(j){return a.comparator(j,a)}}e[a.add?"add":"reset"](h,a);if(a.useSorting){e.sort()}this.trigger("fetchSuccess",e)}}.createDelegate(this);b.waypoints({numPoints:this.numPoints},c)}.createDelegate(this))}});namespace("JSEngine");JSEngine.RegionListWeatherCollection=JSEngine.BaseLiveTextNewsCollection.extend({initialize:function(b,a){a=a||{};this.alwaysFetch=a.alwaysFetch;JSEngine.BaseLiveTextNewsCollection.prototype.initialize.call(this,b,a)},hasFeedChanged:function(){if(this.hasBeenInitialised&&!this.alwaysFetch){return false}else{return true}},_fetch:function(b){b=b?_.clone(b):{};var a=!b.useCachedCopy;a=a?true:(!this.hasBeenInitialised);if(a){JSEngine.IFAPIInitHelper.initialize("livetextnews/v1",function(d){var e=d[0];if(b.parse===undefined){b.parse=true}var f=this;var c=function(h,j){if(h){if(_.isFunction(b.error)){var g=Backbone.wrapError(b.error,f,b);g(h)}this.fail(h,j)}else{j=j.regions;var i=[];for(var l in j){var k=new Object();k.region_name=j[l].name;k.region_id=l;i.push(k)}this.hasBeenInitialised=true;if(b.useSorting){f.comparator=function(m){return b.comparator(m,b)}}f[b.add?"add":"reset"](i,b);if(b.useSorting){f.sort()}this.success()}}.createDelegate(this);e.currentWeather(c)}.createDelegate(this))}else{this.success()}}});namespace("JSEngine");JSEngine.UrlReplaceCollection=JSEngine.BaseCollection.extend({initialize:function(b,a){a=a||{};helpers.assertParametersExistAndAddToObject(a,["seat_class","url","item"],this);this.xs=a.xs||false;JSEngine.BaseCollection.prototype.initialize.call(this,b,a)},_fetch:function(b){b=b?_.clone(b):{};var d=[];var a=this.url;var e=new RegExp(/\[\[(.*?)\]\]/);e.global=true;var c=e.exec(a);e.global=false;d=_.reduce(c,function(g,f){if(g.length>0&&g[g.length-1].inner==undefined){g[g.length-1].inner=f}else{g[g.length]={outer:f}}return g},d);d=_.map(d,function(f){f.path=$j(this.item).attr(f.inner);return f},this);d=_.map(d,function(g){var f=jsonPath(b.applicationVariables,g.path);if(_.isArray(f)&&f.length>0){f=f[0]}g.value=f;return g},this);while(d.length>0){a=a.replace(e,d.pop().value)}if(b.applicationVariables){a=_.template(a,b.applicationVariables)}if(this.fetchedUrl!==a){this.hasBeenFetched=false}if(!this.hasBeenFetched||!b.useCachedCopy){this.fetchedUrl=a;Backbone.Collection.prototype.fetch.call(this,{success:this._success.createDelegate(this,b,true),error:this._error.createDelegate(this,b,true),url:a,dataType:this.xs?"jsonp":"json"})}else{this.trigger("fetchSuccess",this)}},_success:function(c,a,b){this.hasBeenFetched=true;this.trigger("fetchSuccess",this)},_error:function(c,a,b){this.hasBeenFetched=false;this._response=a;this.trigger("fetchFail",a);console.debug("error loading");console.debug(a)}});namespace("JSEngine");JSEngine.ContextualCollection=JSEngine.BaseCollection.extend({cacheable:false,initialize:function(b,a){a=a||{};helpers.assertParametersExistAndAddToObject(a,["path"],this);helpers.addParametersToObjectIfExist(a,["data"],this);if(_.isUndefined(this.data)){return}JSEngine.BaseCollection.prototype.initialize.call(this,b,a)},hasFeedChanged:function(){return true},_fetch:function(a){a=a?_.clone(a):{};a.parse=(a.parse===undefined)?true:a.parse;var c=this;var b=jsonPath(this.data,this.path);if(b.length>0){b=b[0]}c.reset(c.parse(b),a);this.trigger("fetchSuccess",c)}});namespace("JSEngine");JSEngine.ExtvStationsCollection=JSEngine.BaseCollection.extend({initialize:function(b,a){this.options=a||{};JSEngine.BaseCollection.prototype.initialize.call(this,b,this.options);if(a.listenToChannelChange){JSEngine.EventHandler.subscribe("extvStationChange","ExtvStationsCollection_"+(Math.random()*100000),function(c){this.onFetchSuccess(null,c)}.createDelegate(this))}},hasFeedChanged:function(){return true},onStationsChanged:function(){this.fetch()},_fetch:function(a){a=a?_.clone(a):{};JSEngine.IFAPIInitHelper.initialize("extv_metadata/v1",function(c){var b=c[0];if(a.parse===undefined){a.parse=true}if(_.isUndefined(this.isCommissioned)){if(!this.options.bypassCommissionCheck){b.isCommissioned(function(d,e){if(d||!e){this.setCommisioned(false);this.trigger("fetchFail",d,e)}else{if(!d&&e){this.doChannelFetch(b,this.onFetchSuccess.createDelegate(this))}}}.createDelegate(this))}else{this.doChannelFetch(b,this.onFetchSuccess.createDelegate(this))}}else{if(this.isCommissioned){b.stations(this.onFetchSuccess.createDelegate(this))}else{this.trigger("fetchFail",{},{})}}}.createDelegate(this))},onFetchSuccess:function(b,d){var e=this;if(b){if(_.isFunction(this.options.error)){var a=Backbone.wrapError(this.options.error,e,this.options);a(b)}this.trigger("fetchFail",b,d)}else{var c=_.toArray(d);if(this.options.useSorting){e.comparator=function(f){return this.options.comparator(f,this.options)}}e[this.options.add?"add":"reset"](c,this.options);if(this.options.useSorting){e.sort()}if(e.models.length===0){$j("html").addClass("ae-extv-empty")}else{$j("html").removeClass("ae-extv-empty")}this.trigger("fetchSuccess",e)}},setCommisioned:function(a){this.isCommissioned=a;if(a){$j("html").addClass("ae-extv-commissioned").removeClass("ae-no-extv-commissioned")}else{$j("html").removeClass("ae-extv-commissioned").addClass("ae-no-extv-commissioned")}},doChannelFetch:function(b,a){this.setCommisioned(true);b.onStationsChanged(this.onStationsChanged.createDelegate(this));b.stations(a)}});namespace("JSEngine");JSEngine.CollectionControlLink=Backbone.Model.extend({initialize:function(a){helpers.assertParametersExistAndAddToObject(a,["applicationVariables","linkType","collectionName","el","page","feedManager","newParams"],this);this.onClick=_.bind(this.onClick,this);this.newParams=a.newParams;this.el.on("click",this.onClick)},onClick:function(b){b.preventDefault();var c=this.feedManager.getDataCollectionByCollectionName(this.collectionName);if(c){switch(this.linkType){case"refresh":var a={applicationVariables:this.newParams};c.fetch(a);break;default:console.error("CollectionControlLink: Cannot find type of action for linkType in '"+this.collectionName+"'")}}else{console.error("CollectionControlLink: Unable to find collection: '"+this.collectionName+"'")}return}});var TRANSITION_DURATION,TRANSITION_TIMING_FUNCTION,TRANSITION_PROPERTY,TRANSITION_END_EVENT=null;var TRANSFORM_CSS_PROPERTY,TRANSFORM_PROPERTY=null;var IS_TOUCH,TOUCH_START,TOUCH_END,TOUCH_MOVE=null;var DURATION=800;var Transitions={table:{slideright:[[1,"0px","0px","0px"],["0px","0px",-1,"0px"]],slideleft:[[-1,"0px","0px","0px"],["0px","0px",1,"0px"]],slideup:[["0px",1,"0px","0px"],["0px","0px","0px",-1]],slidedown:[["0px",-1,"0px","0px"],["0px","0px","0px",1]]},toWidth:function(b,a){if(typeof a=="string"){return a}else{return(b.clientWidth*a)+"px"}},toHeight:function(b,a){if(typeof a=="string"){return a}else{return(b.clientHeight*a)+"px"}},applyStart:function(b,e,a,d){if(e=="pop"){if(a){b.style[TRANSFORM_PROPERTY]="scale(1.0)";b.style.opacity="1.0"}else{b.style[TRANSFORM_PROPERTY]="scale(0.2)";b.style.opacity="0.2"}return}var c=this.table[e][a?1:0];if(d){b.style[TRANSFORM_PROPERTY]="translate3d("+this.toWidth(b,c[0])+","+this.toHeight(b,c[1])+", 0px)"}else{b.style[TRANSFORM_PROPERTY]="translate("+this.toWidth(b,c[0])+","+this.toHeight(b,c[1])+")";console.log(TRANSFORM_PROPERTY,b.style[TRANSFORM_PROPERTY])}},applyGo:function(b,e,a,d){$j("#element-masker").show();b.style[TRANSITION_DURATION]=DURATION+"ms";b.style[TRANSITION_TIMING_FUNCTION]="ease-in-out";if(e=="pop"){if(a){b.style[TRANSITION_PROPERTY]=TRANSFORM_CSS_PROPERTY+" opacity";b.style[TRANSFORM_PROPERTY]="scale(0.2)";b.style.opacity="0.2"}else{b.style[TRANSITION_PROPERTY]=TRANSFORM_CSS_PROPERTY+" opacity";b.style[TRANSFORM_PROPERTY]="scale(1.0)";b.style.opacity="1.0"}return}b.style[TRANSITION_PROPERTY]=TRANSFORM_CSS_PROPERTY;var c=this.table[e][a?1:0];if(d){b.style[TRANSFORM_PROPERTY]="translate3d("+this.toWidth(b,c[2])+","+this.toHeight(b,c[3])+",0px)"}else{b.style[TRANSFORM_PROPERTY]="translate("+this.toWidth(b,c[2])+","+this.toHeight(b,c[3])+")"}},applyEnd:function(a){$j("#element-masker").hide();a.style[TRANSITION_DURATION]="";a.style[TRANSITION_TIMING_FUNCTION]="";a.style[TRANSITION_PROPERTY]="";a.style[TRANSFORM_PROPERTY]="";a.style.opacity=""},oneOf:function(c,b){for(var a=0;a<b.length;++a){if(b[a] in c.style){return b[a]}}return null},initCompatability:function(){TRANSITION_PROPERTY=this.oneOf(document.body,["OTransitionProperty","webkitTransitionProperty","MozTransitionProperty","msTransitionProperty","transitionProperty"]);TRANSITION_END_EVENT=null;switch(TRANSITION_PROPERTY){case"webkitTransitionProperty":TRANSITION_END_EVENT="webkitTransitionEnd";TRANSFORM_PROPERTY="webkitTransform";TRANSITION_DURATION="webkitTransitionDuration";TRANSITION_TIMING_FUNCTION="webkitTransitionTimingFunction";TRANSFORM_CSS_PROPERTY="-webkit-transform";break;case"OTransitionProperty":TRANSITION_END_EVENT="oTransitionEnd";TRANSFORM_PROPERTY="OTransform";TRANSITION_DURATION="OTransitionDuration";TRANSITION_TIMING_FUNCTION="OTransitionTimingFunction";TRANSFORM_CSS_PROPERTY="-o-transform";break;case"MozTransitionProperty":TRANSITION_END_EVENT="transitionend";TRANSFORM_PROPERTY="MozTransform";TRANSITION_DURATION="MozTransitionDuration";TRANSITION_TIMING_FUNCTION="MozTransitionTimingFunction";TRANSFORM_CSS_PROPERTY="-moz-transform";break}IS_TOUCH=true;TOUCH_START="touchstart";TOUCH_END="touchend";TOUCH_MOVE="touchmove";if(typeof(Touch)!="object"){IS_TOUCH=false;TOUCH_START="mousedown";TOUCH_END="mouseup";TOUCH_MOVE="mousemove"}},runSimpleTransition:function(b,f,e,g,d,c){var i=this;if(_.isUndefined(this.hasInitialized)){this.initCompatability();this.supportsCSSTransforms3D=$j("html").hasClass("csstransforms3d");this.hasInitialized=true}if(this.supportsCSSTransforms3D){var h=false;function a(j){if(j.target===b){h=true;b.removeEventListener(TRANSITION_END_EVENT,a,false);i.applyEnd(b);if(d){d()}}}b.addEventListener(TRANSITION_END_EVENT,a,false);this.applyStart(b,f,e,this.trans3d);if(c){c()}helpers.setTimeout(function(){console.log("move left");i.applyGo(b,f,e,this.trans3d);helpers.setTimeout(function(){if(!h){a({target:b})}},(DURATION+200))},0)}else{if(e){$j(b).addClass("hide")}else{$j(b).removeClass("hide");$j(b).removeClass("hidden")}if(c){c()}if(d){d()}}},runSwapTransition:function(e,b,h,g,a,c){var f=function(){b.removeClass("transition-in").removeClass("transition-out");if(e){e.removeClass("transition-in").removeClass("transition-out")}if(a){a()}};var d=function(){e.addClass("hide");e.addClass("ae-hide")};b.addClass("transition-in");b.removeClass("hide");b.removeClass("hidden");b.removeClass("ae-hide");if(e){e.addClass("transition-out")}Transitions.runSimpleTransition(b[0],h,false,g,f,c);if(e){Transitions.runSimpleTransition(e[0],h,true,g,d)}},runFadeInOutTransition:function(d,b,f,e,c){var a=function(){if(d){d.addClass("hide");d.addClass("ae-hide");d.attr("style","")}var g=function(){b.removeClass("hide");b.removeClass("hidden");b.removeClass("ae-hide");b.attr("style","");if(e){$j("#element-masker").hide();e()}};b.fadeIn(f+"",g);if(c){c()}};$j("#element-masker").show();if(d){d.fadeOut(f+"",a)}else{a()}}};namespace("JSEngine");JSEngine.SlideFromLeftTransitionHandler=JSEngine.PageTransitionHandler.extend({initialize:function(){},doTransition:function(i,a,b,e){var d=i.pop();var f=false;var c=function(){i.push(a);if(d&&(d!==a)){d.trigger("transitionAway")}e()};var h=function(){try{a.trigger("renderContent",b);$j(".pseudo-page").not(a.el).addClass("hide");$j(".pseudo-page").not(a.el).addClass("ae-hide");a.el.removeClass("hide");a.el.removeClass("ae-hide")}catch(j){console.log("Error triggering 'renderContent'",j)}};if(d!==a){if(d){var g=this.getElementsToTransition(d,a);Transitions.runSwapTransition(g.outElement,g.inElement,"slideright",f,c,h)}else{Transitions.runSwapTransition(null,a.el,"slideright",f,c,h);this.hideAllMasterPagesButNew(a)}}else{h();c()}}});namespace("JSEngine");JSEngine.SlideFromRightTransitionHandler=JSEngine.PageTransitionHandler.extend({initialize:function(){},doTransition:function(i,a,b,e){var d=i.pop();var f=false;var c=function(){i.push(a);if(d&&(d!==a)){d.trigger("transitionAway")}e()};var h=function(){try{a.trigger("renderContent",b);$j(".pseudo-page").not(a.el).addClass("hide");$j(".pseudo-page").not(a.el).addClass("ae-hide");a.el.removeClass("hide");a.el.removeClass("ae-hide")}catch(j){console.log("Error triggering 'renderContent'",j)}};if(d!==a){if(d){var g=this.getElementsToTransition(d,a);Transitions.runSwapTransition(g.outElement,g.inElement,"slideleft",f,c,h)}else{Transitions.runSwapTransition(null,a.el,"slideleft",f,c,h);this.hideAllMasterPagesButNew(a)}}else{h();c()}}});namespace("JSEngine");JSEngine.ContextualPageTransitionHandler=JSEngine.PageTransitionHandler.extend({initialize:function(){this.leftTransitionHandler=new JSEngine.SlideFromLeftTransitionHandler();this.rightTransitionHandler=new JSEngine.SlideFromRightTransitionHandler();this.defaultTransionHandler=new JSEngine.PageTransitionHandler()},doTransition:function(f,e,g,b){var d=f[0];if(!_.isUndefined(d)){var c=e.el.attr("data-transition-right-pages");var a=e.el.attr("data-transition-left-pages");if(this.tryTransition(this.leftTransitionHandler,c,f,d,e,g,b)){return}else{if(this.tryTransition(this.rightTransitionHandler,a,f,d,e,g,b)){return}}}this.defaultTransionHandler.doTransition(f,e,g,b)},tryTransition:function(i,g,h,e,c,d,f){if(g){var a=g.split(" ");var b=e.el.attr("id");if(a.indexOf(b)>=0){i.doTransition(h,c,d,f);return true}}return false}});namespace("JSEngine");JSEngine.FancyboxPageTransitionHandler=JSEngine.PageTransitionHandler.extend({initialize:function(a){this.config=a||{}},doTransition:function(j,b,c,g){var f=j.length>=1?j[j.length-1]:undefined;this.currentPage=f;this.isOpen=true;b.el.detach();var h=$j("#modal-window-generic");var d=h.attr("data-fade-duration");var a=h.find("a.modal-close,.modal-window-overlay");var e=h.find(".modal-window-inner");a.unbind("click");a.bind("click",function(k){k.preventDefault();this.close(j,function(){if(f){helpers.changeDocumentLocation(f.lastUrl)}})}.createDelegate(this));e.append(b.el);b.el.removeClass("hide");var i=function(){try{b.trigger("renderContent",c)}catch(k){console.log("Error triggering 'renderContent'",k)}this.currentPage.el.attr("aria-hidden","true");if(g){g()}}.createDelegate(this);h.attr("style","display: none;");h.removeClass("hide");h.fadeIn(d,i);j.push(b)},close:function(d,a){if(this.isOpen){this.isOpen=false;var e=$j("#modal-window-generic");var c=d.pop();var b=function(){c.el.addClass("hide");e.addClass("hide");e.attr("style","");c.el.detach();c.trigger("hideModalWindow");this.currentPage.el.attr("aria-hidden","false");c.trigger("transitionAway");if(a){a()}}.createDelegate(this);e.fadeOut(this.transitionDuration,b)}},beforeTransitionAway:function(c,b,d,a){this.close(c,a)}});namespace("JSEngine");JSEngine.FadeInOutTransitionHandler=JSEngine.PageTransitionHandler.extend({initialize:function(){},doTransition:function(i,a,b,e){var d=i.pop();var f=parseInt(a.el.attr("data-transition-time-ms"))||500;var c=function(){i.push(a);if(d&&(d!==a)){d.trigger("transitionAway")}$j(".pseudo-page").not(a.el).addClass("hide");$j(".pseudo-page").not(a.el).addClass("ae-hide");a.el.removeClass("hide");a.el.removeClass("ae-hide");e()};var h=function(){try{a.trigger("renderContent",b)}catch(j){console.log("Error triggering 'renderContent'",j)}};if(d!==a){if(d){var g=this.getElementsToTransition(d,a);Transitions.runFadeInOutTransition(g.outElement,g.inElement,f,c,h)}else{Transitions.runFadeInOutTransition(null,a.el,f,c,h);this.hideAllMasterPagesButNew(a)}}else{h();c()}}});namespace("JSEngine");JSEngine.EventHandlerWrapper=Backbone.Model.extend({lastEvents:{},initialize:function(a){if(this.subscribers){throw new Error("Event Handler has already been initialised")}this.subscribers={};this.appConfig=a||{useServiceControl:true}},subscribe:function(d,e,a,b){if(!this.subscribers){throw new Error("Event Handler has not been initialised")}var c=d.split(":");if(_.isUndefined(this.subscribers[c[0]])&&!this.tryInitialiseEventListener(c[0])){throw new Error("The event '"+c[0]+"' has not been registered")}else{if(_.isUndefined(this.subscribers[d])){this.subscribers[d]={}}if(!_.has(this.subscribers[d],e)){this.subscribers[d][e]={cb:a,context:b}}}if(!_.isUndefined(this.lastEvents[d])&&this.lastEvents[d]!=null){a.call(b,this.lastEvents[d])}return this.lastEvents[d]},unSubscribe:function(a,b){if(!_.isUndefined(this.subscribers[a])){if(!_.isUndefined(this.subscribers[a][b])){delete this.subscribers[a][b]}}},notify:function(a,b){this.lastEvents[a]=b;if(!_.isUndefined(this.subscribers[a])){_.each(this.subscribers[a],function(c){c.cb.call(c.ctx,b)})}},registerEvent:function(b,a){this.lastEvents[b]=a;this.subscribers[b]={}},getEventState:function(a){return((_.isUndefined(this.lastEvents[a]))?null:this.lastEvents[a])},tryInitialiseEventListener:function(a){switch(a){case"extvStationChange":this.initExtvStationChange();return true;case"ltnUpdate":this.initLtnEvents();return true;case"eXConnectStatus":this.initEXConnectEvent();return true;case"paoff":case"paaudio":case"pavideo":case"pavideoa":case"paother":this.initSystemMessage();return true;case"serviceControlStatusChange":if(this.appConfig.useServiceControl){this.initServiceControlEvent()}return true;case"flightEvents":this.initNewFlightCheck();return true}return false},initSystemMessage:function(){JSEngine.IFAPIInitHelper.initialize("system/v1",function(a){var b=a[0];b.addEventListener(b.PA_STATE,function(d){var c="";switch(d.data.pa_state){case b.PAState.OFF:c="paoff";break;case b.PAState.AUDIO:c="paaudio";break;case b.PAState.VIDEO:c="pavideo";break;case b.PAState.VIDEO_ANNOUNCEMENT:c="pavideoa";break;default:c="paother";break}this.notify(c,d)}.createDelegate(this))}.createDelegate(this));this.registerEvent("paoff",null);this.registerEvent("paaudio",null);this.registerEvent("pavideo",null);this.registerEvent("pavideoa",null);this.registerEvent("paother",null)},initExtvStationChange:function(){var a=this;this.registerEvent("extvStationChange",null);JSEngine.IFAPIInitHelper.initialize("extv_metadata/v1",function(d){var b=d[0];var c=function(){var e=function(f,g){if(f){console.error("Problem retrieving Channel List",f.code)}else{a.notify("extvStationChange",g)}};b.stations(e)};b.onStationsChanged(c)})},initLtnEvents:function(){var a=this;this.registerEvent("ltnUpdate");JSEngine.IFAPIInitHelper.initialize("livetextnews/v1",function(b){var c=b[0];c.addEventListener(c.Events.UPDATE,function(){a.notify("ltnUpdate")})})},initEXConnectEvent:function(){this.buildExconnectStatus();this.registerEvent("eXConnectStatus");JSEngine.IFAPIInitHelper.initialize("exconnect/v1",function(a){var b=a[0];b.addEventListener(b.Events.GLOBAL_CONN_ENABLED_CHANGE,function(c){$j.cookie("eXConnectStatus_connectionState",c.global_conn_enabled);this.buildExconnectStatus();this.notify("eXConnectStatus",this.eXConnectStatus)}.createDelegate(this));b.addEventListener(b.Events.TIME_UNTIL_COVERAGE_CHANGE_CHANGE,function(c){$j.cookie("eXConnectStatus_timeUntilCoverageChange",c.time_until_coverage_change);this.buildExconnectStatus();this.notify("eXConnectStatus",this.eXConnectStatus)}.createDelegate(this));b.addEventListener(b.Events.TOTAL_COVERAGE_REMAINING_CHANGE,function(c){$j.cookie("eXConnectStatus_totalCoverageRemaining",c.total_coverage_remaining);this.buildExconnectStatus();this.notify("eXConnectStatus",this.eXConnectStatus)}.createDelegate(this))}.createDelegate(this))},buildExconnectStatus:function(){this.eXConnectStatus={connectionState:$j.cookie("eXConnectStatus_connectionState")=="true",timeUntilCoverageChange:$j.cookie("eXConnectStatus_timeUntilCoverageChange")||0,totalCoverageRemaining:$j.cookie("eXConnectStatus_totalCoverageRemaining")||0}},initServiceControlEvent:function(){this.registerEvent("serviceControlStatusChange");JSEngine.IFAPIInitHelper.initialize("service_control/v1",function(a){var b=a[0];b.getAllServices(function(d,c){if(!d){_.each(c,function(e){e.serviceName=e.media_uri;delete e.media_uri;this.notify("serviceControlStatusChange",e);this.notify("serviceControlStatusChange:"+e.serviceName,e)}.createDelegate(this))}else{console.error("Problem checking service status",d.code)}}.createDelegate(this));b.addEventListener(b.Events.SERVICE_CHANGE,function(d){var c={serviceName:d.media_uri,blocked:(d.blocked==="1"||d.blocked==true),enabled:(d.enabled==="1"||d.enabled==true)};this.notify("serviceControlStatusChange",c);this.notify("serviceControlStatusChange:"+c.serviceName,c)}.createDelegate(this))}.createDelegate(this))},initNewFlightCheck:function(){this.registerEvent("flightEvents");var a=new JSEngine.FlightIdItem();a.on("change:flight_id",function(){this.notify("flightEvents:flightChange",a.get("flight_id"))}.createDelegate(this));a.fetch({success:function(){this.notify("flightEvents:initialise",a.get("flight_id"))}.createDelegate(this),error:function(){var b=(Math.random()*-1000);this.notify("flightEvents:initialise",b);a.set("flight_id",b)}.createDelegate(this)});helpers.setInterval(function(){a.fetch()},60000)}});namespace("JSEngine");JSEngine.TouchHandler={touchStartX:0,touchEndx:0,touchStartY:0,touchEndY:0,defPercentage:10,triggerAClick:function(c){var b=$j(c).data("events")||$j._data(c,"events");if((c&&c.nodeName==="A")||(b&&b.click)){if((b&&b.click)||c.onclick){var a=$j(c);if(a.data("type")!=="JSEngine.ServiceBlockingURL"){a.click()}else{helpers.changeDocumentLocation(c.href)}}else{helpers.changeDocumentLocation(c.href)}return true}else{if(c){return this.triggerAClick(c.parentNode)}else{return false}}},startTouchStartAndEndHandler:function(a,b){this.touchStart=function(c){if(this.mustPreventDefault(c.target)){c.preventDefault();this.eventTarget=c.target;this.touchStartX=c.originalEvent.changedTouches[0].pageX;this.touchStartY=c.originalEvent.changedTouches[0].pageY}}.createDelegate(this);$j(document).bind("touchstart",this.touchStart);this.touchEnd=function(j){if(this.eventTarget){this.touchEndX=j.originalEvent.changedTouches[0].pageX;this.touchEndY=j.originalEvent.changedTouches[0].pageY;a=(a>100)?this.defPercentage:a;var n=$j(document).height();var f=$j(document).width();var d=Math.pow(n,2);var g=Math.pow(f,2);var i=d+g;var c=Math.ceil(Math.sqrt(i)*(a/100));var l=Math.abs(this.touchStartX-this.touchEndX);var k=Math.abs(this.touchStartY-this.touchEndY);var h=false;var m="horizontal";if(b.length===1&&f>=b[0].minWidth){m=b[0].direction}else{if(b.length>1){_.each(b,function(e){if(f>=e.minWidth){m=e.direction}})}}switch(m){case"horizontal":if(l<=c){h=true}break;case"vertical":if(k<=c){h=true}break;case"both":if(l<=c&&k<=c){h=true}break}if(h){try{if(this.eventTarget){this.triggerAClick(this.eventTarget)}}catch(j){}}delete this.eventTarget}}.createDelegate(this);$j(document).bind("touchend",this.touchEnd)},mustPreventDefault:function(a){if(this.eventTarget){return false}targetJ=$j(a);if(targetJ.hasClass("swiper")){return false}if(this.inheritsClass(a,"ignore-drag-to-click")||this.inheritsClass(a,"ae-ignore-prevent-touchmove")){return false}return true},inheritsClass:function(b,a){if($j(b).hasClass(a)){return true}else{if(b.parentNode){return this.inheritsClass(b.parentNode,a)}}return false},initStmhResponsive:function(a){$j(window).on("resize",function(){if(helpers.matchMedia(a).matches!=this.stmhMatchMedia){this.stmhMatchMedia=helpers.matchMedia(a).matches;if(this.stmhMatchMedia){$j(document).bind("touchmove",this.stmhTouchMove)}else{$j(document).unbind("touchmove",this.stmhTouchMove)}}}.createDelegate(this))},startTouchMoveHandler:function(a){if(_.isString(a)){this.stmhMatchMedia=true;this.initStmhResponsive(a);if(!helpers.matchMedia(a).matches){this.stmhMatchMedia=false;return}}this.stmhTouchMove=function(b){b.preventDefault()};$j(document).bind("touchmove",this.stmhTouchMove)}};namespace("JSEngine");JSEngine.BGHandler={interval:3600000,ranges:[],flightDataFunction:"timeAtDestination",timer:null,htmlElement:null,initialise:function(a,b){this.flightDataFunction=a.valueToCheck;this.interval=a.interval;this.ranges=a.ranges;this.htmlElement=b;if(this.timer===null){this.init()}},init:function(){clearTimeout(this.timer);JSEngine.IFAPIInitHelper.initialize("flightdata/v1",function(b){var c=b[0];var a=function(d,e){if(d){console.debug("BGHandler Error",d)}else{_.each(this.ranges,function(f){if(this.inRange(f,e)){this.htmlElement.addClass(f.cssClass);return true}else{this.htmlElement.removeClass(f.cssClass)}}.createDelegate(this));this.timer=setTimeout(this.init,this.interval)}}.createDelegate(this);if(typeof c[this.flightDataFunction]==="function"){c[this.flightDataFunction](a)}else{console.error("BGHandler Error, the supplied function is not a Flight Data function: "+this.flightDataFunction)}}.createDelegate(this))},inRange:function(d,a){var e=false;var c=new Date();var b=new Date();c.setHours(d.start.hours);c.setMinutes(d.start.minutes);b.setHours(d.end.hours);b.setMinutes(d.end.minutes);if(c.getTime()<=a.getTime()&&b.getTime()>=a.getTime()){e=true}return e}};namespace("JSEngine");JSEngine.SortableContainer=JSEngine.DynamicContainer.extend({initialize:function(a){var b={};if(a.disabled){b.disabled=a.disabled}b.el=a.el;this.dragAndDropManager=new JSEngine.DragAndDropManager(b);JSEngine.DynamicContainer.prototype.initialize.call(this,a)},render:function(a){this.hasBeenRendered=true;var d=this.getModelsToRender();var d=_.map(d,function(f){var e=_.indexOf(this.collection.models,f);return f.set("filterIndex",e)}.createDelegate(this));var c=this.bodyContainer;if(this.includeWrappingDiv&&c.find("div").length==0){c.append($j('<div class="wrap swiper-wrapper"/>'));c=c.find("> div")}else{if(this.includeWrappingDiv){c=c.find("> div")}}var b=true;if(_.isUndefined(this.view)){b=false;c.empty();this.view=new JSEngine.DragAndDropView({container:c,template:this.itemTemplate,noDataTemplate:this.noDataTemplate,models:d,dragAndDropManager:this.dragAndDropManager})}this.destroyChildElementWrapper();this.view.render(this.applicationVariables,d);if(b){this.createChildElementWrapper()}this.trigger("dataLoaded",this,this.collection)},initDragAndDrop:function(){this.dragAndDropManager.on("drop",this.onDrop.createDelegate(this))},onDrop:function(c,b){var a=this.collection.indexOf(c);if(a==-1||this.collection.indexOf(b)==-1){return}a++;if(a>this.collection.indexOf(b)){a--}this.collection.remove(b,{silentSecondaryEvents:true});this.collection.add(b,{at:a,silentSecondaryEvents:true});this.collection.trigger("fetchSuccess",this.collection)},cleanUp:function(){JSEngine.DynamicContainer.prototype.cleanUp.call(this)}});namespace("JSEngine");JSEngine.GrowableContainer=JSEngine.DynamicContainer.extend({initialize:function(a){this.onViewChange=_.bind(this.onViewChange,this);this.options=a;helpers.assertParametersExistAndAddToObject(a,["growCount"],this);helpers.addParametersToObjectIfExist(a,["growButtonSelector","matchMedia","retainStatePath","hideButtonClass"],this);this.hasBeenRendered=false;this.matchMedia=this.matchMedia||true;this.hideButtonClass=this.hideButtonClass||"ae-hide";this.startCount=_.isNumber(a.startCount)?a.startCount:a.growCount;this.growButton=a.growButtonSelectorScope==="all"?$j(this.growButtonSelector):this.el.find(this.growButtonSelector);this.growButton.on("click",function(b){b.preventDefault();if(this.matchMedia){this.view.grow(this.growCount)}}.createDelegate(this));JSEngine.DynamicContainer.prototype.initialize.call(this,a)},render:function(){var b=this.getModelsToRender();if(!this.view){var a=_.extend(this.getViewOptions(),{models:b});this.view=new JSEngine.GrowableView(a);this.view.on("change",this.onViewChange)}this.view.models=b;this.view.render();this.hasBeenRendered=true},cleanUp:function(){this.view.cleanUp();this.off()},getViewOptions:function(){return _.extend({},this.options,{container:this.bodyContainer,template:this.itemTemplate,noDataTemplate:this.noDataTemplate,applicationVariables:this.options.applicationVariables,page:this.options.page,feedManager:this.options.feedManager,mediaManager:this.options.mediaManager,messageManager:this.options.messageManager,growCount:this.growCount,startCount:this.startCount,growButton:this.growButton,itemClasses:this.options.itemClasses})},onViewChange:function(){if(this.view.canGrow()){this.growButton.removeClass(this.hideButtonClass)}else{this.growButton.addClass(this.hideButtonClass)}}});namespace("JSEngine");JSEngine.VODPlayer=JSEngine.BasePlayer.extend({initialize:function(a){a=a||{};var b=["videoJSImgPath","playerEl","autoPlay","mediaUri","sClass","hClass","container","persist","AVOD","posterUrl","playerW","playerH","applicationVariables","messageManager","useSkin","playerType","mediaManager"];helpers.assertParametersExistAndAddToObject(a,b,this);this.isVolumeSupported=true;this.handlers={fullScreenTypeChangedHandler:function(c){this.positionCloseButton()},endedHandler:function(c){var d=this.player.playlistGetInfo();if(!d||d.length<=1){this.player.stop()}},playlistEndHandler:function(c){this.player.stop()},playingHandler:function(c){this.positionCloseButton()},readyHandler:function(c){$j(this.container).find("object, embed").css("visibility","visible");this.positionCloseButton();this.overlayLoader.remove()},pauseHandler:function(c){if(this.rotatePause){this.buttonPause=false;this.rotatePause=false}else{this.buttonPause=true}},playlistIndexChangedHandler:function(c){this.updatePlayButtonPosition()},decompressionHandler:function(c){this.player.pause();$j(this.playerEl).avod("showMessage","pa",this.applicationVariables.messages.sysMessages.decompression.message)},paOffHandler:function(c){this.player.play();$j(this.playerEl).avod("hideMessage")},paAudioHandler:function(c){this.player.pause();$j(this.playerEl).avod("showMessage","pa",this.applicationVariables.messages.paMessages.paAudio.message);helpers.setTimeout(function(){$j(this.playerEl).avod("hideMessage")},this.applicationVariables.messages.mediaPlayerMessages.timeout)},paVideoHandler:function(c){this.player.pause();$j(this.playerEl).avod("showMessage","pa",this.applicationVariables.messages.paMessages.paVideo.message);helpers.setTimeout(function(){$j(this.playerEl).avod("hideMessage")},this.applicationVariables.messages.mediaPlayerMessages.timeout)},paVideoAHandler:function(c){this.player.pause();$j(this.playerEl).avod("showMessage","pa",this.applicationVariables.messages.paMessages.paVideoA.message);helpers.setTimeout(function(){$j(this.playerEl).avod("hideMessage")},this.applicationVariables.messages.mediaPlayerMessages.timeout)},paOtherHandler:function(c){this.player.pause();$j(this.playerEl).avod("showMessage","pa",this.applicationVariables.messages.paMessages.paOther.message);helpers.setTimeout(function(){$j(this.playerEl).avod("hideMessage")},this.applicationVariables.messages.mediaPlayerMessages.timeout)},warningHandler:function(d){var c=this.applicationVariables.messages.mediaMessages[""+d.code];if(c){this.overlayLoader.remove();this.mediaManager.cleanUp(this.playerType);this.messageManager.mediaMessage.show(c)}console.log("Media Warning Occurred: "+d.code)}};JSEngine.BasePlayer.prototype.initialize.call(this);this.createPlayer()},createPlayer:function(){this.player=new this.AVOD.VODPlayer({target:this.playerEl,width:this.playerW,height:this.playerH});this.player.addEventListener(this.AVOD.Events.FULL_SCREEN_CHANGE,this.handlers.fullScreenTypeChangedHandler.createDelegate(this));this.player.addEventListener(this.AVOD.Events.ENDED,this.handlers.endedHandler.createDelegate(this));this.player.addEventListener(this.AVOD.Events.READY,this.handlers.readyHandler.createDelegate(this));this.player.addEventListener(this.AVOD.Events.LOAD_START,this.handlers.playingHandler.createDelegate(this));this.player.addEventListener(this.AVOD.Events.PAUSE,this.handlers.pauseHandler.createDelegate(this));this.player.addEventListener(this.AVOD.Events.PLAYLIST_INDEX_CHANGE,this.handlers.playlistIndexChangedHandler.createDelegate(this));this.player.addEventListener(this.AVOD.Events.PLAYLIST_END,this.handlers.playlistEndHandler.createDelegate(this));this.player.addEventListener(this.AVOD.Events.WARNING,this.handlers.warningHandler.createDelegate(this));window.addEventListener("resize",this.positionCloseButton.createDelegate(this),false);JSEngine.EventHandler.subscribe("paoff","mPlayerPAOffHandler",this.handlers.paOffHandler.createDelegate(this),this);JSEngine.EventHandler.subscribe("paaudio","mPlayerPAAudioHandler",this.handlers.paAudioHandler.createDelegate(this),this);JSEngine.EventHandler.subscribe("pavideo","mPlayerPAVideoHandler",this.handlers.paVideoHandler.createDelegate(this),this);JSEngine.EventHandler.subscribe("pavideoa","mPlayerPAVideoAHandler",this.handlers.paVideoAHandler.createDelegate(this),this);JSEngine.EventHandler.subscribe("paother","mPlayerPAOtherHandler",this.handlers.paOtherHandler.createDelegate(this),this);this.setupBaseErrorListeners();this.addRotationHandler();this.overlayLoader=$j('<div class="cover load-generic"><div></div></div>');$j(this.container).append(this.overlayLoader);return this},load:function(){var a={media_uri:this.mediaUri,autoplay:this.autoPlay,poster_url:this.poster};this.player.load(a);this.show()},skin:function(){if(this.useSkin){$j(this.playerEl).avod({avodPlayer:this.player,controlSwf:this.getMediaPlayerControlPluginPath(),skin:"vjs-qantas-video-skin",onComplete:this.updatePlayButtonPosition.createDelegate(this)})}},updatePlayButtonPosition:function(){var a=this.player.playlistGetInfo();if(a.length>1){$j(this.playerEl).parent("div.avod-wrapper:first").find(".vjs-play-control").css("margin-left","125px")}else{$j(this.playerEl).parent("div.avod-wrapper:first").find(".vjs-play-control").css("margin-left","26px")}},positionCloseButton:function(){var c=$j(this.playerEl);var b=c.parent("div.avod-wrapper:first");var d=b.find(".vjs-stop-control");var a=b.find(".vjs-controls");var e=0;if(d.length>0&&a.length>0){e=c.width()-a.offset().left-d.width()+c.offset().left-20;closeTop=-a.position().top+50;d.css({left:e,top:closeTop})}},cleanUp:function(){if(this.persist!="true"){this.player.pause()}this.hide()},show:function(){if(!$j(this.container).hasClass(this.sClass)){$j(this.container).addClass(this.sClass)}if($j(this.container).hasClass(this.hClass)){$j(this.container).removeClass(this.hClass)}},hide:function(){if(!$j(this.container).hasClass(this.hClass)){$j(this.container).addClass(this.hClass)}if($j(this.container).hasClass(this.sClass)){$j(this.container).removeClass(this.sClass)}},addRotationHandler:function(){$j(window).bind("orientationchange",function(){switch(window.orientation){case 0:case 180:this.positionCloseButton();this.rotatePause=true;this.player.pause();break;case -90:case 90:this.positionCloseButton();if(!this.buttonPause){this.player.play()}break}}.createDelegate(this))},removeListeners:function(){JSEngine.EventHandler.unSubscribe("paoff","mPlayerPAOffHandler");JSEngine.EventHandler.unSubscribe("paaudio","mPlayerPAAudioHandler");JSEngine.EventHandler.unSubscribe("pavideo","mPlayerPAVideoHandler");JSEngine.EventHandler.unSubscribe("pavideoa","mPlayerPAVideoAHandler");JSEngine.EventHandler.unSubscribe("paother","mPlayerPAOtherHandler");JSEngine.BasePlayer.prototype.removeListeners.call(this)}});namespace("JSEngine");JSEngine.AODPlayer=JSEngine.BasePlayer.extend({initialize:function(a){a=a||{};var b=["videoJSImgPath","playerEl","autoPlay","mediaUri","sClass","hClass","container","persist","AVOD","applicationVariables","aodSkinEl","skinContainerEl","messageManager","useSkin","mediaManager","playerType"];helpers.assertParametersExistAndAddToObject(a,b,this);this.isVolumeSupported=true;this.handlers={endedHandler:function(c){},playlistIndexChangedHandler:function(c){this.trigger("playlistindexchange")},decompressionHandler:function(c){this.player.pause()},paOffHandler:function(c){this.player.play()},paAudioHandler:function(c){this.player.pause()},paVideoHandler:function(c){this.player.pause()},paVideoAHandler:function(c){this.player.pause()},paOtherHandler:function(c){this.player.pause()}};JSEngine.BasePlayer.prototype.initialize.call(this);this.createPlayer()},createPlayer:function(){this.player=new this.AVOD.AODPlayer({target:this.playerEl,width:this.playerW,height:this.playerH});this.player.addEventListener(this.AVOD.Events.PLAYLIST_INDEX_CHANGE,this.handlers.playlistIndexChangedHandler.createDelegate(this));JSEngine.EventHandler.subscribe("paoff","mPlayerPAOffHandler",this.handlers.paOffHandler.createDelegate(this),this);JSEngine.EventHandler.subscribe("paaudio","mPlayerPAAudioHandler",this.handlers.paAudioHandler.createDelegate(this),this);JSEngine.EventHandler.subscribe("pavideo","mPlayerPAVideoHandler",this.handlers.paVideoHandler.createDelegate(this),this);JSEngine.EventHandler.subscribe("pavideoa","mPlayerPAVideoAHandler",this.handlers.paVideoAHandler.createDelegate(this),this);JSEngine.EventHandler.subscribe("paother","mPlayerPAOtherHandler",this.handlers.paOtherHandler.createDelegate(this),this);this.setupBaseErrorListeners();$j("#track-meta").html("");return this},load:function(){var a={media_uri:this.mediaUri,autoplay:this.autoPlay};this.player.load(a);this.player.playlistPlayItemByIndex(0)},skin:function(){if(this.useSkin){var a={avodPlayer:this.player};if(!_.isNull(this.aodSkinEl)){if($j(this.aodSkinEl).length==0){$j(this.skinContainerEl).append($j('<div id="'+this.aodSkinEl.replace("#","")+'" class="audio-player-generic-component"></div>'))}a.playerControls=$j(this.aodSkinEl)}$j(this.playerEl).avod(a)}},cleanUp:function(){$j("#track-meta").html("");$j("#track-meta").hide();if(this.persist!="true"){this.player.pause()}},removeListeners:function(){JSEngine.EventHandler.unSubscribe("paoff","mPlayerPAOffHandler");JSEngine.EventHandler.unSubscribe("paaudio","mPlayerPAAudioHandler");JSEngine.EventHandler.unSubscribe("pavideo","mPlayerPAVideoHandler");JSEngine.EventHandler.unSubscribe("pavideoa","mPlayerPAVideoAHandler");JSEngine.EventHandler.unSubscribe("paother","mPlayerPAOtherHandler");JSEngine.BasePlayer.prototype.removeListeners.call(this)}});namespace("JSEngine");JSEngine.RadioPlayer=JSEngine.BasePlayer.extend({initialize:function(a){console.log("RadioPlayer: initialize");a=a||{};var b=["videoJSImgPath","playerEl","autoPlay","mediaUri","sClass","hClass","container","persist","AVOD","applicationVariables","aodSkinEl","skinContainerEl","messageManager","useSkin","mediaManager","playerType"];helpers.assertParametersExistAndAddToObject(a,b,this);this.isVolumeSupported=true;this.handlers={endedHandler:function(c){},playlistIndexChangedHandler:function(c){this.trigger("playlistindexchange")},decompressionHandler:function(c){this.player.player.pause()},paOffHandler:function(c){this.player.player.play()},paAudioHandler:function(c){this.player.player.pause()},paVideoHandler:function(c){this.player.player.pause()},paVideoAHandler:function(c){this.player.player.pause()},paOtherHandler:function(c){this.player.player.pause()}};JSEngine.BasePlayer.prototype.initialize.call(this);this.createPlayer()},createPlayer:function(){this.player=new this.AVOD.AODPlayer({target:this.playerEl,width:this.playerW,height:this.playerH});this.player.addEventListener(this.AVOD.Events.PLAYLIST_INDEX_CHANGE,this.handlers.playlistIndexChangedHandler.createDelegate(this));JSEngine.EventHandler.subscribe("paoff","mPlayerPAOffHandler",this.handlers.paOffHandler.createDelegate(this),this);JSEngine.EventHandler.subscribe("paaudio","mPlayerPAAudioHandler",this.handlers.paAudioHandler.createDelegate(this),this);JSEngine.EventHandler.subscribe("pavideo","mPlayerPAVideoHandler",this.handlers.paVideoHandler.createDelegate(this),this);JSEngine.EventHandler.subscribe("pavideoa","mPlayerPAVideoAHandler",this.handlers.paVideoAHandler.createDelegate(this),this);JSEngine.EventHandler.subscribe("paother","mPlayerPAOtherHandler",this.handlers.paOtherHandler.createDelegate(this),this);this.setupBaseErrorListeners();$j("#track-meta").show();return this},load:function(){var a={media_uri:this.mediaUri,autoplay:this.autoPlay};this.player.load(a);this.player.playlistPlayItemByIndex(0)},skin:function(){if(this.useSkin){var a={avodPlayer:this.player};if(!_.isNull(this.aodSkinEl)){if($j(this.aodSkinEl).length==0){$j(this.skinContainerEl).append($j('<div id="'+this.aodSkinEl.replace("#","")+'" class="audio-player-generic-component"></div>'))}a.playerControls=$j(this.aodSkinEl)}$j(this.playerEl).avod(a)}},cleanUp:function(){$j("#track-meta").html("");$j("#track-meta").hide();if(this.persist!="true"){this.player.pause()}},removeListeners:function(){JSEngine.EventHandler.unSubscribe("paoff","mPlayerPAOffHandler");JSEngine.EventHandler.unSubscribe("paaudio","mPlayerPAAudioHandler");JSEngine.EventHandler.unSubscribe("pavideo","mPlayerPAVideoHandler");JSEngine.EventHandler.unSubscribe("pavideoa","mPlayerPAVideoAHandler");JSEngine.EventHandler.unSubscribe("paother","mPlayerPAOtherHandler");JSEngine.BasePlayer.prototype.removeListeners.call(this)}});namespace("JSEngine");JSEngine.TVPlayer=JSEngine.BasePlayer.extend({initialize:function(a){a=a||{};var b=["videoJSImgPath","playerEl","autoPlay","mediaUri","sClass","hClass","container","persist","AVOD","posterUrl","playerW","playerH","applicationVariables","messageManager","useSkin","playerType","mediaManager"];helpers.assertParametersExistAndAddToObject(a,b,this);this.isVolumeSupported=true;this.handlers={fullScreenTypeChangedHandler:function(c){this.positionCloseButton()},endedHandler:function(c){var d=this.player.playlistGetInfo();if(!d||d.length<=1){this.player.stop()}},readyHandler:function(c){$j(this.container).find("object, embed").css("visibility","visible");this.positionCloseButton()},pauseHandler:function(c){if(this.rotatePause){this.buttonPause=false;this.rotatePause=false}else{this.buttonPause=true}},decompressionHandler:function(c){this.player.pause();$j(this.playerEl).avod("showMessage","pa",this.applicationVariables.messages.sysMessages.decompression.message)},paOffHandler:function(c){this.player.play();$j(this.playerEl).avod("hideMessage")},paAudioHandler:function(c){this.player.pause();$j(this.playerEl).avod("showMessage","pa",this.applicationVariables.messages.paMessages.paAudio.message);helpers.setTimeout(function(){$j(this.playerEl).avod("hideMessage")},this.applicationVariables.messages.mediaPlayerMessages.timeout)},paVideoHandler:function(c){this.player.pause();$j(this.playerEl).avod("showMessage","pa",this.applicationVariables.messages.paMessages.paVideo.message);helpers.setTimeout(function(){$j(this.playerEl).avod("hideMessage")},this.applicationVariables.messages.mediaPlayerMessages.timeout)},paVideoAHandler:function(c){this.palyer.pause();$j(this.playerEl).avod("showMessage","pa",this.applicationVariables.messages.paMessages.paVideoA.message);helpers.setTimeout(function(){$j(this.playerEl).avod("hideMessage")},this.applicationVariables.messages.mediaPlayerMessages.timeout)},paOtherHandler:function(c){this.player.pause();$j(this.playerEl).avod("showMessage","pa",this.applicationVariables.messages.paMessages.paOther.message);helpers.setTimeout(function(){$j(this.playerEl).avod("hideMessage")},this.applicationVariables.messages.mediaPlayerMessages.timeout)}};JSEngine.BasePlayer.prototype.initialize.call(this);this.createPlayer();JSEngine.EventHandler.subscribe("extvStationChange","TVPlayer"+(Math.random()*100000),function(d){var c=false;_.each(d,function(e){if(this.mediaUri===e.media_uri){c=true}}.createDelegate(this));if(!c){this.cleanUp();this.channelAvalibilityStatus(false)}}.createDelegate(this))},channelAvalibilityStatus:function(a){if(a){$j("html").removeClass("ae-extv-channel-unavailable")}else{$j("html").addClass("ae-extv-channel-unavailable")}},createPlayer:function(){this.player=new this.AVOD.TVPlayer({target:this.playerEl,width:this.playerW,height:this.playerH});this.player.addEventListener(this.AVOD.Events.FULL_SCREEN_CHANGE,this.handlers.fullScreenTypeChangedHandler.createDelegate(this));this.player.addEventListener(this.AVOD.Events.ENDED,this.handlers.endedHandler.createDelegate(this));this.player.addEventListener(this.AVOD.Events.READY,this.handlers.readyHandler.createDelegate(this));this.player.addEventListener(this.AVOD.Events.PAUSE,this.handlers.pauseHandler.createDelegate(this));window.addEventListener("resize",this.positionCloseButton.createDelegate(this),false);JSEngine.EventHandler.subscribe("paoff","mPlayerPAOffHandler",this.handlers.paOffHandler.createDelegate(this),this);JSEngine.EventHandler.subscribe("paaudio","mPlayerPAAudioHandler",this.handlers.paAudioHandler.createDelegate(this),this);JSEngine.EventHandler.subscribe("pavideo","mPlayerPAVideoHandler",this.handlers.paVideoHandler.createDelegate(this),this);JSEngine.EventHandler.subscribe("pavideoa","mPlayerPAVideoAHandler",this.handlers.paVideoAHandler.createDelegate(this),this);JSEngine.EventHandler.subscribe("paother","mPlayerPAOtherHandler",this.handlers.paOtherHandler.createDelegate(this),this);this.setupBaseErrorListeners();this.addRotationHandler();return this},load:function(){var a={media_uri:this.mediaUri,autoplay:this.autoPlay,poster_url:this.poster};this.player.load(a);this.show()},skin:function(){if(this.useSkin){$j(this.playerEl).avod({avodPlayer:this.player,controlSwf:this.getMediaPlayerControlPluginPath(),skin:"vjs-qantas-video-skin",onComplete:this.updatePlayButtonPosition.createDelegate(this)})}},updatePlayButtonPosition:function(){$j(this.playerEl).parent("div.avod-wrapper:first").find(".vjs-play-control").css("margin-left","26px")},positionCloseButton:function(){var c=$j(this.playerEl);var b=c.parent("div.avod-wrapper:first");var d=b.find(".vjs-stop-control");var a=b.find(".vjs-controls");var e=0;if(d.length>0&&a.length>0){e=c.width()-a.offset().left-d.width()+c.offset().left-20;closeTop=-a.position().top+50;d.css({left:e,top:closeTop})}},cleanUp:function(){if(this.persist!="true"){this.player.pause()}this.hide()},show:function(){this.channelAvalibilityStatus(true);if(!$j(this.container).hasClass(this.sClass)){$j(this.container).addClass(this.sClass)}if($j(this.container).hasClass(this.hClass)){$j(this.container).removeClass(this.hClass)}},hide:function(){if(!$j(this.container).hasClass(this.hClass)){$j(this.container).addClass(this.hClass)}if($j(this.container).hasClass(this.sClass)){$j(this.container).removeClass(this.sClass)}},addRotationHandler:function(){$j(window).bind("orientationchange",function(){switch(window.orientation){case 0:case 180:this.positionCloseButton();this.rotatePause=true;this.player.pause();break;case -90:case 90:this.positionCloseButton();if(!this.buttonPause){this.player.play()}break}}.createDelegate(this))},removeListeners:function(){JSEngine.EventHandler.unSubscribe("paoff","mPlayerPAOffHandler");JSEngine.EventHandler.unSubscribe("paaudio","mPlayerPAAudioHandler");JSEngine.EventHandler.unSubscribe("pavideo","mPlayerPAVideoHandler");JSEngine.EventHandler.unSubscribe("pavideoa","mPlayerPAVideoAHandler");JSEngine.EventHandler.unSubscribe("paother","mPlayerPAOtherHandler");JSEngine.BasePlayer.prototype.removeListeners.call(this)}});namespace("JSEngine");var metaDataRegistry={};var metaDataRegistryCallbacks={};JSEngine.PlaylistItem=JSEngine.Model.extend({initialize:function(b,a){a=a||{};if(_.isUndefined(b)){throw new Error("attrs needs to be defined")}JSEngine.Model.prototype.initialize.call(this,b,a)},fetch:function(a){a=a||{};var b=this.get("media_uri");JSEngine.IFAPIInitHelper.initialize("metadata/v1",function(d){var e=d[0];var c=function(g,h){this.hasBeenFetched=true;if(g){if(_.isFunction(a.error)){var f=Backbone.wrapError(a.error,this,a);f(g)}_.each(metaDataRegistryCallbacks[b],function(i){if(i.error){i.error(g)}},this);delete metaDataRegistryCallbacks[b]}else{this._setData(this,h,a);metaDataRegistry[b]=h;_.each(metaDataRegistryCallbacks[b],function(i){this._setData(i.model,h,{success:i.success,error:i.error})},this);delete metaDataRegistryCallbacks[b]}}.createDelegate(this);if(!_.isUndefined(metaDataRegistry[b])){if(metaDataRegistry[b]){this.hasBeenFetched=true;this._setData(this,metaDataRegistry[b],a)}else{metaDataRegistryCallbacks[b].push({error:a.error,success:a.success,model:this})}}else{metaDataRegistryCallbacks[b]=[];metaDataRegistry[b]=false;e.mediaMetadata({media_uri:this.get("media_uri")},c)}}.createDelegate(this))},_setData:function(b,c,a){b.set(c,{silent:true});if(_.isFunction(a.success)){a.success(this)}},setEl:function(a){this.el=a}});namespace("JSEngine");JSEngine.FlightIdItem=Backbone.Model.extend({initialize:function(a){a=a||{};Backbone.Model.prototype.initialize.call(this);this.set({flight_id:this._getCurrentFlightId()});this.on("change:flight_id",this._changeFlightId.createDelegate(this))},url:function(){return"/flight_id.json?t="+new Date().getTime()},_getCurrentFlightId:function(){var b=helpers.localStorage("lastFlightId");if(b){try{b=parseInt(b)}catch(a){b=undefined;console.error("Unable to convert flight id: "+b)}}return b},_changeFlightId:function(){helpers.localStorage("lastFlightId",this.get("flight_id"))}});namespace("JSEngine.Media");JSEngine.Media.PlaylistLink=Backbone.Model.extend({initialize:function(a){helpers.assertParametersExistAndAddToObject(a,["page","linkType","playlistName","el","mediaManager","linkUriType"],this);helpers.addParametersToObjectIfExist(a,["mediaUri","mediaIndex"],this);this.mediaUri=this.mediaUri?(this.mediaUri+""):undefined;this.onPlaylistChange=_.bind(this.onPlaylistChange,this);this.onPlaylistRemove=_.bind(this.onPlaylistRemove,this);if(this.mediaUri&&this.mediaIndex){throw"only mediaUri or media index should be set"}this.page.pageManager.waitForComponents([{lookup:this.mediaManager.getPlaylistByName,scope:this.mediaManager,value:this.playlistName}],function(){var b=this.mediaManager.getPlaylistByName(this.playlistName);b.on("change",this.onPlaylistChange);b.on("remove",this.onPlaylistRemove)}.createDelegate(this));this.el.click(function(b){b.preventDefault();var d=document.activeElement;helpers.setTimeout(function(){d.focus()},1000);var c=this.mediaManager.getPlaylistByName(this.playlistName);if(this.linkType=="add"){if(this.linkUriType=="item"){c.addMediaUris([this.mediaUri])}else{this.addAllChildMedia(c)}}else{if(this.linkType=="remove"){if(this.linkUriType!="item"){throw"linkUriType should be item"}if(!_.isUndefined(this.mediaUri)){c.removeMediaUris([this.mediaUri])}else{if(!_.isUndefined(this.mediaIndex)){c.removeMediaIndex(this.el.attr("data-media-index"))}}}}return false}.createDelegate(this))},cleanUp:function(){var a=this.mediaManager.getPlaylistByName(this.playlistName);if(a){a.off("change",this.onPlaylistChange);a.off("remove",this.onPlaylistRemove)}},onPlaylistRemove:function(){var a=this.mediaManager.getPlaylistByName(this.playlistName);if(a.length===0){$j(this.el).removeClass("item-added")}},onPlaylistChange:function(){var a=this.mediaManager.getPlaylistByName(this.playlistName);_.each(a.models,function(b){if(this.mediaUri===b.get("media_uri")){$j(this.el).addClass("item-added")}}.createDelegate(this))},addAllChildMedia:function(b){var a=new JSEngine.ChildMediaCollection([],{jsonPathToMediaChildIdInApplicationVariables:"",staticMediaChildIdInApplicationVariables:""+this.mediaUri,page:this.page});a.on("fetchSuccess",function(d){var c=_.map(d.models,function(e){return e.get("media_uri")});b.addMediaUris(c)});a.fetch({})}});namespace("JSEngine.Media");JSEngine.Media.PlaylistClearLink=Backbone.Model.extend({initialize:function(a){helpers.assertParametersExistAndAddToObject(a,["page","playlistName","el","mediaManager"],this);this.el.click(function(b){b.preventDefault();var c=this.mediaManager.getPlaylistByName(this.playlistName);c.player.stop();c.clear();c.trigger("clearPlayList");return false}.createDelegate(this))}});namespace("JSEngine.Media");JSEngine.Media.PlayerControlLink=Backbone.Model.extend({initialize:function(a){helpers.assertParametersExistAndAddToObject(a,["applicationVariables","linkType","playerName","el","mediaManager","feedManager","messageManager","page"],this);helpers.addParametersToObjectIfExist(a,["reset","isContainer"],this);this.onClick=_.bind(this.onClick,this);this.onPlayerAddedToMediaManager=_.bind(this.onPlayerAddedToMediaManager,this);this.onPlayerStateChange=_.bind(this.onPlayerStateChange,this);this.mediaUri=a.mediaUri;this.childMediaUri=a.childMediaUri;if(!this.isContainer){this.el.on("click",this.onClick)}this.mediaManager.on("playerAdded",this.onPlayerAddedToMediaManager);var b=this.mediaManager.getByName(this.playerName);if(b){this.onPlayerAddedToMediaManager({player:b})}if(this.isContainer){this.createChildElementWrapper()}},onPlayerStateChange:function(b){var a=this.delegatedPlayer.player.playlistGetInfo()[this.delegatedPlayer.player.playlistGetCurrentItemIndex()];helpers.removeClassByPrefix(this.el,"ae-item");if(this.childMediaUri==a){switch(b){case"play":this.el.addClass("ae-item-playing");break}}},onPlayerAddedToMediaManager:function(a){if(a.player.name===this.playerName){if(this.delegatedPlayer){this.delegatedPlayer.off("stateChange",this.onPlayerStateChange)}this.delegatedPlayer=a.player;this.delegatedPlayer.on("stateChange",this.onPlayerStateChange)}},onClick:function(c){c.preventDefault();var b=this.delegatedPlayer||this.mediaManager.getByName(this.playerName);if(b&&!b.loading){switch(this.linkType){case"play":var a=this.mediaUri?_.template(this.mediaUri+"",this.applicationVariables):null;var d=this.childMediaUri?_.template(this.childMediaUri+"",this.applicationVariables):null;if(this.reset){b.setPlaylistIndex(0)}b.play(a,d);break;case"pause":b.pause();break;case"stop":b.stop();break;case"dynamic":var a=this.mediaUri?_.template(this.mediaUri+"",this.applicationVariables):null;var d=this.childMediaUri?_.template(this.childMediaUri+"",this.applicationVariables):null;if((b.getCurrentUri()===a||b.getCurrentUri()===d)&&b.getState()==="play"){b.pause()}else{b.play(a,d)}break;default:console.error("PlayerControlLink: Cannot find type of action for linkType '"+this.linkType+"'")}}else{console.error("PlayerControlLink: Unable to find media player: '"+this.playerName+"'")}return},createChildElementWrapper:function(){if(this.childElementWrapper){this.childElementWrapper.cleanUp();delete this.childElementWrapper}this.childElementWrapper=new JSEngine.ElementWrapper({el:this.el,applicationVariables:this.applicationVariables,page:this.page,feedManager:this.feedManager,mediaManager:this.mediaManager,messageManager:this.messageManager})},cleanUp:function(){if(this.childElementWrapper){this.childElementWrapper.cleanUp();delete this.childElementWrapper}}});namespace("JSEngine.Media");JSEngine.Media.TVPlayer=JSEngine.Media.BasePlayer.extend({initialize:function(a){JSEngine.Media.BasePlayer.prototype.initialize.call(this,a);this.extvStationChangeMessage=new JSEngine.Message({template:helpers.getTemplateMarkup("channelUnavailableMessageBox")});this.backToPreviousPage=a.backToPreviousPage;JSEngine.EventHandler.subscribe("extvStationChange","TVPlayer"+(Math.random()*100000),this.changeStationChannel.createDelegate(this))},createNewPlayer:function(a){var b=new a.TVPlayer({target:this.mediaContainerSelector,width:"100%",height:"100%",auto_install:(this.autoInstall===undefined?true:this.autoInstall)});return b},loadPlayer:function(a){this.channelAvalibilityStatus(true);JSEngine.Media.BasePlayer.prototype.loadPlayer.call(this,a)},changeStationChannel:function(d){var b=false;var c;_.each(d,function(e){if(this.currentMediaUri===e.media_uri){b=true}c=c||e.media_uri}.createDelegate(this));if(!b){this.stop();if(this.player.isAbsoluteFullScreen()){console.log("Player: In Fullscreen");this.wasInFullScreen=this.player.cancelFullScreen();console.log("Player: Fullscreen cancelled")}if(this.player.isHtml()){this.player.hide()}var a=function(){if(this.backToPreviousPage){helpers.windowHistoryGoBack(1)}else{var f={};f[this.uriParameterName]=c;var e="#"+this.page.name+"/"+JSON.stringify(f);helpers.changeDocumentLocation(e)}}.createDelegate(this);if(this.applicationVariables.messages.tvMessages&&this.applicationVariables.messages.tvMessages.unavailable){this.extvStationChangeMessage.show(this.applicationVariables.messages.tvMessages.unavailable,a)}this.channelAvalibilityStatus(false)}},channelAvalibilityStatus:function(a){if(a){$j("html").removeClass("ae-extv-channel-unavailable")}else{$j("html").addClass("ae-extv-channel-unavailable")}}});namespace("JSEngine.Media");JSEngine.Media.VideoPlayer=JSEngine.Media.SeekingBasePlayer.extend({initialize:function(a){JSEngine.Media.SeekingBasePlayer.prototype.initialize.call(this,a)},createNewPlayer:function(a){var b=new a.VODPlayer({target:this.mediaContainerSelector,width:"100%",height:"100%",auto_install:(this.autoInstall===undefined?true:this.autoInstall)});return b},loadPlayer:function(a){JSEngine.Media.SeekingBasePlayer.prototype.loadPlayer.call(this,a);JSEngine.Media.BasePlayer.prototype.loadPlayer.call(this,a)}});namespace("JSEngine.Media");JSEngine.Media.AudioPlayer=JSEngine.Media.SeekingBasePlayer.extend({initialize:function(a){JSEngine.Media.SeekingBasePlayer.prototype.initialize.call(this,a)},createNewPlayer:function(a){var b=new a.AODPlayer({target:this.mediaContainerSelector,width:"100%",height:"100%",auto_install:(this.autoInstall===undefined?true:this.autoInstall)});return b},loadPlayer:function(a){JSEngine.Media.SeekingBasePlayer.prototype.loadPlayer.call(this,a);JSEngine.Media.BasePlayer.prototype.loadPlayer.call(this,a)}});namespace("JSEngine.Media");JSEngine.Media.ShuffleLink=Backbone.Model.extend({initialize:function(a){this.config=a||{};var b=["el","classIsShuffled","classNotShuffled","mediaManager","playlistName"];helpers.assertParametersExistAndAddToObject(this.config,b,this);a.page.pageManager.waitForComponents([{lookup:a.mediaManager.getPlaylistByName,scope:a.mediaManager,value:this.playlistName},{lookup:a.mediaManager.getByName,scope:a.mediaManager,name:"mediaPlayerName"}],this.setup.createDelegate(this))},setup:function(){this.playlist=this.mediaManager.getPlaylistByName(this.playlistName);this.player=this.mediaManager.getByName(this.playlist.mediaPlayerName);var b=function(){this.getShuffle()?this.shuffleOnClass():this.shuffleOffClass()}.createDelegate(this);var a=function(){b();this.player.off("playerReady",a)}.createDelegate(this);(this.player.isReady())?b():this.player.on("playerReady",a);this.el.click(function(c){c.preventDefault();this.toggleShuffleAndUpdateStyle()}.createDelegate(this))},toggleShuffleAndUpdateStyle:function(){(this.getShuffle())?this.setShuffle(false,this.shuffleOffClass.createDelegate(this)):this.setShuffle(true,this.shuffleOnClass.createDelegate(this))},toggleClass:function(a,b){this.el.removeClass(a);this.el.addClass(b)},shuffleOnClass:function(){this.toggleClass(this.config.classNotShuffled,this.config.classIsShuffled)},shuffleOffClass:function(){this.toggleClass(this.config.classIsShuffled,this.config.classNotShuffled)},getShuffle:function(){try{return this.player.getShuffle()}catch(a){console.error("An error occurred getting the shuffle value.");console.error(a)}},setShuffle:function(b,c){try{this.player.setShuffle(b);c()}catch(a){console.error("An error occurred setting the shuffle value.");console.error(a)}}});namespace("JSEngine.Media");JSEngine.Media.RepeatLink=Backbone.Model.extend({REPEATMODE:{NONE:0,ONE:1,ALL:2},REPEATMODES:["NONE","ONE","ALL"],CLASSNONE:"classRepeatNone",CLASSONE:"classRepeatOne",CLASSALL:"classRepeatAll",initialize:function(a){this.config=a||{};var b=["el",this.CLASSNONE,"mediaManager","playlistName"];helpers.assertParametersExistAndAddToObject(this.config,b,this);this.modes=this.configureModes(this.config);if(this.modes.length<2){throw new Error("RepeatLink: A style for either classReapeatOne or classRepeatAll must be provided.")}a.page.pageManager.waitForComponents([{lookup:a.mediaManager.getPlaylistByName,scope:a.mediaManager,value:this.playlistName},{lookup:a.mediaManager.getByName,scope:a.mediaManager,name:"mediaPlayerName"}],this.setup.createDelegate(this))},setup:function(){this.playlist=this.mediaManager.getPlaylistByName(this.playlistName);this.player=this.mediaManager.getByName(this.playlist.mediaPlayerName);var a=function(){this.setInitialStyle();this.player.off("playerReady",a)}.createDelegate(this);(this.player.isReady())?this.setInitialStyle():this.player.on("playerReady",a);this.el.click(function(b){b.preventDefault();this.cycleRepeatModeAndUpdateStyle()}.createDelegate(this))},configureModes:function(a){var b=["NONE"];if(a.classRepeatOne){b.push("ONE")}if(a.classRepeatAll){b.push("ALL")}return b},setInitialStyle:function(){var a=this.getRepeatMode();this.toggleClasses(this.REPEATMODES,this.REPEATMODES[a])},cycleRepeatModeAndUpdateStyle:function(){var d=this.getRepeatMode();var b=this.nextMode(d);var a=_.without(this.modes,b);var c=function(){this.toggleClasses(a,b)}.createDelegate(this);this.setRepeatMode(this.REPEATMODE[b],c)},nextMode:function(b){var a=this.modes.indexOf(this.REPEATMODES[b])+1;if(a>=(this.modes.length)){return this.modes[0]}return this.modes[a]},lookupClassViaMode:function(b){var a;switch(b){case"NONE":a=this.CLASSNONE;break;case"ONE":a=this.CLASSONE;break;case"ALL":a=this.CLASSALL;break;default:throw new Error("RepeatLink: Lookup class via mode failed.")}return this.config[a]},toggleClasses:function(a,b){_.each(a,function(c){if(_.isUndefined(this.lookupClassViaMode(c))){return}this.el.removeClass(this.lookupClassViaMode(c))},this);this.el.addClass(this.lookupClassViaMode(b))},getRepeatMode:function(){try{return this.player.getRepeatMode()}catch(a){console.error("An error occurred getting the repeat mode.");console.error(a)}},setRepeatMode:function(c,b){try{this.player.setRepeatMode(c);b()}catch(a){console.error("An error occurred setting the repeat mode.");console.error(a)}}});namespace("JSEngine.Media");JSEngine.Media.SoundtrackList=Backbone.Model.extend({templateContent:"",container:null,limit:1,hideBelowLimit:false,initialize:function(a){helpers.assertParametersExistAndAddToObject(a,["el","page","template","mediaUri","feedManager","mediaManager","messageManager","applicationVariables",],this);helpers.addParametersToObjectIfExist(a,["limit","hideBelowLimit"],this);this.container=(a.container&&this.el.find(a.container).length==1)?this.el.find(a.container):this.el;this.templateContent=_.template(helpers.parseTemplateMarkup(this.el,a.template)||helpers.parseTemplateMarkup($j("body"),"#"+a.template));this.errorTemplateContent=_.template(helpers.parseTemplateMarkup(this.el,a.errorTemplate)||helpers.parseTemplateMarkup($j("body"),"#"+a.errorTemplate)||"");this.noDataTemplateContent=_.template(helpers.parseTemplateMarkup(this.el,a.noDataTemplate)||helpers.parseTemplateMarkup($j("body"),"#"+a.noDataTemplate)||"");this.loadingTemplateContent=_.template(helpers.parseTemplateMarkup(this.el,a.loadingTemplate)||helpers.parseTemplateMarkup($j("body"),"#"+a.loadingTemplate)||"");JSEngine.ViewHelper.renderItem(this.container,this.loadingTemplateContent,{});this.getMetadata(this.mediaUri,this.onGetMetadata.createDelegate(this))},getMetadata:function(b,a){JSEngine.IFAPIInitHelper.initialize("metadata/v1",function(c){var d=c[0];d.mediaMetadata({media_uri:b},a)})},onGetMetadata:function(a,b){if(a){JSEngine.ViewHelper.renderItem(this.el,this.errorTemplateContent,a)}else{if(b.hasOwnProperty("soundtrack")){this.render(b.soundtrack)}else{this.render()}}},render:function(a){if(a&&a.length>=this.limit){var b="";_.each(a,function(d){var c=$j("<div/>");JSEngine.ViewHelper.renderItem(c,this.templateContent,d);b+=c.html()}.createDelegate(this));this.container.html(b)}else{JSEngine.ViewHelper.renderItem(this.container,this.noDataTemplateContent,{})}if(a&&a.length<this.limit&&this.hideBelowLimit){this.el.hide()}else{this.el.show()}}});namespace("JSEngine");JSEngine.UADeviceChecker=JSEngine.DeviceRouteChecker.extend({initialize:function(a){a=a||{};JSEngine.DeviceRouteChecker.prototype.initialize.call(this,a);helpers.assertParametersExistAndAddToObject(a,["regex","flags"],this)},doCheck:function(a){var c=JSEngine.DeviceRouteChecker.prototype.doCheck.call(this,a);if(c==false){return c}var b=new RegExp(this.regex,this.flags);return a.userAgent.match(b)}});namespace("JSEngine");JSEngine.LocaleAndUADeviceChecker=JSEngine.DeviceRouteChecker.extend({initialize:function(a){a=a||{};JSEngine.DeviceRouteChecker.prototype.initialize.call(this,a);helpers.assertParametersExistAndAddToObject(a,["lang"],this);helpers.addParametersToObjectIfExist(a,["regex","flags"],this)},doCheck:function(a){var b=JSEngine.DeviceRouteChecker.prototype.doCheck.call(this,a);if(b==false){return b}if(this.regex!=undefined&&this.flags!=undefined){if(!a.userAgent.match(new RegExp(this.regex,this.flags))){return false}}var c=(a.languages&&a.languages.length>0)?a.languages[0]:a.language||a.userLanguage;if(c.substring(0,this.lang.length)==this.lang){}else{return false}return b}});$j(document).ready(function(){if(console.debug==undefined){console.debug=console.log}if(document.location.search.indexOf("debug=true")>0){compSpy=new ComponentSpy(JSEngine,"JSEngine");btn=$j("<button />").text("Generate Report").css("position","fixed").css("bottom","10px").css("right","10px");btn.appendTo($j("body"));btn.click(function(){compSpy.generateReport()})}window.html5.elements="abbr article aside bdi canvas data datalist details figcaption figure footer header hgroup main mark meter nav output progress section summary template time";html5.shivDocument(document);if(respond.hasInitialised()){$j("html").addClass("ae-respond-js-initialised")}else{$j("html").addClass("ae-respond-js-initialising");respond.addEventListener("onInitEnd",function(){$j("html").removeClass("ae-respond-js-initialising");$j("html").addClass("ae-respond-js-initialised")})}var a=function(d){var c=new JSEngine.AppRouter({engineController:d});Backbone.history.start()};var b=new JSEngine.EngineContoller({afterInitialise:a})});